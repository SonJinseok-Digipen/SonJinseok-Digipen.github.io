\hypertarget{transformation_8h_source}{}\doxysection{transformation.\+h}
\label{transformation_8h_source}\index{AseSprite/aseprite/src/app/transformation.h@{AseSprite/aseprite/src/app/transformation.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Aseprite}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ Copyright\ (C)\ 2020-\/2022\ \ Igara\ Studio\ S.A.}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ Copyright\ (C)\ 2001-\/2016\ \ David\ Capello}}
\DoxyCodeLine{00004\ \textcolor{comment}{//}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ This\ program\ is\ distributed\ under\ the\ terms\ of}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ the\ End-\/User\ License\ Agreement\ for\ Aseprite.}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#ifndef\ APP\_TRANSFORMATION\_H\_INCLUDED}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#define\ APP\_TRANSFORMATION\_H\_INCLUDED}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ "{}gfx/point.h"{}}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ "{}gfx/rect.h"{}}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#define\ CORNER\_THICK\_FOR\_TILEMAP\_MODE\ 0.001}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#define\ CORNER\_THICK\_FOR\_PIXELS\_MODE\ 1.0}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{keyword}{namespace\ }app\ \{}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{comment}{//\ Represents\ a\ transformation\ that\ can\ be\ done\ by\ the\ user\ in\ the}}
\DoxyCodeLine{00022\ \textcolor{comment}{//\ document\ when\ he/she\ moves\ the\ mask\ using\ the\ selection\ handles.}}
\DoxyCodeLine{00023\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classapp_1_1_transformation}{Transformation}}\ \{}
\DoxyCodeLine{00024\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00025\ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{classapp_1_1_transformation_1_1_corners}{Corners}}\ \{}
\DoxyCodeLine{00026\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00027\ \ \ \ \ \ \ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ LEFT\_TOP\ =\ 0,}
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ RIGHT\_TOP\ =\ 1,}
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ RIGHT\_BOTTOM\ =\ 2,}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ LEFT\_BOTTOM\ =\ 3,}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ NUM\_OF\_CORNERS\ =\ 4}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \};}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \ \ \ \ \ \ \mbox{\hyperlink{classapp_1_1_transformation_1_1_corners}{Corners}}()\ :\ m\_corners(NUM\_OF\_CORNERS)\ \{\ \}}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \mbox{\hyperlink{classapp_1_1_transformation_1_1_corners}{Corners}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classgfx_1_1_rect_t}{gfx::RectF}}\ bounds)\ :\ m\_corners(NUM\_OF\_CORNERS)\ \{}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ m\_corners[LEFT\_TOP].x\ =\ bounds.x;}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ m\_corners[LEFT\_TOP].y\ =\ bounds.y;}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ m\_corners[RIGHT\_TOP].x\ =\ bounds.x2();}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ m\_corners[RIGHT\_TOP].y\ =\ bounds.y;}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ m\_corners[RIGHT\_BOTTOM].x\ =\ bounds.x2();}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ m\_corners[RIGHT\_BOTTOM].y\ =\ bounds.y2();}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ m\_corners[LEFT\_BOTTOM].x\ =\ bounds.x;}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ m\_corners[LEFT\_BOTTOM].y\ =\ bounds.y2();}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \ \ \ \ \ \ std::size\_t\ size()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_corners.size();\ \}}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \ \ \ \ \ \ \mbox{\hyperlink{classgfx_1_1_point_t}{gfx::PointF}}\&\ operator[](\textcolor{keywordtype}{int}\ index)\ \{\ \textcolor{keywordflow}{return}\ m\_corners[index];\ \}}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classgfx_1_1_point_t}{gfx::PointF}}\&\ operator[](\textcolor{keywordtype}{int}\ index)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_corners[index];\ \}}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classgfx_1_1_point_t}{gfx::PointF}}\&\ leftTop()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_corners[LEFT\_TOP];\ \}}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classgfx_1_1_point_t}{gfx::PointF}}\&\ rightTop()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_corners[RIGHT\_TOP];\ \}}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classgfx_1_1_point_t}{gfx::PointF}}\&\ rightBottom()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_corners[RIGHT\_BOTTOM];\ \}}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classgfx_1_1_point_t}{gfx::PointF}}\&\ leftBottom()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_corners[LEFT\_BOTTOM];\ \}}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ leftTop(\textcolor{keyword}{const}\ \mbox{\hyperlink{classgfx_1_1_point_t}{gfx::PointF}}\&\ pt)\ \{\ m\_corners[LEFT\_TOP]\ =\ pt;\ \}}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ rightTop(\textcolor{keyword}{const}\ \mbox{\hyperlink{classgfx_1_1_point_t}{gfx::PointF}}\&\ pt)\ \{\ m\_corners[RIGHT\_TOP]\ =\ pt;\ \}}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ rightBottom(\textcolor{keyword}{const}\ \mbox{\hyperlink{classgfx_1_1_point_t}{gfx::PointF}}\&\ pt)\ \{\ m\_corners[RIGHT\_BOTTOM]\ =\ pt;\ \}}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ leftBottom(\textcolor{keyword}{const}\ \mbox{\hyperlink{classgfx_1_1_point_t}{gfx::PointF}}\&\ pt)\ \{\ m\_corners[LEFT\_BOTTOM]\ =\ pt;\ \}}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \ \ \ \ \ \ \mbox{\hyperlink{classgfx_1_1_rect_t}{gfx::RectF}}\ bounds(\textcolor{keywordtype}{double}\ cornerThick)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classgfx_1_1_rect_t}{gfx::RectF}}\ bounds;}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i=0;\ i<Corners::NUM\_OF\_CORNERS;\ ++i)}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ bounds\ |=\ \mbox{\hyperlink{classgfx_1_1_rect_t}{gfx::RectF}}(m\_corners[i].x,\ m\_corners[i].y,\ cornerThick,\ cornerThick);}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ bounds.floor();}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00069\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00070\ \ \ \ \ \ \ std::vector<gfx::PointF>\ m\_corners;}
\DoxyCodeLine{00071\ \ \ \};}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ \mbox{\hyperlink{classapp_1_1_transformation}{Transformation}}();}
\DoxyCodeLine{00074\ \ \ \mbox{\hyperlink{classapp_1_1_transformation}{Transformation}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classgfx_1_1_rect_t}{gfx::RectF}}\&\ bounds,\ \textcolor{keywordtype}{double}\ cornerThick);}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \ \ \textcolor{comment}{//\ Simple\ getters\ and\ setters.\ The\ angle\ is\ in\ radians.}}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classgfx_1_1_rect_t}{gfx::RectF}}\&\ bounds()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_bounds;\ \}}
\DoxyCodeLine{00079\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classgfx_1_1_point_t}{gfx::PointF}}\&\ pivot()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_pivot;\ \}}
\DoxyCodeLine{00080\ \ \ \textcolor{keywordtype}{double}\ cornerThick()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_cornerThick;\ \}}
\DoxyCodeLine{00081\ \ \ \textcolor{keywordtype}{double}\ angle()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_angle;\ \}}
\DoxyCodeLine{00082\ \ \ \textcolor{keywordtype}{double}\ skew()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_skew;\ \}}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ \textcolor{keywordtype}{void}\ bounds(\textcolor{keyword}{const}\ \mbox{\hyperlink{classgfx_1_1_rect_t}{gfx::RectF}}\&\ bounds)\ \{\ m\_bounds\ =\ bounds;\ \}}
\DoxyCodeLine{00085\ \ \ \textcolor{keywordtype}{void}\ pivot(\textcolor{keyword}{const}\ \mbox{\hyperlink{classgfx_1_1_point_t}{gfx::PointF}}\&\ pivot)\ \{\ m\_pivot\ =\ pivot;\ \}}
\DoxyCodeLine{00086\ \ \ \textcolor{keywordtype}{void}\ angle(\textcolor{keywordtype}{double}\ angle)\ \{\ m\_angle\ =\ angle;\ \}}
\DoxyCodeLine{00087\ \ \ \textcolor{keywordtype}{void}\ skew(\textcolor{keywordtype}{double}\ angle)\ \{\ m\_skew\ =\ angle;\ \}}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ \ \ \textcolor{comment}{//\ Applies\ the\ transformation\ (rotation\ with\ angle/pivot)\ to\ the}}
\DoxyCodeLine{00090\ \ \ \textcolor{comment}{//\ current\ bounds\ (m\_bounds).}}
\DoxyCodeLine{00091\ \ \ Corners\ transformedCorners()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ \textcolor{comment}{//\ Changes\ the\ pivot\ to\ another\ location,\ adjusting\ the\ bounds\ to}}
\DoxyCodeLine{00094\ \ \ \textcolor{comment}{//\ keep\ the\ current\ rotated-\/corners\ in\ the\ same\ location.}}
\DoxyCodeLine{00095\ \ \ \textcolor{keywordtype}{void}\ displacePivotTo(\textcolor{keyword}{const}\ \mbox{\hyperlink{classgfx_1_1_point_t}{gfx::PointF}}\&\ newPivot);}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \mbox{\hyperlink{classgfx_1_1_rect_t}{gfx::RectF}}\ transformedBounds()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00099\ \ \ \textcolor{comment}{//\ Static\ helper\ method\ to\ rotate\ points.}}
\DoxyCodeLine{00100\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classgfx_1_1_point_t}{gfx::PointF}}\ rotatePoint(\textcolor{keyword}{const}\ \mbox{\hyperlink{classgfx_1_1_point_t}{gfx::PointF}}\&\ \mbox{\hyperlink{structpoint}{point}},}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classgfx_1_1_point_t}{gfx::PointF}}\&\ pivot,}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ angle,}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ skew);}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00106\ \ \ \mbox{\hyperlink{classgfx_1_1_rect_t}{gfx::RectF}}\ m\_bounds\ =\ \mbox{\hyperlink{classgfx_1_1_rect_t}{gfx::RectF}}(0.0,\ 0.0,\ 0.0,\ 0.0);}
\DoxyCodeLine{00107\ \ \ \mbox{\hyperlink{classgfx_1_1_point_t}{gfx::PointF}}\ m\_pivot\ =\ \mbox{\hyperlink{classgfx_1_1_point_t}{gfx::PointF}}(0.0,\ 0.0);}
\DoxyCodeLine{00108\ \ \ \textcolor{keywordtype}{double}\ m\_angle\ =\ 0.0;}
\DoxyCodeLine{00109\ \ \ \textcolor{keywordtype}{double}\ m\_skew\ =\ 0.0;}
\DoxyCodeLine{00110\ \ \ \textcolor{keywordtype}{double}\ m\_cornerThick\ =\ CORNER\_THICK\_FOR\_PIXELS\_MODE;}
\DoxyCodeLine{00111\ \};}
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00113\ \}\ \textcolor{comment}{//\ namespace\ app}}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}

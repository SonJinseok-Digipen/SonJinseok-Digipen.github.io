\hypertarget{vtls_8h_source}{}\doxysection{vtls.\+h}
\label{vtls_8h_source}\index{AseSprite/aseprite/third\_party/curl/lib/vtls/vtls.h@{AseSprite/aseprite/third\_party/curl/lib/vtls/vtls.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ HEADER\_CURL\_VTLS\_H}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ HEADER\_CURL\_VTLS\_H}}
\DoxyCodeLine{00003\ \textcolor{comment}{/***************************************************************************}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ *\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\ \ \ \_\ \_\_\_\_\ \ \_}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ *\ \ Project\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_\_|\ |\ |\ |\ \ \_\ \(\backslash\)|\ |}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ *\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ /\ \_\_|\ |\ |\ |\ |\_)\ |\ |}}
\DoxyCodeLine{00007\ \textcolor{comment}{\ *\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ (\_\_|\ |\_|\ |\ \ \_\ <|\ |\_\_\_}}
\DoxyCodeLine{00008\ \textcolor{comment}{\ *\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)\_\_\_|\(\backslash\)\_\_\_/|\_|\ \(\backslash\)\_\(\backslash\)\_\_\_\_\_|}}
\DoxyCodeLine{00009\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00010\ \textcolor{comment}{\ *\ Copyright\ (C)\ 1998\ -\/\ 2021,\ Daniel\ Stenberg,\ <daniel@haxx.se>,\ et\ al.}}
\DoxyCodeLine{00011\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00012\ \textcolor{comment}{\ *\ This\ software\ is\ licensed\ as\ described\ in\ the\ file\ COPYING,\ which}}
\DoxyCodeLine{00013\ \textcolor{comment}{\ *\ you\ should\ have\ received\ as\ part\ of\ this\ distribution.\ The\ terms}}
\DoxyCodeLine{00014\ \textcolor{comment}{\ *\ are\ also\ available\ at\ https://curl.se/docs/copyright.html.}}
\DoxyCodeLine{00015\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00016\ \textcolor{comment}{\ *\ You\ may\ opt\ to\ use,\ copy,\ modify,\ merge,\ publish,\ distribute\ and/or\ sell}}
\DoxyCodeLine{00017\ \textcolor{comment}{\ *\ copies\ of\ the\ Software,\ and\ permit\ persons\ to\ whom\ the\ Software\ is}}
\DoxyCodeLine{00018\ \textcolor{comment}{\ *\ furnished\ to\ do\ so,\ under\ the\ terms\ of\ the\ COPYING\ file.}}
\DoxyCodeLine{00019\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00020\ \textcolor{comment}{\ *\ This\ software\ is\ distributed\ on\ an\ "{}AS\ IS"{}\ basis,\ WITHOUT\ WARRANTY\ OF\ ANY}}
\DoxyCodeLine{00021\ \textcolor{comment}{\ *\ KIND,\ either\ express\ or\ implied.}}
\DoxyCodeLine{00022\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00023\ \textcolor{comment}{\ ***************************************************************************/}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}curl\_setup.h"{}}}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structconnectdata}{connectdata}};}
\DoxyCodeLine{00027\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structssl__connect__data}{ssl\_connect\_data}};}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#define\ SSLSUPP\_CA\_PATH\ \ \ \ \ \ (1<<0)\ }\textcolor{comment}{/*\ supports\ CAPATH\ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#define\ SSLSUPP\_CERTINFO\ \ \ \ \ (1<<1)\ }\textcolor{comment}{/*\ supports\ CURLOPT\_CERTINFO\ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#define\ SSLSUPP\_PINNEDPUBKEY\ (1<<2)\ }\textcolor{comment}{/*\ supports\ CURLOPT\_PINNEDPUBLICKEY\ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#define\ SSLSUPP\_SSL\_CTX\ \ \ \ \ \ (1<<3)\ }\textcolor{comment}{/*\ supports\ CURLOPT\_SSL\_CTX\ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#define\ SSLSUPP\_HTTPS\_PROXY\ \ (1<<4)\ }\textcolor{comment}{/*\ supports\ access\ via\ HTTPS\ proxies\ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#define\ SSLSUPP\_TLS13\_CIPHERSUITES\ (1<<5)\ }\textcolor{comment}{/*\ supports\ TLS\ 1.3\ ciphersuites\ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#define\ SSLSUPP\_CAINFO\_BLOB\ \ (1<<6)}}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_curl__ssl}{Curl\_ssl}}\ \{}
\DoxyCodeLine{00038\ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00039\ \textcolor{comment}{\ \ \ *\ This\ *must*\ be\ the\ first\ entry\ to\ allow\ returning\ the\ list\ of\ available}}
\DoxyCodeLine{00040\ \textcolor{comment}{\ \ \ *\ backends\ in\ curl\_global\_sslset().}}
\DoxyCodeLine{00041\ \textcolor{comment}{\ \ \ */}}
\DoxyCodeLine{00042\ \ \ \mbox{\hyperlink{structcurl__ssl__backend}{curl\_ssl\_backend}}\ info;}
\DoxyCodeLine{00043\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ supports;\ \textcolor{comment}{/*\ bitfield,\ see\ above\ */}}
\DoxyCodeLine{00044\ \ \ \textcolor{keywordtype}{size\_t}\ sizeof\_ssl\_backend\_data;}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ int\ (*init)(void);}
\DoxyCodeLine{00047\ \ \ void\ (*cleanup)(void);}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \ \ size\_t\ (*version)(\textcolor{keywordtype}{char}\ *\mbox{\hyperlink{classbuffer}{buffer}},\ \textcolor{keywordtype}{size\_t}\ size);}
\DoxyCodeLine{00050\ \ \ int\ (*check\_cxn)(\textcolor{keyword}{struct\ }\mbox{\hyperlink{structconnectdata}{connectdata}}\ *cxn);}
\DoxyCodeLine{00051\ \ \ int\ (*shut\_down)(\textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}},\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structconnectdata}{connectdata}}\ *conn,}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ sockindex);}
\DoxyCodeLine{00053\ \ \ bool\ (*data\_pending)(\textcolor{keyword}{const}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structconnectdata}{connectdata}}\ *conn,}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ connindex);}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \textcolor{comment}{/*\ return\ 0\ if\ a\ find\ random\ is\ filled\ in\ */}}
\DoxyCodeLine{00057\ \ \ CURLcode\ (*random)(\textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}},\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *entropy,}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ length);}
\DoxyCodeLine{00059\ \ \ bool\ (*cert\_status\_request)(void);}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \ \ CURLcode\ (*connect\_blocking)(\textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}},}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structconnectdata}{connectdata}}\ *conn,\ \textcolor{keywordtype}{int}\ sockindex);}
\DoxyCodeLine{00063\ \ \ CURLcode\ (*connect\_nonblocking)(\textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}},}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structconnectdata}{connectdata}}\ *conn,\ \textcolor{keywordtype}{int}\ sockindex,}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ *done);}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \ \ \textcolor{comment}{/*\ If\ the\ SSL\ backend\ wants\ to\ read\ or\ write\ on\ this\ connection\ during\ a}}
\DoxyCodeLine{00068\ \textcolor{comment}{\ \ \ \ \ handshake,\ set\ socks[0]\ to\ the\ connection's\ FIRSTSOCKET,\ and\ return}}
\DoxyCodeLine{00069\ \textcolor{comment}{\ \ \ \ \ a\ bitmap\ indicating\ read\ or\ write\ with\ GETSOCK\_WRITESOCK(0)\ or}}
\DoxyCodeLine{00070\ \textcolor{comment}{\ \ \ \ \ GETSOCK\_READSOCK(0).\ Otherwise\ return\ GETSOCK\_BLANK.}}
\DoxyCodeLine{00071\ \textcolor{comment}{\ \ \ \ \ Mandatory.\ */}}
\DoxyCodeLine{00072\ \ \ int\ (*getsock)(\textcolor{keyword}{struct\ }\mbox{\hyperlink{structconnectdata}{connectdata}}\ *conn,\ curl\_socket\_t\ *socks);}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \ \ \textcolor{keywordtype}{void}\ *(*get\_internals)(\textcolor{keyword}{struct\ }\mbox{\hyperlink{structssl__connect__data}{ssl\_connect\_data}}\ *connssl,\ CURLINFO\ info);}
\DoxyCodeLine{00075\ \ \ void\ (*close\_one)(\textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}},\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structconnectdata}{connectdata}}\ *conn,}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ sockindex);}
\DoxyCodeLine{00077\ \ \ void\ (*close\_all)(\textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}});}
\DoxyCodeLine{00078\ \ \ void\ (*session\_free)(\textcolor{keywordtype}{void}\ *ptr);}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \ \ CURLcode\ (*set\_engine)(\textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *engine);}
\DoxyCodeLine{00081\ \ \ CURLcode\ (*set\_engine\_default)(\textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}});}
\DoxyCodeLine{00082\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structcurl__slist}{curl\_slist}}\ *(*engines\_list)(\textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}});}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ bool\ (*false\_start)(void);}
\DoxyCodeLine{00085\ \ \ CURLcode\ (*sha256sum)(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{structinput}{input}},\ \textcolor{keywordtype}{size\_t}\ inputlen,}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *sha256sum,\ \textcolor{keywordtype}{size\_t}\ sha256sumlen);}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \ \ void\ (*associate\_connection)(\textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}},}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structconnectdata}{connectdata}}\ *conn,}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ sockindex);}
\DoxyCodeLine{00091\ \ \ void\ (*disassociate\_connection)(\textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}},\ \textcolor{keywordtype}{int}\ sockindex);}
\DoxyCodeLine{00092\ \};}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \textcolor{preprocessor}{\#ifdef\ USE\_SSL}}
\DoxyCodeLine{00095\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_curl__ssl}{Curl\_ssl}}\ *\mbox{\hyperlink{struct_curl__ssl}{Curl\_ssl}};}
\DoxyCodeLine{00096\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \textcolor{keywordtype}{int}\ Curl\_none\_init(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00099\ \textcolor{keywordtype}{void}\ Curl\_none\_cleanup(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00100\ \textcolor{keywordtype}{int}\ Curl\_none\_shutdown(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}},\ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structconnectdata}{connectdata}}\ *conn,}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ sockindex);}
\DoxyCodeLine{00102\ \textcolor{keywordtype}{int}\ Curl\_none\_check\_cxn(\textcolor{keyword}{struct}\ \mbox{\hyperlink{structconnectdata}{connectdata}}\ *conn);}
\DoxyCodeLine{00103\ CURLcode\ Curl\_none\_random(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}},\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *entropy,}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ length);}
\DoxyCodeLine{00105\ \textcolor{keywordtype}{void}\ Curl\_none\_close\_all(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}});}
\DoxyCodeLine{00106\ \textcolor{keywordtype}{void}\ Curl\_none\_session\_free(\textcolor{keywordtype}{void}\ *ptr);}
\DoxyCodeLine{00107\ \textcolor{keywordtype}{bool}\ Curl\_none\_data\_pending(\textcolor{keyword}{const}\ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structconnectdata}{connectdata}}\ *conn,\ \textcolor{keywordtype}{int}\ connindex);}
\DoxyCodeLine{00108\ \textcolor{keywordtype}{bool}\ Curl\_none\_cert\_status\_request(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00109\ CURLcode\ Curl\_none\_set\_engine(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *engine);}
\DoxyCodeLine{00110\ CURLcode\ Curl\_none\_set\_engine\_default(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}});}
\DoxyCodeLine{00111\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structcurl__slist}{curl\_slist}}\ *Curl\_none\_engines\_list(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}});}
\DoxyCodeLine{00112\ \textcolor{keywordtype}{bool}\ Curl\_none\_false\_start(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00113\ \textcolor{keywordtype}{bool}\ Curl\_ssl\_tls13\_ciphersuites(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \textcolor{preprocessor}{\#include\ "{}openssl.h"{}}\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ OpenSSL\ versions\ */}}
\DoxyCodeLine{00116\ \textcolor{preprocessor}{\#include\ "{}gtls.h"{}}\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ GnuTLS\ versions\ */}}
\DoxyCodeLine{00117\ \textcolor{preprocessor}{\#include\ "{}nssg.h"{}}\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ NSS\ versions\ */}}
\DoxyCodeLine{00118\ \textcolor{preprocessor}{\#include\ "{}gskit.h"{}}\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Global\ Secure\ ToolKit\ versions\ */}}
\DoxyCodeLine{00119\ \textcolor{preprocessor}{\#include\ "{}wolfssl.h"{}}\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ wolfSSL\ versions\ */}}
\DoxyCodeLine{00120\ \textcolor{preprocessor}{\#include\ "{}schannel.h"{}}\ \ \ \ \ \ \ \textcolor{comment}{/*\ Schannel\ SSPI\ version\ */}}
\DoxyCodeLine{00121\ \textcolor{preprocessor}{\#include\ "{}sectransp.h"{}}\ \ \ \ \ \ \textcolor{comment}{/*\ SecureTransport\ (Darwin)\ version\ */}}
\DoxyCodeLine{00122\ \textcolor{preprocessor}{\#include\ "{}mbedtls.h"{}}\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ mbedTLS\ versions\ */}}
\DoxyCodeLine{00123\ \textcolor{preprocessor}{\#include\ "{}mesalink.h"{}}\ \ \ \ \ \ \ \textcolor{comment}{/*\ MesaLink\ versions\ */}}
\DoxyCodeLine{00124\ \textcolor{preprocessor}{\#include\ "{}bearssl.h"{}}\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ BearSSL\ versions\ */}}
\DoxyCodeLine{00125\ \textcolor{preprocessor}{\#include\ "{}rustls.h"{}}\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ rustls\ versions\ */}}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00127\ \textcolor{preprocessor}{\#ifndef\ MAX\_PINNED\_PUBKEY\_SIZE}}
\DoxyCodeLine{00128\ \textcolor{preprocessor}{\#define\ MAX\_PINNED\_PUBKEY\_SIZE\ 1048576\ }\textcolor{comment}{/*\ 1MB\ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{00129\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \textcolor{preprocessor}{\#ifndef\ CURL\_SHA256\_DIGEST\_LENGTH}}
\DoxyCodeLine{00132\ \textcolor{preprocessor}{\#define\ CURL\_SHA256\_DIGEST\_LENGTH\ 32\ }\textcolor{comment}{/*\ fixed\ size\ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{00133\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00135\ \textcolor{comment}{/*\ see\ https://www.iana.org/assignments/tls-\/extensiontype-\/values/\ */}}
\DoxyCodeLine{00136\ \textcolor{preprocessor}{\#define\ ALPN\_HTTP\_1\_1\_LENGTH\ 8}}
\DoxyCodeLine{00137\ \textcolor{preprocessor}{\#define\ ALPN\_HTTP\_1\_1\ "{}http/1.1"{}}}
\DoxyCodeLine{00138\ \textcolor{preprocessor}{\#define\ ALPN\_H2\_LENGTH\ 2}}
\DoxyCodeLine{00139\ \textcolor{preprocessor}{\#define\ ALPN\_H2\ "{}h2"{}}}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \textcolor{comment}{/*\ set\ of\ helper\ macros\ for\ the\ backends\ to\ access\ the\ correct\ fields.\ For\ the}}
\DoxyCodeLine{00142\ \textcolor{comment}{\ \ \ proxy\ or\ for\ the\ remote\ host\ -\/\ to\ properly\ support\ HTTPS\ proxy\ */}}
\DoxyCodeLine{00143\ \textcolor{preprocessor}{\#ifndef\ CURL\_DISABLE\_PROXY}}
\DoxyCodeLine{00144\ \textcolor{preprocessor}{\#define\ SSL\_IS\_PROXY()\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00145\ \textcolor{preprocessor}{\ \ (CURLPROXY\_HTTPS\ ==\ conn-\/>http\_proxy.proxytype\ \&\&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00146\ \textcolor{preprocessor}{\ \ \ ssl\_connection\_complete\ !=\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00147\ \textcolor{preprocessor}{\ \ \ conn-\/>proxy\_ssl[conn-\/>sock[SECONDARYSOCKET]\ ==\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00148\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CURL\_SOCKET\_BAD\ ?\ FIRSTSOCKET\ :\ SECONDARYSOCKET].state)}}
\DoxyCodeLine{00149\ \textcolor{preprocessor}{\#define\ SSL\_SET\_OPTION(var)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00150\ \textcolor{preprocessor}{\ \ (SSL\_IS\_PROXY()\ ?\ data-\/>set.proxy\_ssl.var\ :\ data-\/>set.ssl.var)}}
\DoxyCodeLine{00151\ \textcolor{preprocessor}{\#define\ SSL\_SET\_OPTION\_LVALUE(var)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00152\ \textcolor{preprocessor}{\ \ (*(SSL\_IS\_PROXY()\ ?\ \&data-\/>set.proxy\_ssl.var\ :\ \&data-\/>set.ssl.var))}}
\DoxyCodeLine{00153\ \textcolor{preprocessor}{\#define\ SSL\_CONN\_CONFIG(var)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00154\ \textcolor{preprocessor}{\ \ (SSL\_IS\_PROXY()\ ?\ conn-\/>proxy\_ssl\_config.var\ :\ conn-\/>ssl\_config.var)}}
\DoxyCodeLine{00155\ \textcolor{preprocessor}{\#define\ SSL\_HOST\_NAME()\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00156\ \textcolor{preprocessor}{\ \ (SSL\_IS\_PROXY()\ ?\ conn-\/>http\_proxy.host.name\ :\ conn-\/>host.name)}}
\DoxyCodeLine{00157\ \textcolor{preprocessor}{\#define\ SSL\_HOST\_DISPNAME()\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00158\ \textcolor{preprocessor}{\ \ (SSL\_IS\_PROXY()\ ?\ conn-\/>http\_proxy.host.dispname\ :\ conn-\/>host.dispname)}}
\DoxyCodeLine{00159\ \textcolor{preprocessor}{\#define\ SSL\_HOST\_PORT()\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00160\ \textcolor{preprocessor}{\ \ (SSL\_IS\_PROXY()\ ?\ conn-\/>port\ :\ conn-\/>remote\_port)}}
\DoxyCodeLine{00161\ \textcolor{preprocessor}{\#define\ SSL\_PINNED\_PUB\_KEY()\ (SSL\_IS\_PROXY()\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00162\ \textcolor{preprocessor}{\ \ ?\ data-\/>set.str[STRING\_SSL\_PINNEDPUBLICKEY\_PROXY]\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00163\ \textcolor{preprocessor}{\ \ :\ data-\/>set.str[STRING\_SSL\_PINNEDPUBLICKEY])}}
\DoxyCodeLine{00164\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00165\ \textcolor{preprocessor}{\#define\ SSL\_IS\_PROXY()\ FALSE}}
\DoxyCodeLine{00166\ \textcolor{preprocessor}{\#define\ SSL\_SET\_OPTION(var)\ data-\/>set.ssl.var}}
\DoxyCodeLine{00167\ \textcolor{preprocessor}{\#define\ SSL\_SET\_OPTION\_LVALUE(var)\ data-\/>set.ssl.var}}
\DoxyCodeLine{00168\ \textcolor{preprocessor}{\#define\ SSL\_CONN\_CONFIG(var)\ conn-\/>ssl\_config.var}}
\DoxyCodeLine{00169\ \textcolor{preprocessor}{\#define\ SSL\_HOST\_NAME()\ conn-\/>host.name}}
\DoxyCodeLine{00170\ \textcolor{preprocessor}{\#define\ SSL\_HOST\_DISPNAME()\ conn-\/>host.dispname}}
\DoxyCodeLine{00171\ \textcolor{preprocessor}{\#define\ SSL\_HOST\_PORT()\ conn-\/>remote\_port}}
\DoxyCodeLine{00172\ \textcolor{preprocessor}{\#define\ SSL\_PINNED\_PUB\_KEY()\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00173\ \textcolor{preprocessor}{\ \ data-\/>set.str[STRING\_SSL\_PINNEDPUBLICKEY]}}
\DoxyCodeLine{00174\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \textcolor{keywordtype}{bool}\ Curl\_ssl\_config\_matches(\textcolor{keyword}{struct}\ \mbox{\hyperlink{structssl__primary__config}{ssl\_primary\_config}}\ *\mbox{\hyperlink{structdata}{data}},}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structssl__primary__config}{ssl\_primary\_config}}\ *needle);}
\DoxyCodeLine{00178\ \textcolor{keywordtype}{bool}\ Curl\_clone\_primary\_ssl\_config(\textcolor{keyword}{struct}\ \mbox{\hyperlink{structssl__primary__config}{ssl\_primary\_config}}\ *source,}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structssl__primary__config}{ssl\_primary\_config}}\ *dest);}
\DoxyCodeLine{00180\ \textcolor{keywordtype}{void}\ Curl\_free\_primary\_ssl\_config(\textcolor{keyword}{struct}\ \mbox{\hyperlink{structssl__primary__config}{ssl\_primary\_config}}\ *sslc);}
\DoxyCodeLine{00181\ \textcolor{comment}{/*\ An\ implementation\ of\ the\ getsock\ field\ of\ Curl\_ssl\ that\ relies}}
\DoxyCodeLine{00182\ \textcolor{comment}{\ \ \ on\ the\ ssl\_connect\_state\ enum.\ Asks\ for\ read\ or\ write\ depending}}
\DoxyCodeLine{00183\ \textcolor{comment}{\ \ \ on\ whether\ conn-\/>state\ is\ ssl\_connect\_2\_reading\ or}}
\DoxyCodeLine{00184\ \textcolor{comment}{\ \ \ ssl\_connect\_2\_writing.\ */}}
\DoxyCodeLine{00185\ \textcolor{keywordtype}{int}\ Curl\_ssl\_getsock(\textcolor{keyword}{struct}\ \mbox{\hyperlink{structconnectdata}{connectdata}}\ *conn,\ curl\_socket\_t\ *socks);}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \textcolor{keywordtype}{int}\ Curl\_ssl\_backend(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00189\ \textcolor{preprocessor}{\#ifdef\ USE\_SSL}}
\DoxyCodeLine{00190\ \textcolor{keywordtype}{int}\ Curl\_ssl\_init(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00191\ \textcolor{keywordtype}{void}\ Curl\_ssl\_cleanup(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00192\ CURLcode\ Curl\_ssl\_connect(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}},\ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structconnectdata}{connectdata}}\ *conn,}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ sockindex);}
\DoxyCodeLine{00194\ CURLcode\ Curl\_ssl\_connect\_nonblocking(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}},}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structconnectdata}{connectdata}}\ *conn,}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ isproxy,}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ sockindex,}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ *done);}
\DoxyCodeLine{00199\ \textcolor{comment}{/*\ tell\ the\ SSL\ stuff\ to\ close\ down\ all\ open\ information\ regarding}}
\DoxyCodeLine{00200\ \textcolor{comment}{\ \ \ connections\ (and\ thus\ session\ ID\ caching\ etc)\ */}}
\DoxyCodeLine{00201\ \textcolor{keywordtype}{void}\ Curl\_ssl\_close\_all(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}});}
\DoxyCodeLine{00202\ \textcolor{keywordtype}{void}\ Curl\_ssl\_close(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}},\ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structconnectdata}{connectdata}}\ *conn,}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ sockindex);}
\DoxyCodeLine{00204\ CURLcode\ Curl\_ssl\_shutdown(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}},\ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structconnectdata}{connectdata}}\ *conn,}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ sockindex);}
\DoxyCodeLine{00206\ CURLcode\ Curl\_ssl\_set\_engine(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *engine);}
\DoxyCodeLine{00207\ \textcolor{comment}{/*\ Sets\ engine\ as\ default\ for\ all\ SSL\ operations\ */}}
\DoxyCodeLine{00208\ CURLcode\ Curl\_ssl\_set\_engine\_default(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}});}
\DoxyCodeLine{00209\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structcurl__slist}{curl\_slist}}\ *Curl\_ssl\_engines\_list(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}});}
\DoxyCodeLine{00210\ }
\DoxyCodeLine{00211\ \textcolor{comment}{/*\ init\ the\ SSL\ session\ ID\ cache\ */}}
\DoxyCodeLine{00212\ CURLcode\ Curl\_ssl\_initsessions(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *,\ \textcolor{keywordtype}{size\_t});}
\DoxyCodeLine{00213\ \textcolor{keywordtype}{void}\ Curl\_ssl\_version(\textcolor{keywordtype}{char}\ *\mbox{\hyperlink{classbuffer}{buffer}},\ \textcolor{keywordtype}{size\_t}\ size);}
\DoxyCodeLine{00214\ \textcolor{keywordtype}{bool}\ Curl\_ssl\_data\_pending(\textcolor{keyword}{const}\ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structconnectdata}{connectdata}}\ *conn,}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ connindex);}
\DoxyCodeLine{00216\ \textcolor{keywordtype}{int}\ Curl\_ssl\_check\_cxn(\textcolor{keyword}{struct}\ \mbox{\hyperlink{structconnectdata}{connectdata}}\ *conn);}
\DoxyCodeLine{00217\ }
\DoxyCodeLine{00218\ \textcolor{comment}{/*\ Certificate\ information\ list\ handling.\ */}}
\DoxyCodeLine{00219\ }
\DoxyCodeLine{00220\ \textcolor{keywordtype}{void}\ Curl\_ssl\_free\_certinfo(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}});}
\DoxyCodeLine{00221\ CURLcode\ Curl\_ssl\_init\_certinfo(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}},\ \textcolor{keywordtype}{int}\ num);}
\DoxyCodeLine{00222\ CURLcode\ Curl\_ssl\_push\_certinfo\_len(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}},\ \textcolor{keywordtype}{int}\ certnum,}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *label,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{classvalue}{value}},}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ valuelen);}
\DoxyCodeLine{00225\ CURLcode\ Curl\_ssl\_push\_certinfo(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}},\ \textcolor{keywordtype}{int}\ certnum,}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *label,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{classvalue}{value}});}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00228\ \textcolor{comment}{/*\ Functions\ to\ be\ used\ by\ SSL\ library\ adaptation\ functions\ */}}
\DoxyCodeLine{00229\ }
\DoxyCodeLine{00230\ \textcolor{comment}{/*\ Lock\ session\ cache\ mutex.}}
\DoxyCodeLine{00231\ \textcolor{comment}{\ *\ Call\ this\ before\ calling\ other\ Curl\_ssl\_*session*\ functions}}
\DoxyCodeLine{00232\ \textcolor{comment}{\ *\ Caller\ should\ unlock\ this\ mutex\ as\ soon\ as\ possible,\ as\ it\ may\ block}}
\DoxyCodeLine{00233\ \textcolor{comment}{\ *\ other\ SSL\ connection\ from\ making\ progress.}}
\DoxyCodeLine{00234\ \textcolor{comment}{\ *\ The\ purpose\ of\ explicitly\ locking\ SSL\ session\ cache\ data\ is\ to\ allow}}
\DoxyCodeLine{00235\ \textcolor{comment}{\ *\ individual\ SSL\ engines\ to\ manage\ session\ lifetime\ in\ their\ specific\ way.}}
\DoxyCodeLine{00236\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00237\ \textcolor{keywordtype}{void}\ Curl\_ssl\_sessionid\_lock(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}});}
\DoxyCodeLine{00238\ }
\DoxyCodeLine{00239\ \textcolor{comment}{/*\ Unlock\ session\ cache\ mutex\ */}}
\DoxyCodeLine{00240\ \textcolor{keywordtype}{void}\ Curl\_ssl\_sessionid\_unlock(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}});}
\DoxyCodeLine{00241\ }
\DoxyCodeLine{00242\ \textcolor{comment}{/*\ extract\ a\ session\ ID}}
\DoxyCodeLine{00243\ \textcolor{comment}{\ *\ Sessionid\ mutex\ must\ be\ locked\ (see\ Curl\_ssl\_sessionid\_lock).}}
\DoxyCodeLine{00244\ \textcolor{comment}{\ *\ Caller\ must\ make\ sure\ that\ the\ ownership\ of\ returned\ sessionid\ object}}
\DoxyCodeLine{00245\ \textcolor{comment}{\ *\ is\ properly\ taken\ (e.g.\ its\ refcount\ is\ incremented}}
\DoxyCodeLine{00246\ \textcolor{comment}{\ *\ under\ sessionid\ mutex).}}
\DoxyCodeLine{00247\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00248\ \textcolor{keywordtype}{bool}\ Curl\_ssl\_getsessionid(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}},}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structconnectdata}{connectdata}}\ *conn,}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ isProxy,}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ **ssl\_sessionid,}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ *idsize,\ \textcolor{comment}{/*\ set\ 0\ if\ unknown\ */}}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ sockindex);}
\DoxyCodeLine{00254\ \textcolor{comment}{/*\ add\ a\ new\ session\ ID}}
\DoxyCodeLine{00255\ \textcolor{comment}{\ *\ Sessionid\ mutex\ must\ be\ locked\ (see\ Curl\_ssl\_sessionid\_lock).}}
\DoxyCodeLine{00256\ \textcolor{comment}{\ *\ Caller\ must\ ensure\ that\ it\ has\ properly\ shared\ ownership\ of\ this\ sessionid}}
\DoxyCodeLine{00257\ \textcolor{comment}{\ *\ object\ with\ cache\ (e.g.\ incrementing\ refcount\ on\ success)}}
\DoxyCodeLine{00258\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00259\ CURLcode\ Curl\_ssl\_addsessionid(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}},}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structconnectdata}{connectdata}}\ *conn,}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ isProxy,}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *ssl\_sessionid,}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ idsize,}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ sockindex);}
\DoxyCodeLine{00265\ \textcolor{comment}{/*\ Kill\ a\ single\ session\ ID\ entry\ in\ the\ cache}}
\DoxyCodeLine{00266\ \textcolor{comment}{\ *\ Sessionid\ mutex\ must\ be\ locked\ (see\ Curl\_ssl\_sessionid\_lock).}}
\DoxyCodeLine{00267\ \textcolor{comment}{\ *\ This\ will\ call\ engine-\/specific\ curlssl\_session\_free\ function,\ which\ must}}
\DoxyCodeLine{00268\ \textcolor{comment}{\ *\ take\ sessionid\ object\ ownership\ from\ sessionid\ cache}}
\DoxyCodeLine{00269\ \textcolor{comment}{\ *\ (e.g.\ decrement\ refcount).}}
\DoxyCodeLine{00270\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00271\ \textcolor{keywordtype}{void}\ Curl\_ssl\_kill\_session(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__ssl__session}{Curl\_ssl\_session}}\ *session);}
\DoxyCodeLine{00272\ \textcolor{comment}{/*\ delete\ a\ session\ from\ the\ cache}}
\DoxyCodeLine{00273\ \textcolor{comment}{\ *\ Sessionid\ mutex\ must\ be\ locked\ (see\ Curl\_ssl\_sessionid\_lock).}}
\DoxyCodeLine{00274\ \textcolor{comment}{\ *\ This\ will\ call\ engine-\/specific\ curlssl\_session\_free\ function,\ which\ must}}
\DoxyCodeLine{00275\ \textcolor{comment}{\ *\ take\ sessionid\ object\ ownership\ from\ sessionid\ cache}}
\DoxyCodeLine{00276\ \textcolor{comment}{\ *\ (e.g.\ decrement\ refcount).}}
\DoxyCodeLine{00277\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00278\ \textcolor{keywordtype}{void}\ Curl\_ssl\_delsessionid(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}},\ \textcolor{keywordtype}{void}\ *ssl\_sessionid);}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00280\ \textcolor{comment}{/*\ get\ N\ random\ bytes\ into\ the\ buffer\ */}}
\DoxyCodeLine{00281\ CURLcode\ Curl\_ssl\_random(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}},\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{classbuffer}{buffer}},}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ length);}
\DoxyCodeLine{00283\ \textcolor{comment}{/*\ Check\ pinned\ public\ key.\ */}}
\DoxyCodeLine{00284\ CURLcode\ Curl\_pin\_peer\_pubkey(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}},}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *pinnedpubkey,}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *pubkey,\ \textcolor{keywordtype}{size\_t}\ pubkeylen);}
\DoxyCodeLine{00287\ }
\DoxyCodeLine{00288\ \textcolor{keywordtype}{bool}\ Curl\_ssl\_cert\_status\_request(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00289\ }
\DoxyCodeLine{00290\ \textcolor{keywordtype}{bool}\ Curl\_ssl\_false\_start(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00292\ \textcolor{keywordtype}{void}\ Curl\_ssl\_associate\_conn(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}},}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structconnectdata}{connectdata}}\ *conn);}
\DoxyCodeLine{00294\ \textcolor{keywordtype}{void}\ Curl\_ssl\_detach\_conn(\textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_curl__easy}{Curl\_easy}}\ *\mbox{\hyperlink{structdata}{data}},}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structconnectdata}{connectdata}}\ *conn);}
\DoxyCodeLine{00296\ }
\DoxyCodeLine{00297\ \textcolor{preprocessor}{\#define\ SSL\_SHUTDOWN\_TIMEOUT\ 10000\ }\textcolor{comment}{/*\ ms\ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{00298\ }
\DoxyCodeLine{00299\ \textcolor{preprocessor}{\#else\ }\textcolor{comment}{/*\ if\ not\ USE\_SSL\ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ \textcolor{comment}{/*\ When\ SSL\ support\ is\ not\ present,\ just\ define\ away\ these\ function\ calls\ */}}
\DoxyCodeLine{00302\ \textcolor{preprocessor}{\#define\ Curl\_ssl\_init()\ 1}}
\DoxyCodeLine{00303\ \textcolor{preprocessor}{\#define\ Curl\_ssl\_cleanup()\ Curl\_nop\_stmt}}
\DoxyCodeLine{00304\ \textcolor{preprocessor}{\#define\ Curl\_ssl\_connect(x,y,z)\ CURLE\_NOT\_BUILT\_IN}}
\DoxyCodeLine{00305\ \textcolor{preprocessor}{\#define\ Curl\_ssl\_close\_all(x)\ Curl\_nop\_stmt}}
\DoxyCodeLine{00306\ \textcolor{preprocessor}{\#define\ Curl\_ssl\_close(x,y,z)\ Curl\_nop\_stmt}}
\DoxyCodeLine{00307\ \textcolor{preprocessor}{\#define\ Curl\_ssl\_shutdown(x,y,z)\ CURLE\_NOT\_BUILT\_IN}}
\DoxyCodeLine{00308\ \textcolor{preprocessor}{\#define\ Curl\_ssl\_set\_engine(x,y)\ CURLE\_NOT\_BUILT\_IN}}
\DoxyCodeLine{00309\ \textcolor{preprocessor}{\#define\ Curl\_ssl\_set\_engine\_default(x)\ CURLE\_NOT\_BUILT\_IN}}
\DoxyCodeLine{00310\ \textcolor{preprocessor}{\#define\ Curl\_ssl\_engines\_list(x)\ NULL}}
\DoxyCodeLine{00311\ \textcolor{preprocessor}{\#define\ Curl\_ssl\_send(a,b,c,d,e)\ -\/1}}
\DoxyCodeLine{00312\ \textcolor{preprocessor}{\#define\ Curl\_ssl\_recv(a,b,c,d,e)\ -\/1}}
\DoxyCodeLine{00313\ \textcolor{preprocessor}{\#define\ Curl\_ssl\_initsessions(x,y)\ CURLE\_OK}}
\DoxyCodeLine{00314\ \textcolor{preprocessor}{\#define\ Curl\_ssl\_data\_pending(x,y)\ 0}}
\DoxyCodeLine{00315\ \textcolor{preprocessor}{\#define\ Curl\_ssl\_check\_cxn(x)\ 0}}
\DoxyCodeLine{00316\ \textcolor{preprocessor}{\#define\ Curl\_ssl\_free\_certinfo(x)\ Curl\_nop\_stmt}}
\DoxyCodeLine{00317\ \textcolor{preprocessor}{\#define\ Curl\_ssl\_connect\_nonblocking(x,y,z,w,a)\ CURLE\_NOT\_BUILT\_IN}}
\DoxyCodeLine{00318\ \textcolor{preprocessor}{\#define\ Curl\_ssl\_kill\_session(x)\ Curl\_nop\_stmt}}
\DoxyCodeLine{00319\ \textcolor{preprocessor}{\#define\ Curl\_ssl\_random(x,y,z)\ ((void)x,\ CURLE\_NOT\_BUILT\_IN)}}
\DoxyCodeLine{00320\ \textcolor{preprocessor}{\#define\ Curl\_ssl\_cert\_status\_request()\ FALSE}}
\DoxyCodeLine{00321\ \textcolor{preprocessor}{\#define\ Curl\_ssl\_false\_start()\ FALSE}}
\DoxyCodeLine{00322\ \textcolor{preprocessor}{\#define\ Curl\_ssl\_tls13\_ciphersuites()\ FALSE}}
\DoxyCodeLine{00323\ \textcolor{preprocessor}{\#define\ Curl\_ssl\_associate\_conn(a,b)\ Curl\_nop\_stmt}}
\DoxyCodeLine{00324\ \textcolor{preprocessor}{\#define\ Curl\_ssl\_detach\_conn(a,b)\ Curl\_nop\_stmt}}
\DoxyCodeLine{00325\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00326\ }
\DoxyCodeLine{00327\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*\ HEADER\_CURL\_VTLS\_H\ */}\textcolor{preprocessor}{}}

\end{DoxyCode}

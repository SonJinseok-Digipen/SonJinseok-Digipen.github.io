\hypertarget{hb-ot-layout-common_8hh_source}{}\doxysection{hb-\/ot-\/layout-\/common.hh}
\label{hb-ot-layout-common_8hh_source}\index{AseSprite/aseprite/third\_party/harfbuzz/src/hb-\/ot-\/layout-\/common.hh@{AseSprite/aseprite/third\_party/harfbuzz/src/hb-\/ot-\/layout-\/common.hh}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ *\ Copyright\ ©\ 2007,2008,2009\ \ Red\ Hat,\ Inc.}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ *\ Copyright\ ©\ 2010,2012\ \ Google,\ Inc.}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ *\ \ This\ is\ part\ of\ HarfBuzz,\ a\ text\ shaping\ library.}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00007\ \textcolor{comment}{\ *\ Permission\ is\ hereby\ granted,\ without\ written\ agreement\ and\ without}}
\DoxyCodeLine{00008\ \textcolor{comment}{\ *\ license\ or\ royalty\ fees,\ to\ use,\ copy,\ modify,\ and\ distribute\ this}}
\DoxyCodeLine{00009\ \textcolor{comment}{\ *\ software\ and\ its\ documentation\ for\ any\ purpose,\ provided\ that\ the}}
\DoxyCodeLine{00010\ \textcolor{comment}{\ *\ above\ copyright\ notice\ and\ the\ following\ two\ paragraphs\ appear\ in}}
\DoxyCodeLine{00011\ \textcolor{comment}{\ *\ all\ copies\ of\ this\ software.}}
\DoxyCodeLine{00012\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00013\ \textcolor{comment}{\ *\ IN\ NO\ EVENT\ SHALL\ THE\ COPYRIGHT\ HOLDER\ BE\ LIABLE\ TO\ ANY\ PARTY\ FOR}}
\DoxyCodeLine{00014\ \textcolor{comment}{\ *\ DIRECT,\ INDIRECT,\ SPECIAL,\ INCIDENTAL,\ OR\ CONSEQUENTIAL\ DAMAGES}}
\DoxyCodeLine{00015\ \textcolor{comment}{\ *\ ARISING\ OUT\ OF\ THE\ USE\ OF\ THIS\ SOFTWARE\ AND\ ITS\ DOCUMENTATION,\ EVEN}}
\DoxyCodeLine{00016\ \textcolor{comment}{\ *\ IF\ THE\ COPYRIGHT\ HOLDER\ HAS\ BEEN\ ADVISED\ OF\ THE\ POSSIBILITY\ OF\ SUCH}}
\DoxyCodeLine{00017\ \textcolor{comment}{\ *\ DAMAGE.}}
\DoxyCodeLine{00018\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00019\ \textcolor{comment}{\ *\ THE\ COPYRIGHT\ HOLDER\ SPECIFICALLY\ DISCLAIMS\ ANY\ WARRANTIES,\ INCLUDING,}}
\DoxyCodeLine{00020\ \textcolor{comment}{\ *\ BUT\ NOT\ LIMITED\ TO,\ THE\ IMPLIED\ WARRANTIES\ OF\ MERCHANTABILITY\ AND}}
\DoxyCodeLine{00021\ \textcolor{comment}{\ *\ FITNESS\ FOR\ A\ PARTICULAR\ PURPOSE.\ \ THE\ SOFTWARE\ PROVIDED\ HEREUNDER\ IS}}
\DoxyCodeLine{00022\ \textcolor{comment}{\ *\ ON\ AN\ "{}AS\ IS"{}\ BASIS,\ AND\ THE\ COPYRIGHT\ HOLDER\ HAS\ NO\ OBLIGATION\ TO}}
\DoxyCodeLine{00023\ \textcolor{comment}{\ *\ PROVIDE\ MAINTENANCE,\ SUPPORT,\ UPDATES,\ ENHANCEMENTS,\ OR\ MODIFICATIONS.}}
\DoxyCodeLine{00024\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00025\ \textcolor{comment}{\ *\ Red\ Hat\ Author(s):\ Behdad\ Esfahbod}}
\DoxyCodeLine{00026\ \textcolor{comment}{\ *\ Google\ Author(s):\ Behdad\ Esfahbod}}
\DoxyCodeLine{00027\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#ifndef\ HB\_OT\_LAYOUT\_COMMON\_HH}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#define\ HB\_OT\_LAYOUT\_COMMON\_HH}}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#include\ "{}hb.hh"{}}}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#include\ "{}hb-\/ot-\/layout.hh"{}}}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#include\ "{}hb-\/open-\/type.hh"{}}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#include\ "{}hb-\/set.hh"{}}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#include\ "{}hb-\/bimap.hh"{}}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#ifndef\ HB\_MAX\_NESTING\_LEVEL}}
\DoxyCodeLine{00040\ \textcolor{preprocessor}{\#define\ HB\_MAX\_NESTING\_LEVEL\ \ \ \ 6}}
\DoxyCodeLine{00041\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\#ifndef\ HB\_MAX\_CONTEXT\_LENGTH}}
\DoxyCodeLine{00043\ \textcolor{preprocessor}{\#define\ HB\_MAX\_CONTEXT\_LENGTH\ \ \ 64}}
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00045\ \textcolor{preprocessor}{\#ifndef\ HB\_CLOSURE\_MAX\_STAGES}}
\DoxyCodeLine{00046\ \textcolor{comment}{/*}}
\DoxyCodeLine{00047\ \textcolor{comment}{\ *\ The\ maximum\ number\ of\ times\ a\ lookup\ can\ be\ applied\ during\ shaping.}}
\DoxyCodeLine{00048\ \textcolor{comment}{\ *\ Used\ to\ limit\ the\ number\ of\ iterations\ of\ the\ closure\ algorithm.}}
\DoxyCodeLine{00049\ \textcolor{comment}{\ *\ This\ must\ be\ larger\ than\ the\ number\ of\ times\ add\_pause()\ is}}
\DoxyCodeLine{00050\ \textcolor{comment}{\ *\ called\ in\ a\ collect\_features\ call\ of\ any\ shaper.}}
\DoxyCodeLine{00051\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00052\ \textcolor{preprocessor}{\#define\ HB\_CLOSURE\_MAX\_STAGES\ \ \ 32}}
\DoxyCodeLine{00053\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \textcolor{preprocessor}{\#ifndef\ HB\_MAX\_SCRIPTS}}
\DoxyCodeLine{00056\ \textcolor{preprocessor}{\#define\ HB\_MAX\_SCRIPTS\ \ 500}}
\DoxyCodeLine{00057\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \textcolor{preprocessor}{\#ifndef\ HB\_MAX\_LANGSYS}}
\DoxyCodeLine{00060\ \textcolor{preprocessor}{\#define\ HB\_MAX\_LANGSYS\ \ 2000}}
\DoxyCodeLine{00061\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \textcolor{preprocessor}{\#ifndef\ HB\_MAX\_FEATURES}}
\DoxyCodeLine{00064\ \textcolor{preprocessor}{\#define\ HB\_MAX\_FEATURES\ 750}}
\DoxyCodeLine{00065\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \textcolor{preprocessor}{\#ifndef\ HB\_MAX\_FEATURE\_INDICES}}
\DoxyCodeLine{00068\ \textcolor{preprocessor}{\#define\ HB\_MAX\_FEATURE\_INDICES\ \ 1500}}
\DoxyCodeLine{00069\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \textcolor{preprocessor}{\#ifndef\ HB\_MAX\_LOOKUP\_VISIT\_COUNT}}
\DoxyCodeLine{00072\ \textcolor{preprocessor}{\#define\ HB\_MAX\_LOOKUP\_VISIT\_COUNT\ \ \ 35000}}
\DoxyCodeLine{00073\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \textcolor{keyword}{namespace\ }OT\ \{}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00079\ \textcolor{preprocessor}{\#define\ NOT\_COVERED\ \ \ \ \ ((unsigned\ int)\ -\/1)}}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Iterator>}
\DoxyCodeLine{00083\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ Coverage\_serialize\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Iterator\ it);}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Iterator>}
\DoxyCodeLine{00087\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ ClassDef\_serialize\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Iterator\ it);}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ ClassDef\_remap\_and\_serialize\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ \&gid\_klass\_map,}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__vector__t}{hb\_sorted\_vector\_t<HBGlyphID16>}}\ \&glyphs,}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \&klasses,}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ use\_class\_zero,}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *klass\_map\ \textcolor{comment}{/*INOUT*/});}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1hb__prune__langsys__context__t}{hb\_prune\_langsys\_context\_t}}}
\DoxyCodeLine{00099\ \{}
\DoxyCodeLine{00100\ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__prune__langsys__context__t}{hb\_prune\_langsys\_context\_t}}\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ \ \ \ \ \ \ \ \ *table\_,}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__hashmap__t}{hb\_hashmap\_t<unsigned,\ hb\_set\_t\ *>}}\ *script\_langsys\_map\_,}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ \ \ \ \ *duplicate\_feature\_map\_,}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \ \ \ \ \ \ \ \ \ \ *new\_collected\_feature\_indexes\_)}
\DoxyCodeLine{00104\ \ \ \ \ \ \ :table\ (table\_),}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \mbox{\hyperlink{structhb__hashmap__t}{script\_langsys\_map}}\ (script\_langsys\_map\_),}
\DoxyCodeLine{00106\ \ \ \ \ \ \ duplicate\_feature\_map\ (duplicate\_feature\_map\_),}
\DoxyCodeLine{00107\ \ \ \ \ \ \ new\_feature\_indexes\ (new\_collected\_feature\_indexes\_),}
\DoxyCodeLine{00108\ \ \ \ \ \ \ script\_count\ (0),langsys\_count\ (0)\ \{\}}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ \ \ \textcolor{keywordtype}{bool}\ visitedScript\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *s)}
\DoxyCodeLine{00111\ \ \ \{}
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keywordflow}{if}\ (script\_count++\ >\ HB\_MAX\_SCRIPTS)}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{keywordflow}{return}\ visited\ (s,\ visited\_script);}
\DoxyCodeLine{00116\ \ \ \}}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \ \ \textcolor{keywordtype}{bool}\ visitedLangsys\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *l)}
\DoxyCodeLine{00119\ \ \ \{}
\DoxyCodeLine{00120\ \ \ \ \ \textcolor{keywordflow}{if}\ (langsys\_count++\ >\ HB\_MAX\_LANGSYS)}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ \ \ \ \ \textcolor{keywordflow}{return}\ visited\ (l,\ visited\_langsys);}
\DoxyCodeLine{00124\ \ \ \}}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00127\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00128\ \ \ \textcolor{keywordtype}{bool}\ visited\ (\textcolor{keyword}{const}\ T\ *p,\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \&visited\_set)}
\DoxyCodeLine{00129\ \ \ \{}
\DoxyCodeLine{00130\ \ \ \ \ hb\_codepoint\_t\ delta\ =\ (hb\_codepoint\_t)\ ((uintptr\_t)\ p\ -\/\ (uintptr\_t)\ table);}
\DoxyCodeLine{00131\ \ \ \ \ \textcolor{keywordflow}{if}\ (visited\_set.in\_error\ ()\ ||\ visited\_set.has\ (delta))}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ \ \ \ \ visited\_set.add\ (delta);}
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00136\ \ \ \}}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00139\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *table;}
\DoxyCodeLine{00140\ \ \ \mbox{\hyperlink{structhb__hashmap__t}{hb\_hashmap\_t<unsigned,\ hb\_set\_t\ *>}}\ *\mbox{\hyperlink{structhb__hashmap__t}{script\_langsys\_map}};}
\DoxyCodeLine{00141\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ \ \ \ \ *duplicate\_feature\_map;}
\DoxyCodeLine{00142\ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \ \ \ \ \ \ \ \ \ \ *new\_feature\_indexes;}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00145\ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ visited\_script;}
\DoxyCodeLine{00146\ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ visited\_langsys;}
\DoxyCodeLine{00147\ \ \ \textcolor{keywordtype}{unsigned}\ script\_count;}
\DoxyCodeLine{00148\ \ \ \textcolor{keywordtype}{unsigned}\ langsys\_count;}
\DoxyCodeLine{00149\ \};}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00151\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1hb__subset__layout__context__t}{hb\_subset\_layout\_context\_t}}\ :}
\DoxyCodeLine{00152\ \ \ \mbox{\hyperlink{structhb__dispatch__context__t}{hb\_dispatch\_context\_t}}<hb\_subset\_layout\_context\_t,\ hb\_empty\_t,\ HB\_DEBUG\_SUBSET>}
\DoxyCodeLine{00153\ \{}
\DoxyCodeLine{00154\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *get\_name\ ()\ \{\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}SUBSET\_LAYOUT"{}};\ \}}
\DoxyCodeLine{00155\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{structhb__empty__t}{return\_t}}\ default\_return\_value\ ()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structhb__empty__t}{hb\_empty\_t}}\ ();\ \}}
\DoxyCodeLine{00156\ }
\DoxyCodeLine{00157\ \ \ \textcolor{keywordtype}{bool}\ visitScript\ ()}
\DoxyCodeLine{00158\ \ \ \{}
\DoxyCodeLine{00159\ \ \ \ \ \textcolor{keywordflow}{return}\ script\_count++\ <\ HB\_MAX\_SCRIPTS;}
\DoxyCodeLine{00160\ \ \ \}}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00162\ \ \ \textcolor{keywordtype}{bool}\ visitLangSys\ ()}
\DoxyCodeLine{00163\ \ \ \{}
\DoxyCodeLine{00164\ \ \ \ \ \textcolor{keywordflow}{return}\ langsys\_count++\ <\ HB\_MAX\_LANGSYS;}
\DoxyCodeLine{00165\ \ \ \}}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00167\ \ \ \textcolor{keywordtype}{bool}\ visitFeatureIndex\ (\textcolor{keywordtype}{int}\ count)}
\DoxyCodeLine{00168\ \ \ \{}
\DoxyCodeLine{00169\ \ \ \ \ feature\_index\_count\ +=\ count;}
\DoxyCodeLine{00170\ \ \ \ \ \textcolor{keywordflow}{return}\ feature\_index\_count\ <\ HB\_MAX\_FEATURE\_INDICES;}
\DoxyCodeLine{00171\ \ \ \}}
\DoxyCodeLine{00172\ }
\DoxyCodeLine{00173\ \ \ \textcolor{keywordtype}{bool}\ visitLookupIndex()}
\DoxyCodeLine{00174\ \ \ \{}
\DoxyCodeLine{00175\ \ \ \ \ lookup\_index\_count++;}
\DoxyCodeLine{00176\ \ \ \ \ \textcolor{keywordflow}{return}\ lookup\_index\_count\ <\ HB\_MAX\_LOOKUP\_VISIT\_COUNT;}
\DoxyCodeLine{00177\ \ \ \}}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \ \ \mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *subset\_context;}
\DoxyCodeLine{00180\ \ \ \textcolor{keyword}{const}\ hb\_tag\_t\ table\_tag;}
\DoxyCodeLine{00181\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *lookup\_index\_map;}
\DoxyCodeLine{00182\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__hashmap__t}{hb\_hashmap\_t<unsigned,\ hb\_set\_t\ *>}}\ *\mbox{\hyperlink{structhb__hashmap__t}{script\_langsys\_map}};}
\DoxyCodeLine{00183\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *feature\_index\_map;}
\DoxyCodeLine{00184\ \ \ \textcolor{keywordtype}{unsigned}\ cur\_script\_index;}
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00186\ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__subset__layout__context__t}{hb\_subset\_layout\_context\_t}}\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c\_,}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_tag\_t\ tag\_,}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *lookup\_map\_,}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__hashmap__t}{hb\_hashmap\_t<unsigned,\ hb\_set\_t\ *>}}\ *script\_langsys\_map\_,}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *feature\_index\_map\_)\ :}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ subset\_context\ (c\_),}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ table\_tag\ (tag\_),}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_index\_map\ (lookup\_map\_),}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__hashmap__t}{script\_langsys\_map}}\ (script\_langsys\_map\_),}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ feature\_index\_map\ (feature\_index\_map\_),}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cur\_script\_index\ (0xFFFFu),}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ script\_count\ (0),}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ langsys\_count\ (0),}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ feature\_index\_count\ (0),}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_index\_count\ (0)}
\DoxyCodeLine{00201\ \ \ \{\}}
\DoxyCodeLine{00202\ }
\DoxyCodeLine{00203\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00204\ \ \ \textcolor{keywordtype}{unsigned}\ script\_count;}
\DoxyCodeLine{00205\ \ \ \textcolor{keywordtype}{unsigned}\ langsys\_count;}
\DoxyCodeLine{00206\ \ \ \textcolor{keywordtype}{unsigned}\ feature\_index\_count;}
\DoxyCodeLine{00207\ \ \ \textcolor{keywordtype}{unsigned}\ lookup\_index\_count;}
\DoxyCodeLine{00208\ \};}
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00210\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1hb__collect__variation__indices__context__t}{hb\_collect\_variation\_indices\_context\_t}}\ :}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__dispatch__context__t}{hb\_dispatch\_context\_t}}<hb\_collect\_variation\_indices\_context\_t>}
\DoxyCodeLine{00212\ \{}
\DoxyCodeLine{00213\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00214\ \ \ \mbox{\hyperlink{structhb__empty__t}{return\_t}}\ dispatch\ (\textcolor{keyword}{const}\ T\ \&obj)\ \{\ obj.collect\_variation\_indices\ (\textcolor{keyword}{this});\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structhb__empty__t}{hb\_empty\_t}}\ ();\ \}}
\DoxyCodeLine{00215\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{structhb__empty__t}{return\_t}}\ default\_return\_value\ ()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structhb__empty__t}{hb\_empty\_t}}\ ();\ \}}
\DoxyCodeLine{00216\ }
\DoxyCodeLine{00217\ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *layout\_variation\_indices;}
\DoxyCodeLine{00218\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyph\_set;}
\DoxyCodeLine{00219\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *gpos\_lookups;}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__collect__variation__indices__context__t}{hb\_collect\_variation\_indices\_context\_t}}\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *layout\_variation\_indices\_,}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyph\_set\_,}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *gpos\_lookups\_)\ :}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ layout\_variation\_indices\ (layout\_variation\_indices\_),}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ glyph\_set\ (glyph\_set\_),}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ gpos\_lookups\ (gpos\_lookups\_)\ \{\}}
\DoxyCodeLine{00227\ \};}
\DoxyCodeLine{00228\ }
\DoxyCodeLine{00229\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ OutputArray>}
\DoxyCodeLine{00230\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1subset__offset__array__t}{subset\_offset\_array\_t}}}
\DoxyCodeLine{00231\ \{}
\DoxyCodeLine{00232\ \ \ \mbox{\hyperlink{struct_o_t_1_1subset__offset__array__t}{subset\_offset\_array\_t}}\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *subset\_context\_,}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \ \ \ \ \ OutputArray\&\ out\_,}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base\_)\ :\ subset\_context\ (subset\_context\_),}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ out\ (out\_),\ base\ (base\_)\ \{\}}
\DoxyCodeLine{00236\ }
\DoxyCodeLine{00237\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00238\ \ \ \textcolor{keywordtype}{bool}\ operator\ ()\ (T\&\&\ offset)}
\DoxyCodeLine{00239\ \ \ \{}
\DoxyCodeLine{00240\ \ \ \ \ \textcolor{keyword}{auto}\ snap\ =\ subset\_context-\/>serializer-\/>snapshot\ ();}
\DoxyCodeLine{00241\ \ \ \ \ \textcolor{keyword}{auto}\ *o\ =\ out.serialize\_append\ (subset\_context-\/>serializer);}
\DoxyCodeLine{00242\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!o))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00243\ \ \ \ \ \textcolor{keywordtype}{bool}\ ret\ =\ o-\/>serialize\_subset\ (subset\_context,\ offset,\ base);}
\DoxyCodeLine{00244\ \ \ \ \ \textcolor{keywordflow}{if}\ (!ret)}
\DoxyCodeLine{00245\ \ \ \ \ \{}
\DoxyCodeLine{00246\ \ \ \ \ \ \ out.pop\ ();}
\DoxyCodeLine{00247\ \ \ \ \ \ \ subset\_context-\/>serializer-\/>revert\ (snap);}
\DoxyCodeLine{00248\ \ \ \ \ \}}
\DoxyCodeLine{00249\ \ \ \ \ \textcolor{keywordflow}{return}\ ret;}
\DoxyCodeLine{00250\ \ \ \}}
\DoxyCodeLine{00251\ }
\DoxyCodeLine{00252\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00253\ \ \ \mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *subset\_context;}
\DoxyCodeLine{00254\ \ \ OutputArray\ \&out;}
\DoxyCodeLine{00255\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base;}
\DoxyCodeLine{00256\ \};}
\DoxyCodeLine{00257\ }
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00259\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ OutputArray,\ \textcolor{keyword}{typename}\ Arg>}
\DoxyCodeLine{00260\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1subset__offset__array__arg__t}{subset\_offset\_array\_arg\_t}}}
\DoxyCodeLine{00261\ \{}
\DoxyCodeLine{00262\ \ \ \mbox{\hyperlink{struct_o_t_1_1subset__offset__array__arg__t}{subset\_offset\_array\_arg\_t}}\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *subset\_context\_,}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ OutputArray\&\ out\_,}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base\_,}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Arg\ \&\&arg\_)\ :\ subset\_context\ (subset\_context\_),\ out\ (out\_),}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ base\ (base\_),\ arg\ (arg\_)\ \{\}}
\DoxyCodeLine{00267\ }
\DoxyCodeLine{00268\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00269\ \ \ \textcolor{keywordtype}{bool}\ operator\ ()\ (T\&\&\ offset)}
\DoxyCodeLine{00270\ \ \ \{}
\DoxyCodeLine{00271\ \ \ \ \ \textcolor{keyword}{auto}\ snap\ =\ subset\_context-\/>serializer-\/>snapshot\ ();}
\DoxyCodeLine{00272\ \ \ \ \ \textcolor{keyword}{auto}\ *o\ =\ out.serialize\_append\ (subset\_context-\/>serializer);}
\DoxyCodeLine{00273\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!o))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00274\ \ \ \ \ \textcolor{keywordtype}{bool}\ ret\ =\ o-\/>serialize\_subset\ (subset\_context,\ offset,\ base,\ arg);}
\DoxyCodeLine{00275\ \ \ \ \ \textcolor{keywordflow}{if}\ (!ret)}
\DoxyCodeLine{00276\ \ \ \ \ \{}
\DoxyCodeLine{00277\ \ \ \ \ \ \ out.pop\ ();}
\DoxyCodeLine{00278\ \ \ \ \ \ \ subset\_context-\/>serializer-\/>revert\ (snap);}
\DoxyCodeLine{00279\ \ \ \ \ \}}
\DoxyCodeLine{00280\ \ \ \ \ \textcolor{keywordflow}{return}\ ret;}
\DoxyCodeLine{00281\ \ \ \}}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00283\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00284\ \ \ \mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *subset\_context;}
\DoxyCodeLine{00285\ \ \ OutputArray\ \&out;}
\DoxyCodeLine{00286\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base;}
\DoxyCodeLine{00287\ \ \ Arg\ \&\&arg;}
\DoxyCodeLine{00288\ \};}
\DoxyCodeLine{00289\ }
\DoxyCodeLine{00290\ \textcolor{comment}{/*}}
\DoxyCodeLine{00291\ \textcolor{comment}{\ *\ Helper\ to\ subset\ an\ array\ of\ offsets.\ Subsets\ the\ thing\ pointed\ to\ by\ each\ offset}}
\DoxyCodeLine{00292\ \textcolor{comment}{\ *\ and\ discards\ the\ offset\ in\ the\ array\ if\ the\ subset\ operation\ results\ in\ an\ empty}}
\DoxyCodeLine{00293\ \textcolor{comment}{\ *\ thing.}}
\DoxyCodeLine{00294\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00295\ \textcolor{keyword}{struct}}
\DoxyCodeLine{00296\ \{}
\DoxyCodeLine{00297\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ OutputArray>}
\DoxyCodeLine{00298\ \ \ \mbox{\hyperlink{struct_o_t_1_1subset__offset__array__t}{subset\_offset\_array\_t<OutputArray>}}}
\DoxyCodeLine{00299\ \ \ operator\ ()\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *subset\_context,\ OutputArray\&\ out,}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00301\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_o_t_1_1subset__offset__array__t}{subset\_offset\_array\_t<OutputArray>}}\ (subset\_context,\ out,\ base);\ \}}
\DoxyCodeLine{00302\ }
\DoxyCodeLine{00303\ \ \ \textcolor{comment}{/*\ Variant\ with\ one\ extra\ argument\ passed\ to\ serialize\_subset\ */}}
\DoxyCodeLine{00304\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ OutputArray,\ \textcolor{keyword}{typename}\ Arg>}
\DoxyCodeLine{00305\ \ \ subset\_offset\_array\_arg\_t<OutputArray,\ Arg>}
\DoxyCodeLine{00306\ \ \ operator\ ()\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *subset\_context,\ OutputArray\&\ out,}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base,\ Arg\ \&\&arg)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00308\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ subset\_offset\_array\_arg\_t<OutputArray,\ Arg>\ (subset\_context,\ out,\ base,\ arg);\ \}}
\DoxyCodeLine{00309\ \}}
\DoxyCodeLine{00310\ HB\_FUNCOBJ\ (subset\_offset\_array);}
\DoxyCodeLine{00311\ }
\DoxyCodeLine{00312\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ OutputArray>}
\DoxyCodeLine{00313\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1subset__record__array__t}{subset\_record\_array\_t}}}
\DoxyCodeLine{00314\ \{}
\DoxyCodeLine{00315\ \ \ \mbox{\hyperlink{struct_o_t_1_1subset__record__array__t}{subset\_record\_array\_t}}\ (\mbox{\hyperlink{struct_o_t_1_1hb__subset__layout__context__t}{hb\_subset\_layout\_context\_t}}\ *c\_,\ OutputArray*\ out\_,}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base\_)\ :\ subset\_layout\_context\ (c\_),}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ out\ (out\_),\ base\ (base\_)\ \{\}}
\DoxyCodeLine{00318\ }
\DoxyCodeLine{00319\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00320\ \ \ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00321\ \ \ operator\ ()\ (T\&\&\ record)}
\DoxyCodeLine{00322\ \ \ \{}
\DoxyCodeLine{00323\ \ \ \ \ \textcolor{keyword}{auto}\ snap\ =\ subset\_layout\_context-\/>subset\_context-\/>serializer-\/>snapshot\ ();}
\DoxyCodeLine{00324\ \ \ \ \ \textcolor{keywordtype}{bool}\ ret\ =\ record.subset\ (subset\_layout\_context,\ base);}
\DoxyCodeLine{00325\ \ \ \ \ \textcolor{keywordflow}{if}\ (!ret)\ subset\_layout\_context-\/>subset\_context-\/>serializer-\/>revert\ (snap);}
\DoxyCodeLine{00326\ \ \ \ \ \textcolor{keywordflow}{else}\ out-\/>len++;}
\DoxyCodeLine{00327\ \ \ \}}
\DoxyCodeLine{00328\ }
\DoxyCodeLine{00329\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00330\ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__subset__layout__context__t}{hb\_subset\_layout\_context\_t}}\ *subset\_layout\_context;}
\DoxyCodeLine{00331\ \ \ OutputArray\ *out;}
\DoxyCodeLine{00332\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base;}
\DoxyCodeLine{00333\ \};}
\DoxyCodeLine{00334\ }
\DoxyCodeLine{00335\ \textcolor{comment}{/*}}
\DoxyCodeLine{00336\ \textcolor{comment}{\ *\ Helper\ to\ subset\ a\ RecordList/record\ array.\ Subsets\ each\ Record\ in\ the\ array\ and}}
\DoxyCodeLine{00337\ \textcolor{comment}{\ *\ discards\ the\ record\ if\ the\ subset\ operation\ returns\ false.}}
\DoxyCodeLine{00338\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00339\ \textcolor{keyword}{struct}}
\DoxyCodeLine{00340\ \{}
\DoxyCodeLine{00341\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ OutputArray>}
\DoxyCodeLine{00342\ \ \ \mbox{\hyperlink{struct_o_t_1_1subset__record__array__t}{subset\_record\_array\_t<OutputArray>}}}
\DoxyCodeLine{00343\ \ \ operator\ ()\ (\mbox{\hyperlink{struct_o_t_1_1hb__subset__layout__context__t}{hb\_subset\_layout\_context\_t}}\ *c,\ OutputArray*\ out,}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00345\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_o_t_1_1subset__record__array__t}{subset\_record\_array\_t<OutputArray>}}\ (c,\ out,\ base);\ \}}
\DoxyCodeLine{00346\ \}}
\DoxyCodeLine{00347\ HB\_FUNCOBJ\ (subset\_record\_array);}
\DoxyCodeLine{00348\ }
\DoxyCodeLine{00349\ }
\DoxyCodeLine{00350\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ OutputArray>}
\DoxyCodeLine{00351\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1serialize__math__record__array__t}{serialize\_math\_record\_array\_t}}}
\DoxyCodeLine{00352\ \{}
\DoxyCodeLine{00353\ \ \ \mbox{\hyperlink{struct_o_t_1_1serialize__math__record__array__t}{serialize\_math\_record\_array\_t}}\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *serialize\_context\_,}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ OutputArray\&\ out\_,}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base\_)\ :\ serialize\_context\ (serialize\_context\_),}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ out\ (out\_),\ base\ (base\_)\ \{\}}
\DoxyCodeLine{00357\ }
\DoxyCodeLine{00358\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00359\ \ \ \textcolor{keywordtype}{bool}\ operator\ ()\ (T\&\&\ record)}
\DoxyCodeLine{00360\ \ \ \{}
\DoxyCodeLine{00361\ \ \ \ \ \textcolor{keywordflow}{if}\ (!serialize\_context-\/>copy\ (record,\ base))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00362\ \ \ \ \ out.len++;}
\DoxyCodeLine{00363\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00364\ \ \ \}}
\DoxyCodeLine{00365\ }
\DoxyCodeLine{00366\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00367\ \ \ \mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *serialize\_context;}
\DoxyCodeLine{00368\ \ \ OutputArray\ \&out;}
\DoxyCodeLine{00369\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base;}
\DoxyCodeLine{00370\ \};}
\DoxyCodeLine{00371\ }
\DoxyCodeLine{00372\ \textcolor{comment}{/*}}
\DoxyCodeLine{00373\ \textcolor{comment}{\ *\ Helper\ to\ serialize\ an\ array\ of\ MATH\ records.}}
\DoxyCodeLine{00374\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00375\ \textcolor{keyword}{struct}}
\DoxyCodeLine{00376\ \{}
\DoxyCodeLine{00377\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ OutputArray>}
\DoxyCodeLine{00378\ \ \ \mbox{\hyperlink{struct_o_t_1_1serialize__math__record__array__t}{serialize\_math\_record\_array\_t<OutputArray>}}}
\DoxyCodeLine{00379\ \ \ operator\ ()\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *serialize\_context,\ OutputArray\&\ out,}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00381\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_o_t_1_1serialize__math__record__array__t}{serialize\_math\_record\_array\_t<OutputArray>}}\ (serialize\_context,\ out,\ base);\ \}}
\DoxyCodeLine{00382\ }
\DoxyCodeLine{00383\ \}}
\DoxyCodeLine{00384\ HB\_FUNCOBJ\ (serialize\_math\_record\_array);}
\DoxyCodeLine{00385\ }
\DoxyCodeLine{00386\ \textcolor{comment}{/*}}
\DoxyCodeLine{00387\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00388\ \textcolor{comment}{\ *\ OpenType\ Layout\ Common\ Table\ Formats}}
\DoxyCodeLine{00389\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00390\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00391\ }
\DoxyCodeLine{00392\ }
\DoxyCodeLine{00393\ \textcolor{comment}{/*}}
\DoxyCodeLine{00394\ \textcolor{comment}{\ *\ Script,\ ScriptList,\ LangSys,\ Feature,\ FeatureList,\ Lookup,\ LookupList}}
\DoxyCodeLine{00395\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00396\ }
\DoxyCodeLine{00397\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_record__sanitize__closure__t}{Record\_sanitize\_closure\_t}}\ \{}
\DoxyCodeLine{00398\ \ \ hb\_tag\_t\ tag;}
\DoxyCodeLine{00399\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *list\_base;}
\DoxyCodeLine{00400\ \};}
\DoxyCodeLine{00401\ }
\DoxyCodeLine{00402\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Type>}
\DoxyCodeLine{00403\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_record}{Record}}}
\DoxyCodeLine{00404\ \{}
\DoxyCodeLine{00405\ \ \ \textcolor{keywordtype}{int}\ cmp\ (hb\_tag\_t\ \mbox{\hyperlink{structa}{a}})\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ tag.cmp\ (\mbox{\hyperlink{structa}{a}});\ \}}
\DoxyCodeLine{00406\ }
\DoxyCodeLine{00407\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{struct_o_t_1_1hb__subset__layout__context__t}{hb\_subset\_layout\_context\_t}}\ *c,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00408\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00409\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00410\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>subset\_context-\/>serializer-\/>embed\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00411\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!out))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{00412\ \ \ \ \ \textcolor{keywordtype}{bool}\ ret\ =\ out-\/>offset.serialize\_subset\ (c-\/>subset\_context,\ offset,\ base,\ c,\ \&tag);}
\DoxyCodeLine{00413\ \ \ \ \ return\_trace\ (ret);}
\DoxyCodeLine{00414\ \ \ \}}
\DoxyCodeLine{00415\ }
\DoxyCodeLine{00416\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00417\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00418\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00419\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_record__sanitize__closure__t}{Record\_sanitize\_closure\_t}}\ closure\ =\ \{tag,\ base\};}
\DoxyCodeLine{00420\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this})\ \&\&\ offset.sanitize\ (c,\ base,\ \&closure));}
\DoxyCodeLine{00421\ \ \ \}}
\DoxyCodeLine{00422\ }
\DoxyCodeLine{00423\ \ \ \mbox{\hyperlink{struct_o_t_1_1_tag}{Tag}}\ \ \ \ \ \ \ \ tag;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ 4-\/byte\ Tag\ identifier\ */}}
\DoxyCodeLine{00424\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<Type>}}}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ offset;\ \ \ \ \ \textcolor{comment}{/*\ Offset\ from\ beginning\ of\ object\ holding}}
\DoxyCodeLine{00426\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ the\ Record\ */}}
\DoxyCodeLine{00427\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00428\ \ \ DEFINE\_SIZE\_STATIC\ (6);}
\DoxyCodeLine{00429\ \};}
\DoxyCodeLine{00430\ }
\DoxyCodeLine{00431\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Type>}
\DoxyCodeLine{00432\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_record_array_of}{RecordArrayOf}}\ :\ \mbox{\hyperlink{struct_o_t_1_1_sorted_array_of}{SortedArray16Of}}<Record<Type>>}
\DoxyCodeLine{00433\ \{}
\DoxyCodeLine{00434\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<Type>}}\&\ get\_offset\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00435\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ (*\textcolor{keyword}{this})[i].offset;\ \}}
\DoxyCodeLine{00436\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<Type>}}\&\ get\_offset\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i)}
\DoxyCodeLine{00437\ \ \ \{\ \textcolor{keywordflow}{return}\ (*\textcolor{keyword}{this})[i].offset;\ \}}
\DoxyCodeLine{00438\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_tag}{Tag}}\&\ get\_tag\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00439\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ (*\textcolor{keyword}{this})[i].tag;\ \}}
\DoxyCodeLine{00440\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_tags\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ start\_offset,}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *record\_count\ \textcolor{comment}{/*\ IN/OUT\ */},}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_tag\_t\ \ \ \ \ *record\_tags\ \textcolor{comment}{/*\ OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{00443\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00444\ \ \ \ \ \textcolor{keywordflow}{if}\ (record\_count)}
\DoxyCodeLine{00445\ \ \ \ \ \{}
\DoxyCodeLine{00446\ \ \ \ \ \ \ +\ this-\/>sub\_array\ (start\_offset,\ record\_count)}
\DoxyCodeLine{00447\ \ \ \ \ \ \ |\ hb\_map\ (\&\mbox{\hyperlink{struct_o_t_1_1_record}{Record<Type>::tag}})}
\DoxyCodeLine{00448\ \ \ \ \ \ \ |\ hb\_sink\ (hb\_array\ (record\_tags,\ *record\_count))}
\DoxyCodeLine{00449\ \ \ \ \ \ \ ;}
\DoxyCodeLine{00450\ \ \ \ \ \}}
\DoxyCodeLine{00451\ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>len;}
\DoxyCodeLine{00452\ \ \ \}}
\DoxyCodeLine{00453\ \ \ \textcolor{keywordtype}{bool}\ find\_index\ (hb\_tag\_t\ tag,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *index)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00454\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00455\ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>bfind\ (tag,\ index,\ HB\_NOT\_FOUND\_STORE,\ Index::NOT\_FOUND\_INDEX);}
\DoxyCodeLine{00456\ \ \ \}}
\DoxyCodeLine{00457\ \};}
\DoxyCodeLine{00458\ }
\DoxyCodeLine{00459\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Type>}
\DoxyCodeLine{00460\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_record_list_of}{RecordListOf}}\ :\ \mbox{\hyperlink{struct_o_t_1_1_record_array_of}{RecordArrayOf}}<Type>}
\DoxyCodeLine{00461\ \{}
\DoxyCodeLine{00462\ \ \ \textcolor{keyword}{const}\ Type\&\ operator\ []\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00463\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{this}+this-\/>get\_offset\ (i);\ \}}
\DoxyCodeLine{00464\ }
\DoxyCodeLine{00465\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c,}
\DoxyCodeLine{00466\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__subset__layout__context__t}{hb\_subset\_layout\_context\_t}}\ *l)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00467\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00468\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00469\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>serializer-\/>start\_embed\ (*\textcolor{keyword}{this});}
\DoxyCodeLine{00470\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>serializer-\/>extend\_min\ (out)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{00471\ }
\DoxyCodeLine{00472\ \ \ \ \ +\ this-\/>iter\ ()}
\DoxyCodeLine{00473\ \ \ \ \ |\ hb\_apply\ (subset\_record\_array\ (l,\ out,\ \textcolor{keyword}{this}))}
\DoxyCodeLine{00474\ \ \ \ \ ;}
\DoxyCodeLine{00475\ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{00476\ \ \ \}}
\DoxyCodeLine{00477\ }
\DoxyCodeLine{00478\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00479\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00480\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00481\ \ \ \ \ return\_trace\ (\mbox{\hyperlink{struct_o_t_1_1_record_array_of}{RecordArrayOf<Type>::sanitize}}\ (c,\ \textcolor{keyword}{this}));}
\DoxyCodeLine{00482\ \ \ \}}
\DoxyCodeLine{00483\ \};}
\DoxyCodeLine{00484\ }
\DoxyCodeLine{00485\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_feature}{Feature}};}
\DoxyCodeLine{00486\ }
\DoxyCodeLine{00487\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_record_list_of_feature}{RecordListOfFeature}}\ :\ \mbox{\hyperlink{struct_o_t_1_1_record_list_of}{RecordListOf}}<Feature>}
\DoxyCodeLine{00488\ \{}
\DoxyCodeLine{00489\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c,}
\DoxyCodeLine{00490\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__subset__layout__context__t}{hb\_subset\_layout\_context\_t}}\ *l)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00491\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00492\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00493\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>serializer-\/>start\_embed\ (*\textcolor{keyword}{this});}
\DoxyCodeLine{00494\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!out\ ||\ !c-\/>serializer-\/>extend\_min\ (out)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{00495\ }
\DoxyCodeLine{00496\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ count\ =\ this-\/>len;}
\DoxyCodeLine{00497\ \ \ \ \ +\ hb\_zip\ (*\textcolor{keyword}{this},\ hb\_range\ (count))}
\DoxyCodeLine{00498\ \ \ \ \ |\ hb\_filter\ (l-\/>feature\_index\_map,\ hb\_second)}
\DoxyCodeLine{00499\ \ \ \ \ |\ hb\_map\ (hb\_first)}
\DoxyCodeLine{00500\ \ \ \ \ |\ hb\_apply\ (subset\_record\_array\ (l,\ out,\ \textcolor{keyword}{this}))}
\DoxyCodeLine{00501\ \ \ \ \ ;}
\DoxyCodeLine{00502\ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{00503\ \ \ \}}
\DoxyCodeLine{00504\ \};}
\DoxyCodeLine{00505\ }
\DoxyCodeLine{00506\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_script}{Script}};}
\DoxyCodeLine{00507\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_record_list_of_script}{RecordListOfScript}}\ :\ \mbox{\hyperlink{struct_o_t_1_1_record_list_of}{RecordListOf}}<Script>}
\DoxyCodeLine{00508\ \{}
\DoxyCodeLine{00509\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c,}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__subset__layout__context__t}{hb\_subset\_layout\_context\_t}}\ *l)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00511\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00512\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00513\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>serializer-\/>start\_embed\ (*\textcolor{keyword}{this});}
\DoxyCodeLine{00514\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!out\ ||\ !c-\/>serializer-\/>extend\_min\ (out)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{00515\ }
\DoxyCodeLine{00516\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ count\ =\ this-\/>len;}
\DoxyCodeLine{00517\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \_\ :\ +\ hb\_zip\ (*\textcolor{keyword}{this},\ hb\_range\ (count)))}
\DoxyCodeLine{00518\ \ \ \ \ \{}
\DoxyCodeLine{00519\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ snap\ =\ c-\/>serializer-\/>snapshot\ ();}
\DoxyCodeLine{00520\ \ \ \ \ \ \ l-\/>cur\_script\_index\ =\ \_.second;}
\DoxyCodeLine{00521\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ ret\ =\ \_.first.subset\ (l,\ \textcolor{keyword}{this});}
\DoxyCodeLine{00522\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!ret)\ c-\/>serializer-\/>revert\ (snap);}
\DoxyCodeLine{00523\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ out-\/>len++;}
\DoxyCodeLine{00524\ \ \ \ \ \}}
\DoxyCodeLine{00525\ }
\DoxyCodeLine{00526\ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{00527\ \ \ \}}
\DoxyCodeLine{00528\ \};}
\DoxyCodeLine{00529\ }
\DoxyCodeLine{00530\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_range_record}{RangeRecord}}}
\DoxyCodeLine{00531\ \{}
\DoxyCodeLine{00532\ \ \ \textcolor{keywordtype}{int}\ cmp\ (hb\_codepoint\_t\ g)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00533\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ g\ <\ first\ ?\ -\/1\ :\ g\ <=\ last\ ?\ 0\ :\ +1;\ \}}
\DoxyCodeLine{00534\ }
\DoxyCodeLine{00535\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00536\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00537\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00538\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this}));}
\DoxyCodeLine{00539\ \ \ \}}
\DoxyCodeLine{00540\ }
\DoxyCodeLine{00541\ \ \ \textcolor{keywordtype}{bool}\ intersects\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00542\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ glyphs-\/>intersects\ (first,\ last);\ \}}
\DoxyCodeLine{00543\ }
\DoxyCodeLine{00544\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ set\_t>}
\DoxyCodeLine{00545\ \ \ \textcolor{keywordtype}{bool}\ collect\_coverage\ (set\_t\ *glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00546\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ glyphs-\/>add\_range\ (first,\ last);\ \}}
\DoxyCodeLine{00547\ }
\DoxyCodeLine{00548\ \ \ \mbox{\hyperlink{struct_o_t_1_1_h_b_glyph_i_d16}{HBGlyphID16}}\ \ \ \ first;\ \ \ \ \ \ \textcolor{comment}{/*\ First\ GlyphID\ in\ the\ range\ */}}
\DoxyCodeLine{00549\ \ \ \mbox{\hyperlink{struct_o_t_1_1_h_b_glyph_i_d16}{HBGlyphID16}}\ \ \ \ last;\ \ \ \ \ \ \ \textcolor{comment}{/*\ Last\ GlyphID\ in\ the\ range\ */}}
\DoxyCodeLine{00550\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ \mbox{\hyperlink{classvalue}{value}};\ \ \ \ \ \textcolor{comment}{/*\ Value\ */}}
\DoxyCodeLine{00551\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00552\ \ \ DEFINE\_SIZE\_STATIC\ (6);}
\DoxyCodeLine{00553\ \};}
\DoxyCodeLine{00554\ DECLARE\_NULL\_NAMESPACE\_BYTES\ (OT,\ \mbox{\hyperlink{struct_o_t_1_1_range_record}{RangeRecord}});}
\DoxyCodeLine{00555\ }
\DoxyCodeLine{00556\ }
\DoxyCodeLine{00557\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_index_array}{IndexArray}}\ :\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of}}<Index>}
\DoxyCodeLine{00558\ \{}
\DoxyCodeLine{00559\ \ \ \textcolor{keywordtype}{bool}\ intersects\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *indexes)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00560\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ hb\_any\ (*\textcolor{keyword}{this},\ indexes);\ \}}
\DoxyCodeLine{00561\ }
\DoxyCodeLine{00562\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Iterator,}
\DoxyCodeLine{00563\ \ \ \ \ \ \ \ \ hb\_requires\ (hb\_is\_iterator\ (Iterator))>}
\DoxyCodeLine{00564\ \ \ \textcolor{keywordtype}{void}\ serialize\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{00565\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__subset__layout__context__t}{hb\_subset\_layout\_context\_t}}\ *l,}
\DoxyCodeLine{00566\ \ \ \ \ \ \ \ \ \ \ Iterator\ it)}
\DoxyCodeLine{00567\ \ \ \{}
\DoxyCodeLine{00568\ \ \ \ \ \textcolor{keywordflow}{if}\ (!it)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00569\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>extend\_min\ ((*\textcolor{keyword}{this}))))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00570\ }
\DoxyCodeLine{00571\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ \_\ :\ it)}
\DoxyCodeLine{00572\ \ \ \ \ \{}
\DoxyCodeLine{00573\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!l-\/>visitLookupIndex())\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00574\ }
\DoxyCodeLine{00575\ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_index}{Index}}\ i;}
\DoxyCodeLine{00576\ \ \ \ \ \ \ i\ =\ \_;}
\DoxyCodeLine{00577\ \ \ \ \ \ \ c-\/>copy\ (i);}
\DoxyCodeLine{00578\ \ \ \ \ \ \ this-\/>len++;}
\DoxyCodeLine{00579\ \ \ \ \ \}}
\DoxyCodeLine{00580\ \ \ \}}
\DoxyCodeLine{00581\ }
\DoxyCodeLine{00582\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_indexes\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ start\_offset,}
\DoxyCodeLine{00583\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *\_count\ \textcolor{comment}{/*\ IN/OUT\ */},}
\DoxyCodeLine{00584\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *\_indexes\ \textcolor{comment}{/*\ OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{00585\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00586\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_count)}
\DoxyCodeLine{00587\ \ \ \ \ \{}
\DoxyCodeLine{00588\ \ \ \ \ \ \ +\ this-\/>sub\_array\ (start\_offset,\ \_count)}
\DoxyCodeLine{00589\ \ \ \ \ \ \ |\ hb\_sink\ (hb\_array\ (\_indexes,\ *\_count))}
\DoxyCodeLine{00590\ \ \ \ \ \ \ ;}
\DoxyCodeLine{00591\ \ \ \ \ \}}
\DoxyCodeLine{00592\ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>len;}
\DoxyCodeLine{00593\ \ \ \}}
\DoxyCodeLine{00594\ }
\DoxyCodeLine{00595\ \ \ \textcolor{keywordtype}{void}\ add\_indexes\_to\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}*\ output\ \textcolor{comment}{/*\ OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{00596\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00597\ \ \ \ \ output-\/>add\_array\ (as\_array\ ());}
\DoxyCodeLine{00598\ \ \ \}}
\DoxyCodeLine{00599\ \};}
\DoxyCodeLine{00600\ }
\DoxyCodeLine{00601\ }
\DoxyCodeLine{00602\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_lang_sys}{LangSys}}}
\DoxyCodeLine{00603\ \{}
\DoxyCodeLine{00604\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_feature\_count\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00605\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ featureIndex.len;\ \}}
\DoxyCodeLine{00606\ \ \ hb\_tag\_t\ get\_feature\_index\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00607\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ featureIndex[i];\ \}}
\DoxyCodeLine{00608\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_feature\_indexes\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ start\_offset,}
\DoxyCodeLine{00609\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *feature\_count\ \textcolor{comment}{/*\ IN/OUT\ */},}
\DoxyCodeLine{00610\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *feature\_indexes\ \textcolor{comment}{/*\ OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{00611\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ featureIndex.get\_indexes\ (start\_offset,\ feature\_count,\ feature\_indexes);\ \}}
\DoxyCodeLine{00612\ \ \ \textcolor{keywordtype}{void}\ add\_feature\_indexes\_to\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *feature\_indexes)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00613\ \textcolor{keyword}{\ \ }\{\ featureIndex.add\_indexes\_to\ (feature\_indexes);\ \}}
\DoxyCodeLine{00614\ }
\DoxyCodeLine{00615\ \ \ \textcolor{keywordtype}{bool}\ has\_required\_feature\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ reqFeatureIndex\ !=\ 0xFFFFu;\ \}}
\DoxyCodeLine{00616\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_required\_feature\_index\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00617\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00618\ \ \ \ \ \textcolor{keywordflow}{if}\ (reqFeatureIndex\ ==\ 0xFFFFu)}
\DoxyCodeLine{00619\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ Index::NOT\_FOUND\_INDEX;}
\DoxyCodeLine{00620\ \ \ \ \textcolor{keywordflow}{return}\ reqFeatureIndex;}
\DoxyCodeLine{00621\ \ \ \}}
\DoxyCodeLine{00622\ }
\DoxyCodeLine{00623\ \ \ \mbox{\hyperlink{struct_o_t_1_1_lang_sys}{LangSys}}*\ copy\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00624\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00625\ \ \ \ \ TRACE\_SERIALIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00626\ \ \ \ \ return\_trace\ (c-\/>embed\ (*\textcolor{keyword}{this}));}
\DoxyCodeLine{00627\ \ \ \}}
\DoxyCodeLine{00628\ }
\DoxyCodeLine{00629\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacecompare}{compare}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_lang_sys}{LangSys}}\&\ o,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *feature\_index\_map)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00630\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00631\ \ \ \ \ \textcolor{keywordflow}{if}\ (reqFeatureIndex\ !=\ o.reqFeatureIndex)}
\DoxyCodeLine{00632\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00633\ }
\DoxyCodeLine{00634\ \ \ \ \ \textcolor{keyword}{auto}\ iter\ =}
\DoxyCodeLine{00635\ \ \ \ \ +\ hb\_iter\ (featureIndex)}
\DoxyCodeLine{00636\ \ \ \ \ |\ hb\_filter\ (feature\_index\_map)}
\DoxyCodeLine{00637\ \ \ \ \ |\ hb\_map\ (feature\_index\_map)}
\DoxyCodeLine{00638\ \ \ \ \ ;}
\DoxyCodeLine{00639\ }
\DoxyCodeLine{00640\ \ \ \ \ \textcolor{keyword}{auto}\ o\_iter\ =}
\DoxyCodeLine{00641\ \ \ \ \ +\ hb\_iter\ (o.featureIndex)}
\DoxyCodeLine{00642\ \ \ \ \ |\ hb\_filter\ (feature\_index\_map)}
\DoxyCodeLine{00643\ \ \ \ \ |\ hb\_map\ (feature\_index\_map)}
\DoxyCodeLine{00644\ \ \ \ \ ;}
\DoxyCodeLine{00645\ }
\DoxyCodeLine{00646\ \ \ \ \ \textcolor{keywordflow}{if}\ (iter.len\ ()\ !=\ o\_iter.len\ ())}
\DoxyCodeLine{00647\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00648\ }
\DoxyCodeLine{00649\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ \_\ :\ +\ hb\_zip\ (iter,\ o\_iter))}
\DoxyCodeLine{00650\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_.first\ !=\ \_.second)\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00651\ }
\DoxyCodeLine{00652\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00653\ \ \ \}}
\DoxyCodeLine{00654\ }
\DoxyCodeLine{00655\ \ \ \textcolor{keywordtype}{void}\ collect\_features\ (\mbox{\hyperlink{struct_o_t_1_1hb__prune__langsys__context__t}{hb\_prune\_langsys\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00656\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00657\ \ \ \ \ \textcolor{keywordflow}{if}\ (!has\_required\_feature\ ()\ \&\&\ !get\_feature\_count\ ())\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00658\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_required\_feature\ ()\ \&\&}
\DoxyCodeLine{00659\ \ \ \ \ \ \ \ \ c-\/>duplicate\_feature\_map-\/>has\ (reqFeatureIndex))}
\DoxyCodeLine{00660\ \ \ \ \ \ \ c-\/>new\_feature\_indexes-\/>add\ (get\_required\_feature\_index\ ());}
\DoxyCodeLine{00661\ }
\DoxyCodeLine{00662\ \ \ \ \ +\ hb\_iter\ (featureIndex)}
\DoxyCodeLine{00663\ \ \ \ \ |\ hb\_filter\ (c-\/>duplicate\_feature\_map)}
\DoxyCodeLine{00664\ \ \ \ \ |\ hb\_sink\ (c-\/>new\_feature\_indexes)}
\DoxyCodeLine{00665\ \ \ \ \ ;}
\DoxyCodeLine{00666\ \ \ \}}
\DoxyCodeLine{00667\ }
\DoxyCodeLine{00668\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ \ \ \ \ \ \ \ *c,}
\DoxyCodeLine{00669\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__subset__layout__context__t}{hb\_subset\_layout\_context\_t}}\ *l,}
\DoxyCodeLine{00670\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_tag}{Tag}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *tag\ =\ \textcolor{keyword}{nullptr})\textcolor{keyword}{\ const}}
\DoxyCodeLine{00671\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00672\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00673\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>serializer-\/>start\_embed\ (*\textcolor{keyword}{this});}
\DoxyCodeLine{00674\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!out\ ||\ !c-\/>serializer-\/>extend\_min\ (out)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{00675\ }
\DoxyCodeLine{00676\ \ \ \ \ out-\/>reqFeatureIndex\ =\ l-\/>feature\_index\_map-\/>has\ (reqFeatureIndex)\ ?\ l-\/>feature\_index\_map-\/>get\ (reqFeatureIndex)\ :\ 0xFFFFu;}
\DoxyCodeLine{00677\ }
\DoxyCodeLine{00678\ \ \ \ \ \textcolor{keywordflow}{if}\ (!l-\/>visitFeatureIndex\ (featureIndex.len))}
\DoxyCodeLine{00679\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{00680\ }
\DoxyCodeLine{00681\ \ \ \ \ \textcolor{keyword}{auto}\ it\ =}
\DoxyCodeLine{00682\ \ \ \ \ +\ hb\_iter\ (featureIndex)}
\DoxyCodeLine{00683\ \ \ \ \ |\ hb\_filter\ (l-\/>feature\_index\_map)}
\DoxyCodeLine{00684\ \ \ \ \ |\ hb\_map\ (l-\/>feature\_index\_map)}
\DoxyCodeLine{00685\ \ \ \ \ ;}
\DoxyCodeLine{00686\ }
\DoxyCodeLine{00687\ \ \ \ \ \textcolor{keywordtype}{bool}\ ret\ =\ bool\ (it);}
\DoxyCodeLine{00688\ \ \ \ \ out-\/>featureIndex.serialize\ (c-\/>serializer,\ l,\ it);}
\DoxyCodeLine{00689\ \ \ \ \ return\_trace\ (ret);}
\DoxyCodeLine{00690\ \ \ \}}
\DoxyCodeLine{00691\ }
\DoxyCodeLine{00692\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c,}
\DoxyCodeLine{00693\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_record__sanitize__closure__t}{Record\_sanitize\_closure\_t}}\ *\ =\ \textcolor{keyword}{nullptr})\textcolor{keyword}{\ const}}
\DoxyCodeLine{00694\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00695\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00696\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this})\ \&\&\ featureIndex.sanitize\ (c));}
\DoxyCodeLine{00697\ \ \ \}}
\DoxyCodeLine{00698\ }
\DoxyCodeLine{00699\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset}{Offset16}}\ \ lookupOrderZ;\ \ \ \textcolor{comment}{/*\ =\ Null\ (reserved\ for\ an\ offset\ to\ a}}
\DoxyCodeLine{00700\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ reordering\ table)\ */}}
\DoxyCodeLine{00701\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ reqFeatureIndex;\textcolor{comment}{/*\ Index\ of\ a\ feature\ required\ for\ this}}
\DoxyCodeLine{00702\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ language\ system-\/-\/if\ no\ required\ features}}
\DoxyCodeLine{00703\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ =\ 0xFFFFu\ */}}
\DoxyCodeLine{00704\ \ \ \mbox{\hyperlink{struct_o_t_1_1_index_array}{IndexArray}}\ \ featureIndex;\ \ \ \textcolor{comment}{/*\ Array\ of\ indices\ into\ the\ FeatureList\ */}}
\DoxyCodeLine{00705\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00706\ \ \ DEFINE\_SIZE\_ARRAY\_SIZED\ (6,\ featureIndex);}
\DoxyCodeLine{00707\ \};}
\DoxyCodeLine{00708\ DECLARE\_NULL\_NAMESPACE\_BYTES\ (OT,\ \mbox{\hyperlink{struct_o_t_1_1_lang_sys}{LangSys}});}
\DoxyCodeLine{00709\ }
\DoxyCodeLine{00710\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_script}{Script}}}
\DoxyCodeLine{00711\ \{}
\DoxyCodeLine{00712\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_lang\_sys\_count\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00713\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ langSys.len;\ \}}
\DoxyCodeLine{00714\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_tag}{Tag}}\&\ get\_lang\_sys\_tag\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00715\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ langSys.get\_tag\ (i);\ \}}
\DoxyCodeLine{00716\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_lang\_sys\_tags\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ start\_offset,}
\DoxyCodeLine{00717\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *lang\_sys\_count\ \textcolor{comment}{/*\ IN/OUT\ */},}
\DoxyCodeLine{00718\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_tag\_t\ \ \ \ \ *lang\_sys\_tags\ \textcolor{comment}{/*\ OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{00719\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ langSys.get\_tags\ (start\_offset,\ lang\_sys\_count,\ lang\_sys\_tags);\ \}}
\DoxyCodeLine{00720\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_lang_sys}{LangSys}}\&\ get\_lang\_sys\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00721\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00722\ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ ==\ Index::NOT\_FOUND\_INDEX)\ \textcolor{keywordflow}{return}\ get\_default\_lang\_sys\ ();}
\DoxyCodeLine{00723\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{this}+langSys[i].offset;}
\DoxyCodeLine{00724\ \ \ \}}
\DoxyCodeLine{00725\ \ \ \textcolor{keywordtype}{bool}\ find\_lang\_sys\_index\ (hb\_tag\_t\ tag,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *index)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00726\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ langSys.find\_index\ (tag,\ index);\ \}}
\DoxyCodeLine{00727\ }
\DoxyCodeLine{00728\ \ \ \textcolor{keywordtype}{bool}\ has\_default\_lang\_sys\ ()\textcolor{keyword}{\ const\ \ \ \ \ \ \ \ \ \ \ }\{\ \textcolor{keywordflow}{return}\ defaultLangSys\ !=\ 0;\ \}}
\DoxyCodeLine{00729\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_lang_sys}{LangSys}}\&\ get\_default\_lang\_sys\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{this}+defaultLangSys;\ \}}
\DoxyCodeLine{00730\ }
\DoxyCodeLine{00731\ \ \ \textcolor{keywordtype}{void}\ prune\_langsys\ (\mbox{\hyperlink{struct_o_t_1_1hb__prune__langsys__context__t}{hb\_prune\_langsys\_context\_t}}\ *c,}
\DoxyCodeLine{00732\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ script\_index)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00733\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00734\ \ \ \ \ \textcolor{keywordflow}{if}\ (!has\_default\_lang\_sys\ ()\ \&\&\ !get\_lang\_sys\_count\ ())\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00735\ \ \ \ \ \textcolor{keywordflow}{if}\ (c-\/>visitedScript\ (\textcolor{keyword}{this}))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00736\ }
\DoxyCodeLine{00737\ \ \ \ \ \textcolor{keywordflow}{if}\ (!c-\/>script\_langsys\_map-\/>has\ (script\_index))}
\DoxyCodeLine{00738\ \ \ \ \ \{}
\DoxyCodeLine{00739\ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}*\ empty\_set\ =\ hb\_set\_create\ ();}
\DoxyCodeLine{00740\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>script\_langsys\_map-\/>set\ (script\_index,\ empty\_set)))}
\DoxyCodeLine{00741\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00742\ \ \ \ \ hb\_set\_destroy\ (empty\_set);}
\DoxyCodeLine{00743\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00744\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00745\ \ \ \ \ \}}
\DoxyCodeLine{00746\ }
\DoxyCodeLine{00747\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ langsys\_count\ =\ get\_lang\_sys\_count\ ();}
\DoxyCodeLine{00748\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_default\_lang\_sys\ ())}
\DoxyCodeLine{00749\ \ \ \ \ \{}
\DoxyCodeLine{00750\ \ \ \ \ \ \ \textcolor{comment}{//only\ collect\ features\ from\ non-\/redundant\ langsys}}
\DoxyCodeLine{00751\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_lang_sys}{LangSys}}\&\ d\ =\ get\_default\_lang\_sys\ ();}
\DoxyCodeLine{00752\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!c-\/>visitedLangsys\ (\&d))\ \{}
\DoxyCodeLine{00753\ \ \ \ \ \ \ \ \ d.collect\_features\ (c);}
\DoxyCodeLine{00754\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00755\ }
\DoxyCodeLine{00756\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \_\ :\ +\ hb\_zip\ (langSys,\ hb\_range\ (langsys\_count)))}
\DoxyCodeLine{00757\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00758\ }
\DoxyCodeLine{00759\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_lang_sys}{LangSys}}\&\ l\ =\ \textcolor{keyword}{this}+\_.first.offset;}
\DoxyCodeLine{00760\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (c-\/>visitedLangsys\ (\&l))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00761\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (l.compare\ (d,\ c-\/>duplicate\_feature\_map))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00762\ }
\DoxyCodeLine{00763\ \ \ \ \ \ \ \ \ l.collect\_features\ (c);}
\DoxyCodeLine{00764\ \ \ \ \ \ \ \ \ c-\/>script\_langsys\_map-\/>get\ (script\_index)-\/>add\ (\_.second);}
\DoxyCodeLine{00765\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00766\ \ \ \ \ \}}
\DoxyCodeLine{00767\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00768\ \ \ \ \ \{}
\DoxyCodeLine{00769\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \_\ :\ +\ hb\_zip\ (langSys,\ hb\_range\ (langsys\_count)))}
\DoxyCodeLine{00770\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00771\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_lang_sys}{LangSys}}\&\ l\ =\ \textcolor{keyword}{this}+\_.first.offset;}
\DoxyCodeLine{00772\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (c-\/>visitedLangsys\ (\&l))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00773\ \ \ \ \ \ \ \ \ l.collect\_features\ (c);}
\DoxyCodeLine{00774\ \ \ \ \ \ \ \ \ c-\/>script\_langsys\_map-\/>get\ (script\_index)-\/>add\ (\_.second);}
\DoxyCodeLine{00775\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00776\ \ \ \ \ \}}
\DoxyCodeLine{00777\ \ \ \}}
\DoxyCodeLine{00778\ }
\DoxyCodeLine{00779\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ \ \ \ \ \ \ \ \ *c,}
\DoxyCodeLine{00780\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__subset__layout__context__t}{hb\_subset\_layout\_context\_t}}\ \ *l,}
\DoxyCodeLine{00781\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_tag}{Tag}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *tag)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00782\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00783\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00784\ \ \ \ \ \textcolor{keywordflow}{if}\ (!l-\/>visitScript\ ())\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{00785\ }
\DoxyCodeLine{00786\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>serializer-\/>start\_embed\ (*\textcolor{keyword}{this});}
\DoxyCodeLine{00787\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!out\ ||\ !c-\/>serializer-\/>extend\_min\ (out)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{00788\ }
\DoxyCodeLine{00789\ \ \ \ \ \textcolor{keywordtype}{bool}\ defaultLang\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00790\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_default\_lang\_sys\ ())}
\DoxyCodeLine{00791\ \ \ \ \ \{}
\DoxyCodeLine{00792\ \ \ \ \ \ \ c-\/>serializer-\/>push\ ();}
\DoxyCodeLine{00793\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_lang_sys}{LangSys}}\&\ ls\ =\ \textcolor{keyword}{this}+defaultLangSys;}
\DoxyCodeLine{00794\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ ret\ =\ ls.subset\ (c,\ l);}
\DoxyCodeLine{00795\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!ret\ \&\&\ tag\ \&\&\ *tag\ !=\ HB\_TAG\ (\textcolor{charliteral}{'D'},\ \textcolor{charliteral}{'F'},\ \textcolor{charliteral}{'L'},\ \textcolor{charliteral}{'T'}))}
\DoxyCodeLine{00796\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00797\ \ \ \ \ c-\/>serializer-\/>pop\_discard\ ();}
\DoxyCodeLine{00798\ \ \ \ \ out-\/>defaultLangSys\ =\ 0;}
\DoxyCodeLine{00799\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00800\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00801\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00802\ \ \ \ \ c-\/>serializer-\/>add\_link\ (out-\/>defaultLangSys,\ c-\/>serializer-\/>pop\_pack\ ());}
\DoxyCodeLine{00803\ \ \ \ \ defaultLang\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00804\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00805\ \ \ \ \ \}}
\DoxyCodeLine{00806\ }
\DoxyCodeLine{00807\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *active\_langsys\ =\ l-\/>script\_langsys\_map-\/>get\ (l-\/>cur\_script\_index);}
\DoxyCodeLine{00808\ \ \ \ \ \textcolor{keywordflow}{if}\ (active\_langsys)}
\DoxyCodeLine{00809\ \ \ \ \ \{}
\DoxyCodeLine{00810\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ count\ =\ langSys.len;}
\DoxyCodeLine{00811\ \ \ \ \ \ \ +\ hb\_zip\ (langSys,\ hb\_range\ (count))}
\DoxyCodeLine{00812\ \ \ \ \ \ \ |\ hb\_filter\ (active\_langsys,\ hb\_second)}
\DoxyCodeLine{00813\ \ \ \ \ \ \ |\ hb\_map\ (hb\_first)}
\DoxyCodeLine{00814\ \ \ \ \ \ \ |\ hb\_filter\ ([=]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_record}{Record<LangSys>}}\&\ record)\ \{\textcolor{keywordflow}{return}\ l-\/>visitLangSys\ ();\ \})}
\DoxyCodeLine{00815\ \ \ \ \ \ \ |\ hb\_apply\ (subset\_record\_array\ (l,\ \&(out-\/>langSys),\ \textcolor{keyword}{this}))}
\DoxyCodeLine{00816\ \ \ \ \ \ \ ;}
\DoxyCodeLine{00817\ \ \ \ \ \}}
\DoxyCodeLine{00818\ }
\DoxyCodeLine{00819\ \ \ \ \ return\_trace\ (\textcolor{keywordtype}{bool}\ (out-\/>langSys.len)\ ||\ defaultLang\ ||\ l-\/>table\_tag\ ==\ HB\_OT\_TAG\_GSUB);}
\DoxyCodeLine{00820\ \ \ \}}
\DoxyCodeLine{00821\ }
\DoxyCodeLine{00822\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c,}
\DoxyCodeLine{00823\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_record__sanitize__closure__t}{Record\_sanitize\_closure\_t}}\ *\ =\ \textcolor{keyword}{nullptr})\textcolor{keyword}{\ const}}
\DoxyCodeLine{00824\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00825\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00826\ \ \ \ \ return\_trace\ (defaultLangSys.sanitize\ (c,\ \textcolor{keyword}{this})\ \&\&\ langSys.sanitize\ (c,\ \textcolor{keyword}{this}));}
\DoxyCodeLine{00827\ \ \ \}}
\DoxyCodeLine{00828\ }
\DoxyCodeLine{00829\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00830\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<LangSys>}}}
\DoxyCodeLine{00831\ \ \ \ \ \ \ \ \ defaultLangSys;\ \textcolor{comment}{/*\ Offset\ to\ DefaultLangSys\ table-\/-\/from}}
\DoxyCodeLine{00832\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ beginning\ of\ Script\ table-\/-\/may\ be\ Null\ */}}
\DoxyCodeLine{00833\ \ \ \mbox{\hyperlink{struct_o_t_1_1_record_array_of}{RecordArrayOf<LangSys>}}}
\DoxyCodeLine{00834\ \ \ \ \ \ \ \ \ langSys;\ \ \ \ \textcolor{comment}{/*\ Array\ of\ LangSysRecords-\/-\/listed}}
\DoxyCodeLine{00835\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ alphabetically\ by\ LangSysTag\ */}}
\DoxyCodeLine{00836\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00837\ \ \ DEFINE\_SIZE\_ARRAY\_SIZED\ (4,\ langSys);}
\DoxyCodeLine{00838\ \};}
\DoxyCodeLine{00839\ }
\DoxyCodeLine{00840\ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{struct_o_t_1_1_record_list_of_script}{RecordListOfScript}}\ \mbox{\hyperlink{struct_o_t_1_1_record_list_of_script}{ScriptList}};}
\DoxyCodeLine{00841\ }
\DoxyCodeLine{00842\ }
\DoxyCodeLine{00843\ \textcolor{comment}{/*\ https://docs.microsoft.com/en-\/us/typography/opentype/spec/features\_pt\#size\ */}}
\DoxyCodeLine{00844\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_feature_params_size}{FeatureParamsSize}}}
\DoxyCodeLine{00845\ \{}
\DoxyCodeLine{00846\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00847\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00848\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00849\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>check\_struct\ (\textcolor{keyword}{this})))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{00850\ }
\DoxyCodeLine{00851\ \ \ \ \ \textcolor{comment}{/*\ This\ subtable\ has\ some\ "{}history"{},\ if\ you\ will.\ \ Some\ earlier\ versions\ of}}
\DoxyCodeLine{00852\ \textcolor{comment}{\ \ \ \ \ *\ Adobe\ tools\ calculated\ the\ offset\ of\ the\ FeatureParams\ subtable\ from\ the}}
\DoxyCodeLine{00853\ \textcolor{comment}{\ \ \ \ \ *\ beginning\ of\ the\ FeatureList\ table!\ \ Now,\ that\ is\ dealt\ with\ in\ the}}
\DoxyCodeLine{00854\ \textcolor{comment}{\ \ \ \ \ *\ Feature\ implementation.\ \ But\ we\ still\ need\ to\ be\ able\ to\ tell\ junk\ from}}
\DoxyCodeLine{00855\ \textcolor{comment}{\ \ \ \ \ *\ real\ data.\ \ Note:\ We\ don't\ check\ that\ the\ nameID\ actually\ exists.}}
\DoxyCodeLine{00856\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00857\ \textcolor{comment}{\ \ \ \ \ *\ Read\ Roberts\ wrote\ on\ 9/15/06\ on\ opentype-\/list@indx.co.uk\ :}}
\DoxyCodeLine{00858\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00859\ \textcolor{comment}{\ \ \ \ \ *\ Yes,\ it\ is\ correct\ that\ a\ new\ version\ of\ the\ AFDKO\ (version\ 2.0)\ will\ be}}
\DoxyCodeLine{00860\ \textcolor{comment}{\ \ \ \ \ *\ coming\ out\ soon,\ and\ that\ the\ makeotf\ program\ will\ build\ a\ font\ with\ a}}
\DoxyCodeLine{00861\ \textcolor{comment}{\ \ \ \ \ *\ 'size'\ feature\ that\ is\ correct\ by\ the\ specification.}}
\DoxyCodeLine{00862\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00863\ \textcolor{comment}{\ \ \ \ \ *\ The\ specification\ for\ this\ feature\ tag\ is\ in\ the\ "{}OpenType\ Layout\ Tag}}
\DoxyCodeLine{00864\ \textcolor{comment}{\ \ \ \ \ *\ Registry"{}.\ You\ can\ see\ a\ copy\ of\ this\ at:}}
\DoxyCodeLine{00865\ \textcolor{comment}{\ \ \ \ \ *\ https://docs.microsoft.com/en-\/us/typography/opentype/spec/features\_pt\#tag-\/size}}
\DoxyCodeLine{00866\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00867\ \textcolor{comment}{\ \ \ \ \ *\ Here\ is\ one\ set\ of\ rules\ to\ determine\ if\ the\ 'size'\ feature\ is\ built}}
\DoxyCodeLine{00868\ \textcolor{comment}{\ \ \ \ \ *\ correctly,\ or\ as\ by\ the\ older\ versions\ of\ MakeOTF.\ You\ may\ be\ able\ to\ do}}
\DoxyCodeLine{00869\ \textcolor{comment}{\ \ \ \ \ *\ better.}}
\DoxyCodeLine{00870\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00871\ \textcolor{comment}{\ \ \ \ \ *\ Assume\ that\ the\ offset\ to\ the\ size\ feature\ is\ according\ to\ specification,}}
\DoxyCodeLine{00872\ \textcolor{comment}{\ \ \ \ \ *\ and\ make\ the\ following\ value\ checks.\ If\ it\ fails,\ assume\ the\ size}}
\DoxyCodeLine{00873\ \textcolor{comment}{\ \ \ \ \ *\ feature\ is\ calculated\ as\ versions\ of\ MakeOTF\ before\ the\ AFDKO\ 2.0\ built\ it.}}
\DoxyCodeLine{00874\ \textcolor{comment}{\ \ \ \ \ *\ If\ this\ fails,\ reject\ the\ 'size'\ feature.\ The\ older\ makeOTF's\ calculated\ the}}
\DoxyCodeLine{00875\ \textcolor{comment}{\ \ \ \ \ *\ offset\ from\ the\ beginning\ of\ the\ FeatureList\ table,\ rather\ than\ from\ the}}
\DoxyCodeLine{00876\ \textcolor{comment}{\ \ \ \ \ *\ beginning\ of\ the\ 'size'\ Feature\ table.}}
\DoxyCodeLine{00877\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00878\ \textcolor{comment}{\ \ \ \ \ *\ If\ "{}design\ size"{}\ ==\ 0:}}
\DoxyCodeLine{00879\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ fails\ check}}
\DoxyCodeLine{00880\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00881\ \textcolor{comment}{\ \ \ \ \ *\ Else\ if\ ("{}subfamily\ identifier"{}\ ==\ 0\ and}}
\DoxyCodeLine{00882\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ "{}range\ start"{}\ ==\ 0\ and}}
\DoxyCodeLine{00883\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ "{}range\ end"{}\ ==\ 0\ and}}
\DoxyCodeLine{00884\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ "{}range\ start"{}\ ==\ 0\ and}}
\DoxyCodeLine{00885\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ "{}menu\ name\ ID"{}\ ==\ 0)}}
\DoxyCodeLine{00886\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ passes\ check:\ this\ is\ the\ format\ used\ when\ there\ is\ a\ design\ size}}
\DoxyCodeLine{00887\ \textcolor{comment}{\ \ \ \ \ *\ specified,\ but\ there\ is\ no\ recommended\ size\ range.}}
\DoxyCodeLine{00888\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00889\ \textcolor{comment}{\ \ \ \ \ *\ Else\ if\ ("{}design\ size"{}\ <\ \ "{}range\ start"{}\ or}}
\DoxyCodeLine{00890\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ "{}design\ size"{}\ >\ \ \ "{}range\ end"{}\ or}}
\DoxyCodeLine{00891\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ "{}range\ end"{}\ <=\ "{}range\ start"{}\ or}}
\DoxyCodeLine{00892\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ "{}menu\ name\ ID"{}\ \ <\ 256\ or}}
\DoxyCodeLine{00893\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ "{}menu\ name\ ID"{}\ \ >\ 32767\ or}}
\DoxyCodeLine{00894\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ menu\ name\ ID\ is\ not\ a\ name\ ID\ which\ is\ actually\ in\ the\ name\ table)}}
\DoxyCodeLine{00895\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ fails\ test}}
\DoxyCodeLine{00896\ \textcolor{comment}{\ \ \ \ \ *\ Else}}
\DoxyCodeLine{00897\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ passes\ test.}}
\DoxyCodeLine{00898\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00899\ }
\DoxyCodeLine{00900\ \ \ \ \ \textcolor{keywordflow}{if}\ (!designSize)}
\DoxyCodeLine{00901\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{00902\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (subfamilyID\ ==\ 0\ \&\&}
\DoxyCodeLine{00903\ \ \ \ \ \ \ \ \ \ subfamilyNameID\ ==\ 0\ \&\&}
\DoxyCodeLine{00904\ \ \ \ \ \ \ \ \ \ rangeStart\ ==\ 0\ \&\&}
\DoxyCodeLine{00905\ \ \ \ \ \ \ \ \ \ rangeEnd\ ==\ 0)}
\DoxyCodeLine{00906\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{00907\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (designSize\ <\ rangeStart\ ||}
\DoxyCodeLine{00908\ \ \ \ \ \ \ \ \ \ designSize\ >\ rangeEnd\ ||}
\DoxyCodeLine{00909\ \ \ \ \ \ \ \ \ \ subfamilyNameID\ <\ 256\ ||}
\DoxyCodeLine{00910\ \ \ \ \ \ \ \ \ \ subfamilyNameID\ >\ 32767)}
\DoxyCodeLine{00911\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{00912\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00913\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{00914\ \ \ \}}
\DoxyCodeLine{00915\ }
\DoxyCodeLine{00916\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00917\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00918\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00919\ \ \ \ \ return\_trace\ ((\textcolor{keywordtype}{bool})\ c-\/>serializer-\/>embed\ (*\textcolor{keyword}{this}));}
\DoxyCodeLine{00920\ \ \ \}}
\DoxyCodeLine{00921\ }
\DoxyCodeLine{00922\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ designSize;\ \textcolor{comment}{/*\ Represents\ the\ design\ size\ in\ 720/inch}}
\DoxyCodeLine{00923\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ units\ (decipoints).\ \ The\ design\ size\ entry}}
\DoxyCodeLine{00924\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ must\ be\ non-\/zero.\ \ When\ there\ is\ a\ design}}
\DoxyCodeLine{00925\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ size\ but\ no\ recommended\ size\ range,\ the}}
\DoxyCodeLine{00926\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ rest\ of\ the\ array\ will\ consist\ of\ zeros.\ */}}
\DoxyCodeLine{00927\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ subfamilyID;\ \ \ \ \textcolor{comment}{/*\ Has\ no\ independent\ meaning,\ but\ serves}}
\DoxyCodeLine{00928\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ as\ an\ identifier\ that\ associates\ fonts}}
\DoxyCodeLine{00929\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ in\ a\ subfamily.\ All\ fonts\ which\ share\ a}}
\DoxyCodeLine{00930\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ Preferred\ or\ Font\ Family\ name\ and\ which}}
\DoxyCodeLine{00931\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ differ\ only\ by\ size\ range\ shall\ have\ the}}
\DoxyCodeLine{00932\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ same\ subfamily\ value,\ and\ no\ fonts\ which}}
\DoxyCodeLine{00933\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ differ\ in\ weight\ or\ style\ shall\ have\ the}}
\DoxyCodeLine{00934\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ same\ subfamily\ value.\ If\ this\ value\ is}}
\DoxyCodeLine{00935\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ zero,\ the\ remaining\ fields\ in\ the\ array}}
\DoxyCodeLine{00936\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ will\ be\ ignored.\ */}}
\DoxyCodeLine{00937\ \ \ \mbox{\hyperlink{struct_o_t_1_1_index}{NameID}}\ \ subfamilyNameID;\textcolor{comment}{/*\ If\ the\ preceding\ value\ is\ non-\/zero,\ this}}
\DoxyCodeLine{00938\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ value\ must\ be\ set\ in\ the\ range\ 256\ -\/\ 32767}}
\DoxyCodeLine{00939\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ (inclusive).\ It\ records\ the\ value\ of\ a}}
\DoxyCodeLine{00940\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ field\ in\ the\ name\ table,\ which\ must}}
\DoxyCodeLine{00941\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ contain\ English-\/language\ strings\ encoded}}
\DoxyCodeLine{00942\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ in\ Windows\ Unicode\ and\ Macintosh\ Roman,}}
\DoxyCodeLine{00943\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ and\ may\ contain\ additional\ strings}}
\DoxyCodeLine{00944\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ localized\ to\ other\ scripts\ and\ languages.}}
\DoxyCodeLine{00945\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ Each\ of\ these\ strings\ is\ the\ name\ an}}
\DoxyCodeLine{00946\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ application\ should\ use,\ in\ combination}}
\DoxyCodeLine{00947\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ with\ the\ family\ name,\ to\ represent\ the}}
\DoxyCodeLine{00948\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ subfamily\ in\ a\ menu.\ \ Applications\ will}}
\DoxyCodeLine{00949\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ choose\ the\ appropriate\ version\ based\ on}}
\DoxyCodeLine{00950\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ their\ selection\ criteria.\ */}}
\DoxyCodeLine{00951\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ rangeStart;\ \textcolor{comment}{/*\ Large\ end\ of\ the\ recommended\ usage\ range}}
\DoxyCodeLine{00952\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ (inclusive),\ stored\ in\ 720/inch\ units}}
\DoxyCodeLine{00953\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ (decipoints).\ */}}
\DoxyCodeLine{00954\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ rangeEnd;\ \ \ \textcolor{comment}{/*\ Small\ end\ of\ the\ recommended\ usage\ range}}
\DoxyCodeLine{00955\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (exclusive),\ stored\ in\ 720/inch\ units}}
\DoxyCodeLine{00956\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ (decipoints).\ */}}
\DoxyCodeLine{00957\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00958\ \ \ DEFINE\_SIZE\_STATIC\ (10);}
\DoxyCodeLine{00959\ \};}
\DoxyCodeLine{00960\ }
\DoxyCodeLine{00961\ \textcolor{comment}{/*\ https://docs.microsoft.com/en-\/us/typography/opentype/spec/features\_pt\#ssxx\ */}}
\DoxyCodeLine{00962\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_feature_params_stylistic_set}{FeatureParamsStylisticSet}}}
\DoxyCodeLine{00963\ \{}
\DoxyCodeLine{00964\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00965\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00966\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00967\ \ \ \ \ \textcolor{comment}{/*\ Right\ now\ minorVersion\ is\ at\ zero.\ \ Which\ means,\ any\ table\ supports}}
\DoxyCodeLine{00968\ \textcolor{comment}{\ \ \ \ \ *\ the\ uiNameID\ field.\ */}}
\DoxyCodeLine{00969\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this}));}
\DoxyCodeLine{00970\ \ \ \}}
\DoxyCodeLine{00971\ }
\DoxyCodeLine{00972\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00973\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00974\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00975\ \ \ \ \ return\_trace\ ((\textcolor{keywordtype}{bool})\ c-\/>serializer-\/>embed\ (*\textcolor{keyword}{this}));}
\DoxyCodeLine{00976\ \ \ \}}
\DoxyCodeLine{00977\ }
\DoxyCodeLine{00978\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ version;\ \ \ \ \textcolor{comment}{/*\ (set\ to\ 0):\ This\ corresponds\ to\ a\ “minor”}}
\DoxyCodeLine{00979\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ version\ number.\ Additional\ data\ may\ be}}
\DoxyCodeLine{00980\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ added\ to\ the\ end\ of\ this\ Feature\ Parameters}}
\DoxyCodeLine{00981\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ table\ in\ the\ future.\ */}}
\DoxyCodeLine{00982\ }
\DoxyCodeLine{00983\ \ \ \mbox{\hyperlink{struct_o_t_1_1_index}{NameID}}\ \ uiNameID;\ \ \ \textcolor{comment}{/*\ The\ 'name'\ table\ name\ ID\ that\ specifies\ a}}
\DoxyCodeLine{00984\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ string\ (or\ strings,\ for\ multiple\ languages)}}
\DoxyCodeLine{00985\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ for\ a\ user-\/interface\ label\ for\ this}}
\DoxyCodeLine{00986\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ feature.\ \ The\ values\ of\ uiLabelNameId\ and}}
\DoxyCodeLine{00987\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ sampleTextNameId\ are\ expected\ to\ be\ in\ the}}
\DoxyCodeLine{00988\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ font-\/specific\ name\ ID\ range\ (256-\/32767),}}
\DoxyCodeLine{00989\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ though\ that\ is\ not\ a\ requirement\ in\ this}}
\DoxyCodeLine{00990\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ Feature\ Parameters\ specification.\ The}}
\DoxyCodeLine{00991\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ user-\/interface\ label\ for\ the\ feature\ can}}
\DoxyCodeLine{00992\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ be\ provided\ in\ multiple\ languages.\ An}}
\DoxyCodeLine{00993\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ English\ string\ should\ be\ included\ as\ a}}
\DoxyCodeLine{00994\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ fallback.\ The\ string\ should\ be\ kept\ to\ a}}
\DoxyCodeLine{00995\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ minimal\ length\ to\ fit\ comfortably\ with}}
\DoxyCodeLine{00996\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ different\ application\ interfaces.\ */}}
\DoxyCodeLine{00997\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00998\ \ \ DEFINE\_SIZE\_STATIC\ (4);}
\DoxyCodeLine{00999\ \};}
\DoxyCodeLine{01000\ }
\DoxyCodeLine{01001\ \textcolor{comment}{/*\ https://docs.microsoft.com/en-\/us/typography/opentype/spec/features\_ae\#cv01-\/cv99\ */}}
\DoxyCodeLine{01002\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_feature_params_character_variants}{FeatureParamsCharacterVariants}}}
\DoxyCodeLine{01003\ \{}
\DoxyCodeLine{01004\ \ \ \textcolor{keywordtype}{unsigned}}
\DoxyCodeLine{01005\ \ \ get\_characters\ (\textcolor{keywordtype}{unsigned}\ start\_offset,\ \textcolor{keywordtype}{unsigned}\ *char\_count,\ hb\_codepoint\_t\ *chars)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01006\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01007\ \ \ \ \ \textcolor{keywordflow}{if}\ (char\_count)}
\DoxyCodeLine{01008\ \ \ \ \ \{}
\DoxyCodeLine{01009\ \ \ \ \ \ \ +\ characters.sub\_array\ (start\_offset,\ char\_count)}
\DoxyCodeLine{01010\ \ \ \ \ \ \ |\ hb\_sink\ (hb\_array\ (chars,\ *char\_count))}
\DoxyCodeLine{01011\ \ \ \ \ \ \ ;}
\DoxyCodeLine{01012\ \ \ \ \ \}}
\DoxyCodeLine{01013\ \ \ \ \ \textcolor{keywordflow}{return}\ characters.len;}
\DoxyCodeLine{01014\ \ \ \}}
\DoxyCodeLine{01015\ }
\DoxyCodeLine{01016\ \ \ \textcolor{keywordtype}{unsigned}\ get\_size\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{01017\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ min\_size\ +\ characters.len\ *\ HBUINT24::static\_size;\ \}}
\DoxyCodeLine{01018\ }
\DoxyCodeLine{01019\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01020\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01021\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01022\ \ \ \ \ return\_trace\ ((\textcolor{keywordtype}{bool})\ c-\/>serializer-\/>embed\ (*\textcolor{keyword}{this}));}
\DoxyCodeLine{01023\ \ \ \}}
\DoxyCodeLine{01024\ }
\DoxyCodeLine{01025\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01026\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01027\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01028\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this})\ \&\&}
\DoxyCodeLine{01029\ \ \ \ \ \ \ \ \ \ \ characters.sanitize\ (c));}
\DoxyCodeLine{01030\ \ \ \}}
\DoxyCodeLine{01031\ }
\DoxyCodeLine{01032\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ format;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Format\ number\ is\ set\ to\ 0.\ */}}
\DoxyCodeLine{01033\ \ \ \mbox{\hyperlink{struct_o_t_1_1_index}{NameID}}\ \ featUILableNameID;\ \ \textcolor{comment}{/*\ The\ ‘name’\ table\ name\ ID\ that}}
\DoxyCodeLine{01034\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ specifies\ a\ string\ (or\ strings,}}
\DoxyCodeLine{01035\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ for\ multiple\ languages)\ for\ a}}
\DoxyCodeLine{01036\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ user-\/interface\ label\ for\ this}}
\DoxyCodeLine{01037\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ feature.\ (May\ be\ NULL.)\ */}}
\DoxyCodeLine{01038\ \ \ \mbox{\hyperlink{struct_o_t_1_1_index}{NameID}}\ \ featUITooltipTextNameID;\textcolor{comment}{/*\ The\ ‘name’\ table\ name\ ID\ that}}
\DoxyCodeLine{01039\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ specifies\ a\ string\ (or\ strings,}}
\DoxyCodeLine{01040\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ for\ multiple\ languages)\ that\ an}}
\DoxyCodeLine{01041\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ application\ can\ use\ for\ tooltip}}
\DoxyCodeLine{01042\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ text\ for\ this\ feature.\ (May\ be}}
\DoxyCodeLine{01043\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ nullptr.)\ */}}
\DoxyCodeLine{01044\ \ \ \mbox{\hyperlink{struct_o_t_1_1_index}{NameID}}\ \ sampleTextNameID;\ \ \ \textcolor{comment}{/*\ The\ ‘name’\ table\ name\ ID\ that}}
\DoxyCodeLine{01045\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ specifies\ sample\ text\ that}}
\DoxyCodeLine{01046\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ illustrates\ the\ effect\ of\ this}}
\DoxyCodeLine{01047\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ feature.\ (May\ be\ NULL.)\ */}}
\DoxyCodeLine{01048\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ numNamedParameters;\ \textcolor{comment}{/*\ Number\ of\ named\ parameters.\ (May}}
\DoxyCodeLine{01049\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ be\ zero.)\ */}}
\DoxyCodeLine{01050\ \ \ \mbox{\hyperlink{struct_o_t_1_1_index}{NameID}}\ \ firstParamUILabelNameID;\textcolor{comment}{/*\ The\ first\ ‘name’\ table\ name\ ID}}
\DoxyCodeLine{01051\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ used\ to\ specify\ strings\ for}}
\DoxyCodeLine{01052\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ user-\/interface\ labels\ for\ the}}
\DoxyCodeLine{01053\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ feature\ parameters.\ (Must\ be\ zero}}
\DoxyCodeLine{01054\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ if\ numParameters\ is\ zero.)\ */}}
\DoxyCodeLine{01055\ \ \ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<HBUINT24>}}}
\DoxyCodeLine{01056\ \ \ \ \ \ \ \ \ characters;\ \ \ \ \ \textcolor{comment}{/*\ Array\ of\ the\ Unicode\ Scalar\ Value}}
\DoxyCodeLine{01057\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ of\ the\ characters\ for\ which\ this}}
\DoxyCodeLine{01058\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ feature\ provides\ glyph\ variants.}}
\DoxyCodeLine{01059\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ (May\ be\ zero.)\ */}}
\DoxyCodeLine{01060\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01061\ \ \ DEFINE\_SIZE\_ARRAY\ (14,\ characters);}
\DoxyCodeLine{01062\ \};}
\DoxyCodeLine{01063\ }
\DoxyCodeLine{01064\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_feature_params}{FeatureParams}}}
\DoxyCodeLine{01065\ \{}
\DoxyCodeLine{01066\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c,\ hb\_tag\_t\ tag)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01067\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01068\ \textcolor{preprocessor}{\#ifdef\ HB\_NO\_LAYOUT\_FEATURE\_PARAMS}}
\DoxyCodeLine{01069\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01070\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01071\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01072\ \ \ \ \ \textcolor{keywordflow}{if}\ (tag\ ==\ HB\_TAG\ (\textcolor{charliteral}{'s'},\textcolor{charliteral}{'i'},\textcolor{charliteral}{'z'},\textcolor{charliteral}{'e'}))}
\DoxyCodeLine{01073\ \ \ \ \ \ \ return\_trace\ (u.size.sanitize\ (c));}
\DoxyCodeLine{01074\ \ \ \ \ \textcolor{keywordflow}{if}\ ((tag\ \&\ 0xFFFF0000u)\ ==\ HB\_TAG\ (\textcolor{charliteral}{'s'},\textcolor{charliteral}{'s'},\textcolor{charliteral}{'\(\backslash\)0'},\textcolor{charliteral}{'\(\backslash\)0'}))\ \textcolor{comment}{/*\ ssXX\ */}}
\DoxyCodeLine{01075\ \ \ \ \ \ \ return\_trace\ (u.stylisticSet.sanitize\ (c));}
\DoxyCodeLine{01076\ \ \ \ \ \textcolor{keywordflow}{if}\ ((tag\ \&\ 0xFFFF0000u)\ ==\ HB\_TAG\ (\textcolor{charliteral}{'c'},\textcolor{charliteral}{'v'},\textcolor{charliteral}{'\(\backslash\)0'},\textcolor{charliteral}{'\(\backslash\)0'}))\ \textcolor{comment}{/*\ cvXX\ */}}
\DoxyCodeLine{01077\ \ \ \ \ \ \ return\_trace\ (u.characterVariants.sanitize\ (c));}
\DoxyCodeLine{01078\ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{01079\ \ \ \}}
\DoxyCodeLine{01080\ }
\DoxyCodeLine{01081\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_tag}{Tag}}*\ tag)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01082\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01083\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01084\ \ \ \ \ \textcolor{keywordflow}{if}\ (!tag)\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01085\ \ \ \ \ \textcolor{keywordflow}{if}\ (*tag\ ==\ HB\_TAG\ (\textcolor{charliteral}{'s'},\textcolor{charliteral}{'i'},\textcolor{charliteral}{'z'},\textcolor{charliteral}{'e'}))}
\DoxyCodeLine{01086\ \ \ \ \ \ \ return\_trace\ (u.size.subset\ (c));}
\DoxyCodeLine{01087\ \ \ \ \ \textcolor{keywordflow}{if}\ ((*tag\ \&\ 0xFFFF0000u)\ ==\ HB\_TAG\ (\textcolor{charliteral}{'s'},\textcolor{charliteral}{'s'},\textcolor{charliteral}{'\(\backslash\)0'},\textcolor{charliteral}{'\(\backslash\)0'}))\ \textcolor{comment}{/*\ ssXX\ */}}
\DoxyCodeLine{01088\ \ \ \ \ \ \ return\_trace\ (u.stylisticSet.subset\ (c));}
\DoxyCodeLine{01089\ \ \ \ \ \textcolor{keywordflow}{if}\ ((*tag\ \&\ 0xFFFF0000u)\ ==\ HB\_TAG\ (\textcolor{charliteral}{'c'},\textcolor{charliteral}{'v'},\textcolor{charliteral}{'\(\backslash\)0'},\textcolor{charliteral}{'\(\backslash\)0'}))\ \textcolor{comment}{/*\ cvXX\ */}}
\DoxyCodeLine{01090\ \ \ \ \ \ \ return\_trace\ (u.characterVariants.subset\ (c));}
\DoxyCodeLine{01091\ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01092\ \ \ \}}
\DoxyCodeLine{01093\ }
\DoxyCodeLine{01094\ \textcolor{preprocessor}{\#ifndef\ HB\_NO\_LAYOUT\_FEATURE\_PARAMS}}
\DoxyCodeLine{01095\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_feature_params_size}{FeatureParamsSize}}\&\ get\_size\_params\ (hb\_tag\_t\ tag)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01096\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01097\ \ \ \ \ \textcolor{keywordflow}{if}\ (tag\ ==\ HB\_TAG\ (\textcolor{charliteral}{'s'},\textcolor{charliteral}{'i'},\textcolor{charliteral}{'z'},\textcolor{charliteral}{'e'}))}
\DoxyCodeLine{01098\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ u.size;}
\DoxyCodeLine{01099\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_null}{Null}}\ (\mbox{\hyperlink{struct_o_t_1_1_feature_params_size}{FeatureParamsSize}});}
\DoxyCodeLine{01100\ \ \ \}}
\DoxyCodeLine{01101\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_feature_params_stylistic_set}{FeatureParamsStylisticSet}}\&\ get\_stylistic\_set\_params\ (hb\_tag\_t\ tag)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01102\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01103\ \ \ \ \ \textcolor{keywordflow}{if}\ ((tag\ \&\ 0xFFFF0000u)\ ==\ HB\_TAG\ (\textcolor{charliteral}{'s'},\textcolor{charliteral}{'s'},\textcolor{charliteral}{'\(\backslash\)0'},\textcolor{charliteral}{'\(\backslash\)0'}))\ \textcolor{comment}{/*\ ssXX\ */}}
\DoxyCodeLine{01104\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ u.stylisticSet;}
\DoxyCodeLine{01105\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_null}{Null}}\ (\mbox{\hyperlink{struct_o_t_1_1_feature_params_stylistic_set}{FeatureParamsStylisticSet}});}
\DoxyCodeLine{01106\ \ \ \}}
\DoxyCodeLine{01107\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_feature_params_character_variants}{FeatureParamsCharacterVariants}}\&\ get\_character\_variants\_params\ (hb\_tag\_t\ tag)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01108\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01109\ \ \ \ \ \textcolor{keywordflow}{if}\ ((tag\ \&\ 0xFFFF0000u)\ ==\ HB\_TAG\ (\textcolor{charliteral}{'c'},\textcolor{charliteral}{'v'},\textcolor{charliteral}{'\(\backslash\)0'},\textcolor{charliteral}{'\(\backslash\)0'}))\ \textcolor{comment}{/*\ cvXX\ */}}
\DoxyCodeLine{01110\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ u.characterVariants;}
\DoxyCodeLine{01111\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_null}{Null}}\ (\mbox{\hyperlink{struct_o_t_1_1_feature_params_character_variants}{FeatureParamsCharacterVariants}});}
\DoxyCodeLine{01112\ \ \ \}}
\DoxyCodeLine{01113\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01114\ }
\DoxyCodeLine{01115\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{01116\ \ \ \textcolor{keyword}{union\ }\{}
\DoxyCodeLine{01117\ \ \ \mbox{\hyperlink{struct_o_t_1_1_feature_params_size}{FeatureParamsSize}}\ \ \ \ \ \ \ \ \ \ \ \ size;}
\DoxyCodeLine{01118\ \ \ \mbox{\hyperlink{struct_o_t_1_1_feature_params_stylistic_set}{FeatureParamsStylisticSet}}\ \ \ \ \ \ \ \ stylisticSet;}
\DoxyCodeLine{01119\ \ \ \mbox{\hyperlink{struct_o_t_1_1_feature_params_character_variants}{FeatureParamsCharacterVariants}}\ \ characterVariants;}
\DoxyCodeLine{01120\ \ \ \}\ u;}
\DoxyCodeLine{01121\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01122\ \ \ DEFINE\_SIZE\_MIN\ (0);}
\DoxyCodeLine{01123\ \};}
\DoxyCodeLine{01124\ }
\DoxyCodeLine{01125\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_feature}{Feature}}}
\DoxyCodeLine{01126\ \{}
\DoxyCodeLine{01127\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_lookup\_count\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{01128\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ lookupIndex.len;\ \}}
\DoxyCodeLine{01129\ \ \ hb\_tag\_t\ get\_lookup\_index\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01130\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ lookupIndex[i];\ \}}
\DoxyCodeLine{01131\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_lookup\_indexes\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ start\_index,}
\DoxyCodeLine{01132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *lookup\_count\ \textcolor{comment}{/*\ IN/OUT\ */},}
\DoxyCodeLine{01133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *lookup\_tags\ \textcolor{comment}{/*\ OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{01134\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ lookupIndex.get\_indexes\ (start\_index,\ lookup\_count,\ lookup\_tags);\ \}}
\DoxyCodeLine{01135\ \ \ \textcolor{keywordtype}{void}\ add\_lookup\_indexes\_to\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *lookup\_indexes)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01136\ \textcolor{keyword}{\ \ }\{\ lookupIndex.add\_indexes\_to\ (lookup\_indexes);\ \}}
\DoxyCodeLine{01137\ }
\DoxyCodeLine{01138\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_feature_params}{FeatureParams}}\ \&get\_feature\_params\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{01139\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{this}+featureParams;\ \}}
\DoxyCodeLine{01140\ }
\DoxyCodeLine{01141\ \ \ \textcolor{keywordtype}{bool}\ intersects\_lookup\_indexes\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *lookup\_indexes)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01142\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ lookupIndex.intersects\ (lookup\_indexes);\ \}}
\DoxyCodeLine{01143\ }
\DoxyCodeLine{01144\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ \ \ \ \ \ \ \ \ *c,}
\DoxyCodeLine{01145\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__subset__layout__context__t}{hb\_subset\_layout\_context\_t}}\ \ *l,}
\DoxyCodeLine{01146\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_tag}{Tag}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *tag\ =\ \textcolor{keyword}{nullptr})\textcolor{keyword}{\ const}}
\DoxyCodeLine{01147\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01148\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01149\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>serializer-\/>start\_embed\ (*\textcolor{keyword}{this});}
\DoxyCodeLine{01150\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!out\ ||\ !c-\/>serializer-\/>extend\_min\ (out)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01151\ }
\DoxyCodeLine{01152\ \ \ \ \ out-\/>featureParams.serialize\_subset\ (c,\ featureParams,\ \textcolor{keyword}{this},\ tag);}
\DoxyCodeLine{01153\ }
\DoxyCodeLine{01154\ \ \ \ \ \textcolor{keyword}{auto}\ it\ =}
\DoxyCodeLine{01155\ \ \ \ \ +\ hb\_iter\ (lookupIndex)}
\DoxyCodeLine{01156\ \ \ \ \ |\ hb\_filter\ (l-\/>lookup\_index\_map)}
\DoxyCodeLine{01157\ \ \ \ \ |\ hb\_map\ (l-\/>lookup\_index\_map)}
\DoxyCodeLine{01158\ \ \ \ \ ;}
\DoxyCodeLine{01159\ }
\DoxyCodeLine{01160\ \ \ \ \ out-\/>lookupIndex.serialize\ (c-\/>serializer,\ l,\ it);}
\DoxyCodeLine{01161\ \ \ \ \ \textcolor{comment}{//\ The\ decision\ to\ keep\ or\ drop\ this\ feature\ is\ already\ made\ before\ we\ get\ here}}
\DoxyCodeLine{01162\ \ \ \ \ \textcolor{comment}{//\ so\ always\ retain\ it.}}
\DoxyCodeLine{01163\ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{01164\ \ \ \}}
\DoxyCodeLine{01165\ }
\DoxyCodeLine{01166\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c,}
\DoxyCodeLine{01167\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_record__sanitize__closure__t}{Record\_sanitize\_closure\_t}}\ *closure\ =\ \textcolor{keyword}{nullptr})\textcolor{keyword}{\ const}}
\DoxyCodeLine{01168\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01169\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01170\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!(c-\/>check\_struct\ (\textcolor{keyword}{this})\ \&\&\ lookupIndex.sanitize\ (c))))}
\DoxyCodeLine{01171\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01172\ }
\DoxyCodeLine{01173\ \ \ \ \ \textcolor{comment}{/*\ Some\ earlier\ versions\ of\ Adobe\ tools\ calculated\ the\ offset\ of\ the}}
\DoxyCodeLine{01174\ \textcolor{comment}{\ \ \ \ \ *\ FeatureParams\ subtable\ from\ the\ beginning\ of\ the\ FeatureList\ table!}}
\DoxyCodeLine{01175\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{01176\ \textcolor{comment}{\ \ \ \ \ *\ If\ sanitizing\ "{}failed"{}\ for\ the\ FeatureParams\ subtable,\ try\ it\ with\ the}}
\DoxyCodeLine{01177\ \textcolor{comment}{\ \ \ \ \ *\ alternative\ location.\ \ We\ would\ know\ sanitize\ "{}failed"{}\ if\ old\ value}}
\DoxyCodeLine{01178\ \textcolor{comment}{\ \ \ \ \ *\ of\ the\ offset\ was\ non-\/zero,\ but\ it's\ zeroed\ now.}}
\DoxyCodeLine{01179\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{01180\ \textcolor{comment}{\ \ \ \ \ *\ Only\ do\ this\ for\ the\ 'size'\ feature,\ since\ at\ the\ time\ of\ the\ faulty}}
\DoxyCodeLine{01181\ \textcolor{comment}{\ \ \ \ \ *\ Adobe\ tools,\ only\ the\ 'size'\ feature\ had\ FeatureParams\ defined.}}
\DoxyCodeLine{01182\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01183\ }
\DoxyCodeLine{01184\ \ \ \ \ \textcolor{keywordflow}{if}\ (likely\ (featureParams.is\_null\ ()))}
\DoxyCodeLine{01185\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{01186\ }
\DoxyCodeLine{01187\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ orig\_offset\ =\ featureParams;}
\DoxyCodeLine{01188\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!featureParams.sanitize\ (c,\ \textcolor{keyword}{this},\ closure\ ?\ closure-\/>tag\ :\ HB\_TAG\_NONE)))}
\DoxyCodeLine{01189\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01190\ }
\DoxyCodeLine{01191\ \ \ \ \ \textcolor{keywordflow}{if}\ (featureParams\ ==\ 0\ \&\&\ closure\ \&\&}
\DoxyCodeLine{01192\ \ \ \ \ closure-\/>tag\ ==\ HB\_TAG\ (\textcolor{charliteral}{'s'},\textcolor{charliteral}{'i'},\textcolor{charliteral}{'z'},\textcolor{charliteral}{'e'})\ \&\&}
\DoxyCodeLine{01193\ \ \ \ \ closure-\/>list\_base\ \&\&\ closure-\/>list\_base\ <\ \textcolor{keyword}{this})}
\DoxyCodeLine{01194\ \ \ \ \ \{}
\DoxyCodeLine{01195\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ new\_offset\_int\ =\ orig\_offset\ -\/}
\DoxyCodeLine{01196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (((\textcolor{keywordtype}{char}\ *)\ \textcolor{keyword}{this})\ -\/\ ((\textcolor{keywordtype}{char}\ *)\ closure-\/>list\_base));}
\DoxyCodeLine{01197\ }
\DoxyCodeLine{01198\ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<FeatureParams>}}\ new\_offset;}
\DoxyCodeLine{01199\ \ \ \ \ \ \ \textcolor{comment}{/*\ Check\ that\ it\ would\ not\ overflow.\ */}}
\DoxyCodeLine{01200\ \ \ \ \ \ \ new\_offset\ =\ new\_offset\_int;}
\DoxyCodeLine{01201\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (new\_offset\ ==\ new\_offset\_int\ \&\&}
\DoxyCodeLine{01202\ \ \ \ \ \ \ c-\/>try\_set\ (\&featureParams,\ new\_offset\_int)\ \&\&}
\DoxyCodeLine{01203\ \ \ \ \ \ \ !featureParams.sanitize\ (c,\ \textcolor{keyword}{this},\ closure\ ?\ closure-\/>tag\ :\ HB\_TAG\_NONE))}
\DoxyCodeLine{01204\ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01205\ \ \ \ \ \}}
\DoxyCodeLine{01206\ }
\DoxyCodeLine{01207\ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{01208\ \ \ \}}
\DoxyCodeLine{01209\ }
\DoxyCodeLine{01210\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<FeatureParams>}}}
\DoxyCodeLine{01211\ \ \ \ \ \ \ \ \ \ featureParams;\ \textcolor{comment}{/*\ Offset\ to\ Feature\ Parameters\ table\ (if\ one}}
\DoxyCodeLine{01212\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ has\ been\ defined\ for\ the\ feature),\ relative}}
\DoxyCodeLine{01213\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ to\ the\ beginning\ of\ the\ Feature\ Table;\ =\ Null}}
\DoxyCodeLine{01214\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ if\ not\ required\ */}}
\DoxyCodeLine{01215\ \ \ \mbox{\hyperlink{struct_o_t_1_1_index_array}{IndexArray}}\ \ \ lookupIndex;\ \ \ \textcolor{comment}{/*\ Array\ of\ LookupList\ indices\ */}}
\DoxyCodeLine{01216\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01217\ \ \ DEFINE\_SIZE\_ARRAY\_SIZED\ (4,\ lookupIndex);}
\DoxyCodeLine{01218\ \};}
\DoxyCodeLine{01219\ }
\DoxyCodeLine{01220\ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{struct_o_t_1_1_record_list_of}{RecordListOf<Feature>}}\ \mbox{\hyperlink{struct_o_t_1_1_record_list_of}{FeatureList}};}
\DoxyCodeLine{01221\ }
\DoxyCodeLine{01222\ }
\DoxyCodeLine{01223\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_lookup_flag}{LookupFlag}}\ :\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}}
\DoxyCodeLine{01224\ \{}
\DoxyCodeLine{01225\ \ \ \textcolor{keyword}{enum}\ Flags\ \{}
\DoxyCodeLine{01226\ \ \ \ \ RightToLeft\ \ \ \ \ =\ 0x0001u,}
\DoxyCodeLine{01227\ \ \ \ \ IgnoreBaseGlyphs\ \ \ \ =\ 0x0002u,}
\DoxyCodeLine{01228\ \ \ \ \ IgnoreLigatures\ =\ 0x0004u,}
\DoxyCodeLine{01229\ \ \ \ \ IgnoreMarks\ \ \ \ \ =\ 0x0008u,}
\DoxyCodeLine{01230\ \ \ \ \ IgnoreFlags\ \ \ \ \ =\ 0x000Eu,}
\DoxyCodeLine{01231\ \ \ \ \ UseMarkFilteringSet\ =\ 0x0010u,}
\DoxyCodeLine{01232\ \ \ \ \ Reserved\ \ \ \ \ \ \ \ =\ 0x00E0u,}
\DoxyCodeLine{01233\ \ \ \ \ MarkAttachmentType\ \ =\ 0xFF00u}
\DoxyCodeLine{01234\ \ \ \};}
\DoxyCodeLine{01235\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01236\ \ \ DEFINE\_SIZE\_STATIC\ (2);}
\DoxyCodeLine{01237\ \};}
\DoxyCodeLine{01238\ }
\DoxyCodeLine{01239\ \}\ \textcolor{comment}{/*\ namespace\ OT\ */}}
\DoxyCodeLine{01240\ \textcolor{comment}{/*\ This\ has\ to\ be\ outside\ the\ namespace.\ */}}
\DoxyCodeLine{01241\ HB\_MARK\_AS\_FLAG\_T\ (OT::LookupFlag::Flags);}
\DoxyCodeLine{01242\ \textcolor{keyword}{namespace\ }OT\ \{}
\DoxyCodeLine{01243\ }
\DoxyCodeLine{01244\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_lookup}{Lookup}}}
\DoxyCodeLine{01245\ \{}
\DoxyCodeLine{01246\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_subtable\_count\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ subTable.len;\ \}}
\DoxyCodeLine{01247\ }
\DoxyCodeLine{01248\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ TSubTable>}
\DoxyCodeLine{01249\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<TSubTable>}}\&\ get\_subtables\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{01250\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<TSubTable>}}\ \&\textcolor{keyword}{>}\ (subTable);\ \}}
\DoxyCodeLine{01251\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ TSubTable>}
\DoxyCodeLine{01252\ \ \ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<TSubTable>}}\&\ get\_subtables\ ()}
\DoxyCodeLine{01253\ \ \ \{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{reinterpret\_cast<}\mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<TSubTable>}}\ \&\textcolor{keyword}{>}\ (subTable);\ \}}
\DoxyCodeLine{01254\ }
\DoxyCodeLine{01255\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ TSubTable>}
\DoxyCodeLine{01256\ \ \ \textcolor{keyword}{const}\ TSubTable\&\ get\_subtable\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01257\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{this}+get\_subtables<TSubTable>\ ()[i];\ \}}
\DoxyCodeLine{01258\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ TSubTable>}
\DoxyCodeLine{01259\ \ \ TSubTable\&\ get\_subtable\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i)}
\DoxyCodeLine{01260\ \ \ \{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{this}+get\_subtables<TSubTable>\ ()[i];\ \}}
\DoxyCodeLine{01261\ }
\DoxyCodeLine{01262\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_size\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{01263\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01264\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \&markFilteringSet\ =\ StructAfter<const\ HBUINT16>\ (subTable);}
\DoxyCodeLine{01265\ \ \ \ \ \textcolor{keywordflow}{if}\ (lookupFlag\ \&\ LookupFlag::UseMarkFilteringSet)}
\DoxyCodeLine{01266\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *)\ \&StructAfter<const\ char>\ (markFilteringSet)\ -\/\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *)\ \textcolor{keyword}{this};}
\DoxyCodeLine{01267\ \ \ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *)\ \&markFilteringSet\ -\/\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *)\ \textcolor{keyword}{this};}
\DoxyCodeLine{01268\ \ \ \}}
\DoxyCodeLine{01269\ }
\DoxyCodeLine{01270\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_type\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ lookupType;\ \}}
\DoxyCodeLine{01271\ }
\DoxyCodeLine{01272\ \ \ \textcolor{comment}{/*\ lookup\_props\ is\ a\ 32-\/bit\ integer\ where\ the\ lower\ 16-\/bit\ is\ LookupFlag\ and}}
\DoxyCodeLine{01273\ \textcolor{comment}{\ \ \ *\ higher\ 16-\/bit\ is\ mark-\/filtering-\/set\ if\ the\ lookup\ uses\ one.}}
\DoxyCodeLine{01274\ \textcolor{comment}{\ \ \ *\ Not\ to\ be\ confused\ with\ glyph\_props\ which\ is\ very\ similar.\ */}}
\DoxyCodeLine{01275\ \ \ uint32\_t\ get\_props\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{01276\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01277\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ flag\ =\ lookupFlag;}
\DoxyCodeLine{01278\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (flag\ \&\ LookupFlag::UseMarkFilteringSet))}
\DoxyCodeLine{01279\ \ \ \ \ \{}
\DoxyCodeLine{01280\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \&markFilteringSet\ =\ StructAfter<HBUINT16>\ (subTable);}
\DoxyCodeLine{01281\ \ \ \ \ \ \ flag\ +=\ (markFilteringSet\ <<\ 16);}
\DoxyCodeLine{01282\ \ \ \ \ \}}
\DoxyCodeLine{01283\ \ \ \ \ \textcolor{keywordflow}{return}\ flag;}
\DoxyCodeLine{01284\ \ \ \}}
\DoxyCodeLine{01285\ }
\DoxyCodeLine{01286\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ TSubTable,\ \textcolor{keyword}{typename}\ context\_t,\ \textcolor{keyword}{typename}\ ...Ts>}
\DoxyCodeLine{01287\ \ \ \textcolor{keyword}{typename}\ context\_t::return\_t\ dispatch\ (context\_t\ *c,\ Ts\&\&...\ ds)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01288\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01289\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookup\_type\ =\ get\_type\ ();}
\DoxyCodeLine{01290\ \ \ \ \ TRACE\_DISPATCH\ (\textcolor{keyword}{this},\ lookup\_type);}
\DoxyCodeLine{01291\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ get\_subtable\_count\ ();}
\DoxyCodeLine{01292\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)\ \{}
\DoxyCodeLine{01293\ \ \ \ \ \ \ \textcolor{keyword}{typename}\ context\_t::return\_t\ r\ =\ get\_subtable<TSubTable>\ (i).dispatch\ (c,\ lookup\_type,\ std::forward<Ts>\ (ds)...);}
\DoxyCodeLine{01294\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (c-\/>stop\_sublookup\_iteration\ (r))}
\DoxyCodeLine{01295\ \ \ \ \ return\_trace\ (r);}
\DoxyCodeLine{01296\ \ \ \ \ \}}
\DoxyCodeLine{01297\ \ \ \ \ return\_trace\ (c-\/>default\_return\_value\ ());}
\DoxyCodeLine{01298\ \ \ \}}
\DoxyCodeLine{01299\ }
\DoxyCodeLine{01300\ \ \ \textcolor{keywordtype}{bool}\ serialize\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{01301\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookup\_type,}
\DoxyCodeLine{01302\ \ \ \ \ \ \ \ \ \ \ uint32\_t\ lookup\_props,}
\DoxyCodeLine{01303\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ num\_subtables)}
\DoxyCodeLine{01304\ \ \ \{}
\DoxyCodeLine{01305\ \ \ \ \ TRACE\_SERIALIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01306\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>extend\_min\ (\textcolor{keyword}{this})))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01307\ \ \ \ \ lookupType\ =\ lookup\_type;}
\DoxyCodeLine{01308\ \ \ \ \ lookupFlag\ =\ lookup\_props\ \&\ 0xFFFFu;}
\DoxyCodeLine{01309\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!subTable.serialize\ (c,\ num\_subtables)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01310\ \ \ \ \ \textcolor{keywordflow}{if}\ (lookupFlag\ \&\ LookupFlag::UseMarkFilteringSet)}
\DoxyCodeLine{01311\ \ \ \ \ \{}
\DoxyCodeLine{01312\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>extend\ (\textcolor{keyword}{this})))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01313\ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \&markFilteringSet\ =\ StructAfter<HBUINT16>\ (subTable);}
\DoxyCodeLine{01314\ \ \ \ \ \ \ markFilteringSet\ =\ lookup\_props\ >>\ 16;}
\DoxyCodeLine{01315\ \ \ \ \ \}}
\DoxyCodeLine{01316\ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{01317\ \ \ \}}
\DoxyCodeLine{01318\ }
\DoxyCodeLine{01319\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ TSubTable>}
\DoxyCodeLine{01320\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01321\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01322\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01323\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>serializer-\/>start\_embed\ (*\textcolor{keyword}{this});}
\DoxyCodeLine{01324\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!out\ ||\ !c-\/>serializer-\/>extend\_min\ (out)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01325\ \ \ \ \ out-\/>lookupType\ =\ lookupType;}
\DoxyCodeLine{01326\ \ \ \ \ out-\/>lookupFlag\ =\ lookupFlag;}
\DoxyCodeLine{01327\ }
\DoxyCodeLine{01328\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphset\ =\ c-\/>plan-\/>glyphset\_gsub\ ();}
\DoxyCodeLine{01329\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookup\_type\ =\ get\_type\ ();}
\DoxyCodeLine{01330\ \ \ \ \ +\ hb\_iter\ (get\_subtables\ <TSubTable>\ ())}
\DoxyCodeLine{01331\ \ \ \ \ |\ hb\_filter\ ([\textcolor{keyword}{this},\ glyphset,\ lookup\_type]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<TSubTable>}}\ \&\_)\ \{\ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{this}+\_).intersects\ (glyphset,\ lookup\_type);\ \})}
\DoxyCodeLine{01332\ \ \ \ \ |\ hb\_apply\ (subset\_offset\_array\ (c,\ out-\/>get\_subtables<TSubTable>\ (),\ \textcolor{keyword}{this},\ lookup\_type))}
\DoxyCodeLine{01333\ \ \ \ \ ;}
\DoxyCodeLine{01334\ }
\DoxyCodeLine{01335\ \ \ \ \ \textcolor{keywordflow}{if}\ (lookupFlag\ \&\ LookupFlag::UseMarkFilteringSet)}
\DoxyCodeLine{01336\ \ \ \ \ \{}
\DoxyCodeLine{01337\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>serializer-\/>extend\ (out)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01338\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \&markFilteringSet\ =\ StructAfter<HBUINT16>\ (subTable);}
\DoxyCodeLine{01339\ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \&outMarkFilteringSet\ =\ StructAfter<HBUINT16>\ (out-\/>subTable);}
\DoxyCodeLine{01340\ \ \ \ \ \ \ outMarkFilteringSet\ =\ markFilteringSet;}
\DoxyCodeLine{01341\ \ \ \ \ \}}
\DoxyCodeLine{01342\ }
\DoxyCodeLine{01343\ \ \ \ \ return\_trace\ (out-\/>subTable.len);}
\DoxyCodeLine{01344\ \ \ \}}
\DoxyCodeLine{01345\ }
\DoxyCodeLine{01346\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ TSubTable>}
\DoxyCodeLine{01347\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01348\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01349\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01350\ \ \ \ \ \textcolor{keywordflow}{if}\ (!(c-\/>check\_struct\ (\textcolor{keyword}{this})\ \&\&\ subTable.sanitize\ (c)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01351\ }
\DoxyCodeLine{01352\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ subtables\ =\ get\_subtable\_count\ ();}
\DoxyCodeLine{01353\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>visit\_subtables\ (subtables)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01354\ }
\DoxyCodeLine{01355\ \ \ \ \ \textcolor{keywordflow}{if}\ (lookupFlag\ \&\ LookupFlag::UseMarkFilteringSet)}
\DoxyCodeLine{01356\ \ \ \ \ \{}
\DoxyCodeLine{01357\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \&markFilteringSet\ =\ StructAfter<HBUINT16>\ (subTable);}
\DoxyCodeLine{01358\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!markFilteringSet.sanitize\ (c))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01359\ \ \ \ \ \}}
\DoxyCodeLine{01360\ }
\DoxyCodeLine{01361\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!get\_subtables<TSubTable>\ ().sanitize\ (c,\ \textcolor{keyword}{this},\ get\_type\ ())))}
\DoxyCodeLine{01362\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01363\ }
\DoxyCodeLine{01364\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (get\_type\ ()\ ==\ TSubTable::Extension\ \&\&\ subtables\ \&\&\ !c-\/>get\_edit\_count\ ()))}
\DoxyCodeLine{01365\ \ \ \ \ \{}
\DoxyCodeLine{01366\ \ \ \ \ \ \ \textcolor{comment}{/*\ The\ spec\ says\ all\ subtables\ of\ an\ Extension\ lookup\ should}}
\DoxyCodeLine{01367\ \textcolor{comment}{\ \ \ \ \ \ \ *\ have\ the\ same\ type,\ which\ shall\ not\ be\ the\ Extension\ type}}
\DoxyCodeLine{01368\ \textcolor{comment}{\ \ \ \ \ \ \ *\ itself\ (but\ we\ already\ checked\ for\ that).}}
\DoxyCodeLine{01369\ \textcolor{comment}{\ \ \ \ \ \ \ *\ This\ is\ specially\ important\ if\ one\ has\ a\ reverse\ type!}}
\DoxyCodeLine{01370\ \textcolor{comment}{\ \ \ \ \ \ \ *}}
\DoxyCodeLine{01371\ \textcolor{comment}{\ \ \ \ \ \ \ *\ We\ only\ do\ this\ if\ sanitizer\ edit\_count\ is\ zero.\ \ Otherwise,}}
\DoxyCodeLine{01372\ \textcolor{comment}{\ \ \ \ \ \ \ *\ some\ of\ the\ subtables\ might\ have\ become\ insane\ after\ they}}
\DoxyCodeLine{01373\ \textcolor{comment}{\ \ \ \ \ \ \ *\ were\ sanity-\/checked\ by\ the\ edits\ of\ subsequent\ subtables.}}
\DoxyCodeLine{01374\ \textcolor{comment}{\ \ \ \ \ \ \ *\ https://bugs.chromium.org/p/chromium/issues/detail?id=960331}}
\DoxyCodeLine{01375\ \textcolor{comment}{\ \ \ \ \ \ \ */}}
\DoxyCodeLine{01376\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ type\ =\ get\_subtable<TSubTable>\ (0).u.extension.get\_type\ ();}
\DoxyCodeLine{01377\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ subtables;\ i++)}
\DoxyCodeLine{01378\ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_subtable<TSubTable>\ (i).u.extension.get\_type\ ()\ !=\ type)}
\DoxyCodeLine{01379\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01380\ \ \ \ \ \}}
\DoxyCodeLine{01381\ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{01382\ \ \ \}}
\DoxyCodeLine{01383\ }
\DoxyCodeLine{01384\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{01385\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ lookupType;\ \ \ \ \ \textcolor{comment}{/*\ Different\ enumerations\ for\ GSUB\ and\ GPOS\ */}}
\DoxyCodeLine{01386\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ lookupFlag;\ \ \ \ \ \textcolor{comment}{/*\ Lookup\ qualifiers\ */}}
\DoxyCodeLine{01387\ \ \ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<Offset16>}}}
\DoxyCodeLine{01388\ \ \ \ \ \ \ \ \ subTable;\ \ \ \ \ \ \ \textcolor{comment}{/*\ Array\ of\ SubTables\ */}}
\DoxyCodeLine{01389\ \textcolor{comment}{/*HBUINT16\ \ markFilteringSetX[HB\_VAR\_ARRAY];*/}\textcolor{comment}{/*\ Index\ (base\ 0)\ into\ GDEF\ mark\ glyph\ sets}}
\DoxyCodeLine{01390\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ structure.\ This\ field\ is\ only\ present\ if\ bit}}
\DoxyCodeLine{01391\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ UseMarkFilteringSet\ of\ lookup\ flags\ is\ set.\ */}}
\DoxyCodeLine{01392\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01393\ \ \ DEFINE\_SIZE\_ARRAY\ (6,\ subTable);}
\DoxyCodeLine{01394\ \};}
\DoxyCodeLine{01395\ }
\DoxyCodeLine{01396\ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{struct_o_t_1_1_list16_of_offset16_to}{List16OfOffset16To<Lookup>}}\ \mbox{\hyperlink{struct_o_t_1_1_list16_of_offset16_to}{LookupList}};}
\DoxyCodeLine{01397\ }
\DoxyCodeLine{01398\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ TLookup>}
\DoxyCodeLine{01399\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_lookup_offset_list}{LookupOffsetList}}\ :\ \mbox{\hyperlink{struct_o_t_1_1_list16_of_offset16_to}{List16OfOffset16To}}<TLookup>}
\DoxyCodeLine{01400\ \{}
\DoxyCodeLine{01401\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ \ \ \ \ \ \ \ *c,}
\DoxyCodeLine{01402\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__subset__layout__context__t}{hb\_subset\_layout\_context\_t}}\ *l)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01403\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01404\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01405\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>serializer-\/>start\_embed\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01406\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!out\ ||\ !c-\/>serializer-\/>extend\_min\ (out)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01407\ }
\DoxyCodeLine{01408\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ count\ =\ this-\/>len;}
\DoxyCodeLine{01409\ \ \ \ \ +\ hb\_zip\ (*\textcolor{keyword}{this},\ hb\_range\ (count))}
\DoxyCodeLine{01410\ \ \ \ \ |\ hb\_filter\ (l-\/>lookup\_index\_map,\ hb\_second)}
\DoxyCodeLine{01411\ \ \ \ \ |\ hb\_map\ (hb\_first)}
\DoxyCodeLine{01412\ \ \ \ \ |\ hb\_apply\ (subset\_offset\_array\ (c,\ *out,\ \textcolor{keyword}{this}))}
\DoxyCodeLine{01413\ \ \ \ \ ;}
\DoxyCodeLine{01414\ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{01415\ \ \ \}}
\DoxyCodeLine{01416\ }
\DoxyCodeLine{01417\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01418\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01419\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01420\ \ \ \ \ return\_trace\ (\mbox{\hyperlink{struct_o_t_1_1_list16_of_offset16_to}{List16OfOffset16To<TLookup>::sanitize}}\ (c,\ \textcolor{keyword}{this}));}
\DoxyCodeLine{01421\ \ \ \}}
\DoxyCodeLine{01422\ \};}
\DoxyCodeLine{01423\ }
\DoxyCodeLine{01424\ }
\DoxyCodeLine{01425\ \textcolor{comment}{/*}}
\DoxyCodeLine{01426\ \textcolor{comment}{\ *\ Coverage\ Table}}
\DoxyCodeLine{01427\ \textcolor{comment}{\ */}}
\DoxyCodeLine{01428\ }
\DoxyCodeLine{01429\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_coverage_format1}{CoverageFormat1}}}
\DoxyCodeLine{01430\ \{}
\DoxyCodeLine{01431\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_coverage}{Coverage}};}
\DoxyCodeLine{01432\ }
\DoxyCodeLine{01433\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{01434\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_coverage\ (hb\_codepoint\_t\ glyph\_id)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01435\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01436\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i;}
\DoxyCodeLine{01437\ \ \ \ \ glyphArray.bfind\ (glyph\_id,\ \&i,\ HB\_NOT\_FOUND\_STORE,\ NOT\_COVERED);}
\DoxyCodeLine{01438\ \ \ \ \ \textcolor{keywordflow}{return}\ i;}
\DoxyCodeLine{01439\ \ \ \}}
\DoxyCodeLine{01440\ }
\DoxyCodeLine{01441\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Iterator,}
\DoxyCodeLine{01442\ \ \ \ \ \ \ hb\_requires\ (hb\_is\_sorted\_source\_of\ (Iterator,\ hb\_codepoint\_t))>}
\DoxyCodeLine{01443\ \ \ \textcolor{keywordtype}{bool}\ serialize\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,\ Iterator\ glyphs)}
\DoxyCodeLine{01444\ \ \ \{}
\DoxyCodeLine{01445\ \ \ \ \ TRACE\_SERIALIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01446\ \ \ \ \ return\_trace\ (glyphArray.serialize\ (c,\ glyphs));}
\DoxyCodeLine{01447\ \ \ \}}
\DoxyCodeLine{01448\ }
\DoxyCodeLine{01449\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01450\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01451\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01452\ \ \ \ \ return\_trace\ (glyphArray.sanitize\ (c));}
\DoxyCodeLine{01453\ \ \ \}}
\DoxyCodeLine{01454\ }
\DoxyCodeLine{01455\ \ \ \textcolor{keywordtype}{bool}\ intersects\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01456\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01457\ \ \ \ \ \textcolor{comment}{/*\ TODO\ Speed\ up,\ using\ hb\_set\_next()\ and\ bsearch()?\ */}}
\DoxyCodeLine{01458\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ g\ :\ glyphArray.as\_array\ ())}
\DoxyCodeLine{01459\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (glyphs-\/>has\ (g))}
\DoxyCodeLine{01460\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01461\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01462\ \ \ \}}
\DoxyCodeLine{01463\ \ \ \textcolor{keywordtype}{bool}\ intersects\_coverage\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ index)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01464\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ glyphs-\/>has\ (glyphArray[index]);\ \}}
\DoxyCodeLine{01465\ }
\DoxyCodeLine{01466\ \ \ \textcolor{keywordtype}{void}\ intersected\_coverage\_glyphs\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *intersect\_glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01467\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01468\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ count\ =\ glyphArray.len;}
\DoxyCodeLine{01469\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{01470\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (glyphs-\/>has\ (glyphArray[i]))}
\DoxyCodeLine{01471\ \ \ \ \ \ \ \ \ intersect\_glyphs-\/>add\ (glyphArray[i]);}
\DoxyCodeLine{01472\ \ \ \}}
\DoxyCodeLine{01473\ }
\DoxyCodeLine{01474\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ set\_t>}
\DoxyCodeLine{01475\ \ \ \textcolor{keywordtype}{bool}\ collect\_coverage\ (set\_t\ *glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01476\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ glyphs-\/>add\_sorted\_array\ (glyphArray.as\_array\ ());\ \}}
\DoxyCodeLine{01477\ }
\DoxyCodeLine{01478\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01479\ \ \ \textcolor{comment}{/*\ Older\ compilers\ need\ this\ to\ be\ public.\ */}}
\DoxyCodeLine{01480\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_coverage_format1_1_1iter__t}{iter\_t}}}
\DoxyCodeLine{01481\ \ \ \{}
\DoxyCodeLine{01482\ \ \ \ \ \textcolor{keywordtype}{void}\ init\ (\textcolor{keyword}{const}\ \textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_o_t_1_1_coverage_format1}{CoverageFormat1}}\ \&c\_)\ \{\ c\ =\ \&c\_;\ i\ =\ 0;\ \}}
\DoxyCodeLine{01483\ \ \ \ \ \textcolor{keywordtype}{void}\ fini\ ()\ \{\}}
\DoxyCodeLine{01484\ \ \ \ \ \textcolor{keywordtype}{bool}\ more\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ i\ <\ c-\/>glyphArray.len;\ \}}
\DoxyCodeLine{01485\ \ \ \ \ \textcolor{keywordtype}{void}\ next\ ()\ \{\ i++;\ \}}
\DoxyCodeLine{01486\ \ \ \ \ hb\_codepoint\_t\ get\_glyph\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ c-\/>glyphArray[i];\ \}}
\DoxyCodeLine{01487\ \ \ \ \ \textcolor{keywordtype}{bool}\ operator\ !=\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_coverage_format1_1_1iter__t}{iter\_t}}\&\ o)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01488\ \textcolor{keyword}{\ \ \ \ }\{\ \textcolor{keywordflow}{return}\ i\ !=\ o.i\ ||\ c\ !=\ o.c;\ \}}
\DoxyCodeLine{01489\ }
\DoxyCodeLine{01490\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{01491\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_coverage_format1}{CoverageFormat1}}\ *c;}
\DoxyCodeLine{01492\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i;}
\DoxyCodeLine{01493\ \ \ \};}
\DoxyCodeLine{01494\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{01495\ }
\DoxyCodeLine{01496\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{01497\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ coverageFormat;\ \textcolor{comment}{/*\ Format\ identifier-\/-\/format\ =\ 1\ */}}
\DoxyCodeLine{01498\ \ \ \mbox{\hyperlink{struct_o_t_1_1_sorted_array_of}{SortedArray16Of<HBGlyphID16>}}}
\DoxyCodeLine{01499\ \ \ \ \ \ \ \ \ glyphArray;\ \textcolor{comment}{/*\ Array\ of\ GlyphIDs-\/-\/in\ numerical\ order\ */}}
\DoxyCodeLine{01500\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01501\ \ \ DEFINE\_SIZE\_ARRAY\ (4,\ glyphArray);}
\DoxyCodeLine{01502\ \};}
\DoxyCodeLine{01503\ }
\DoxyCodeLine{01504\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_coverage_format2}{CoverageFormat2}}}
\DoxyCodeLine{01505\ \{}
\DoxyCodeLine{01506\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_coverage}{Coverage}};}
\DoxyCodeLine{01507\ }
\DoxyCodeLine{01508\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{01509\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_coverage\ (hb\_codepoint\_t\ glyph\_id)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01510\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01511\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_range_record}{RangeRecord}}\ \&range\ =\ rangeRecord.bsearch\ (glyph\_id);}
\DoxyCodeLine{01512\ \ \ \ \ \textcolor{keywordflow}{return}\ likely\ (range.first\ <=\ range.last)}
\DoxyCodeLine{01513\ \ \ \ \ \ ?\ (\textcolor{keywordtype}{unsigned}\ int)\ range.value\ +\ (glyph\_id\ -\/\ range.first)}
\DoxyCodeLine{01514\ \ \ \ \ \ :\ NOT\_COVERED;}
\DoxyCodeLine{01515\ \ \ \}}
\DoxyCodeLine{01516\ }
\DoxyCodeLine{01517\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Iterator,}
\DoxyCodeLine{01518\ \ \ \ \ \ \ hb\_requires\ (hb\_is\_sorted\_source\_of\ (Iterator,\ hb\_codepoint\_t))>}
\DoxyCodeLine{01519\ \ \ \textcolor{keywordtype}{bool}\ serialize\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,\ Iterator\ glyphs)}
\DoxyCodeLine{01520\ \ \ \{}
\DoxyCodeLine{01521\ \ \ \ \ TRACE\_SERIALIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01522\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>extend\_min\ (\textcolor{keyword}{this})))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01523\ }
\DoxyCodeLine{01524\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!glyphs))}
\DoxyCodeLine{01525\ \ \ \ \ \{}
\DoxyCodeLine{01526\ \ \ \ \ \ \ rangeRecord.len\ =\ 0;}
\DoxyCodeLine{01527\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{01528\ \ \ \ \ \}}
\DoxyCodeLine{01529\ }
\DoxyCodeLine{01530\ \ \ \ \ \textcolor{comment}{/*\ TODO(iter)\ Write\ more\ efficiently?\ */}}
\DoxyCodeLine{01531\ }
\DoxyCodeLine{01532\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ num\_ranges\ =\ 0;}
\DoxyCodeLine{01533\ \ \ \ \ hb\_codepoint\_t\ last\ =\ (hb\_codepoint\_t)\ -\/2;}
\DoxyCodeLine{01534\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ g:\ glyphs)}
\DoxyCodeLine{01535\ \ \ \ \ \{}
\DoxyCodeLine{01536\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (last\ +\ 1\ !=\ g)}
\DoxyCodeLine{01537\ \ \ \ \ num\_ranges++;}
\DoxyCodeLine{01538\ \ \ \ \ \ \ last\ =\ g;}
\DoxyCodeLine{01539\ \ \ \ \ \}}
\DoxyCodeLine{01540\ }
\DoxyCodeLine{01541\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!rangeRecord.serialize\ (c,\ num\_ranges)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01542\ }
\DoxyCodeLine{01543\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ count\ =\ 0;}
\DoxyCodeLine{01544\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ range\ =\ (unsigned)\ -\/1;}
\DoxyCodeLine{01545\ \ \ \ \ last\ =\ (hb\_codepoint\_t)\ -\/2;}
\DoxyCodeLine{01546\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ g:\ glyphs)}
\DoxyCodeLine{01547\ \ \ \ \ \{}
\DoxyCodeLine{01548\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (last\ +\ 1\ !=\ g)}
\DoxyCodeLine{01549\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01550\ \ \ \ \ range++;}
\DoxyCodeLine{01551\ \ \ \ \ rangeRecord[range].first\ =\ g;}
\DoxyCodeLine{01552\ \ \ \ \ rangeRecord[range].value\ =\ count;}
\DoxyCodeLine{01553\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01554\ \ \ \ \ \ \ rangeRecord[range].last\ =\ g;}
\DoxyCodeLine{01555\ \ \ \ \ \ \ last\ =\ g;}
\DoxyCodeLine{01556\ \ \ \ \ \ \ count++;}
\DoxyCodeLine{01557\ \ \ \ \ \}}
\DoxyCodeLine{01558\ }
\DoxyCodeLine{01559\ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{01560\ \ \ \}}
\DoxyCodeLine{01561\ }
\DoxyCodeLine{01562\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01563\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01564\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01565\ \ \ \ \ return\_trace\ (rangeRecord.sanitize\ (c));}
\DoxyCodeLine{01566\ \ \ \}}
\DoxyCodeLine{01567\ }
\DoxyCodeLine{01568\ \ \ \textcolor{keywordtype}{bool}\ intersects\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01569\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01570\ \ \ \ \ \textcolor{comment}{/*\ TODO\ Speed\ up,\ using\ hb\_set\_next()\ and\ bsearch()?\ */}}
\DoxyCodeLine{01571\ \ \ \ \ \textcolor{comment}{/*\ TODO(iter)\ Rewrite\ as\ dagger.\ */}}
\DoxyCodeLine{01572\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ range\ :\ rangeRecord.as\_array\ ())}
\DoxyCodeLine{01573\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (range.intersects\ (glyphs))}
\DoxyCodeLine{01574\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01575\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01576\ \ \ \}}
\DoxyCodeLine{01577\ \ \ \textcolor{keywordtype}{bool}\ intersects\_coverage\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ index)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01578\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01579\ \ \ \ \ \textcolor{comment}{/*\ TODO(iter)\ Rewrite\ as\ dagger.\ */}}
\DoxyCodeLine{01580\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ range\ :\ rangeRecord.as\_array\ ())}
\DoxyCodeLine{01581\ \ \ \ \ \{}
\DoxyCodeLine{01582\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (range.value\ <=\ index\ \&\&}
\DoxyCodeLine{01583\ \ \ \ \ \ \ index\ <\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int})\ range.value\ +\ (range.last\ -\/\ range.first)\ \&\&}
\DoxyCodeLine{01584\ \ \ \ \ \ \ range.intersects\ (glyphs))}
\DoxyCodeLine{01585\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01586\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (index\ <\ range.value)}
\DoxyCodeLine{01587\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01588\ \ \ \ \ \}}
\DoxyCodeLine{01589\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01590\ \ \ \}}
\DoxyCodeLine{01591\ }
\DoxyCodeLine{01592\ \ \ \textcolor{keywordtype}{void}\ intersected\_coverage\_glyphs\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *intersect\_glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01593\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01594\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ range\ :\ rangeRecord.as\_array\ ())}
\DoxyCodeLine{01595\ \ \ \ \ \{}
\DoxyCodeLine{01596\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!range.intersects\ (glyphs))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01597\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (hb\_codepoint\_t\ g\ =\ range.first;\ g\ <=\ range.last;\ g++)}
\DoxyCodeLine{01598\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (glyphs-\/>has\ (g))\ intersect\_glyphs-\/>add\ (g);}
\DoxyCodeLine{01599\ \ \ \ \ \}}
\DoxyCodeLine{01600\ \ \ \}}
\DoxyCodeLine{01601\ }
\DoxyCodeLine{01602\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ set\_t>}
\DoxyCodeLine{01603\ \ \ \textcolor{keywordtype}{bool}\ collect\_coverage\ (set\_t\ *glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01604\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01605\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ rangeRecord.len;}
\DoxyCodeLine{01606\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{01607\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!rangeRecord[i].collect\_coverage\ (glyphs)))}
\DoxyCodeLine{01608\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01609\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01610\ \ \ \}}
\DoxyCodeLine{01611\ }
\DoxyCodeLine{01612\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01613\ \ \ \textcolor{comment}{/*\ Older\ compilers\ need\ this\ to\ be\ public.\ */}}
\DoxyCodeLine{01614\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_coverage_format2_1_1iter__t}{iter\_t}}}
\DoxyCodeLine{01615\ \ \ \{}
\DoxyCodeLine{01616\ \ \ \ \ \textcolor{keywordtype}{void}\ init\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_coverage_format2}{CoverageFormat2}}\ \&c\_)}
\DoxyCodeLine{01617\ \ \ \ \ \{}
\DoxyCodeLine{01618\ \ \ \ \ \ \ c\ =\ \&c\_;}
\DoxyCodeLine{01619\ \ \ \ \ \ \ coverage\ =\ 0;}
\DoxyCodeLine{01620\ \ \ \ \ \ \ i\ =\ 0;}
\DoxyCodeLine{01621\ \ \ \ \ \ \ j\ =\ c-\/>rangeRecord.len\ ?\ c-\/>rangeRecord[0].first\ :\ 0;}
\DoxyCodeLine{01622\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (c-\/>rangeRecord[0].first\ >\ c-\/>rangeRecord[0].last))}
\DoxyCodeLine{01623\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01624\ \ \ \ \ \textcolor{comment}{/*\ Broken\ table.\ Skip.\ */}}
\DoxyCodeLine{01625\ \ \ \ \ i\ =\ c-\/>rangeRecord.len;}
\DoxyCodeLine{01626\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01627\ \ \ \ \ \}}
\DoxyCodeLine{01628\ \ \ \ \ \textcolor{keywordtype}{void}\ fini\ ()\ \{\}}
\DoxyCodeLine{01629\ \ \ \ \ \textcolor{keywordtype}{bool}\ more\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ i\ <\ c-\/>rangeRecord.len;\ \}}
\DoxyCodeLine{01630\ \ \ \ \ \textcolor{keywordtype}{void}\ next\ ()}
\DoxyCodeLine{01631\ \ \ \ \ \{}
\DoxyCodeLine{01632\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ >=\ c-\/>rangeRecord[i].last)}
\DoxyCodeLine{01633\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01634\ \ \ \ \ i++;}
\DoxyCodeLine{01635\ \ \ \ \ \textcolor{keywordflow}{if}\ (more\ ())}
\DoxyCodeLine{01636\ \ \ \ \ \{}
\DoxyCodeLine{01637\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ old\ =\ coverage;}
\DoxyCodeLine{01638\ \ \ \ \ \ \ j\ =\ c-\/>rangeRecord[i].first;}
\DoxyCodeLine{01639\ \ \ \ \ \ \ coverage\ =\ c-\/>rangeRecord[i].value;}
\DoxyCodeLine{01640\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (coverage\ !=\ old\ +\ 1))}
\DoxyCodeLine{01641\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01642\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Broken\ table.\ Skip.\ Important\ to\ avoid\ DoS.}}
\DoxyCodeLine{01643\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ Also,\ our\ callers\ depend\ on\ coverage\ being}}
\DoxyCodeLine{01644\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ consecutive\ and\ monotonically\ increasing,}}
\DoxyCodeLine{01645\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ ie.\ iota().\ */}}
\DoxyCodeLine{01646\ \ \ \ \ \ \ \ i\ =\ c-\/>rangeRecord.len;}
\DoxyCodeLine{01647\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01648\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01649\ \ \ \ \ \}}
\DoxyCodeLine{01650\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01651\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01652\ \ \ \ \ \ \ coverage++;}
\DoxyCodeLine{01653\ \ \ \ \ \ \ j++;}
\DoxyCodeLine{01654\ \ \ \ \ \}}
\DoxyCodeLine{01655\ \ \ \ \ hb\_codepoint\_t\ get\_glyph\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ j;\ \}}
\DoxyCodeLine{01656\ \ \ \ \ \textcolor{keywordtype}{bool}\ operator\ !=\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_coverage_format2_1_1iter__t}{iter\_t}}\&\ o)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01657\ \textcolor{keyword}{\ \ \ \ }\{\ \textcolor{keywordflow}{return}\ i\ !=\ o.i\ ||\ j\ !=\ o.j\ ||\ c\ !=\ o.c;\ \}}
\DoxyCodeLine{01658\ }
\DoxyCodeLine{01659\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{01660\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_coverage_format2}{CoverageFormat2}}\ *c;}
\DoxyCodeLine{01661\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i,\ coverage;}
\DoxyCodeLine{01662\ \ \ \ \ hb\_codepoint\_t\ j;}
\DoxyCodeLine{01663\ \ \ \};}
\DoxyCodeLine{01664\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{01665\ }
\DoxyCodeLine{01666\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{01667\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ coverageFormat;\ \textcolor{comment}{/*\ Format\ identifier-\/-\/format\ =\ 2\ */}}
\DoxyCodeLine{01668\ \ \ \mbox{\hyperlink{struct_o_t_1_1_sorted_array_of}{SortedArray16Of<RangeRecord>}}}
\DoxyCodeLine{01669\ \ \ \ \ \ \ \ \ rangeRecord;\ \ \ \ \textcolor{comment}{/*\ Array\ of\ glyph\ ranges-\/-\/ordered\ by}}
\DoxyCodeLine{01670\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ Start\ GlyphID.\ rangeCount\ entries}}
\DoxyCodeLine{01671\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ long\ */}}
\DoxyCodeLine{01672\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01673\ \ \ DEFINE\_SIZE\_ARRAY\ (4,\ rangeRecord);}
\DoxyCodeLine{01674\ \};}
\DoxyCodeLine{01675\ }
\DoxyCodeLine{01676\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_coverage}{Coverage}}}
\DoxyCodeLine{01677\ \{}
\DoxyCodeLine{01678\ \ \ \textcolor{comment}{/*\ Has\ interface.\ */}}
\DoxyCodeLine{01679\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ SENTINEL\ =\ NOT\_COVERED;}
\DoxyCodeLine{01680\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ value\_t;}
\DoxyCodeLine{01681\ \ \ value\_t\ operator\ []\ (hb\_codepoint\_t\ k)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ get\ (k);\ \}}
\DoxyCodeLine{01682\ \ \ \textcolor{keywordtype}{bool}\ has\ (hb\_codepoint\_t\ k)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ (*\textcolor{keyword}{this})[k]\ !=\ SENTINEL;\ \}}
\DoxyCodeLine{01683\ \ \ \textcolor{comment}{/*\ Predicate.\ */}}
\DoxyCodeLine{01684\ \ \ \textcolor{keywordtype}{bool}\ operator\ ()\ (hb\_codepoint\_t\ k)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ has\ (k);\ \}}
\DoxyCodeLine{01685\ }
\DoxyCodeLine{01686\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\ (hb\_codepoint\_t\ k)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ get\_coverage\ (k);\ \}}
\DoxyCodeLine{01687\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_coverage\ (hb\_codepoint\_t\ glyph\_id)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01688\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01689\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)\ \{}
\DoxyCodeLine{01690\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \textcolor{keywordflow}{return}\ u.format1.get\_coverage\ (glyph\_id);}
\DoxyCodeLine{01691\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ \textcolor{keywordflow}{return}\ u.format2.get\_coverage\ (glyph\_id);}
\DoxyCodeLine{01692\ \ \ \ \ \textcolor{keywordflow}{default}:\textcolor{keywordflow}{return}\ NOT\_COVERED;}
\DoxyCodeLine{01693\ \ \ \ \ \}}
\DoxyCodeLine{01694\ \ \ \}}
\DoxyCodeLine{01695\ }
\DoxyCodeLine{01696\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Iterator,}
\DoxyCodeLine{01697\ \ \ \ \ \ \ hb\_requires\ (hb\_is\_sorted\_source\_of\ (Iterator,\ hb\_codepoint\_t))>}
\DoxyCodeLine{01698\ \ \ \textcolor{keywordtype}{bool}\ serialize\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,\ Iterator\ glyphs)}
\DoxyCodeLine{01699\ \ \ \{}
\DoxyCodeLine{01700\ \ \ \ \ TRACE\_SERIALIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01701\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>extend\_min\ (\textcolor{keyword}{this})))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01702\ }
\DoxyCodeLine{01703\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ count\ =\ 0;}
\DoxyCodeLine{01704\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ num\_ranges\ =\ 0;}
\DoxyCodeLine{01705\ \ \ \ \ hb\_codepoint\_t\ last\ =\ (hb\_codepoint\_t)\ -\/2;}
\DoxyCodeLine{01706\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ g:\ glyphs)}
\DoxyCodeLine{01707\ \ \ \ \ \{}
\DoxyCodeLine{01708\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (last\ +\ 1\ !=\ g)}
\DoxyCodeLine{01709\ \ \ \ \ num\_ranges++;}
\DoxyCodeLine{01710\ \ \ \ \ \ \ last\ =\ g;}
\DoxyCodeLine{01711\ \ \ \ \ \ \ count++;}
\DoxyCodeLine{01712\ \ \ \ \ \}}
\DoxyCodeLine{01713\ \ \ \ \ u.format\ =\ count\ <=\ num\_ranges\ *\ 3\ ?\ 1\ :\ 2;}
\DoxyCodeLine{01714\ }
\DoxyCodeLine{01715\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)}
\DoxyCodeLine{01716\ \ \ \ \ \{}
\DoxyCodeLine{01717\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ return\_trace\ (u.format1.serialize\ (c,\ glyphs));}
\DoxyCodeLine{01718\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ return\_trace\ (u.format2.serialize\ (c,\ glyphs));}
\DoxyCodeLine{01719\ \ \ \ \ \textcolor{keywordflow}{default}:return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01720\ \ \ \ \ \}}
\DoxyCodeLine{01721\ \ \ \}}
\DoxyCodeLine{01722\ }
\DoxyCodeLine{01723\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01724\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01725\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01726\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \&glyphset\ =\ *c-\/>plan-\/>glyphset\_gsub\ ();}
\DoxyCodeLine{01727\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ \&glyph\_map\ =\ *c-\/>plan-\/>glyph\_map;}
\DoxyCodeLine{01728\ }
\DoxyCodeLine{01729\ \ \ \ \ \textcolor{keyword}{auto}\ it\ =}
\DoxyCodeLine{01730\ \ \ \ \ +\ iter\ ()}
\DoxyCodeLine{01731\ \ \ \ \ |\ hb\_filter\ (glyphset)}
\DoxyCodeLine{01732\ \ \ \ \ |\ hb\_map\_retains\_sorting\ (glyph\_map)}
\DoxyCodeLine{01733\ \ \ \ \ ;}
\DoxyCodeLine{01734\ }
\DoxyCodeLine{01735\ \ \ \ \ \textcolor{keywordtype}{bool}\ ret\ =\ bool\ (it);}
\DoxyCodeLine{01736\ \ \ \ \ Coverage\_serialize\ (c-\/>serializer,\ it);}
\DoxyCodeLine{01737\ \ \ \ \ return\_trace\ (ret);}
\DoxyCodeLine{01738\ \ \ \}}
\DoxyCodeLine{01739\ }
\DoxyCodeLine{01740\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01741\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01742\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01743\ \ \ \ \ \textcolor{keywordflow}{if}\ (!u.format.sanitize\ (c))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01744\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)}
\DoxyCodeLine{01745\ \ \ \ \ \{}
\DoxyCodeLine{01746\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ return\_trace\ (u.format1.sanitize\ (c));}
\DoxyCodeLine{01747\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ return\_trace\ (u.format2.sanitize\ (c));}
\DoxyCodeLine{01748\ \ \ \ \ \textcolor{keywordflow}{default}:return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{01749\ \ \ \ \ \}}
\DoxyCodeLine{01750\ \ \ \}}
\DoxyCodeLine{01751\ }
\DoxyCodeLine{01752\ \ \ \textcolor{keywordtype}{bool}\ intersects\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01753\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01754\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)}
\DoxyCodeLine{01755\ \ \ \ \ \{}
\DoxyCodeLine{01756\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \textcolor{keywordflow}{return}\ u.format1.intersects\ (glyphs);}
\DoxyCodeLine{01757\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ \textcolor{keywordflow}{return}\ u.format2.intersects\ (glyphs);}
\DoxyCodeLine{01758\ \ \ \ \ \textcolor{keywordflow}{default}:\textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01759\ \ \ \ \ \}}
\DoxyCodeLine{01760\ \ \ \}}
\DoxyCodeLine{01761\ \ \ \textcolor{keywordtype}{bool}\ intersects\_coverage\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ index)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01762\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01763\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)}
\DoxyCodeLine{01764\ \ \ \ \ \{}
\DoxyCodeLine{01765\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \textcolor{keywordflow}{return}\ u.format1.intersects\_coverage\ (glyphs,\ index);}
\DoxyCodeLine{01766\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ \textcolor{keywordflow}{return}\ u.format2.intersects\_coverage\ (glyphs,\ index);}
\DoxyCodeLine{01767\ \ \ \ \ \textcolor{keywordflow}{default}:\textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01768\ \ \ \ \ \}}
\DoxyCodeLine{01769\ \ \ \}}
\DoxyCodeLine{01770\ }
\DoxyCodeLine{01771\ \ \ \textcolor{comment}{/*\ Might\ return\ false\ if\ array\ looks\ unsorted.}}
\DoxyCodeLine{01772\ \textcolor{comment}{\ \ \ *\ Used\ for\ faster\ rejection\ of\ corrupt\ data.\ */}}
\DoxyCodeLine{01773\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ set\_t>}
\DoxyCodeLine{01774\ \ \ \textcolor{keywordtype}{bool}\ collect\_coverage\ (set\_t\ *glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01775\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01776\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)}
\DoxyCodeLine{01777\ \ \ \ \ \{}
\DoxyCodeLine{01778\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \textcolor{keywordflow}{return}\ u.format1.collect\_coverage\ (glyphs);}
\DoxyCodeLine{01779\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ \textcolor{keywordflow}{return}\ u.format2.collect\_coverage\ (glyphs);}
\DoxyCodeLine{01780\ \ \ \ \ \textcolor{keywordflow}{default}:\textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01781\ \ \ \ \ \}}
\DoxyCodeLine{01782\ \ \ \}}
\DoxyCodeLine{01783\ }
\DoxyCodeLine{01784\ \ \ \textcolor{keywordtype}{void}\ intersected\_coverage\_glyphs\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *intersect\_glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01785\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01786\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)}
\DoxyCodeLine{01787\ \ \ \ \ \{}
\DoxyCodeLine{01788\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \textcolor{keywordflow}{return}\ u.format1.intersected\_coverage\_glyphs\ (glyphs,\ intersect\_glyphs);}
\DoxyCodeLine{01789\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ \textcolor{keywordflow}{return}\ u.format2.intersected\_coverage\_glyphs\ (glyphs,\ intersect\_glyphs);}
\DoxyCodeLine{01790\ \ \ \ \ \textcolor{keywordflow}{default}:return\ ;}
\DoxyCodeLine{01791\ \ \ \ \ \}}
\DoxyCodeLine{01792\ \ \ \}}
\DoxyCodeLine{01793\ }
\DoxyCodeLine{01794\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_coverage_1_1iter__t}{iter\_t}}\ :\ \mbox{\hyperlink{structhb__iter__with__fallback__t}{hb\_iter\_with\_fallback\_t}}<iter\_t,\ hb\_codepoint\_t>}
\DoxyCodeLine{01795\ \ \ \{}
\DoxyCodeLine{01796\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{bool}\ is\_sorted\_iterator\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01797\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_coverage_1_1iter__t}{iter\_t}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_coverage}{Coverage}}\ \&c\_\ =\ \mbox{\hyperlink{struct_null}{Null}}\ (\mbox{\hyperlink{struct_o_t_1_1_coverage}{Coverage}}))}
\DoxyCodeLine{01798\ \ \ \ \ \{}
\DoxyCodeLine{01799\ \ \ \ \ \ \ memset\ (\textcolor{keyword}{this},\ 0,\ \textcolor{keyword}{sizeof}\ (*\textcolor{keyword}{this}));}
\DoxyCodeLine{01800\ \ \ \ \ \ \ format\ =\ c\_.u.format;}
\DoxyCodeLine{01801\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (format)}
\DoxyCodeLine{01802\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01803\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ u.format1.init\ (c\_.u.format1);\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01804\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ u.format2.init\ (c\_.u.format2);\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01805\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01806\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01807\ \ \ \ \ \}}
\DoxyCodeLine{01808\ \ \ \ \ \textcolor{keywordtype}{bool}\ \_\_more\_\_\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{01809\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{01810\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (format)}
\DoxyCodeLine{01811\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01812\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \textcolor{keywordflow}{return}\ u.format1.more\ ();}
\DoxyCodeLine{01813\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ \textcolor{keywordflow}{return}\ u.format2.more\ ();}
\DoxyCodeLine{01814\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:\textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01815\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01816\ \ \ \ \ \}}
\DoxyCodeLine{01817\ \ \ \ \ \textcolor{keywordtype}{void}\ \_\_next\_\_\ ()}
\DoxyCodeLine{01818\ \ \ \ \ \{}
\DoxyCodeLine{01819\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (format)}
\DoxyCodeLine{01820\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01821\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ u.format1.next\ ();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01822\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ u.format2.next\ ();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01823\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01824\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01825\ \ \ \ \ \}}
\DoxyCodeLine{01826\ \ \ \ \ \textcolor{keyword}{typedef}\ hb\_codepoint\_t\ \_\_item\_t\_\_;}
\DoxyCodeLine{01827\ \ \ \ \ \_\_item\_t\_\_\ \_\_item\_\_\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ get\_glyph\ ();\ \}}
\DoxyCodeLine{01828\ }
\DoxyCodeLine{01829\ \ \ \ \ hb\_codepoint\_t\ get\_glyph\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{01830\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{01831\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (format)}
\DoxyCodeLine{01832\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01833\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \textcolor{keywordflow}{return}\ u.format1.get\_glyph\ ();}
\DoxyCodeLine{01834\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ \textcolor{keywordflow}{return}\ u.format2.get\_glyph\ ();}
\DoxyCodeLine{01835\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:\textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01836\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01837\ \ \ \ \ \}}
\DoxyCodeLine{01838\ \ \ \ \ \textcolor{keywordtype}{bool}\ operator\ !=\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_coverage_1_1iter__t}{iter\_t}}\&\ o)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01839\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{01840\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (format\ !=\ o.format)\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01841\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (format)}
\DoxyCodeLine{01842\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01843\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \textcolor{keywordflow}{return}\ u.format1\ !=\ o.u.format1;}
\DoxyCodeLine{01844\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ \textcolor{keywordflow}{return}\ u.format2\ !=\ o.u.format2;}
\DoxyCodeLine{01845\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:\textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01846\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01847\ \ \ \ \ \}}
\DoxyCodeLine{01848\ }
\DoxyCodeLine{01849\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{01850\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ format;}
\DoxyCodeLine{01851\ \ \ \ \ \textcolor{keyword}{union\ }\{}
\DoxyCodeLine{01852\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_coverage_format2_1_1iter__t}{CoverageFormat2::iter\_t}}\ \ format2;\ \textcolor{comment}{/*\ Put\ this\ one\ first\ since\ it's\ larger;\ helps\ shut\ up\ compiler.\ */}}
\DoxyCodeLine{01853\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_coverage_format1_1_1iter__t}{CoverageFormat1::iter\_t}}\ \ format1;}
\DoxyCodeLine{01854\ \ \ \ \ \}\ u;}
\DoxyCodeLine{01855\ \ \ \};}
\DoxyCodeLine{01856\ \ \ \mbox{\hyperlink{struct_o_t_1_1_coverage_1_1iter__t}{iter\_t}}\ iter\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_o_t_1_1_coverage_1_1iter__t}{iter\_t}}\ (*\textcolor{keyword}{this});\ \}}
\DoxyCodeLine{01857\ }
\DoxyCodeLine{01858\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{01859\ \ \ \textcolor{keyword}{union\ }\{}
\DoxyCodeLine{01860\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ \ \ \ \ format;\ \ \ \ \ \textcolor{comment}{/*\ Format\ identifier\ */}}
\DoxyCodeLine{01861\ \ \ \mbox{\hyperlink{struct_o_t_1_1_coverage_format1}{CoverageFormat1}}\ \ \ \ format1;}
\DoxyCodeLine{01862\ \ \ \mbox{\hyperlink{struct_o_t_1_1_coverage_format2}{CoverageFormat2}}\ \ \ \ format2;}
\DoxyCodeLine{01863\ \ \ \}\ u;}
\DoxyCodeLine{01864\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01865\ \ \ DEFINE\_SIZE\_UNION\ (2,\ format);}
\DoxyCodeLine{01866\ \};}
\DoxyCodeLine{01867\ }
\DoxyCodeLine{01868\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Iterator>}
\DoxyCodeLine{01869\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{01870\ Coverage\_serialize\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{01871\ \ \ \ \ \ \ \ \ \ \ \ \ Iterator\ it)}
\DoxyCodeLine{01872\ \{\ c-\/>start\_embed<Coverage>\ ()-\/>serialize\ (c,\ it);\ \}}
\DoxyCodeLine{01873\ }
\DoxyCodeLine{01874\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ ClassDef\_remap\_and\_serialize\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{01875\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ \&gid\_klass\_map,}
\DoxyCodeLine{01876\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__vector__t}{hb\_sorted\_vector\_t<HBGlyphID16>}}\ \&glyphs,}
\DoxyCodeLine{01877\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \&klasses,}
\DoxyCodeLine{01878\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ use\_class\_zero,}
\DoxyCodeLine{01879\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *klass\_map\ \textcolor{comment}{/*INOUT*/})}
\DoxyCodeLine{01880\ \{}
\DoxyCodeLine{01881\ \ \ \textcolor{keywordflow}{if}\ (!klass\_map)}
\DoxyCodeLine{01882\ \ \ \{}
\DoxyCodeLine{01883\ \ \ \ \ ClassDef\_serialize\ (c,\ hb\_zip\ (glyphs.iter\ (),\ +\ glyphs.iter\ ()}
\DoxyCodeLine{01884\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ hb\_map\ (gid\_klass\_map)));}
\DoxyCodeLine{01885\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01886\ \ \ \}}
\DoxyCodeLine{01887\ }
\DoxyCodeLine{01888\ \ \ \textcolor{comment}{/*\ any\ glyph\ not\ assigned\ a\ class\ value\ falls\ into\ Class\ zero\ (0),}}
\DoxyCodeLine{01889\ \textcolor{comment}{\ \ \ *\ if\ any\ glyph\ assigned\ to\ class\ 0,\ remapping\ must\ start\ with\ 0-\/>0*/}}
\DoxyCodeLine{01890\ \ \ \textcolor{keywordflow}{if}\ (!use\_class\_zero)}
\DoxyCodeLine{01891\ \ \ \ \ klass\_map-\/>set\ (0,\ 0);}
\DoxyCodeLine{01892\ }
\DoxyCodeLine{01893\ \ \ \textcolor{keywordtype}{unsigned}\ idx\ =\ klass\_map-\/>has\ (0)\ ?\ 1\ :\ 0;}
\DoxyCodeLine{01894\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ k:\ klasses.iter\ ())}
\DoxyCodeLine{01895\ \ \ \{}
\DoxyCodeLine{01896\ \ \ \ \ \textcolor{keywordflow}{if}\ (klass\_map-\/>has\ (k))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01897\ \ \ \ \ klass\_map-\/>set\ (k,\ idx);}
\DoxyCodeLine{01898\ \ \ \ \ idx++;}
\DoxyCodeLine{01899\ \ \ \}}
\DoxyCodeLine{01900\ }
\DoxyCodeLine{01901\ \ \ \textcolor{keyword}{auto}\ it\ =}
\DoxyCodeLine{01902\ \ \ +\ glyphs.iter\ ()}
\DoxyCodeLine{01903\ \ \ |\ hb\_map\_retains\_sorting\ ([\&]\ (\textcolor{keyword}{const}\ HBGlyphID16\&\ gid)\ -\/>\ \mbox{\hyperlink{structhb__pair__t}{hb\_pair\_t<hb\_codepoint\_t,\ unsigned>}}}
\DoxyCodeLine{01904\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01905\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ new\_klass\ =\ klass\_map-\/>get\ (gid\_klass\_map[gid]);}
\DoxyCodeLine{01906\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ hb\_pair\ ((hb\_codepoint\_t)gid,\ new\_klass);}
\DoxyCodeLine{01907\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \})}
\DoxyCodeLine{01908\ \ \ ;}
\DoxyCodeLine{01909\ }
\DoxyCodeLine{01910\ \ \ c-\/>propagate\_error\ (glyphs,\ klasses);}
\DoxyCodeLine{01911\ \ \ ClassDef\_serialize\ (c,\ it);}
\DoxyCodeLine{01912\ \}}
\DoxyCodeLine{01913\ }
\DoxyCodeLine{01914\ \textcolor{comment}{/*}}
\DoxyCodeLine{01915\ \textcolor{comment}{\ *\ Class\ Definition\ Table}}
\DoxyCodeLine{01916\ \textcolor{comment}{\ */}}
\DoxyCodeLine{01917\ }
\DoxyCodeLine{01918\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_class_def_format1}{ClassDefFormat1}}}
\DoxyCodeLine{01919\ \{}
\DoxyCodeLine{01920\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_class_def}{ClassDef}};}
\DoxyCodeLine{01921\ }
\DoxyCodeLine{01922\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{01923\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_class\ (hb\_codepoint\_t\ glyph\_id)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01924\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01925\ \ \ \ \ \textcolor{keywordflow}{return}\ classValue[(\textcolor{keywordtype}{unsigned}\ int)\ (glyph\_id\ -\/\ startGlyph)];}
\DoxyCodeLine{01926\ \ \ \}}
\DoxyCodeLine{01927\ }
\DoxyCodeLine{01928\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Iterator,}
\DoxyCodeLine{01929\ \ \ \ \ \ \ \ hb\_requires\ (hb\_is\_iterator\ (Iterator))>}
\DoxyCodeLine{01930\ \ \ \textcolor{keywordtype}{bool}\ serialize\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{01931\ \ \ \ \ \ \ \ \ \ \ Iterator\ it)}
\DoxyCodeLine{01932\ \ \ \{}
\DoxyCodeLine{01933\ \ \ \ \ TRACE\_SERIALIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01934\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>extend\_min\ (\textcolor{keyword}{this})))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01935\ }
\DoxyCodeLine{01936\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!it))}
\DoxyCodeLine{01937\ \ \ \ \ \{}
\DoxyCodeLine{01938\ \ \ \ \ \ \ classFormat\ =\ 1;}
\DoxyCodeLine{01939\ \ \ \ \ \ \ startGlyph\ =\ 0;}
\DoxyCodeLine{01940\ \ \ \ \ \ \ classValue.len\ =\ 0;}
\DoxyCodeLine{01941\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{01942\ \ \ \ \ \}}
\DoxyCodeLine{01943\ }
\DoxyCodeLine{01944\ \ \ \ \ hb\_codepoint\_t\ glyph\_min\ =\ (*it).first;}
\DoxyCodeLine{01945\ \ \ \ \ hb\_codepoint\_t\ glyph\_max\ =\ +\ it}
\DoxyCodeLine{01946\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ hb\_map\ (hb\_first)}
\DoxyCodeLine{01947\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ hb\_reduce\ (hb\_max,\ 0u);}
\DoxyCodeLine{01948\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ glyph\_count\ =\ glyph\_max\ -\/\ glyph\_min\ +\ 1;}
\DoxyCodeLine{01949\ }
\DoxyCodeLine{01950\ \ \ \ \ startGlyph\ =\ glyph\_min;}
\DoxyCodeLine{01951\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!classValue.serialize\ (c,\ glyph\_count)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01952\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__pair__t}{hb\_pair\_t<hb\_codepoint\_t,\ unsigned>}}\ gid\_klass\_pair\ :\ +\ it)}
\DoxyCodeLine{01953\ \ \ \ \ \{}
\DoxyCodeLine{01954\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ idx\ =\ gid\_klass\_pair.first\ -\/\ glyph\_min;}
\DoxyCodeLine{01955\ \ \ \ \ \ \ classValue[idx]\ =\ gid\_klass\_pair.second;}
\DoxyCodeLine{01956\ \ \ \ \ \}}
\DoxyCodeLine{01957\ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{01958\ \ \ \}}
\DoxyCodeLine{01959\ }
\DoxyCodeLine{01960\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c,}
\DoxyCodeLine{01961\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *klass\_map\ =\ \textcolor{keyword}{nullptr}\ \textcolor{comment}{/*OUT*/},}
\DoxyCodeLine{01962\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ keep\_empty\_table\ =\ \textcolor{keyword}{true},}
\DoxyCodeLine{01963\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ use\_class\_zero\ =\ \textcolor{keyword}{true},}
\DoxyCodeLine{01964\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_coverage}{Coverage}}*\ glyph\_filter\ =\ \textcolor{keyword}{nullptr})\textcolor{keyword}{\ const}}
\DoxyCodeLine{01965\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01966\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01967\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \&glyphset\ =\ *c-\/>plan-\/>glyphset\_gsub\ ();}
\DoxyCodeLine{01968\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ \&glyph\_map\ =\ *c-\/>plan-\/>glyph\_map;}
\DoxyCodeLine{01969\ }
\DoxyCodeLine{01970\ \ \ \ \ \mbox{\hyperlink{structhb__vector__t}{hb\_sorted\_vector\_t<HBGlyphID16>}}\ glyphs;}
\DoxyCodeLine{01971\ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ orig\_klasses;}
\DoxyCodeLine{01972\ \ \ \ \ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ gid\_org\_klass\_map;}
\DoxyCodeLine{01973\ }
\DoxyCodeLine{01974\ \ \ \ \ hb\_codepoint\_t\ start\ =\ startGlyph;}
\DoxyCodeLine{01975\ \ \ \ \ hb\_codepoint\_t\ end\ \ \ =\ start\ +\ classValue.len;}
\DoxyCodeLine{01976\ }
\DoxyCodeLine{01977\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ hb\_codepoint\_t\ gid\ :\ +\ hb\_range\ (start,\ end)}
\DoxyCodeLine{01978\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ hb\_filter\ (glyphset))}
\DoxyCodeLine{01979\ \ \ \ \ \{}
\DoxyCodeLine{01980\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (glyph\_filter\ \&\&\ !glyph\_filter-\/>has(gid))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01981\ }
\DoxyCodeLine{01982\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ klass\ =\ classValue[gid\ -\/\ start];}
\DoxyCodeLine{01983\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!klass)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01984\ }
\DoxyCodeLine{01985\ \ \ \ \ \ \ glyphs.push\ (glyph\_map[gid]);}
\DoxyCodeLine{01986\ \ \ \ \ \ \ gid\_org\_klass\_map.set\ (glyph\_map[gid],\ klass);}
\DoxyCodeLine{01987\ \ \ \ \ \ \ orig\_klasses.add\ (klass);}
\DoxyCodeLine{01988\ \ \ \ \ \}}
\DoxyCodeLine{01989\ }
\DoxyCodeLine{01990\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ glyph\_count\ =\ glyph\_filter}
\DoxyCodeLine{01991\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ?\ hb\_len\ (hb\_iter\ (glyphset)\ |\ hb\_filter\ (glyph\_filter))}
\DoxyCodeLine{01992\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ glyphset.get\_population\ ();}
\DoxyCodeLine{01993\ \ \ \ \ use\_class\_zero\ =\ use\_class\_zero\ \&\&\ glyph\_count\ <=\ gid\_org\_klass\_map.get\_population\ ();}
\DoxyCodeLine{01994\ \ \ \ \ ClassDef\_remap\_and\_serialize\ (c-\/>serializer,\ gid\_org\_klass\_map,}
\DoxyCodeLine{01995\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ glyphs,\ orig\_klasses,\ use\_class\_zero,\ klass\_map);}
\DoxyCodeLine{01996\ \ \ \ \ return\_trace\ (keep\_empty\_table\ ||\ (\textcolor{keywordtype}{bool})\ glyphs);}
\DoxyCodeLine{01997\ \ \ \}}
\DoxyCodeLine{01998\ }
\DoxyCodeLine{01999\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02000\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02001\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02002\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this})\ \&\&\ classValue.sanitize\ (c));}
\DoxyCodeLine{02003\ \ \ \}}
\DoxyCodeLine{02004\ }
\DoxyCodeLine{02005\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ set\_t>}
\DoxyCodeLine{02006\ \ \ \textcolor{keywordtype}{bool}\ collect\_coverage\ (set\_t\ *glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02007\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02008\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ start\ =\ 0;}
\DoxyCodeLine{02009\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ classValue.len;}
\DoxyCodeLine{02010\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{02011\ \ \ \ \ \{}
\DoxyCodeLine{02012\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (classValue[i])}
\DoxyCodeLine{02013\ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{02014\ }
\DoxyCodeLine{02015\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (start\ !=\ i)}
\DoxyCodeLine{02016\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!glyphs-\/>add\_range\ (startGlyph\ +\ start,\ startGlyph\ +\ i)))}
\DoxyCodeLine{02017\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02018\ }
\DoxyCodeLine{02019\ \ \ \ \ \ \ start\ =\ i\ +\ 1;}
\DoxyCodeLine{02020\ \ \ \ \ \}}
\DoxyCodeLine{02021\ \ \ \ \ \textcolor{keywordflow}{if}\ (start\ !=\ count)}
\DoxyCodeLine{02022\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!glyphs-\/>add\_range\ (startGlyph\ +\ start,\ startGlyph\ +\ count)))}
\DoxyCodeLine{02023\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02024\ }
\DoxyCodeLine{02025\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02026\ \ \ \}}
\DoxyCodeLine{02027\ }
\DoxyCodeLine{02028\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ set\_t>}
\DoxyCodeLine{02029\ \ \ \textcolor{keywordtype}{bool}\ collect\_class\ (set\_t\ *glyphs,\ \textcolor{keywordtype}{unsigned}\ klass)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02030\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02031\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ classValue.len;}
\DoxyCodeLine{02032\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{02033\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (classValue[i]\ ==\ klass)\ glyphs-\/>add\ (startGlyph\ +\ i);}
\DoxyCodeLine{02034\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02035\ \ \ \}}
\DoxyCodeLine{02036\ }
\DoxyCodeLine{02037\ \ \ \textcolor{keywordtype}{bool}\ intersects\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02038\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02039\ \ \ \ \ \textcolor{comment}{/*\ TODO\ Speed\ up,\ using\ hb\_set\_next()?\ */}}
\DoxyCodeLine{02040\ \ \ \ \ hb\_codepoint\_t\ start\ =\ startGlyph;}
\DoxyCodeLine{02041\ \ \ \ \ hb\_codepoint\_t\ end\ =\ startGlyph\ +\ classValue.len;}
\DoxyCodeLine{02042\ \ \ \ \ \textcolor{keywordflow}{for}\ (hb\_codepoint\_t\ iter\ =\ startGlyph\ -\/\ 1;}
\DoxyCodeLine{02043\ \ \ \ \ \ hb\_set\_next\ (glyphs,\ \&iter)\ \&\&\ iter\ <\ end;)}
\DoxyCodeLine{02044\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (classValue[iter\ -\/\ start])\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02045\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02046\ \ \ \}}
\DoxyCodeLine{02047\ \ \ \textcolor{keywordtype}{bool}\ intersects\_class\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ uint16\_t\ klass)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02048\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02049\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ classValue.len;}
\DoxyCodeLine{02050\ \ \ \ \ \textcolor{keywordflow}{if}\ (klass\ ==\ 0)}
\DoxyCodeLine{02051\ \ \ \ \ \{}
\DoxyCodeLine{02052\ \ \ \ \ \ \ \textcolor{comment}{/*\ Match\ if\ there's\ any\ glyph\ that\ is\ not\ listed!\ */}}
\DoxyCodeLine{02053\ \ \ \ \ \ \ hb\_codepoint\_t\ g\ =\ HB\_SET\_VALUE\_INVALID;}
\DoxyCodeLine{02054\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!hb\_set\_next\ (glyphs,\ \&g))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02055\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (g\ <\ startGlyph)\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02056\ \ \ \ \ \ \ g\ =\ startGlyph\ +\ count\ -\/\ 1;}
\DoxyCodeLine{02057\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (hb\_set\_next\ (glyphs,\ \&g))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02058\ \ \ \ \ \ \ \textcolor{comment}{/*\ Fall\ through.\ */}}
\DoxyCodeLine{02059\ \ \ \ \ \}}
\DoxyCodeLine{02060\ \ \ \ \ \textcolor{comment}{/*\ TODO\ Speed\ up,\ using\ set\ overlap\ first?\ */}}
\DoxyCodeLine{02061\ \ \ \ \ \textcolor{comment}{/*\ TODO(iter)\ Rewrite\ as\ dagger.\ */}}
\DoxyCodeLine{02062\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ k\ \{klass\};}
\DoxyCodeLine{02063\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *arr\ =\ classValue.arrayZ;}
\DoxyCodeLine{02064\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{02065\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (arr[i]\ ==\ k\ \&\&\ glyphs-\/>has\ (startGlyph\ +\ i))}
\DoxyCodeLine{02066\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02067\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02068\ \ \ \}}
\DoxyCodeLine{02069\ }
\DoxyCodeLine{02070\ \ \ \textcolor{keywordtype}{void}\ intersected\_class\_glyphs\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ \textcolor{keywordtype}{unsigned}\ klass,\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *intersect\_glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02071\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02072\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ count\ =\ classValue.len;}
\DoxyCodeLine{02073\ \ \ \ \ \textcolor{keywordflow}{if}\ (klass\ ==\ 0)}
\DoxyCodeLine{02074\ \ \ \ \ \{}
\DoxyCodeLine{02075\ \ \ \ \ \ \ hb\_codepoint\_t\ endGlyph\ =\ startGlyph\ +\ count\ -\/1;}
\DoxyCodeLine{02076\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (hb\_codepoint\_t\ g\ :\ glyphs-\/>iter\ ())}
\DoxyCodeLine{02077\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (g\ <\ startGlyph\ ||\ g\ >\ endGlyph)}
\DoxyCodeLine{02078\ \ \ \ \ \ \ \ \ \ \ intersect\_glyphs-\/>add\ (g);}
\DoxyCodeLine{02079\ }
\DoxyCodeLine{02080\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02081\ \ \ \ \ \}}
\DoxyCodeLine{02082\ }
\DoxyCodeLine{02083\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{02084\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (classValue[i]\ ==\ klass\ \&\&\ glyphs-\/>has\ (startGlyph\ +\ i))}
\DoxyCodeLine{02085\ \ \ \ \ \ \ \ \ intersect\_glyphs-\/>add\ (startGlyph\ +\ i);}
\DoxyCodeLine{02086\ \ \ \}}
\DoxyCodeLine{02087\ }
\DoxyCodeLine{02088\ \ \ \textcolor{keywordtype}{void}\ intersected\_classes\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *intersect\_classes)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02089\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02090\ \ \ \ \ \textcolor{keywordflow}{if}\ (glyphs-\/>is\_empty\ ())\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02091\ \ \ \ \ hb\_codepoint\_t\ end\_glyph\ =\ startGlyph\ +\ classValue.len\ -\/\ 1;}
\DoxyCodeLine{02092\ \ \ \ \ \textcolor{keywordflow}{if}\ (glyphs-\/>get\_min\ ()\ <\ startGlyph\ ||}
\DoxyCodeLine{02093\ \ \ \ \ \ \ \ \ glyphs-\/>get\_max\ ()\ >\ end\_glyph)}
\DoxyCodeLine{02094\ \ \ \ \ \ \ intersect\_classes-\/>add\ (0);}
\DoxyCodeLine{02095\ }
\DoxyCodeLine{02096\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \_\ :\ +\ hb\_enumerate\ (classValue))}
\DoxyCodeLine{02097\ \ \ \ \ \{}
\DoxyCodeLine{02098\ \ \ \ \ \ \ hb\_codepoint\_t\ g\ =\ startGlyph\ +\ \_.first;}
\DoxyCodeLine{02099\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (glyphs-\/>has\ (g))}
\DoxyCodeLine{02100\ \ \ \ \ \ \ \ \ intersect\_classes-\/>add\ (\_.second);}
\DoxyCodeLine{02101\ \ \ \ \ \}}
\DoxyCodeLine{02102\ \ \ \}}
\DoxyCodeLine{02103\ }
\DoxyCodeLine{02104\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{02105\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ classFormat;\ \ \ \ \textcolor{comment}{/*\ Format\ identifier-\/-\/format\ =\ 1\ */}}
\DoxyCodeLine{02106\ \ \ \mbox{\hyperlink{struct_o_t_1_1_h_b_glyph_i_d16}{HBGlyphID16}}\ \ \ \ startGlyph;\ \textcolor{comment}{/*\ First\ GlyphID\ of\ the\ classValueArray\ */}}
\DoxyCodeLine{02107\ \ \ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<HBUINT16>}}}
\DoxyCodeLine{02108\ \ \ \ \ \ \ \ \ classValue;\ \textcolor{comment}{/*\ Array\ of\ Class\ Values-\/-\/one\ per\ GlyphID\ */}}
\DoxyCodeLine{02109\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{02110\ \ \ DEFINE\_SIZE\_ARRAY\ (6,\ classValue);}
\DoxyCodeLine{02111\ \};}
\DoxyCodeLine{02112\ }
\DoxyCodeLine{02113\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_class_def_format2}{ClassDefFormat2}}}
\DoxyCodeLine{02114\ \{}
\DoxyCodeLine{02115\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_class_def}{ClassDef}};}
\DoxyCodeLine{02116\ }
\DoxyCodeLine{02117\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{02118\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_class\ (hb\_codepoint\_t\ glyph\_id)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02119\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02120\ \ \ \ \ \textcolor{keywordflow}{return}\ rangeRecord.bsearch\ (glyph\_id).value;}
\DoxyCodeLine{02121\ \ \ \}}
\DoxyCodeLine{02122\ }
\DoxyCodeLine{02123\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Iterator,}
\DoxyCodeLine{02124\ \ \ \ \ \ \ \ hb\_requires\ (hb\_is\_iterator\ (Iterator))>}
\DoxyCodeLine{02125\ \ \ \textcolor{keywordtype}{bool}\ serialize\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{02126\ \ \ \ \ \ \ \ \ \ \ Iterator\ it)}
\DoxyCodeLine{02127\ \ \ \{}
\DoxyCodeLine{02128\ \ \ \ \ TRACE\_SERIALIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02129\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>extend\_min\ (\textcolor{keyword}{this})))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02130\ }
\DoxyCodeLine{02131\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!it))}
\DoxyCodeLine{02132\ \ \ \ \ \{}
\DoxyCodeLine{02133\ \ \ \ \ \ \ classFormat\ =\ 2;}
\DoxyCodeLine{02134\ \ \ \ \ \ \ rangeRecord.len\ =\ 0;}
\DoxyCodeLine{02135\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{02136\ \ \ \ \ \}}
\DoxyCodeLine{02137\ }
\DoxyCodeLine{02138\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ num\_ranges\ =\ 1;}
\DoxyCodeLine{02139\ \ \ \ \ hb\_codepoint\_t\ prev\_gid\ =\ (*it).first;}
\DoxyCodeLine{02140\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ prev\_klass\ =\ (*it).second;}
\DoxyCodeLine{02141\ }
\DoxyCodeLine{02142\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_range_record}{RangeRecord}}\ range\_rec;}
\DoxyCodeLine{02143\ \ \ \ \ range\_rec.first\ =\ prev\_gid;}
\DoxyCodeLine{02144\ \ \ \ \ range\_rec.last\ =\ prev\_gid;}
\DoxyCodeLine{02145\ \ \ \ \ range\_rec.value\ =\ prev\_klass;}
\DoxyCodeLine{02146\ }
\DoxyCodeLine{02147\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_range_record}{RangeRecord}}\ *record\ =\ c-\/>copy\ (range\_rec);}
\DoxyCodeLine{02148\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!record))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02149\ }
\DoxyCodeLine{02150\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ gid\_klass\_pair\ :\ +\ (++it))}
\DoxyCodeLine{02151\ \ \ \ \ \{}
\DoxyCodeLine{02152\ \ \ \ \ \ \ hb\_codepoint\_t\ cur\_gid\ =\ gid\_klass\_pair.first;}
\DoxyCodeLine{02153\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ cur\_klass\ =\ gid\_klass\_pair.second;}
\DoxyCodeLine{02154\ }
\DoxyCodeLine{02155\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (cur\_gid\ !=\ prev\_gid\ +\ 1\ ||}
\DoxyCodeLine{02156\ \ \ \ \ \ \ cur\_klass\ !=\ prev\_klass)}
\DoxyCodeLine{02157\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02158\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!record))\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02159\ \ \ \ \ record-\/>last\ =\ prev\_gid;}
\DoxyCodeLine{02160\ \ \ \ \ num\_ranges++;}
\DoxyCodeLine{02161\ }
\DoxyCodeLine{02162\ \ \ \ \ range\_rec.first\ =\ cur\_gid;}
\DoxyCodeLine{02163\ \ \ \ \ range\_rec.last\ =\ cur\_gid;}
\DoxyCodeLine{02164\ \ \ \ \ range\_rec.value\ =\ cur\_klass;}
\DoxyCodeLine{02165\ }
\DoxyCodeLine{02166\ \ \ \ \ record\ =\ c-\/>copy\ (range\_rec);}
\DoxyCodeLine{02167\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02168\ }
\DoxyCodeLine{02169\ \ \ \ \ \ \ prev\_klass\ =\ cur\_klass;}
\DoxyCodeLine{02170\ \ \ \ \ \ \ prev\_gid\ =\ cur\_gid;}
\DoxyCodeLine{02171\ \ \ \ \ \}}
\DoxyCodeLine{02172\ }
\DoxyCodeLine{02173\ \ \ \ \ \textcolor{keywordflow}{if}\ (likely\ (record))\ record-\/>last\ =\ prev\_gid;}
\DoxyCodeLine{02174\ \ \ \ \ rangeRecord.len\ =\ num\_ranges;}
\DoxyCodeLine{02175\ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{02176\ \ \ \}}
\DoxyCodeLine{02177\ }
\DoxyCodeLine{02178\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c,}
\DoxyCodeLine{02179\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *klass\_map\ =\ \textcolor{keyword}{nullptr}\ \textcolor{comment}{/*OUT*/},}
\DoxyCodeLine{02180\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ keep\_empty\_table\ =\ \textcolor{keyword}{true},}
\DoxyCodeLine{02181\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ use\_class\_zero\ =\ \textcolor{keyword}{true},}
\DoxyCodeLine{02182\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_coverage}{Coverage}}*\ glyph\_filter\ =\ \textcolor{keyword}{nullptr})\textcolor{keyword}{\ const}}
\DoxyCodeLine{02183\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02184\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02185\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \&glyphset\ =\ *c-\/>plan-\/>glyphset\_gsub\ ();}
\DoxyCodeLine{02186\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ \&glyph\_map\ =\ *c-\/>plan-\/>glyph\_map;}
\DoxyCodeLine{02187\ }
\DoxyCodeLine{02188\ \ \ \ \ \mbox{\hyperlink{structhb__vector__t}{hb\_sorted\_vector\_t<HBGlyphID16>}}\ glyphs;}
\DoxyCodeLine{02189\ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ orig\_klasses;}
\DoxyCodeLine{02190\ \ \ \ \ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ gid\_org\_klass\_map;}
\DoxyCodeLine{02191\ }
\DoxyCodeLine{02192\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ count\ =\ rangeRecord.len;}
\DoxyCodeLine{02193\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{02194\ \ \ \ \ \{}
\DoxyCodeLine{02195\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ klass\ =\ rangeRecord[i].value;}
\DoxyCodeLine{02196\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!klass)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{02197\ \ \ \ \ \ \ hb\_codepoint\_t\ start\ =\ rangeRecord[i].first;}
\DoxyCodeLine{02198\ \ \ \ \ \ \ hb\_codepoint\_t\ end\ \ \ =\ rangeRecord[i].last\ +\ 1;}
\DoxyCodeLine{02199\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (hb\_codepoint\_t\ g\ =\ start;\ g\ <\ end;\ g++)}
\DoxyCodeLine{02200\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02201\ \ \ \ \ \textcolor{keywordflow}{if}\ (!glyphset.has\ (g))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{02202\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (glyph\_filter\ \&\&\ !glyph\_filter-\/>has\ (g))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{02203\ \ \ \ \ glyphs.push\ (glyph\_map[g]);}
\DoxyCodeLine{02204\ \ \ \ \ gid\_org\_klass\_map.set\ (glyph\_map[g],\ klass);}
\DoxyCodeLine{02205\ \ \ \ \ orig\_klasses.add\ (klass);}
\DoxyCodeLine{02206\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02207\ \ \ \ \ \}}
\DoxyCodeLine{02208\ }
\DoxyCodeLine{02209\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ glyph\_count\ =\ glyph\_filter}
\DoxyCodeLine{02210\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ?\ hb\_len\ (hb\_iter\ (glyphset)\ |\ hb\_filter\ (glyph\_filter))}
\DoxyCodeLine{02211\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ glyphset.get\_population\ ();}
\DoxyCodeLine{02212\ \ \ \ \ use\_class\_zero\ =\ use\_class\_zero\ \&\&\ glyph\_count\ <=\ gid\_org\_klass\_map.get\_population\ ();}
\DoxyCodeLine{02213\ \ \ \ \ ClassDef\_remap\_and\_serialize\ (c-\/>serializer,\ gid\_org\_klass\_map,}
\DoxyCodeLine{02214\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ glyphs,\ orig\_klasses,\ use\_class\_zero,\ klass\_map);}
\DoxyCodeLine{02215\ \ \ \ \ return\_trace\ (keep\_empty\_table\ ||\ (\textcolor{keywordtype}{bool})\ glyphs);}
\DoxyCodeLine{02216\ \ \ \}}
\DoxyCodeLine{02217\ }
\DoxyCodeLine{02218\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02219\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02220\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02221\ \ \ \ \ return\_trace\ (rangeRecord.sanitize\ (c));}
\DoxyCodeLine{02222\ \ \ \}}
\DoxyCodeLine{02223\ }
\DoxyCodeLine{02224\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ set\_t>}
\DoxyCodeLine{02225\ \ \ \textcolor{keywordtype}{bool}\ collect\_coverage\ (set\_t\ *glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02226\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02227\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ rangeRecord.len;}
\DoxyCodeLine{02228\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{02229\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (rangeRecord[i].\mbox{\hyperlink{classvalue}{value}})}
\DoxyCodeLine{02230\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!rangeRecord[i].collect\_coverage\ (glyphs)))}
\DoxyCodeLine{02231\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02232\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02233\ \ \ \}}
\DoxyCodeLine{02234\ }
\DoxyCodeLine{02235\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ set\_t>}
\DoxyCodeLine{02236\ \ \ \textcolor{keywordtype}{bool}\ collect\_class\ (set\_t\ *glyphs,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ klass)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02237\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02238\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ rangeRecord.len;}
\DoxyCodeLine{02239\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{02240\ \ \ \ \ \{}
\DoxyCodeLine{02241\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (rangeRecord[i].\mbox{\hyperlink{classvalue}{value}}\ ==\ klass)}
\DoxyCodeLine{02242\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!rangeRecord[i].collect\_coverage\ (glyphs)))}
\DoxyCodeLine{02243\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02244\ \ \ \ \ \}}
\DoxyCodeLine{02245\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02246\ \ \ \}}
\DoxyCodeLine{02247\ }
\DoxyCodeLine{02248\ \ \ \textcolor{keywordtype}{bool}\ intersects\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02249\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02250\ \ \ \ \ \textcolor{comment}{/*\ TODO\ Speed\ up,\ using\ hb\_set\_next()\ and\ bsearch()?\ */}}
\DoxyCodeLine{02251\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ rangeRecord.len;}
\DoxyCodeLine{02252\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{02253\ \ \ \ \ \{}
\DoxyCodeLine{02254\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ range\ =\ rangeRecord[i];}
\DoxyCodeLine{02255\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (range.intersects\ (glyphs)\ \&\&\ range.value)}
\DoxyCodeLine{02256\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02257\ \ \ \ \ \}}
\DoxyCodeLine{02258\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02259\ \ \ \}}
\DoxyCodeLine{02260\ \ \ \textcolor{keywordtype}{bool}\ intersects\_class\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ uint16\_t\ klass)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02261\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02262\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ rangeRecord.len;}
\DoxyCodeLine{02263\ \ \ \ \ \textcolor{keywordflow}{if}\ (klass\ ==\ 0)}
\DoxyCodeLine{02264\ \ \ \ \ \{}
\DoxyCodeLine{02265\ \ \ \ \ \ \ \textcolor{comment}{/*\ Match\ if\ there's\ any\ glyph\ that\ is\ not\ listed!\ */}}
\DoxyCodeLine{02266\ \ \ \ \ \ \ hb\_codepoint\_t\ g\ =\ HB\_SET\_VALUE\_INVALID;}
\DoxyCodeLine{02267\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{02268\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02269\ \ \ \ \ \textcolor{keywordflow}{if}\ (!hb\_set\_next\ (glyphs,\ \&g))}
\DoxyCodeLine{02270\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02271\ \ \ \ \ \textcolor{keywordflow}{if}\ (g\ <\ rangeRecord[i].first)}
\DoxyCodeLine{02272\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02273\ \ \ \ \ g\ =\ rangeRecord[i].last;}
\DoxyCodeLine{02274\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02275\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (g\ !=\ HB\_SET\_VALUE\_INVALID\ \&\&\ hb\_set\_next\ (glyphs,\ \&g))}
\DoxyCodeLine{02276\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02277\ \ \ \ \ \ \ \textcolor{comment}{/*\ Fall\ through.\ */}}
\DoxyCodeLine{02278\ \ \ \ \ \}}
\DoxyCodeLine{02279\ \ \ \ \ \textcolor{comment}{/*\ TODO\ Speed\ up,\ using\ set\ overlap\ first?\ */}}
\DoxyCodeLine{02280\ \ \ \ \ \textcolor{comment}{/*\ TODO(iter)\ Rewrite\ as\ dagger.\ */}}
\DoxyCodeLine{02281\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ k\ \{klass\};}
\DoxyCodeLine{02282\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_range_record}{RangeRecord}}\ *arr\ =\ rangeRecord.arrayZ;}
\DoxyCodeLine{02283\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{02284\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (arr[i].\mbox{\hyperlink{classvalue}{value}}\ ==\ k\ \&\&\ arr[i].intersects\ (glyphs))}
\DoxyCodeLine{02285\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02286\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02287\ \ \ \}}
\DoxyCodeLine{02288\ }
\DoxyCodeLine{02289\ \ \ \textcolor{keywordtype}{void}\ intersected\_class\_glyphs\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ \textcolor{keywordtype}{unsigned}\ klass,\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *intersect\_glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02290\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02291\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ count\ =\ rangeRecord.len;}
\DoxyCodeLine{02292\ \ \ \ \ \textcolor{keywordflow}{if}\ (klass\ ==\ 0)}
\DoxyCodeLine{02293\ \ \ \ \ \{}
\DoxyCodeLine{02294\ \ \ \ \ \ \ hb\_codepoint\_t\ g\ =\ HB\_SET\_VALUE\_INVALID;}
\DoxyCodeLine{02295\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{02296\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02297\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!hb\_set\_next\ (glyphs,\ \&g))}
\DoxyCodeLine{02298\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02299\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (g\ !=\ HB\_SET\_VALUE\_INVALID\ \&\&\ g\ <\ rangeRecord[i].first)}
\DoxyCodeLine{02300\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02301\ \ \ \ \ \ \ \ \ \ \ intersect\_glyphs-\/>add\ (g);}
\DoxyCodeLine{02302\ \ \ \ \ \ \ \ \ \ \ hb\_set\_next\ (glyphs,\ \&g);}
\DoxyCodeLine{02303\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02304\ \ \ \ \ \ \ \ \ g\ =\ rangeRecord[i].last;}
\DoxyCodeLine{02305\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02306\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (g\ !=\ HB\_SET\_VALUE\_INVALID\ \&\&\ hb\_set\_next\ (glyphs,\ \&g))}
\DoxyCodeLine{02307\ \ \ \ \ \ \ \ \ intersect\_glyphs-\/>add\ (g);}
\DoxyCodeLine{02308\ }
\DoxyCodeLine{02309\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02310\ \ \ \ \ \}}
\DoxyCodeLine{02311\ }
\DoxyCodeLine{02312\ \ \ \ \ hb\_codepoint\_t\ g\ =\ HB\_SET\_VALUE\_INVALID;}
\DoxyCodeLine{02313\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{02314\ \ \ \ \ \{}
\DoxyCodeLine{02315\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (rangeRecord[i].\mbox{\hyperlink{classvalue}{value}}\ !=\ klass)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{02316\ }
\DoxyCodeLine{02317\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (g\ !=\ HB\_SET\_VALUE\_INVALID)}
\DoxyCodeLine{02318\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02319\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (g\ >=\ rangeRecord[i].first\ \&\&}
\DoxyCodeLine{02320\ \ \ \ \ \ \ \ \ \ \ \ \ g\ <=\ rangeRecord[i].last)}
\DoxyCodeLine{02321\ \ \ \ \ \ \ \ \ \ \ intersect\_glyphs-\/>add\ (g);}
\DoxyCodeLine{02322\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (g\ >\ rangeRecord[i].last)}
\DoxyCodeLine{02323\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{02324\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02325\ }
\DoxyCodeLine{02326\ \ \ \ \ \ \ g\ =\ rangeRecord[i].first\ -\/\ 1;}
\DoxyCodeLine{02327\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (hb\_set\_next\ (glyphs,\ \&g))}
\DoxyCodeLine{02328\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02329\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (g\ >=\ rangeRecord[i].first\ \&\&\ g\ <=\ rangeRecord[i].last)}
\DoxyCodeLine{02330\ \ \ \ \ \ \ \ \ \ \ intersect\_glyphs-\/>add\ (g);}
\DoxyCodeLine{02331\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (g\ >\ rangeRecord[i].last)}
\DoxyCodeLine{02332\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02333\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02334\ \ \ \ \ \}}
\DoxyCodeLine{02335\ \ \ \}}
\DoxyCodeLine{02336\ }
\DoxyCodeLine{02337\ \ \ \textcolor{keywordtype}{void}\ intersected\_classes\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *intersect\_classes)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02338\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02339\ \ \ \ \ \textcolor{keywordflow}{if}\ (glyphs-\/>is\_empty\ ())\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02340\ }
\DoxyCodeLine{02341\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ count\ =\ rangeRecord.len;}
\DoxyCodeLine{02342\ \ \ \ \ hb\_codepoint\_t\ g\ =\ HB\_SET\_VALUE\_INVALID;}
\DoxyCodeLine{02343\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{02344\ \ \ \ \ \{}
\DoxyCodeLine{02345\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!hb\_set\_next\ (glyphs,\ \&g))}
\DoxyCodeLine{02346\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02347\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (g\ <\ rangeRecord[i].first)}
\DoxyCodeLine{02348\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02349\ \ \ \ \ \ \ \ \ intersect\_classes-\/>add\ (0);}
\DoxyCodeLine{02350\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02351\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02352\ \ \ \ \ \ \ g\ =\ rangeRecord[i].last;}
\DoxyCodeLine{02353\ \ \ \ \ \}}
\DoxyCodeLine{02354\ \ \ \ \ \textcolor{keywordflow}{if}\ (g\ !=\ HB\_SET\_VALUE\_INVALID\ \&\&\ hb\_set\_next\ (glyphs,\ \&g))}
\DoxyCodeLine{02355\ \ \ \ \ \ \ intersect\_classes-\/>add\ (0);}
\DoxyCodeLine{02356\ }
\DoxyCodeLine{02357\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_range_record}{RangeRecord}}\&\ record\ :\ rangeRecord.iter\ ())}
\DoxyCodeLine{02358\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (record.intersects\ (glyphs))}
\DoxyCodeLine{02359\ \ \ \ \ \ \ \ \ intersect\_classes-\/>add\ (record.value);}
\DoxyCodeLine{02360\ \ \ \}}
\DoxyCodeLine{02361\ }
\DoxyCodeLine{02362\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{02363\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ classFormat;\ \ \ \ \textcolor{comment}{/*\ Format\ identifier-\/-\/format\ =\ 2\ */}}
\DoxyCodeLine{02364\ \ \ \mbox{\hyperlink{struct_o_t_1_1_sorted_array_of}{SortedArray16Of<RangeRecord>}}}
\DoxyCodeLine{02365\ \ \ \ \ \ \ \ \ rangeRecord;\ \ \ \ \textcolor{comment}{/*\ Array\ of\ glyph\ ranges-\/-\/ordered\ by}}
\DoxyCodeLine{02366\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ Start\ GlyphID\ */}}
\DoxyCodeLine{02367\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{02368\ \ \ DEFINE\_SIZE\_ARRAY\ (4,\ rangeRecord);}
\DoxyCodeLine{02369\ \};}
\DoxyCodeLine{02370\ }
\DoxyCodeLine{02371\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_class_def}{ClassDef}}}
\DoxyCodeLine{02372\ \{}
\DoxyCodeLine{02373\ \ \ \textcolor{comment}{/*\ Has\ interface.\ */}}
\DoxyCodeLine{02374\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ SENTINEL\ =\ 0;}
\DoxyCodeLine{02375\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ value\_t;}
\DoxyCodeLine{02376\ \ \ value\_t\ operator\ []\ (hb\_codepoint\_t\ k)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ get\ (k);\ \}}
\DoxyCodeLine{02377\ \ \ \textcolor{keywordtype}{bool}\ has\ (hb\_codepoint\_t\ k)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ (*\textcolor{keyword}{this})[k]\ !=\ SENTINEL;\ \}}
\DoxyCodeLine{02378\ \ \ \textcolor{comment}{/*\ Projection.\ */}}
\DoxyCodeLine{02379\ \ \ hb\_codepoint\_t\ operator\ ()\ (hb\_codepoint\_t\ k)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ get\ (k);\ \}}
\DoxyCodeLine{02380\ }
\DoxyCodeLine{02381\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\ (hb\_codepoint\_t\ k)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ get\_class\ (k);\ \}}
\DoxyCodeLine{02382\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_class\ (hb\_codepoint\_t\ glyph\_id)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02383\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02384\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)\ \{}
\DoxyCodeLine{02385\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \textcolor{keywordflow}{return}\ u.format1.get\_class\ (glyph\_id);}
\DoxyCodeLine{02386\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ \textcolor{keywordflow}{return}\ u.format2.get\_class\ (glyph\_id);}
\DoxyCodeLine{02387\ \ \ \ \ \textcolor{keywordflow}{default}:\textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{02388\ \ \ \ \ \}}
\DoxyCodeLine{02389\ \ \ \}}
\DoxyCodeLine{02390\ }
\DoxyCodeLine{02391\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Iterator,}
\DoxyCodeLine{02392\ \ \ \ \ \ \ \ hb\_requires\ (hb\_is\_iterator\ (Iterator))>}
\DoxyCodeLine{02393\ \ \ \textcolor{keywordtype}{bool}\ serialize\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,\ Iterator\ it\_with\_class\_zero)}
\DoxyCodeLine{02394\ \ \ \{}
\DoxyCodeLine{02395\ \ \ \ \ TRACE\_SERIALIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02396\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>extend\_min\ (\textcolor{keyword}{this})))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02397\ }
\DoxyCodeLine{02398\ \ \ \ \ \textcolor{keyword}{auto}\ it\ =\ +\ it\_with\_class\_zero\ |\ hb\_filter\ (hb\_second);}
\DoxyCodeLine{02399\ }
\DoxyCodeLine{02400\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ format\ =\ 2;}
\DoxyCodeLine{02401\ \ \ \ \ \textcolor{keywordflow}{if}\ (likely\ (it))}
\DoxyCodeLine{02402\ \ \ \ \ \{}
\DoxyCodeLine{02403\ \ \ \ \ \ \ hb\_codepoint\_t\ glyph\_min\ =\ (*it).first;}
\DoxyCodeLine{02404\ \ \ \ \ \ \ hb\_codepoint\_t\ glyph\_max\ =\ glyph\_min;}
\DoxyCodeLine{02405\ }
\DoxyCodeLine{02406\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ num\_glyphs\ =\ 0;}
\DoxyCodeLine{02407\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ num\_ranges\ =\ 1;}
\DoxyCodeLine{02408\ \ \ \ \ \ \ hb\_codepoint\_t\ prev\_gid\ =\ glyph\_min;}
\DoxyCodeLine{02409\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ prev\_klass\ =\ (*it).second;}
\DoxyCodeLine{02410\ }
\DoxyCodeLine{02411\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ gid\_klass\_pair\ :\ it)}
\DoxyCodeLine{02412\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02413\ \ \ \ \ hb\_codepoint\_t\ cur\_gid\ =\ gid\_klass\_pair.first;}
\DoxyCodeLine{02414\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ cur\_klass\ =\ gid\_klass\_pair.second;}
\DoxyCodeLine{02415\ \ \ \ \ \ \ \ \ num\_glyphs++;}
\DoxyCodeLine{02416\ \ \ \ \ \textcolor{keywordflow}{if}\ (cur\_gid\ ==\ glyph\_min)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{02417\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (cur\_gid\ >\ glyph\_max)\ glyph\_max\ =\ cur\_gid;}
\DoxyCodeLine{02418\ \ \ \ \ \textcolor{keywordflow}{if}\ (cur\_gid\ !=\ prev\_gid\ +\ 1\ ||}
\DoxyCodeLine{02419\ \ \ \ \ \ \ \ \ cur\_klass\ !=\ prev\_klass)}
\DoxyCodeLine{02420\ \ \ \ \ \ \ num\_ranges++;}
\DoxyCodeLine{02421\ }
\DoxyCodeLine{02422\ \ \ \ \ prev\_gid\ =\ cur\_gid;}
\DoxyCodeLine{02423\ \ \ \ \ prev\_klass\ =\ cur\_klass;}
\DoxyCodeLine{02424\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02425\ }
\DoxyCodeLine{02426\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_glyphs\ \&\&\ 1\ +\ (glyph\_max\ -\/\ glyph\_min\ +\ 1)\ <=\ num\_ranges\ *\ 3)}
\DoxyCodeLine{02427\ \ \ \ \ format\ =\ 1;}
\DoxyCodeLine{02428\ \ \ \ \ \}}
\DoxyCodeLine{02429\ \ \ \ \ u.format\ =\ format;}
\DoxyCodeLine{02430\ }
\DoxyCodeLine{02431\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)}
\DoxyCodeLine{02432\ \ \ \ \ \{}
\DoxyCodeLine{02433\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ return\_trace\ (u.format1.serialize\ (c,\ it));}
\DoxyCodeLine{02434\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ return\_trace\ (u.format2.serialize\ (c,\ it));}
\DoxyCodeLine{02435\ \ \ \ \ \textcolor{keywordflow}{default}:return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02436\ \ \ \ \ \}}
\DoxyCodeLine{02437\ \ \ \}}
\DoxyCodeLine{02438\ }
\DoxyCodeLine{02439\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c,}
\DoxyCodeLine{02440\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *klass\_map\ =\ \textcolor{keyword}{nullptr}\ \textcolor{comment}{/*OUT*/},}
\DoxyCodeLine{02441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ keep\_empty\_table\ =\ \textcolor{keyword}{true},}
\DoxyCodeLine{02442\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ use\_class\_zero\ =\ \textcolor{keyword}{true},}
\DoxyCodeLine{02443\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_coverage}{Coverage}}*\ glyph\_filter\ =\ \textcolor{keyword}{nullptr})\textcolor{keyword}{\ const}}
\DoxyCodeLine{02444\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02445\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02446\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)\ \{}
\DoxyCodeLine{02447\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ return\_trace\ (u.format1.subset\ (c,\ klass\_map,\ keep\_empty\_table,\ use\_class\_zero,\ glyph\_filter));}
\DoxyCodeLine{02448\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ return\_trace\ (u.format2.subset\ (c,\ klass\_map,\ keep\_empty\_table,\ use\_class\_zero,\ glyph\_filter));}
\DoxyCodeLine{02449\ \ \ \ \ \textcolor{keywordflow}{default}:return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02450\ \ \ \ \ \}}
\DoxyCodeLine{02451\ \ \ \}}
\DoxyCodeLine{02452\ }
\DoxyCodeLine{02453\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02454\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02455\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02456\ \ \ \ \ \textcolor{keywordflow}{if}\ (!u.format.sanitize\ (c))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02457\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)\ \{}
\DoxyCodeLine{02458\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ return\_trace\ (u.format1.sanitize\ (c));}
\DoxyCodeLine{02459\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ return\_trace\ (u.format2.sanitize\ (c));}
\DoxyCodeLine{02460\ \ \ \ \ \textcolor{keywordflow}{default}:return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{02461\ \ \ \ \ \}}
\DoxyCodeLine{02462\ \ \ \}}
\DoxyCodeLine{02463\ }
\DoxyCodeLine{02464\ \ \ \textcolor{comment}{/*\ Might\ return\ false\ if\ array\ looks\ unsorted.}}
\DoxyCodeLine{02465\ \textcolor{comment}{\ \ \ *\ Used\ for\ faster\ rejection\ of\ corrupt\ data.\ */}}
\DoxyCodeLine{02466\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ set\_t>}
\DoxyCodeLine{02467\ \ \ \textcolor{keywordtype}{bool}\ collect\_coverage\ (set\_t\ *glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02468\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02469\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)\ \{}
\DoxyCodeLine{02470\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \textcolor{keywordflow}{return}\ u.format1.collect\_coverage\ (glyphs);}
\DoxyCodeLine{02471\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ \textcolor{keywordflow}{return}\ u.format2.collect\_coverage\ (glyphs);}
\DoxyCodeLine{02472\ \ \ \ \ \textcolor{keywordflow}{default}:\textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02473\ \ \ \ \ \}}
\DoxyCodeLine{02474\ \ \ \}}
\DoxyCodeLine{02475\ }
\DoxyCodeLine{02476\ \ \ \textcolor{comment}{/*\ Might\ return\ false\ if\ array\ looks\ unsorted.}}
\DoxyCodeLine{02477\ \textcolor{comment}{\ \ \ *\ Used\ for\ faster\ rejection\ of\ corrupt\ data.\ */}}
\DoxyCodeLine{02478\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ set\_t>}
\DoxyCodeLine{02479\ \ \ \textcolor{keywordtype}{bool}\ collect\_class\ (set\_t\ *glyphs,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ klass)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02480\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02481\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)\ \{}
\DoxyCodeLine{02482\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \textcolor{keywordflow}{return}\ u.format1.collect\_class\ (glyphs,\ klass);}
\DoxyCodeLine{02483\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ \textcolor{keywordflow}{return}\ u.format2.collect\_class\ (glyphs,\ klass);}
\DoxyCodeLine{02484\ \ \ \ \ \textcolor{keywordflow}{default}:\textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02485\ \ \ \ \ \}}
\DoxyCodeLine{02486\ \ \ \}}
\DoxyCodeLine{02487\ }
\DoxyCodeLine{02488\ \ \ \textcolor{keywordtype}{bool}\ intersects\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02489\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02490\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)\ \{}
\DoxyCodeLine{02491\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \textcolor{keywordflow}{return}\ u.format1.intersects\ (glyphs);}
\DoxyCodeLine{02492\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ \textcolor{keywordflow}{return}\ u.format2.intersects\ (glyphs);}
\DoxyCodeLine{02493\ \ \ \ \ \textcolor{keywordflow}{default}:\textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02494\ \ \ \ \ \}}
\DoxyCodeLine{02495\ \ \ \}}
\DoxyCodeLine{02496\ \ \ \textcolor{keywordtype}{bool}\ intersects\_class\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ klass)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02497\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02498\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)\ \{}
\DoxyCodeLine{02499\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \textcolor{keywordflow}{return}\ u.format1.intersects\_class\ (glyphs,\ klass);}
\DoxyCodeLine{02500\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ \textcolor{keywordflow}{return}\ u.format2.intersects\_class\ (glyphs,\ klass);}
\DoxyCodeLine{02501\ \ \ \ \ \textcolor{keywordflow}{default}:\textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02502\ \ \ \ \ \}}
\DoxyCodeLine{02503\ \ \ \}}
\DoxyCodeLine{02504\ }
\DoxyCodeLine{02505\ \ \ \textcolor{keywordtype}{void}\ intersected\_class\_glyphs\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ \textcolor{keywordtype}{unsigned}\ klass,\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *intersect\_glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02506\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02507\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)\ \{}
\DoxyCodeLine{02508\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \textcolor{keywordflow}{return}\ u.format1.intersected\_class\_glyphs\ (glyphs,\ klass,\ intersect\_glyphs);}
\DoxyCodeLine{02509\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ \textcolor{keywordflow}{return}\ u.format2.intersected\_class\_glyphs\ (glyphs,\ klass,\ intersect\_glyphs);}
\DoxyCodeLine{02510\ \ \ \ \ \textcolor{keywordflow}{default}:\textcolor{keywordflow}{return};}
\DoxyCodeLine{02511\ \ \ \ \ \}}
\DoxyCodeLine{02512\ \ \ \}}
\DoxyCodeLine{02513\ }
\DoxyCodeLine{02514\ \ \ \textcolor{keywordtype}{void}\ intersected\_classes\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *intersect\_classes)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02515\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02516\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)\ \{}
\DoxyCodeLine{02517\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \textcolor{keywordflow}{return}\ u.format1.intersected\_classes\ (glyphs,\ intersect\_classes);}
\DoxyCodeLine{02518\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ \textcolor{keywordflow}{return}\ u.format2.intersected\_classes\ (glyphs,\ intersect\_classes);}
\DoxyCodeLine{02519\ \ \ \ \ \textcolor{keywordflow}{default}:\textcolor{keywordflow}{return};}
\DoxyCodeLine{02520\ \ \ \ \ \}}
\DoxyCodeLine{02521\ \ \ \}}
\DoxyCodeLine{02522\ }
\DoxyCodeLine{02523\ }
\DoxyCodeLine{02524\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{02525\ \ \ \textcolor{keyword}{union\ }\{}
\DoxyCodeLine{02526\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ \ \ \ \ format;\ \ \ \ \ \textcolor{comment}{/*\ Format\ identifier\ */}}
\DoxyCodeLine{02527\ \ \ \mbox{\hyperlink{struct_o_t_1_1_class_def_format1}{ClassDefFormat1}}\ \ \ \ format1;}
\DoxyCodeLine{02528\ \ \ \mbox{\hyperlink{struct_o_t_1_1_class_def_format2}{ClassDefFormat2}}\ \ \ \ format2;}
\DoxyCodeLine{02529\ \ \ \}\ u;}
\DoxyCodeLine{02530\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{02531\ \ \ DEFINE\_SIZE\_UNION\ (2,\ format);}
\DoxyCodeLine{02532\ \};}
\DoxyCodeLine{02533\ }
\DoxyCodeLine{02534\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Iterator>}
\DoxyCodeLine{02535\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ ClassDef\_serialize\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{02536\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Iterator\ it)}
\DoxyCodeLine{02537\ \{\ c-\/>start\_embed<\mbox{\hyperlink{struct_o_t_1_1_class_def}{ClassDef}}>\ ()-\/>serialize\ (c,\ it);\ \}}
\DoxyCodeLine{02538\ }
\DoxyCodeLine{02539\ }
\DoxyCodeLine{02540\ \textcolor{comment}{/*}}
\DoxyCodeLine{02541\ \textcolor{comment}{\ *\ Item\ Variation\ Store}}
\DoxyCodeLine{02542\ \textcolor{comment}{\ */}}
\DoxyCodeLine{02543\ }
\DoxyCodeLine{02544\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_var_region_axis}{VarRegionAxis}}}
\DoxyCodeLine{02545\ \{}
\DoxyCodeLine{02546\ \ \ \textcolor{keywordtype}{float}\ evaluate\ (\textcolor{keywordtype}{int}\ coord)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02547\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02548\ \ \ \ \ \textcolor{keywordtype}{int}\ start\ =\ startCoord,\ peak\ =\ peakCoord,\ end\ =\ endCoord;}
\DoxyCodeLine{02549\ }
\DoxyCodeLine{02550\ \ \ \ \ \textcolor{comment}{/*\ TODO\ Move\ these\ to\ sanitize().\ */}}
\DoxyCodeLine{02551\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (start\ >\ peak\ ||\ peak\ >\ end))}
\DoxyCodeLine{02552\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1.;}
\DoxyCodeLine{02553\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (start\ <\ 0\ \&\&\ end\ >\ 0\ \&\&\ peak\ !=\ 0))}
\DoxyCodeLine{02554\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1.;}
\DoxyCodeLine{02555\ }
\DoxyCodeLine{02556\ \ \ \ \ \textcolor{keywordflow}{if}\ (peak\ ==\ 0\ ||\ coord\ ==\ peak)}
\DoxyCodeLine{02557\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1.;}
\DoxyCodeLine{02558\ }
\DoxyCodeLine{02559\ \ \ \ \ \textcolor{keywordflow}{if}\ (coord\ <=\ start\ ||\ end\ <=\ coord)}
\DoxyCodeLine{02560\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0.;}
\DoxyCodeLine{02561\ }
\DoxyCodeLine{02562\ \ \ \ \ \textcolor{comment}{/*\ Interpolate\ */}}
\DoxyCodeLine{02563\ \ \ \ \ \textcolor{keywordflow}{if}\ (coord\ <\ peak)}
\DoxyCodeLine{02564\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ float\ (coord\ -\/\ start)\ /\ (peak\ -\/\ start);}
\DoxyCodeLine{02565\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02566\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ float\ (end\ -\/\ coord)\ /\ (end\ -\/\ peak);}
\DoxyCodeLine{02567\ \ \ \}}
\DoxyCodeLine{02568\ }
\DoxyCodeLine{02569\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02570\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02571\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02572\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this}));}
\DoxyCodeLine{02573\ \ \ \ \ \textcolor{comment}{/*\ TODO\ Handle\ invalid\ start/peak/end\ configs,\ so\ we\ don't}}
\DoxyCodeLine{02574\ \textcolor{comment}{\ \ \ \ \ *\ have\ to\ do\ that\ at\ runtime.\ */}}
\DoxyCodeLine{02575\ \ \ \}}
\DoxyCodeLine{02576\ }
\DoxyCodeLine{02577\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{02578\ \ \ \mbox{\hyperlink{struct_o_t_1_1_f2_d_o_t14}{F2DOT14}}\ \ \ \ startCoord;}
\DoxyCodeLine{02579\ \ \ \mbox{\hyperlink{struct_o_t_1_1_f2_d_o_t14}{F2DOT14}}\ \ \ \ peakCoord;}
\DoxyCodeLine{02580\ \ \ \mbox{\hyperlink{struct_o_t_1_1_f2_d_o_t14}{F2DOT14}}\ \ \ \ endCoord;}
\DoxyCodeLine{02581\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{02582\ \ \ DEFINE\_SIZE\_STATIC\ (6);}
\DoxyCodeLine{02583\ \};}
\DoxyCodeLine{02584\ }
\DoxyCodeLine{02585\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_var_region_list}{VarRegionList}}}
\DoxyCodeLine{02586\ \{}
\DoxyCodeLine{02587\ \ \ \textcolor{keywordtype}{float}\ evaluate\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ region\_index,}
\DoxyCodeLine{02588\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ *coords,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ coord\_len)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02589\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02590\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (region\_index\ >=\ regionCount))}
\DoxyCodeLine{02591\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0.;}
\DoxyCodeLine{02592\ }
\DoxyCodeLine{02593\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_var_region_axis}{VarRegionAxis}}\ *axes\ =\ axesZ.arrayZ\ +\ (region\_index\ *\ axisCount);}
\DoxyCodeLine{02594\ }
\DoxyCodeLine{02595\ \ \ \ \ \textcolor{keywordtype}{float}\ v\ =\ 1.;}
\DoxyCodeLine{02596\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ axisCount;}
\DoxyCodeLine{02597\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{02598\ \ \ \ \ \{}
\DoxyCodeLine{02599\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ coord\ =\ i\ <\ coord\_len\ ?\ coords[i]\ :\ 0;}
\DoxyCodeLine{02600\ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ factor\ =\ axes[i].evaluate\ (coord);}
\DoxyCodeLine{02601\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (factor\ ==\ 0.f)}
\DoxyCodeLine{02602\ \ \ \ \ \textcolor{keywordflow}{return}\ 0.;}
\DoxyCodeLine{02603\ \ \ \ \ \ \ v\ *=\ factor;}
\DoxyCodeLine{02604\ \ \ \ \ \}}
\DoxyCodeLine{02605\ \ \ \ \ \textcolor{keywordflow}{return}\ v;}
\DoxyCodeLine{02606\ \ \ \}}
\DoxyCodeLine{02607\ }
\DoxyCodeLine{02608\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02609\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02610\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02611\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this})\ \&\&\ axesZ.sanitize\ (c,\ axisCount\ *\ regionCount));}
\DoxyCodeLine{02612\ \ \ \}}
\DoxyCodeLine{02613\ }
\DoxyCodeLine{02614\ \ \ \textcolor{keywordtype}{bool}\ serialize\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_var_region_list}{VarRegionList}}\ *src,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__bimap__t}{hb\_bimap\_t}}\ \&region\_map)}
\DoxyCodeLine{02615\ \ \ \{}
\DoxyCodeLine{02616\ \ \ \ \ TRACE\_SERIALIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02617\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>extend\_min\ (\textcolor{keyword}{this})))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02618\ \ \ \ \ axisCount\ =\ src-\/>axisCount;}
\DoxyCodeLine{02619\ \ \ \ \ regionCount\ =\ region\_map.get\_population\ ();}
\DoxyCodeLine{02620\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (hb\_unsigned\_mul\_overflows\ (axisCount\ *\ regionCount,}
\DoxyCodeLine{02621\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ VarRegionAxis::static\_size)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02622\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>extend\ (\textcolor{keyword}{this})))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02623\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ region\_count\ =\ src-\/>regionCount;}
\DoxyCodeLine{02624\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ r\ =\ 0;\ r\ <\ regionCount;\ r++)}
\DoxyCodeLine{02625\ \ \ \ \ \{}
\DoxyCodeLine{02626\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ backward\ =\ region\_map.backward\ (r);}
\DoxyCodeLine{02627\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (backward\ >=\ region\_count)\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02628\ \ \ \ \ \ \ memcpy\ (\&axesZ[axisCount\ *\ r],\ \&src-\/>axesZ[axisCount\ *\ backward],\ VarRegionAxis::static\_size\ *\ axisCount);}
\DoxyCodeLine{02629\ \ \ \ \ \}}
\DoxyCodeLine{02630\ }
\DoxyCodeLine{02631\ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{02632\ \ \ \}}
\DoxyCodeLine{02633\ }
\DoxyCodeLine{02634\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_size\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ min\_size\ +\ VarRegionAxis::static\_size\ *\ axisCount\ *\ regionCount;\ \}}
\DoxyCodeLine{02635\ }
\DoxyCodeLine{02636\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{02637\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ axisCount;}
\DoxyCodeLine{02638\ \ \ \mbox{\hyperlink{struct_o_t_1_1_h_b_u_i_n_t15}{HBUINT15}}\ \ regionCount;}
\DoxyCodeLine{02639\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{02640\ \ \ \mbox{\hyperlink{struct_o_t_1_1_unsized_array_of}{UnsizedArrayOf<VarRegionAxis>}}}
\DoxyCodeLine{02641\ \ \ \ \ \ \ \ \ axesZ;}
\DoxyCodeLine{02642\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{02643\ \ \ DEFINE\_SIZE\_ARRAY\ (4,\ axesZ);}
\DoxyCodeLine{02644\ \};}
\DoxyCodeLine{02645\ }
\DoxyCodeLine{02646\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_var_data}{VarData}}}
\DoxyCodeLine{02647\ \{}
\DoxyCodeLine{02648\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_region\_index\_count\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{02649\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ regionIndices.len;\ \}}
\DoxyCodeLine{02650\ }
\DoxyCodeLine{02651\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_row\_size\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{02652\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ shortCount\ +\ regionIndices.len;\ \}}
\DoxyCodeLine{02653\ }
\DoxyCodeLine{02654\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_size\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{02655\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ min\_size}
\DoxyCodeLine{02656\ \ \ \ \ \ -\/\ regionIndices.min\_size\ +\ regionIndices.get\_size\ ()}
\DoxyCodeLine{02657\ \ \ \ \ \ +\ itemCount\ *\ get\_row\_size\ ();}
\DoxyCodeLine{02658\ \ \ \}}
\DoxyCodeLine{02659\ }
\DoxyCodeLine{02660\ \ \ \textcolor{keywordtype}{float}\ get\_delta\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ inner,}
\DoxyCodeLine{02661\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ *coords,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ coord\_count,}
\DoxyCodeLine{02662\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_var_region_list}{VarRegionList}}\ \&regions)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02663\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02664\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (inner\ >=\ itemCount))}
\DoxyCodeLine{02665\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0.;}
\DoxyCodeLine{02666\ }
\DoxyCodeLine{02667\ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ regionIndices.len;}
\DoxyCodeLine{02668\ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ scount\ =\ shortCount;}
\DoxyCodeLine{02669\ }
\DoxyCodeLine{02670\ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT8}}\ *\mbox{\hyperlink{classbytes}{bytes}}\ =\ get\_delta\_bytes\ ();}
\DoxyCodeLine{02671\ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT8}}\ *row\ =\ \mbox{\hyperlink{classbytes}{bytes}}\ +\ inner\ *\ (scount\ +\ count);}
\DoxyCodeLine{02672\ }
\DoxyCodeLine{02673\ \ \ \ \textcolor{keywordtype}{float}\ delta\ =\ 0.;}
\DoxyCodeLine{02674\ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;}
\DoxyCodeLine{02675\ }
\DoxyCodeLine{02676\ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBINT16}}\ *scursor\ =\ \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{struct_o_t_1_1_int_type}{HBINT16}}\ *\textcolor{keyword}{>}\ (row);}
\DoxyCodeLine{02677\ \ \ \ \textcolor{keywordflow}{for}\ (;\ i\ <\ scount;\ i++)}
\DoxyCodeLine{02678\ \ \ \ \{}
\DoxyCodeLine{02679\ \ \ \ \ \ \textcolor{keywordtype}{float}\ scalar\ =\ regions.evaluate\ (regionIndices.arrayZ[i],\ coords,\ coord\_count);}
\DoxyCodeLine{02680\ \ \ \ \ \ delta\ +=\ scalar\ *\ *scursor++;}
\DoxyCodeLine{02681\ \ \ \ \}}
\DoxyCodeLine{02682\ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBINT8}}\ *bcursor\ =\ \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{struct_o_t_1_1_int_type}{HBINT8}}\ *\textcolor{keyword}{>}\ (scursor);}
\DoxyCodeLine{02683\ \ \ \ \textcolor{keywordflow}{for}\ (;\ i\ <\ count;\ i++)}
\DoxyCodeLine{02684\ \ \ \ \{}
\DoxyCodeLine{02685\ \ \ \ \ \ \textcolor{keywordtype}{float}\ scalar\ =\ regions.evaluate\ (regionIndices.arrayZ[i],\ coords,\ coord\_count);}
\DoxyCodeLine{02686\ \ \ \ \ \ delta\ +=\ scalar\ *\ *bcursor++;}
\DoxyCodeLine{02687\ \ \ \ \}}
\DoxyCodeLine{02688\ }
\DoxyCodeLine{02689\ \ \ \ \textcolor{keywordflow}{return}\ delta;}
\DoxyCodeLine{02690\ \ \ \}}
\DoxyCodeLine{02691\ }
\DoxyCodeLine{02692\ \ \ \textcolor{keywordtype}{void}\ get\_region\_scalars\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ *coords,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ coord\_count,}
\DoxyCodeLine{02693\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_var_region_list}{VarRegionList}}\ \&regions,}
\DoxyCodeLine{02694\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ *scalars\ \textcolor{comment}{/*OUT\ */},}
\DoxyCodeLine{02695\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ num\_scalars)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02696\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02697\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ count\ =\ hb\_min\ (num\_scalars,\ regionIndices.len);}
\DoxyCodeLine{02698\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{02699\ \ \ \ \ \ \ scalars[i]\ =\ regions.evaluate\ (regionIndices.arrayZ[i],\ coords,\ coord\_count);}
\DoxyCodeLine{02700\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ count;\ i\ <\ num\_scalars;\ i++)}
\DoxyCodeLine{02701\ \ \ \ \ \ \ scalars[i]\ =\ 0.f;}
\DoxyCodeLine{02702\ \ \ \}}
\DoxyCodeLine{02703\ }
\DoxyCodeLine{02704\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02705\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02706\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02707\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this})\ \&\&}
\DoxyCodeLine{02708\ \ \ \ \ \ \ \ \ \ \ regionIndices.sanitize\ (c)\ \&\&}
\DoxyCodeLine{02709\ \ \ \ \ \ \ \ \ \ \ shortCount\ <=\ regionIndices.len\ \&\&}
\DoxyCodeLine{02710\ \ \ \ \ \ \ \ \ \ \ c-\/>check\_range\ (get\_delta\_bytes\ (),}
\DoxyCodeLine{02711\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ itemCount,}
\DoxyCodeLine{02712\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_row\_size\ ()));}
\DoxyCodeLine{02713\ \ \ \}}
\DoxyCodeLine{02714\ }
\DoxyCodeLine{02715\ \ \ \textcolor{keywordtype}{bool}\ serialize\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{02716\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_var_data}{VarData}}\ *src,}
\DoxyCodeLine{02717\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__inc__bimap__t}{hb\_inc\_bimap\_t}}\ \&inner\_map,}
\DoxyCodeLine{02718\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__bimap__t}{hb\_bimap\_t}}\ \&region\_map)}
\DoxyCodeLine{02719\ \ \ \{}
\DoxyCodeLine{02720\ \ \ \ \ TRACE\_SERIALIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02721\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>extend\_min\ (\textcolor{keyword}{this})))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02722\ \ \ \ \ itemCount\ =\ inner\_map.get\_next\_value\ ();}
\DoxyCodeLine{02723\ }
\DoxyCodeLine{02724\ \ \ \ \ \textcolor{comment}{/*\ Optimize\ short\ count\ */}}
\DoxyCodeLine{02725\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ ri\_count\ =\ src-\/>regionIndices.len;}
\DoxyCodeLine{02726\ \ \ \ \ \textcolor{keyword}{enum}\ delta\_size\_t\ \{\ kZero=0,\ kByte,\ kShort\ \};}
\DoxyCodeLine{02727\ \ \ \ \ \mbox{\hyperlink{structhb__vector__t}{hb\_vector\_t<delta\_size\_t>}}\ delta\_sz;}
\DoxyCodeLine{02728\ \ \ \ \ \mbox{\hyperlink{structhb__vector__t}{hb\_vector\_t<unsigned\ int>}}\ ri\_map;\ \ \textcolor{comment}{/*\ maps\ old\ index\ to\ new\ index\ */}}
\DoxyCodeLine{02729\ \ \ \ \ delta\_sz.resize\ (ri\_count);}
\DoxyCodeLine{02730\ \ \ \ \ ri\_map.resize\ (ri\_count);}
\DoxyCodeLine{02731\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ new\_short\_count\ =\ 0;}
\DoxyCodeLine{02732\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ r;}
\DoxyCodeLine{02733\ \ \ \ \ \textcolor{keywordflow}{for}\ (r\ =\ 0;\ r\ <\ ri\_count;\ r++)}
\DoxyCodeLine{02734\ \ \ \ \ \{}
\DoxyCodeLine{02735\ \ \ \ \ \ \ delta\_sz[r]\ =\ kZero;}
\DoxyCodeLine{02736\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ inner\_map.get\_next\_value\ ();\ i++)}
\DoxyCodeLine{02737\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02738\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ old\ =\ inner\_map.backward\ (i);}
\DoxyCodeLine{02739\ \ \ \ \ int16\_t\ delta\ =\ src-\/>get\_item\_delta\ (old,\ r);}
\DoxyCodeLine{02740\ \ \ \ \ \textcolor{keywordflow}{if}\ (delta\ <\ -\/128\ ||\ 127\ <\ delta)}
\DoxyCodeLine{02741\ \ \ \ \ \{}
\DoxyCodeLine{02742\ \ \ \ \ \ \ delta\_sz[r]\ =\ kShort;}
\DoxyCodeLine{02743\ \ \ \ \ \ \ new\_short\_count++;}
\DoxyCodeLine{02744\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02745\ \ \ \ \ \}}
\DoxyCodeLine{02746\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (delta\ !=\ 0)}
\DoxyCodeLine{02747\ \ \ \ \ \ \ delta\_sz[r]\ =\ kByte;}
\DoxyCodeLine{02748\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02749\ \ \ \ \ \}}
\DoxyCodeLine{02750\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ short\_index\ =\ 0;}
\DoxyCodeLine{02751\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ byte\_index\ =\ new\_short\_count;}
\DoxyCodeLine{02752\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ new\_ri\_count\ =\ 0;}
\DoxyCodeLine{02753\ \ \ \ \ \textcolor{keywordflow}{for}\ (r\ =\ 0;\ r\ <\ ri\_count;\ r++)}
\DoxyCodeLine{02754\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (delta\_sz[r])}
\DoxyCodeLine{02755\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02756\ \ \ \ \ ri\_map[r]\ =\ (delta\_sz[r]\ ==\ kShort)?\ short\_index++\ :\ byte\_index++;}
\DoxyCodeLine{02757\ \ \ \ \ new\_ri\_count++;}
\DoxyCodeLine{02758\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02759\ }
\DoxyCodeLine{02760\ \ \ \ \ shortCount\ =\ new\_short\_count;}
\DoxyCodeLine{02761\ \ \ \ \ regionIndices.len\ =\ new\_ri\_count;}
\DoxyCodeLine{02762\ }
\DoxyCodeLine{02763\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>extend\ (\textcolor{keyword}{this})))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02764\ }
\DoxyCodeLine{02765\ \ \ \ \ \textcolor{keywordflow}{for}\ (r\ =\ 0;\ r\ <\ ri\_count;\ r++)}
\DoxyCodeLine{02766\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (delta\_sz[r])\ regionIndices[ri\_map[r]]\ =\ region\_map[src-\/>regionIndices[r]];}
\DoxyCodeLine{02767\ }
\DoxyCodeLine{02768\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ itemCount;\ i++)}
\DoxyCodeLine{02769\ \ \ \ \ \{}
\DoxyCodeLine{02770\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \ old\ =\ inner\_map.backward\ (i);}
\DoxyCodeLine{02771\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ r\ =\ 0;\ r\ <\ ri\_count;\ r++)}
\DoxyCodeLine{02772\ \ \ \ \ \textcolor{keywordflow}{if}\ (delta\_sz[r])\ set\_item\_delta\ (i,\ ri\_map[r],\ src-\/>get\_item\_delta\ (old,\ r));}
\DoxyCodeLine{02773\ \ \ \ \ \}}
\DoxyCodeLine{02774\ }
\DoxyCodeLine{02775\ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{02776\ \ \ \}}
\DoxyCodeLine{02777\ }
\DoxyCodeLine{02778\ \ \ \textcolor{keywordtype}{void}\ collect\_region\_refs\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \&region\_indices,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__inc__bimap__t}{hb\_inc\_bimap\_t}}\ \&inner\_map)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02779\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02780\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ r\ =\ 0;\ r\ <\ regionIndices.len;\ r++)}
\DoxyCodeLine{02781\ \ \ \ \ \{}
\DoxyCodeLine{02782\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ region\ =\ regionIndices[r];}
\DoxyCodeLine{02783\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (region\_indices.has\ (region))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{02784\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ inner\_map.get\_next\_value\ ();\ i++)}
\DoxyCodeLine{02785\ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_item\_delta\ (inner\_map.backward\ (i),\ r)\ !=\ 0)}
\DoxyCodeLine{02786\ \ \ \ \ \{}
\DoxyCodeLine{02787\ \ \ \ \ \ \ region\_indices.add\ (region);}
\DoxyCodeLine{02788\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02789\ \ \ \ \ \}}
\DoxyCodeLine{02790\ \ \ \ \ \}}
\DoxyCodeLine{02791\ \ \ \}}
\DoxyCodeLine{02792\ }
\DoxyCodeLine{02793\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{02794\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT8}}\ *get\_delta\_bytes\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{02795\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ \&StructAfter<HBUINT8>\ (regionIndices);\ \}}
\DoxyCodeLine{02796\ }
\DoxyCodeLine{02797\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT8}}\ *get\_delta\_bytes\ ()}
\DoxyCodeLine{02798\ \ \ \{\ \textcolor{keywordflow}{return}\ \&StructAfter<HBUINT8>\ (regionIndices);\ \}}
\DoxyCodeLine{02799\ }
\DoxyCodeLine{02800\ \ \ int16\_t\ get\_item\_delta\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ item,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ region)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02801\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02802\ \ \ \ \ \textcolor{keywordflow}{if}\ (\ item\ >=\ itemCount\ ||\ unlikely\ (region\ >=\ regionIndices.len))\ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{02803\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBINT8}}\ *p\ =\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBINT8}}\ *)get\_delta\_bytes\ ()\ +\ item\ *\ get\_row\_size\ ();}
\DoxyCodeLine{02804\ \ \ \ \ \textcolor{keywordflow}{if}\ (region\ <\ shortCount)}
\DoxyCodeLine{02805\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ((\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBINT16}}\ *)p)[region];}
\DoxyCodeLine{02806\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02807\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (p\ +\ HBINT16::static\_size\ *\ shortCount)[region\ -\/\ shortCount];}
\DoxyCodeLine{02808\ \ \ \}}
\DoxyCodeLine{02809\ }
\DoxyCodeLine{02810\ \ \ \textcolor{keywordtype}{void}\ set\_item\_delta\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ item,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ region,\ int16\_t\ delta)}
\DoxyCodeLine{02811\ \ \ \{}
\DoxyCodeLine{02812\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBINT8}}\ *p\ =\ (\mbox{\hyperlink{struct_o_t_1_1_int_type}{HBINT8}}\ *)get\_delta\_bytes\ ()\ +\ item\ *\ get\_row\_size\ ();}
\DoxyCodeLine{02813\ \ \ \ \ \textcolor{keywordflow}{if}\ (region\ <\ shortCount)}
\DoxyCodeLine{02814\ \ \ \ \ \ \ ((\mbox{\hyperlink{struct_o_t_1_1_int_type}{HBINT16}}\ *)p)[region]\ =\ delta;}
\DoxyCodeLine{02815\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02816\ \ \ \ \ \ \ (p\ +\ HBINT16::static\_size\ *\ shortCount)[region\ -\/\ shortCount]\ =\ delta;}
\DoxyCodeLine{02817\ \ \ \}}
\DoxyCodeLine{02818\ }
\DoxyCodeLine{02819\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{02820\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ \ \ \ \ itemCount;}
\DoxyCodeLine{02821\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ \ \ \ \ shortCount;}
\DoxyCodeLine{02822\ \ \ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<HBUINT16>}}\ \ \ \ regionIndices;}
\DoxyCodeLine{02823\ \textcolor{comment}{/*UnsizedArrayOf<HBUINT8>bytesX;*/}}
\DoxyCodeLine{02824\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{02825\ \ \ DEFINE\_SIZE\_ARRAY\ (6,\ regionIndices);}
\DoxyCodeLine{02826\ \};}
\DoxyCodeLine{02827\ }
\DoxyCodeLine{02828\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_variation_store}{VariationStore}}}
\DoxyCodeLine{02829\ \{}
\DoxyCodeLine{02830\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{02831\ \ \ \textcolor{keywordtype}{float}\ get\_delta\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ outer,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ inner,}
\DoxyCodeLine{02832\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ *coords,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ coord\_count)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02833\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02834\ \textcolor{preprocessor}{\#ifdef\ HB\_NO\_VAR}}
\DoxyCodeLine{02835\ \ \ \ \ \textcolor{keywordflow}{return}\ 0.f;}
\DoxyCodeLine{02836\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02837\ }
\DoxyCodeLine{02838\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (outer\ >=\ dataSets.len))}
\DoxyCodeLine{02839\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0.f;}
\DoxyCodeLine{02840\ }
\DoxyCodeLine{02841\ \ \ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{this}+dataSets[outer]).get\_delta\ (inner,}
\DoxyCodeLine{02842\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coords,\ coord\_count,}
\DoxyCodeLine{02843\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{this}+regions);}
\DoxyCodeLine{02844\ \ \ \}}
\DoxyCodeLine{02845\ }
\DoxyCodeLine{02846\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{02847\ \ \ \textcolor{keywordtype}{float}\ get\_delta\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ index,}
\DoxyCodeLine{02848\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ *coords,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ coord\_count)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02849\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02850\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ outer\ =\ index\ >>\ 16;}
\DoxyCodeLine{02851\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ inner\ =\ index\ \&\ 0xFFFF;}
\DoxyCodeLine{02852\ \ \ \ \ \textcolor{keywordflow}{return}\ get\_delta\ (outer,\ inner,\ coords,\ coord\_count);}
\DoxyCodeLine{02853\ \ \ \}}
\DoxyCodeLine{02854\ }
\DoxyCodeLine{02855\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02856\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02857\ \textcolor{preprocessor}{\#ifdef\ HB\_NO\_VAR}}
\DoxyCodeLine{02858\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02859\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02860\ }
\DoxyCodeLine{02861\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02862\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this})\ \&\&}
\DoxyCodeLine{02863\ \ \ \ \ \ \ \ \ \ \ format\ ==\ 1\ \&\&}
\DoxyCodeLine{02864\ \ \ \ \ \ \ \ \ \ \ regions.sanitize\ (c,\ \textcolor{keyword}{this})\ \&\&}
\DoxyCodeLine{02865\ \ \ \ \ \ \ \ \ \ \ dataSets.sanitize\ (c,\ \textcolor{keyword}{this}));}
\DoxyCodeLine{02866\ \ \ \}}
\DoxyCodeLine{02867\ }
\DoxyCodeLine{02868\ \ \ \textcolor{keywordtype}{bool}\ serialize\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{02869\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_variation_store}{VariationStore}}\ *src,}
\DoxyCodeLine{02870\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ hb\_array\_t\ <hb\_inc\_bimap\_t>\ \&inner\_maps)}
\DoxyCodeLine{02871\ \ \ \{}
\DoxyCodeLine{02872\ \ \ \ \ TRACE\_SERIALIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02873\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>extend\_min\ (\textcolor{keyword}{this})))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02874\ }
\DoxyCodeLine{02875\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ set\_count\ =\ 0;}
\DoxyCodeLine{02876\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ inner\_maps.length;\ i++)}
\DoxyCodeLine{02877\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (inner\_maps[i].get\_population\ ())}
\DoxyCodeLine{02878\ \ \ \ \ set\_count++;}
\DoxyCodeLine{02879\ }
\DoxyCodeLine{02880\ \ \ \ \ format\ =\ 1;}
\DoxyCodeLine{02881\ }
\DoxyCodeLine{02882\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ \&src\_regions\ =\ src+src-\/>regions;}
\DoxyCodeLine{02883\ }
\DoxyCodeLine{02884\ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ region\_indices;}
\DoxyCodeLine{02885\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ inner\_maps.length;\ i++)}
\DoxyCodeLine{02886\ \ \ \ \ \ \ (src+src-\/>dataSets[i]).collect\_region\_refs\ (region\_indices,\ inner\_maps[i]);}
\DoxyCodeLine{02887\ }
\DoxyCodeLine{02888\ \ \ \ \ \textcolor{keywordflow}{if}\ (region\_indices.in\_error\ ())}
\DoxyCodeLine{02889\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02890\ }
\DoxyCodeLine{02891\ \ \ \ \ region\_indices.del\_range\ ((src\_regions).regionCount,\ hb\_set\_t::INVALID);}
\DoxyCodeLine{02892\ }
\DoxyCodeLine{02893\ \ \ \ \ \textcolor{comment}{/*\ TODO\ use\ constructor\ when\ our\ data-\/structures\ support\ that.\ */}}
\DoxyCodeLine{02894\ \ \ \ \ \mbox{\hyperlink{structhb__inc__bimap__t}{hb\_inc\_bimap\_t}}\ region\_map;}
\DoxyCodeLine{02895\ \ \ \ \ +\ hb\_iter\ (region\_indices)}
\DoxyCodeLine{02896\ \ \ \ \ |\ hb\_apply\ ([\&region\_map]\ (\textcolor{keywordtype}{unsigned}\ \_)\ \{\ region\_map.add(\_);\ \})}
\DoxyCodeLine{02897\ \ \ \ \ ;}
\DoxyCodeLine{02898\ \ \ \ \ \textcolor{keywordflow}{if}\ (region\_map.in\_error())}
\DoxyCodeLine{02899\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02900\ }
\DoxyCodeLine{02901\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!regions.serialize\_serialize\ (c,\ \&src\_regions,\ region\_map)))}
\DoxyCodeLine{02902\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02903\ }
\DoxyCodeLine{02904\ \ \ \ \ dataSets.len\ =\ set\_count;}
\DoxyCodeLine{02905\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>extend\ (dataSets)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02906\ }
\DoxyCodeLine{02907\ \ \ \ \ \textcolor{comment}{/*\ TODO:\ The\ following\ code\ could\ be\ simplified\ when}}
\DoxyCodeLine{02908\ \textcolor{comment}{\ \ \ \ \ *\ List16OfOffset16To::subset\ ()\ can\ take\ a\ custom\ param\ to\ be\ passed\ to\ VarData::serialize\ ()\ */}}
\DoxyCodeLine{02909\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ set\_index\ =\ 0;}
\DoxyCodeLine{02910\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ inner\_maps.length;\ i++)}
\DoxyCodeLine{02911\ \ \ \ \ \{}
\DoxyCodeLine{02912\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!inner\_maps[i].get\_population\ ())\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{02913\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!dataSets[set\_index++]}
\DoxyCodeLine{02914\ \ \ \ \ \ \ \ \ \ \ \ \ \ .serialize\_serialize\ (c,\ \&(src+src-\/>dataSets[i]),\ inner\_maps[i],\ region\_map)))}
\DoxyCodeLine{02915\ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02916\ \ \ \ \ \}}
\DoxyCodeLine{02917\ }
\DoxyCodeLine{02918\ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{02919\ \ \ \}}
\DoxyCodeLine{02920\ }
\DoxyCodeLine{02921\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02922\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02923\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02924\ }
\DoxyCodeLine{02925\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_variation_store}{VariationStore}}\ *varstore\_prime\ =\ c-\/>serializer-\/>start\_embed<\mbox{\hyperlink{struct_o_t_1_1_variation_store}{VariationStore}}>\ ();}
\DoxyCodeLine{02926\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!varstore\_prime))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02927\ }
\DoxyCodeLine{02928\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *variation\_indices\ =\ c-\/>plan-\/>layout\_variation\_indices;}
\DoxyCodeLine{02929\ \ \ \ \ \textcolor{keywordflow}{if}\ (variation\_indices-\/>is\_empty\ ())\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02930\ }
\DoxyCodeLine{02931\ \ \ \ \ \mbox{\hyperlink{structhb__vector__t}{hb\_vector\_t<hb\_inc\_bimap\_t>}}\ inner\_maps;}
\DoxyCodeLine{02932\ \ \ \ \ inner\_maps.resize\ ((\textcolor{keywordtype}{unsigned})\ dataSets.len);}
\DoxyCodeLine{02933\ }
\DoxyCodeLine{02934\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ idx\ :\ c-\/>plan-\/>layout\_variation\_indices-\/>iter\ ())}
\DoxyCodeLine{02935\ \ \ \ \ \{}
\DoxyCodeLine{02936\ \ \ \ \ \ \ uint16\_t\ major\ =\ idx\ >>\ 16;}
\DoxyCodeLine{02937\ \ \ \ \ \ \ uint16\_t\ minor\ =\ idx\ \&\ 0xFFFF;}
\DoxyCodeLine{02938\ }
\DoxyCodeLine{02939\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (major\ >=\ inner\_maps.length)}
\DoxyCodeLine{02940\ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02941\ \ \ \ \ \ \ inner\_maps[major].add\ (minor);}
\DoxyCodeLine{02942\ \ \ \ \ \}}
\DoxyCodeLine{02943\ \ \ \ \ varstore\_prime-\/>serialize\ (c-\/>serializer,\ \textcolor{keyword}{this},\ inner\_maps.as\_array\ ());}
\DoxyCodeLine{02944\ }
\DoxyCodeLine{02945\ \ \ \ \ return\_trace\ (}
\DoxyCodeLine{02946\ \ \ \ \ \ \ \ \ !c-\/>serializer-\/>in\_error()}
\DoxyCodeLine{02947\ \ \ \ \ \ \ \ \ \&\&\ varstore\_prime-\/>dataSets);}
\DoxyCodeLine{02948\ \ \ \}}
\DoxyCodeLine{02949\ }
\DoxyCodeLine{02950\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_region\_index\_count\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ major)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02951\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{this}+dataSets[major]).get\_region\_index\_count\ ();\ \}}
\DoxyCodeLine{02952\ }
\DoxyCodeLine{02953\ \ \ \textcolor{keywordtype}{void}\ get\_region\_scalars\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ major,}
\DoxyCodeLine{02954\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ *coords,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ coord\_count,}
\DoxyCodeLine{02955\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ *scalars\ \textcolor{comment}{/*OUT*/},}
\DoxyCodeLine{02956\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ num\_scalars)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02957\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02958\ \textcolor{preprocessor}{\#ifdef\ HB\_NO\_VAR}}
\DoxyCodeLine{02959\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ 0;\ i\ <\ num\_scalars;\ i++)}
\DoxyCodeLine{02960\ \ \ \ \ \ \ scalars[i]\ =\ 0.f;}
\DoxyCodeLine{02961\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02962\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02963\ }
\DoxyCodeLine{02964\ \ \ \ \ (\textcolor{keyword}{this}+dataSets[major]).get\_region\_scalars\ (coords,\ coord\_count,}
\DoxyCodeLine{02965\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{this}+regions,}
\DoxyCodeLine{02966\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&scalars[0],\ num\_scalars);}
\DoxyCodeLine{02967\ \ \ \}}
\DoxyCodeLine{02968\ }
\DoxyCodeLine{02969\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_sub\_table\_count\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ dataSets.len;\ \}}
\DoxyCodeLine{02970\ }
\DoxyCodeLine{02971\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{02972\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ format;}
\DoxyCodeLine{02973\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset32To<VarRegionList>}}\ \ \ \ \ \ \ \ regions;}
\DoxyCodeLine{02974\ \ \ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset32To<VarData>}}\ \ \ \ \ \ dataSets;}
\DoxyCodeLine{02975\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{02976\ \ \ DEFINE\_SIZE\_ARRAY\_SIZED\ (8,\ dataSets);}
\DoxyCodeLine{02977\ \};}
\DoxyCodeLine{02978\ }
\DoxyCodeLine{02979\ \textcolor{comment}{/*}}
\DoxyCodeLine{02980\ \textcolor{comment}{\ *\ Feature\ Variations}}
\DoxyCodeLine{02981\ \textcolor{comment}{\ */}}
\DoxyCodeLine{02982\ }
\DoxyCodeLine{02983\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_condition_format1}{ConditionFormat1}}}
\DoxyCodeLine{02984\ \{}
\DoxyCodeLine{02985\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_condition}{Condition}};}
\DoxyCodeLine{02986\ }
\DoxyCodeLine{02987\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02988\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02989\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02990\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>serializer-\/>embed\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02991\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!out))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02992\ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{02993\ \ \ \}}
\DoxyCodeLine{02994\ }
\DoxyCodeLine{02995\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{02996\ \ \ \textcolor{keywordtype}{bool}\ evaluate\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ *coords,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ coord\_len)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02997\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02998\ \ \ \ \ \textcolor{keywordtype}{int}\ coord\ =\ axisIndex\ <\ coord\_len\ ?\ coords[axisIndex]\ :\ 0;}
\DoxyCodeLine{02999\ \ \ \ \ \textcolor{keywordflow}{return}\ filterRangeMinValue\ <=\ coord\ \&\&\ coord\ <=\ filterRangeMaxValue;}
\DoxyCodeLine{03000\ \ \ \}}
\DoxyCodeLine{03001\ }
\DoxyCodeLine{03002\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03003\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03004\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03005\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this}));}
\DoxyCodeLine{03006\ \ \ \}}
\DoxyCodeLine{03007\ }
\DoxyCodeLine{03008\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{03009\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ format;\ \ \ \ \ \textcolor{comment}{/*\ Format\ identifier-\/-\/format\ =\ 1\ */}}
\DoxyCodeLine{03010\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ axisIndex;}
\DoxyCodeLine{03011\ \ \ \mbox{\hyperlink{struct_o_t_1_1_f2_d_o_t14}{F2DOT14}}\ \ \ \ filterRangeMinValue;}
\DoxyCodeLine{03012\ \ \ \mbox{\hyperlink{struct_o_t_1_1_f2_d_o_t14}{F2DOT14}}\ \ \ \ filterRangeMaxValue;}
\DoxyCodeLine{03013\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{03014\ \ \ DEFINE\_SIZE\_STATIC\ (8);}
\DoxyCodeLine{03015\ \};}
\DoxyCodeLine{03016\ }
\DoxyCodeLine{03017\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_condition}{Condition}}}
\DoxyCodeLine{03018\ \{}
\DoxyCodeLine{03019\ \ \ \textcolor{keywordtype}{bool}\ evaluate\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ *coords,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ coord\_len)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03020\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03021\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)\ \{}
\DoxyCodeLine{03022\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \textcolor{keywordflow}{return}\ u.format1.evaluate\ (coords,\ coord\_len);}
\DoxyCodeLine{03023\ \ \ \ \ \textcolor{keywordflow}{default}:\textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03024\ \ \ \ \ \}}
\DoxyCodeLine{03025\ \ \ \}}
\DoxyCodeLine{03026\ }
\DoxyCodeLine{03027\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ context\_t,\ \textcolor{keyword}{typename}\ ...Ts>}
\DoxyCodeLine{03028\ \ \ \textcolor{keyword}{typename}\ context\_t::return\_t\ dispatch\ (context\_t\ *c,\ Ts\&\&...\ ds)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03029\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03030\ \ \ \ \ TRACE\_DISPATCH\ (\textcolor{keyword}{this},\ u.format);}
\DoxyCodeLine{03031\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>may\_dispatch\ (\textcolor{keyword}{this},\ \&u.format)))\ return\_trace\ (c-\/>no\_dispatch\_return\_value\ ());}
\DoxyCodeLine{03032\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)\ \{}
\DoxyCodeLine{03033\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ return\_trace\ (c-\/>dispatch\ (u.format1,\ std::forward<Ts>\ (ds)...));}
\DoxyCodeLine{03034\ \ \ \ \ \textcolor{keywordflow}{default}:return\_trace\ (c-\/>default\_return\_value\ ());}
\DoxyCodeLine{03035\ \ \ \ \ \}}
\DoxyCodeLine{03036\ \ \ \}}
\DoxyCodeLine{03037\ }
\DoxyCodeLine{03038\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03039\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03040\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03041\ \ \ \ \ \textcolor{keywordflow}{if}\ (!u.format.sanitize\ (c))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{03042\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)\ \{}
\DoxyCodeLine{03043\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ return\_trace\ (u.format1.sanitize\ (c));}
\DoxyCodeLine{03044\ \ \ \ \ \textcolor{keywordflow}{default}:return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{03045\ \ \ \ \ \}}
\DoxyCodeLine{03046\ \ \ \}}
\DoxyCodeLine{03047\ }
\DoxyCodeLine{03048\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{03049\ \ \ \textcolor{keyword}{union\ }\{}
\DoxyCodeLine{03050\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ \ \ \ \ format;\ \ \ \ \ \textcolor{comment}{/*\ Format\ identifier\ */}}
\DoxyCodeLine{03051\ \ \ \mbox{\hyperlink{struct_o_t_1_1_condition_format1}{ConditionFormat1}}\ \ format1;}
\DoxyCodeLine{03052\ \ \ \}\ u;}
\DoxyCodeLine{03053\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{03054\ \ \ DEFINE\_SIZE\_UNION\ (2,\ format);}
\DoxyCodeLine{03055\ \};}
\DoxyCodeLine{03056\ }
\DoxyCodeLine{03057\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_condition_set}{ConditionSet}}}
\DoxyCodeLine{03058\ \{}
\DoxyCodeLine{03059\ \ \ \textcolor{keywordtype}{bool}\ evaluate\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ *coords,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ coord\_len)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03060\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03061\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ conditions.len;}
\DoxyCodeLine{03062\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{03063\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!(\textcolor{keyword}{this}+conditions.arrayZ[i]).evaluate\ (coords,\ coord\_len))}
\DoxyCodeLine{03064\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03065\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{03066\ \ \ \}}
\DoxyCodeLine{03067\ }
\DoxyCodeLine{03068\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03069\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03070\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03071\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>serializer-\/>start\_embed\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03072\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!out\ ||\ !c-\/>serializer-\/>extend\_min\ (out)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{03073\ }
\DoxyCodeLine{03074\ \ \ \ \ +\ conditions.iter\ ()}
\DoxyCodeLine{03075\ \ \ \ \ |\ hb\_apply\ (subset\_offset\_array\ (c,\ out-\/>conditions,\ \textcolor{keyword}{this}))}
\DoxyCodeLine{03076\ \ \ \ \ ;}
\DoxyCodeLine{03077\ }
\DoxyCodeLine{03078\ \ \ \ \ return\_trace\ (\textcolor{keywordtype}{bool}\ (out-\/>conditions));}
\DoxyCodeLine{03079\ \ \ \}}
\DoxyCodeLine{03080\ }
\DoxyCodeLine{03081\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03082\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03083\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03084\ \ \ \ \ return\_trace\ (conditions.sanitize\ (c,\ \textcolor{keyword}{this}));}
\DoxyCodeLine{03085\ \ \ \}}
\DoxyCodeLine{03086\ }
\DoxyCodeLine{03087\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{03088\ \ \ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset32To<Condition>}}\ \ conditions;}
\DoxyCodeLine{03089\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{03090\ \ \ DEFINE\_SIZE\_ARRAY\ (2,\ conditions);}
\DoxyCodeLine{03091\ \};}
\DoxyCodeLine{03092\ }
\DoxyCodeLine{03093\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_feature_table_substitution_record}{FeatureTableSubstitutionRecord}}}
\DoxyCodeLine{03094\ \{}
\DoxyCodeLine{03095\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_feature_table_substitution}{FeatureTableSubstitution}};}
\DoxyCodeLine{03096\ }
\DoxyCodeLine{03097\ \ \ \textcolor{keywordtype}{void}\ collect\_lookups\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base,\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *lookup\_indexes\ \textcolor{comment}{/*\ OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{03098\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03099\ \ \ \ \ \textcolor{keywordflow}{return}\ (base+feature).add\_lookup\_indexes\_to\ (lookup\_indexes);}
\DoxyCodeLine{03100\ \ \ \}}
\DoxyCodeLine{03101\ }
\DoxyCodeLine{03102\ \ \ \textcolor{keywordtype}{void}\ closure\_features\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base,}
\DoxyCodeLine{03103\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *lookup\_indexes,}
\DoxyCodeLine{03104\ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \ \ \ \ \ \ *feature\_indexes\ \textcolor{comment}{/*\ OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{03105\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03106\ \ \ \ \ \textcolor{keywordflow}{if}\ ((base+feature).intersects\_lookup\_indexes\ (lookup\_indexes))}
\DoxyCodeLine{03107\ \ \ \ \ \ \ feature\_indexes-\/>add\ (featureIndex);}
\DoxyCodeLine{03108\ \ \ \}}
\DoxyCodeLine{03109\ }
\DoxyCodeLine{03110\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{struct_o_t_1_1hb__subset__layout__context__t}{hb\_subset\_layout\_context\_t}}\ *c,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03111\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03112\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03113\ \ \ \ \ \textcolor{keywordflow}{if}\ (!c-\/>feature\_index\_map-\/>has\ (featureIndex))\ \{}
\DoxyCodeLine{03114\ \ \ \ \ \ \ \textcolor{comment}{//\ Feature\ that\ is\ being\ substituted\ is\ not\ being\ retained,\ so\ we\ don't}}
\DoxyCodeLine{03115\ \ \ \ \ \ \ \textcolor{comment}{//\ need\ this.}}
\DoxyCodeLine{03116\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{03117\ \ \ \ \ \}}
\DoxyCodeLine{03118\ }
\DoxyCodeLine{03119\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>subset\_context-\/>serializer-\/>embed\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03120\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!out))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{03121\ }
\DoxyCodeLine{03122\ \ \ \ \ out-\/>featureIndex\ =\ c-\/>feature\_index\_map-\/>get\ (featureIndex);}
\DoxyCodeLine{03123\ \ \ \ \ \textcolor{keywordtype}{bool}\ ret\ =\ out-\/>feature.serialize\_subset\ (c-\/>subset\_context,\ feature,\ base,\ c);}
\DoxyCodeLine{03124\ \ \ \ \ return\_trace\ (ret);}
\DoxyCodeLine{03125\ \ \ \}}
\DoxyCodeLine{03126\ }
\DoxyCodeLine{03127\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03128\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03129\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03130\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this})\ \&\&\ feature.sanitize\ (c,\ base));}
\DoxyCodeLine{03131\ \ \ \}}
\DoxyCodeLine{03132\ }
\DoxyCodeLine{03133\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{03134\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ \ \ \ \ featureIndex;}
\DoxyCodeLine{03135\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset32To<Feature>}}\ \ \ \ feature;}
\DoxyCodeLine{03136\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{03137\ \ \ DEFINE\_SIZE\_STATIC\ (6);}
\DoxyCodeLine{03138\ \};}
\DoxyCodeLine{03139\ }
\DoxyCodeLine{03140\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_feature_table_substitution}{FeatureTableSubstitution}}}
\DoxyCodeLine{03141\ \{}
\DoxyCodeLine{03142\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_feature}{Feature}}\ *find\_substitute\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ feature\_index)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03143\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03144\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ substitutions.len;}
\DoxyCodeLine{03145\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{03146\ \ \ \ \ \{}
\DoxyCodeLine{03147\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_feature_table_substitution_record}{FeatureTableSubstitutionRecord}}\ \&record\ =\ substitutions.arrayZ[i];}
\DoxyCodeLine{03148\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (record.featureIndex\ ==\ feature\_index)}
\DoxyCodeLine{03149\ \ \ \ \ \textcolor{keywordflow}{return}\ \&(\textcolor{keyword}{this}+record.feature);}
\DoxyCodeLine{03150\ \ \ \ \ \}}
\DoxyCodeLine{03151\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{03152\ \ \ \}}
\DoxyCodeLine{03153\ }
\DoxyCodeLine{03154\ \ \ \textcolor{keywordtype}{void}\ collect\_lookups\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *feature\_indexes,}
\DoxyCodeLine{03155\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \ \ \ \ \ \ *lookup\_indexes\ \textcolor{comment}{/*\ OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{03156\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03157\ \ \ \ \ +\ hb\_iter\ (substitutions)}
\DoxyCodeLine{03158\ \ \ \ \ |\ hb\_filter\ (feature\_indexes,\ \&FeatureTableSubstitutionRecord::featureIndex)}
\DoxyCodeLine{03159\ \ \ \ \ |\ hb\_apply\ ([\textcolor{keyword}{this},\ lookup\_indexes]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_feature_table_substitution_record}{FeatureTableSubstitutionRecord}}\&\ r)}
\DoxyCodeLine{03160\ \ \ \ \ \ \ \ \ \{\ r.collect\_lookups\ (\textcolor{keyword}{this},\ lookup\_indexes);\ \})}
\DoxyCodeLine{03161\ \ \ \ \ ;}
\DoxyCodeLine{03162\ \ \ \}}
\DoxyCodeLine{03163\ }
\DoxyCodeLine{03164\ \ \ \textcolor{keywordtype}{void}\ closure\_features\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *lookup\_indexes,}
\DoxyCodeLine{03165\ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \ \ \ \ \ \ *feature\_indexes\ \textcolor{comment}{/*\ OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{03166\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03167\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_feature_table_substitution_record}{FeatureTableSubstitutionRecord}}\&\ record\ :\ substitutions)}
\DoxyCodeLine{03168\ \ \ \ \ \ \ record.closure\_features\ (\textcolor{keyword}{this},\ lookup\_indexes,\ feature\_indexes);}
\DoxyCodeLine{03169\ \ \ \}}
\DoxyCodeLine{03170\ }
\DoxyCodeLine{03171\ \ \ \textcolor{keywordtype}{bool}\ intersects\_features\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *feature\_index\_map)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03172\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03173\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_feature_table_substitution_record}{FeatureTableSubstitutionRecord}}\&\ record\ :\ substitutions)}
\DoxyCodeLine{03174\ \ \ \ \ \{}
\DoxyCodeLine{03175\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (feature\_index\_map-\/>has\ (record.featureIndex))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{03176\ \ \ \ \ \}}
\DoxyCodeLine{03177\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03178\ \ \ \}}
\DoxyCodeLine{03179\ }
\DoxyCodeLine{03180\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ \ \ \ \ \ \ \ *c,}
\DoxyCodeLine{03181\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__subset__layout__context__t}{hb\_subset\_layout\_context\_t}}\ *l)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03182\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03183\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03184\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>serializer-\/>start\_embed\ (*\textcolor{keyword}{this});}
\DoxyCodeLine{03185\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!out\ ||\ !c-\/>serializer-\/>extend\_min\ (out)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{03186\ }
\DoxyCodeLine{03187\ \ \ \ \ out-\/>version.major\ =\ version.major;}
\DoxyCodeLine{03188\ \ \ \ \ out-\/>version.minor\ =\ version.minor;}
\DoxyCodeLine{03189\ }
\DoxyCodeLine{03190\ \ \ \ \ +\ substitutions.iter\ ()}
\DoxyCodeLine{03191\ \ \ \ \ |\ hb\_apply\ (subset\_record\_array\ (l,\ \&(out-\/>substitutions),\ \textcolor{keyword}{this}))}
\DoxyCodeLine{03192\ \ \ \ \ ;}
\DoxyCodeLine{03193\ }
\DoxyCodeLine{03194\ \ \ \ \ return\_trace\ (\textcolor{keywordtype}{bool}\ (out-\/>substitutions));}
\DoxyCodeLine{03195\ \ \ \}}
\DoxyCodeLine{03196\ }
\DoxyCodeLine{03197\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03198\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03199\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03200\ \ \ \ \ return\_trace\ (version.sanitize\ (c)\ \&\&}
\DoxyCodeLine{03201\ \ \ \ \ \ \ \ \ \ \ likely\ (version.major\ ==\ 1)\ \&\&}
\DoxyCodeLine{03202\ \ \ \ \ \ \ \ \ \ \ substitutions.sanitize\ (c,\ \textcolor{keyword}{this}));}
\DoxyCodeLine{03203\ \ \ \}}
\DoxyCodeLine{03204\ }
\DoxyCodeLine{03205\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{03206\ \ \ \mbox{\hyperlink{struct_o_t_1_1_fixed_version}{FixedVersion<>}}\ \ version;\ \ \ \ \textcolor{comment}{/*\ Version-\/-\/0x00010000u\ */}}
\DoxyCodeLine{03207\ \ \ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<FeatureTableSubstitutionRecord>}}}
\DoxyCodeLine{03208\ \ \ \ \ \ \ \ \ \ \ \ \ substitutions;}
\DoxyCodeLine{03209\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{03210\ \ \ DEFINE\_SIZE\_ARRAY\ (6,\ substitutions);}
\DoxyCodeLine{03211\ \};}
\DoxyCodeLine{03212\ }
\DoxyCodeLine{03213\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_feature_variation_record}{FeatureVariationRecord}}}
\DoxyCodeLine{03214\ \{}
\DoxyCodeLine{03215\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_feature_variations}{FeatureVariations}};}
\DoxyCodeLine{03216\ }
\DoxyCodeLine{03217\ \ \ \textcolor{keywordtype}{void}\ collect\_lookups\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ \ \ \ \ *base,}
\DoxyCodeLine{03218\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *feature\_indexes,}
\DoxyCodeLine{03219\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \ \ \ \ \ \ *lookup\_indexes\ \textcolor{comment}{/*\ OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{03220\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03221\ \ \ \ \ \textcolor{keywordflow}{return}\ (base+substitutions).collect\_lookups\ (feature\_indexes,\ lookup\_indexes);}
\DoxyCodeLine{03222\ \ \ \}}
\DoxyCodeLine{03223\ }
\DoxyCodeLine{03224\ \ \ \textcolor{keywordtype}{void}\ closure\_features\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ \ \ \ \ *base,}
\DoxyCodeLine{03225\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *lookup\_indexes,}
\DoxyCodeLine{03226\ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \ \ \ \ \ \ *feature\_indexes\ \textcolor{comment}{/*\ OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{03227\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03228\ \ \ \ \ (base+substitutions).closure\_features\ (lookup\_indexes,\ feature\_indexes);}
\DoxyCodeLine{03229\ \ \ \}}
\DoxyCodeLine{03230\ }
\DoxyCodeLine{03231\ \ \ \textcolor{keywordtype}{bool}\ intersects\_features\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *feature\_index\_map)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03232\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03233\ \ \ \ \ \textcolor{keywordflow}{return}\ (base+substitutions).intersects\_features\ (feature\_index\_map);}
\DoxyCodeLine{03234\ \ \ \}}
\DoxyCodeLine{03235\ }
\DoxyCodeLine{03236\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{struct_o_t_1_1hb__subset__layout__context__t}{hb\_subset\_layout\_context\_t}}\ *c,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03237\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03238\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03239\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>subset\_context-\/>serializer-\/>embed\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03240\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!out))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{03241\ }
\DoxyCodeLine{03242\ \ \ \ \ out-\/>conditions.serialize\_subset\ (c-\/>subset\_context,\ conditions,\ base);}
\DoxyCodeLine{03243\ \ \ \ \ out-\/>substitutions.serialize\_subset\ (c-\/>subset\_context,\ substitutions,\ base,\ c);}
\DoxyCodeLine{03244\ }
\DoxyCodeLine{03245\ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{03246\ \ \ \}}
\DoxyCodeLine{03247\ }
\DoxyCodeLine{03248\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03249\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03250\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03251\ \ \ \ \ return\_trace\ (conditions.sanitize\ (c,\ base)\ \&\&}
\DoxyCodeLine{03252\ \ \ \ \ \ \ \ \ \ \ substitutions.sanitize\ (c,\ base));}
\DoxyCodeLine{03253\ \ \ \}}
\DoxyCodeLine{03254\ }
\DoxyCodeLine{03255\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{03256\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset32To<ConditionSet>}}}
\DoxyCodeLine{03257\ \ \ \ \ \ \ \ \ \ \ \ \ conditions;}
\DoxyCodeLine{03258\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset32To<FeatureTableSubstitution>}}}
\DoxyCodeLine{03259\ \ \ \ \ \ \ \ \ \ \ \ \ substitutions;}
\DoxyCodeLine{03260\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{03261\ \ \ DEFINE\_SIZE\_STATIC\ (8);}
\DoxyCodeLine{03262\ \};}
\DoxyCodeLine{03263\ }
\DoxyCodeLine{03264\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_feature_variations}{FeatureVariations}}}
\DoxyCodeLine{03265\ \{}
\DoxyCodeLine{03266\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ NOT\_FOUND\_INDEX\ =\ 0xFFFFFFFFu;}
\DoxyCodeLine{03267\ }
\DoxyCodeLine{03268\ \ \ \textcolor{keywordtype}{bool}\ find\_index\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ *coords,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ coord\_len,}
\DoxyCodeLine{03269\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *index)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03270\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03271\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ varRecords.len;}
\DoxyCodeLine{03272\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{03273\ \ \ \ \ \{}
\DoxyCodeLine{03274\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_feature_variation_record}{FeatureVariationRecord}}\ \&record\ =\ varRecords.arrayZ[i];}
\DoxyCodeLine{03275\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\textcolor{keyword}{this}+record.conditions).evaluate\ (coords,\ coord\_len))}
\DoxyCodeLine{03276\ \ \ \ \ \ \ \{}
\DoxyCodeLine{03277\ \ \ \ \ *index\ =\ i;}
\DoxyCodeLine{03278\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{03279\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03280\ \ \ \ \ \}}
\DoxyCodeLine{03281\ \ \ \ \ *index\ =\ NOT\_FOUND\_INDEX;}
\DoxyCodeLine{03282\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03283\ \ \ \}}
\DoxyCodeLine{03284\ }
\DoxyCodeLine{03285\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_feature}{Feature}}\ *find\_substitute\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ variations\_index,}
\DoxyCodeLine{03286\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ feature\_index)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03287\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03288\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_feature_variation_record}{FeatureVariationRecord}}\ \&record\ =\ varRecords[variations\_index];}
\DoxyCodeLine{03289\ \ \ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{this}+record.substitutions).find\_substitute\ (feature\_index);}
\DoxyCodeLine{03290\ \ \ \}}
\DoxyCodeLine{03291\ }
\DoxyCodeLine{03292\ \ \ \mbox{\hyperlink{struct_o_t_1_1_feature_variations}{FeatureVariations}}*\ copy\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03293\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03294\ \ \ \ \ TRACE\_SERIALIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03295\ \ \ \ \ return\_trace\ (c-\/>embed\ (*\textcolor{keyword}{this}));}
\DoxyCodeLine{03296\ \ \ \}}
\DoxyCodeLine{03297\ }
\DoxyCodeLine{03298\ \ \ \textcolor{keywordtype}{void}\ collect\_lookups\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *feature\_indexes,}
\DoxyCodeLine{03299\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \ \ \ \ \ \ *lookup\_indexes\ \textcolor{comment}{/*\ OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{03300\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03301\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_feature_variation_record}{FeatureVariationRecord}}\&\ r\ :\ varRecords)}
\DoxyCodeLine{03302\ \ \ \ \ \ \ r.collect\_lookups\ (\textcolor{keyword}{this},\ feature\_indexes,\ lookup\_indexes);}
\DoxyCodeLine{03303\ \ \ \}}
\DoxyCodeLine{03304\ }
\DoxyCodeLine{03305\ \ \ \textcolor{keywordtype}{void}\ closure\_features\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *lookup\_indexes,}
\DoxyCodeLine{03306\ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \ \ \ \ \ \ *feature\_indexes\ \textcolor{comment}{/*\ OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{03307\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03308\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_feature_variation_record}{FeatureVariationRecord}}\&\ record\ :\ varRecords)}
\DoxyCodeLine{03309\ \ \ \ \ \ \ record.closure\_features\ (\textcolor{keyword}{this},\ lookup\_indexes,\ feature\_indexes);}
\DoxyCodeLine{03310\ \ \ \}}
\DoxyCodeLine{03311\ }
\DoxyCodeLine{03312\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c,}
\DoxyCodeLine{03313\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__subset__layout__context__t}{hb\_subset\_layout\_context\_t}}\ *l)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03314\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03315\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03316\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>serializer-\/>start\_embed\ (*\textcolor{keyword}{this});}
\DoxyCodeLine{03317\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!out\ ||\ !c-\/>serializer-\/>extend\_min\ (out)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{03318\ }
\DoxyCodeLine{03319\ \ \ \ \ out-\/>version.major\ =\ version.major;}
\DoxyCodeLine{03320\ \ \ \ \ out-\/>version.minor\ =\ version.minor;}
\DoxyCodeLine{03321\ }
\DoxyCodeLine{03322\ \ \ \ \ \textcolor{keywordtype}{int}\ keep\_up\_to\ =\ -\/1;}
\DoxyCodeLine{03323\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ varRecords.len\ -\/\ 1;\ i\ >=\ 0;\ i-\/-\/)\ \{}
\DoxyCodeLine{03324\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (varRecords[i].intersects\_features\ (\textcolor{keyword}{this},\ l-\/>feature\_index\_map))\ \{}
\DoxyCodeLine{03325\ \ \ \ \ \ \ \ \ keep\_up\_to\ =\ i;}
\DoxyCodeLine{03326\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03327\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03328\ \ \ \ \ \}}
\DoxyCodeLine{03329\ }
\DoxyCodeLine{03330\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ count\ =\ (unsigned)\ (keep\_up\_to\ +\ 1);}
\DoxyCodeLine{03331\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ 0;\ i\ <\ count;\ i++)\ \{}
\DoxyCodeLine{03332\ \ \ \ \ \ \ subset\_record\_array\ (l,\ \&(out-\/>varRecords),\ \textcolor{keyword}{this})\ (varRecords[i]);}
\DoxyCodeLine{03333\ \ \ \ \ \}}
\DoxyCodeLine{03334\ \ \ \ \ return\_trace\ (\textcolor{keywordtype}{bool}\ (out-\/>varRecords));}
\DoxyCodeLine{03335\ \ \ \}}
\DoxyCodeLine{03336\ }
\DoxyCodeLine{03337\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03338\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03339\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03340\ \ \ \ \ return\_trace\ (version.sanitize\ (c)\ \&\&}
\DoxyCodeLine{03341\ \ \ \ \ \ \ \ \ \ \ likely\ (version.major\ ==\ 1)\ \&\&}
\DoxyCodeLine{03342\ \ \ \ \ \ \ \ \ \ \ varRecords.sanitize\ (c,\ \textcolor{keyword}{this}));}
\DoxyCodeLine{03343\ \ \ \}}
\DoxyCodeLine{03344\ }
\DoxyCodeLine{03345\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{03346\ \ \ \mbox{\hyperlink{struct_o_t_1_1_fixed_version}{FixedVersion<>}}\ \ version;\ \ \ \ \textcolor{comment}{/*\ Version-\/-\/0x00010000u\ */}}
\DoxyCodeLine{03347\ \ \ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array32Of<FeatureVariationRecord>}}}
\DoxyCodeLine{03348\ \ \ \ \ \ \ \ \ \ \ \ \ varRecords;}
\DoxyCodeLine{03349\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{03350\ \ \ DEFINE\_SIZE\_ARRAY\_SIZED\ (8,\ varRecords);}
\DoxyCodeLine{03351\ \};}
\DoxyCodeLine{03352\ }
\DoxyCodeLine{03353\ }
\DoxyCodeLine{03354\ \textcolor{comment}{/*}}
\DoxyCodeLine{03355\ \textcolor{comment}{\ *\ Device\ Tables}}
\DoxyCodeLine{03356\ \textcolor{comment}{\ */}}
\DoxyCodeLine{03357\ }
\DoxyCodeLine{03358\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_hinting_device}{HintingDevice}}}
\DoxyCodeLine{03359\ \{}
\DoxyCodeLine{03360\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_device}{Device}};}
\DoxyCodeLine{03361\ }
\DoxyCodeLine{03362\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{03363\ }
\DoxyCodeLine{03364\ \ \ hb\_position\_t\ get\_x\_delta\ (\mbox{\hyperlink{structhb__font__t}{hb\_font\_t}}\ *font)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03365\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ get\_delta\ (font-\/>x\_ppem,\ font-\/>x\_scale);\ \}}
\DoxyCodeLine{03366\ }
\DoxyCodeLine{03367\ \ \ hb\_position\_t\ get\_y\_delta\ (\mbox{\hyperlink{structhb__font__t}{hb\_font\_t}}\ *font)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03368\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ get\_delta\ (font-\/>y\_ppem,\ font-\/>y\_scale);\ \}}
\DoxyCodeLine{03369\ }
\DoxyCodeLine{03370\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{03371\ }
\DoxyCodeLine{03372\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_size\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{03373\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03374\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ f\ =\ deltaFormat;}
\DoxyCodeLine{03375\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (f\ <\ 1\ ||\ f\ >\ 3\ ||\ startSize\ >\ endSize))\ \textcolor{keywordflow}{return}\ 3\ *\ HBUINT16::static\_size;}
\DoxyCodeLine{03376\ \ \ \ \ \textcolor{keywordflow}{return}\ HBUINT16::static\_size\ *\ (4\ +\ ((endSize\ -\/\ startSize)\ >>\ (4\ -\/\ f)));}
\DoxyCodeLine{03377\ \ \ \}}
\DoxyCodeLine{03378\ }
\DoxyCodeLine{03379\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03380\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03381\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03382\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this})\ \&\&\ c-\/>check\_range\ (\textcolor{keyword}{this},\ this-\/>get\_size\ ()));}
\DoxyCodeLine{03383\ \ \ \}}
\DoxyCodeLine{03384\ }
\DoxyCodeLine{03385\ \ \ \mbox{\hyperlink{struct_o_t_1_1_hinting_device}{HintingDevice}}*\ copy\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03386\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03387\ \ \ \ \ TRACE\_SERIALIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03388\ \ \ \ \ return\_trace\ (c-\/>embed<\mbox{\hyperlink{struct_o_t_1_1_hinting_device}{HintingDevice}}>\ (\textcolor{keyword}{this}));}
\DoxyCodeLine{03389\ \ \ \}}
\DoxyCodeLine{03390\ }
\DoxyCodeLine{03391\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{03392\ }
\DoxyCodeLine{03393\ \ \ \textcolor{keywordtype}{int}\ get\_delta\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ppem,\ \textcolor{keywordtype}{int}\ scale)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03394\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03395\ \ \ \ \ \textcolor{keywordflow}{if}\ (!ppem)\ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{03396\ }
\DoxyCodeLine{03397\ \ \ \ \ \textcolor{keywordtype}{int}\ pixels\ =\ get\_delta\_pixels\ (ppem);}
\DoxyCodeLine{03398\ }
\DoxyCodeLine{03399\ \ \ \ \ \textcolor{keywordflow}{if}\ (!pixels)\ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{03400\ }
\DoxyCodeLine{03401\ \ \ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keywordtype}{int})\ (pixels\ *\ (int64\_t)\ scale\ /\ ppem);}
\DoxyCodeLine{03402\ \ \ \}}
\DoxyCodeLine{03403\ \ \ \textcolor{keywordtype}{int}\ get\_delta\_pixels\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ppem\_size)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03404\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03405\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ f\ =\ deltaFormat;}
\DoxyCodeLine{03406\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (f\ <\ 1\ ||\ f\ >\ 3))}
\DoxyCodeLine{03407\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{03408\ }
\DoxyCodeLine{03409\ \ \ \ \ \textcolor{keywordflow}{if}\ (ppem\_size\ <\ startSize\ ||\ ppem\_size\ >\ endSize)}
\DoxyCodeLine{03410\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{03411\ }
\DoxyCodeLine{03412\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ s\ =\ ppem\_size\ -\/\ startSize;}
\DoxyCodeLine{03413\ }
\DoxyCodeLine{03414\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \textcolor{keywordtype}{byte}\ =\ deltaValueZ[s\ >>\ (4\ -\/\ f)];}
\DoxyCodeLine{03415\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ bits\ =\ (\textcolor{keywordtype}{byte}\ >>\ (16\ -\/\ (((s\ \&\ ((1\ <<\ (4\ -\/\ f))\ -\/\ 1))\ +\ 1)\ <<\ f)));}
\DoxyCodeLine{03416\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ mask\ =\ (0xFFFFu\ >>\ (16\ -\/\ (1\ <<\ f)));}
\DoxyCodeLine{03417\ }
\DoxyCodeLine{03418\ \ \ \ \ \textcolor{keywordtype}{int}\ delta\ =\ bits\ \&\ mask;}
\DoxyCodeLine{03419\ }
\DoxyCodeLine{03420\ \ \ \ \ \textcolor{keywordflow}{if}\ ((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int})\ delta\ >=\ ((mask\ +\ 1)\ >>\ 1))}
\DoxyCodeLine{03421\ \ \ \ \ \ \ delta\ -\/=\ mask\ +\ 1;}
\DoxyCodeLine{03422\ }
\DoxyCodeLine{03423\ \ \ \ \ \textcolor{keywordflow}{return}\ delta;}
\DoxyCodeLine{03424\ \ \ \}}
\DoxyCodeLine{03425\ }
\DoxyCodeLine{03426\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{03427\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ startSize;\ \ \ \ \ \ \textcolor{comment}{/*\ Smallest\ size\ to\ correct-\/-\/in\ ppem\ */}}
\DoxyCodeLine{03428\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ endSize;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Largest\ size\ to\ correct-\/-\/in\ ppem\ */}}
\DoxyCodeLine{03429\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ deltaFormat;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Format\ of\ DeltaValue\ array\ data:\ 1,\ 2,\ or\ 3}}
\DoxyCodeLine{03430\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ 1\ \ \ \ Signed\ 2-\/bit\ value,\ 8\ values\ per\ uint16}}
\DoxyCodeLine{03431\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ 2\ \ \ \ Signed\ 4-\/bit\ value,\ 4\ values\ per\ uint16}}
\DoxyCodeLine{03432\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ 3\ \ \ \ Signed\ 8-\/bit\ value,\ 2\ values\ per\ uint16}}
\DoxyCodeLine{03433\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{03434\ \ \ \mbox{\hyperlink{struct_o_t_1_1_unsized_array_of}{UnsizedArrayOf<HBUINT16>}}}
\DoxyCodeLine{03435\ \ \ \ \ \ \ \ \ deltaValueZ;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Array\ of\ compressed\ data\ */}}
\DoxyCodeLine{03436\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{03437\ \ \ DEFINE\_SIZE\_ARRAY\ (6,\ deltaValueZ);}
\DoxyCodeLine{03438\ \};}
\DoxyCodeLine{03439\ }
\DoxyCodeLine{03440\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_variation_device}{VariationDevice}}}
\DoxyCodeLine{03441\ \{}
\DoxyCodeLine{03442\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_device}{Device}};}
\DoxyCodeLine{03443\ }
\DoxyCodeLine{03444\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{03445\ }
\DoxyCodeLine{03446\ \ \ hb\_position\_t\ get\_x\_delta\ (\mbox{\hyperlink{structhb__font__t}{hb\_font\_t}}\ *font,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_variation_store}{VariationStore}}\ \&store)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03447\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ font-\/>em\_scalef\_x\ (get\_delta\ (font,\ store));\ \}}
\DoxyCodeLine{03448\ }
\DoxyCodeLine{03449\ \ \ hb\_position\_t\ get\_y\_delta\ (\mbox{\hyperlink{structhb__font__t}{hb\_font\_t}}\ *font,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_variation_store}{VariationStore}}\ \&store)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03450\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ font-\/>em\_scalef\_y\ (get\_delta\ (font,\ store));\ \}}
\DoxyCodeLine{03451\ }
\DoxyCodeLine{03452\ \ \ \mbox{\hyperlink{struct_o_t_1_1_variation_device}{VariationDevice}}*\ copy\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *layout\_variation\_idx\_map)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03453\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03454\ \ \ \ \ TRACE\_SERIALIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03455\ \ \ \ \ \textcolor{keyword}{auto}\ snap\ =\ c-\/>snapshot\ ();}
\DoxyCodeLine{03456\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>embed\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03457\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!out))\ return\_trace\ (\textcolor{keyword}{nullptr});}
\DoxyCodeLine{03458\ \ \ \ \ \textcolor{keywordflow}{if}\ (!layout\_variation\_idx\_map\ ||\ layout\_variation\_idx\_map-\/>is\_empty\ ())\ return\_trace\ (out);}
\DoxyCodeLine{03459\ }
\DoxyCodeLine{03460\ \ \ \ \ \textcolor{comment}{/*\ TODO\ Just\ get()\ and\ bail\ if\ NO\_VARIATION.\ Needs\ to\ setup\ the\ map\ to\ return\ that.\ */}}
\DoxyCodeLine{03461\ \ \ \ \ \textcolor{keywordflow}{if}\ (!layout\_variation\_idx\_map-\/>has\ (varIdx))}
\DoxyCodeLine{03462\ \ \ \ \ \{}
\DoxyCodeLine{03463\ \ \ \ \ \ \ c-\/>revert\ (snap);}
\DoxyCodeLine{03464\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{nullptr});}
\DoxyCodeLine{03465\ \ \ \ \ \}}
\DoxyCodeLine{03466\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ new\_idx\ =\ layout\_variation\_idx\_map-\/>get\ (varIdx);}
\DoxyCodeLine{03467\ \ \ \ \ out-\/>varIdx\ =\ new\_idx;}
\DoxyCodeLine{03468\ \ \ \ \ return\_trace\ (out);}
\DoxyCodeLine{03469\ \ \ \}}
\DoxyCodeLine{03470\ }
\DoxyCodeLine{03471\ \ \ \textcolor{keywordtype}{void}\ record\_variation\_index\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *layout\_variation\_indices)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03472\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03473\ \ \ \ \ layout\_variation\_indices-\/>add\ (varIdx);}
\DoxyCodeLine{03474\ \ \ \}}
\DoxyCodeLine{03475\ }
\DoxyCodeLine{03476\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03477\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03478\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03479\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this}));}
\DoxyCodeLine{03480\ \ \ \}}
\DoxyCodeLine{03481\ }
\DoxyCodeLine{03482\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{03483\ }
\DoxyCodeLine{03484\ \ \ \textcolor{keywordtype}{float}\ get\_delta\ (\mbox{\hyperlink{structhb__font__t}{hb\_font\_t}}\ *font,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_variation_store}{VariationStore}}\ \&store)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03485\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03486\ \ \ \ \ \textcolor{keywordflow}{return}\ store.get\_delta\ (varIdx,\ font-\/>coords,\ font-\/>num\_coords);}
\DoxyCodeLine{03487\ \ \ \}}
\DoxyCodeLine{03488\ }
\DoxyCodeLine{03489\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{03490\ \ \ \mbox{\hyperlink{struct_o_t_1_1_var_idx}{VarIdx}}\ \ varIdx;}
\DoxyCodeLine{03491\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ deltaFormat;\ \ \ \ \textcolor{comment}{/*\ Format\ identifier\ for\ this\ table:\ 0x0x8000\ */}}
\DoxyCodeLine{03492\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{03493\ \ \ DEFINE\_SIZE\_STATIC\ (6);}
\DoxyCodeLine{03494\ \};}
\DoxyCodeLine{03495\ }
\DoxyCodeLine{03496\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_device_header}{DeviceHeader}}}
\DoxyCodeLine{03497\ \{}
\DoxyCodeLine{03498\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{03499\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ \ \ \ \ reserved1;}
\DoxyCodeLine{03500\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ \ \ \ \ reserved2;}
\DoxyCodeLine{03501\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{03502\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ \ \ \ \ format;\ \ \ \ \ \textcolor{comment}{/*\ Format\ identifier\ */}}
\DoxyCodeLine{03503\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{03504\ \ \ DEFINE\_SIZE\_STATIC\ (6);}
\DoxyCodeLine{03505\ \};}
\DoxyCodeLine{03506\ }
\DoxyCodeLine{03507\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_device}{Device}}}
\DoxyCodeLine{03508\ \{}
\DoxyCodeLine{03509\ \ \ hb\_position\_t\ get\_x\_delta\ (\mbox{\hyperlink{structhb__font__t}{hb\_font\_t}}\ *font,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_variation_store}{VariationStore}}\ \&store=\mbox{\hyperlink{struct_null}{Null}}\ (\mbox{\hyperlink{struct_o_t_1_1_variation_store}{VariationStore}}))\textcolor{keyword}{\ const}}
\DoxyCodeLine{03510\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03511\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.b.format)}
\DoxyCodeLine{03512\ \ \ \ \ \{}
\DoxyCodeLine{03513\ \textcolor{preprocessor}{\#ifndef\ HB\_NO\_HINTING}}
\DoxyCodeLine{03514\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \textcolor{keywordflow}{case}\ 2:\ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{03515\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ u.hinting.get\_x\_delta\ (font);}
\DoxyCodeLine{03516\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03517\ \textcolor{preprocessor}{\#ifndef\ HB\_NO\_VAR}}
\DoxyCodeLine{03518\ \ \ \ \ \textcolor{keywordflow}{case}\ 0x8000:}
\DoxyCodeLine{03519\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ u.variation.get\_x\_delta\ (font,\ store);}
\DoxyCodeLine{03520\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03521\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{03522\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{03523\ \ \ \ \ \}}
\DoxyCodeLine{03524\ \ \ \}}
\DoxyCodeLine{03525\ \ \ hb\_position\_t\ get\_y\_delta\ (\mbox{\hyperlink{structhb__font__t}{hb\_font\_t}}\ *font,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_variation_store}{VariationStore}}\ \&store=\mbox{\hyperlink{struct_null}{Null}}\ (\mbox{\hyperlink{struct_o_t_1_1_variation_store}{VariationStore}}))\textcolor{keyword}{\ const}}
\DoxyCodeLine{03526\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03527\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.b.format)}
\DoxyCodeLine{03528\ \ \ \ \ \{}
\DoxyCodeLine{03529\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \textcolor{keywordflow}{case}\ 2:\ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{03530\ \textcolor{preprocessor}{\#ifndef\ HB\_NO\_HINTING}}
\DoxyCodeLine{03531\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ u.hinting.get\_y\_delta\ (font);}
\DoxyCodeLine{03532\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03533\ \textcolor{preprocessor}{\#ifndef\ HB\_NO\_VAR}}
\DoxyCodeLine{03534\ \ \ \ \ \textcolor{keywordflow}{case}\ 0x8000:}
\DoxyCodeLine{03535\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ u.variation.get\_y\_delta\ (font,\ store);}
\DoxyCodeLine{03536\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03537\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{03538\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{03539\ \ \ \ \ \}}
\DoxyCodeLine{03540\ \ \ \}}
\DoxyCodeLine{03541\ }
\DoxyCodeLine{03542\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03543\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03544\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03545\ \ \ \ \ \textcolor{keywordflow}{if}\ (!u.b.format.sanitize\ (c))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{03546\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.b.format)\ \{}
\DoxyCodeLine{03547\ \textcolor{preprocessor}{\#ifndef\ HB\_NO\_HINTING}}
\DoxyCodeLine{03548\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \textcolor{keywordflow}{case}\ 2:\ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{03549\ \ \ \ \ \ \ return\_trace\ (u.hinting.sanitize\ (c));}
\DoxyCodeLine{03550\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03551\ \textcolor{preprocessor}{\#ifndef\ HB\_NO\_VAR}}
\DoxyCodeLine{03552\ \ \ \ \ \textcolor{keywordflow}{case}\ 0x8000:}
\DoxyCodeLine{03553\ \ \ \ \ \ \ return\_trace\ (u.variation.sanitize\ (c));}
\DoxyCodeLine{03554\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03555\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{03556\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{03557\ \ \ \ \ \}}
\DoxyCodeLine{03558\ \ \ \}}
\DoxyCodeLine{03559\ }
\DoxyCodeLine{03560\ \ \ \mbox{\hyperlink{struct_o_t_1_1_device}{Device}}*\ copy\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *layout\_variation\_idx\_map=\textcolor{keyword}{nullptr})\textcolor{keyword}{\ const}}
\DoxyCodeLine{03561\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03562\ \ \ \ \ TRACE\_SERIALIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03563\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.b.format)\ \{}
\DoxyCodeLine{03564\ \textcolor{preprocessor}{\#ifndef\ HB\_NO\_HINTING}}
\DoxyCodeLine{03565\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{03566\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{03567\ \ \ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{03568\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{reinterpret\_cast<}\mbox{\hyperlink{struct_o_t_1_1_device}{Device}}\ *\textcolor{keyword}{>}\ (u.hinting.copy\ (c)));}
\DoxyCodeLine{03569\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03570\ \textcolor{preprocessor}{\#ifndef\ HB\_NO\_VAR}}
\DoxyCodeLine{03571\ \ \ \ \ \textcolor{keywordflow}{case}\ 0x8000:}
\DoxyCodeLine{03572\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{reinterpret\_cast<}\mbox{\hyperlink{struct_o_t_1_1_device}{Device}}\ *\textcolor{keyword}{>}\ (u.variation.copy\ (c,\ layout\_variation\_idx\_map)));}
\DoxyCodeLine{03573\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03574\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{03575\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{nullptr});}
\DoxyCodeLine{03576\ \ \ \ \ \}}
\DoxyCodeLine{03577\ \ \ \}}
\DoxyCodeLine{03578\ }
\DoxyCodeLine{03579\ \ \ \textcolor{keywordtype}{void}\ collect\_variation\_indices\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *layout\_variation\_indices)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03580\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03581\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.b.format)\ \{}
\DoxyCodeLine{03582\ \textcolor{preprocessor}{\#ifndef\ HB\_NO\_HINTING}}
\DoxyCodeLine{03583\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{03584\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{03585\ \ \ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{03586\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{03587\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03588\ \textcolor{preprocessor}{\#ifndef\ HB\_NO\_VAR}}
\DoxyCodeLine{03589\ \ \ \ \ \textcolor{keywordflow}{case}\ 0x8000:}
\DoxyCodeLine{03590\ \ \ \ \ \ \ u.variation.record\_variation\_index\ (layout\_variation\_indices);}
\DoxyCodeLine{03591\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{03592\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03593\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{03594\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{03595\ \ \ \ \ \}}
\DoxyCodeLine{03596\ \ \ \}}
\DoxyCodeLine{03597\ }
\DoxyCodeLine{03598\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{03599\ \ \ \textcolor{keyword}{union\ }\{}
\DoxyCodeLine{03600\ \ \ \mbox{\hyperlink{struct_o_t_1_1_device_header}{DeviceHeader}}\ \ \ \ \ \ b;}
\DoxyCodeLine{03601\ \ \ \mbox{\hyperlink{struct_o_t_1_1_hinting_device}{HintingDevice}}\ \ \ \ \ \ \ \ hinting;}
\DoxyCodeLine{03602\ \textcolor{preprocessor}{\#ifndef\ HB\_NO\_VAR}}
\DoxyCodeLine{03603\ \ \ \mbox{\hyperlink{struct_o_t_1_1_variation_device}{VariationDevice}}\ \ \ \ variation;}
\DoxyCodeLine{03604\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03605\ \ \ \}\ u;}
\DoxyCodeLine{03606\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{03607\ \ \ DEFINE\_SIZE\_UNION\ (6,\ b);}
\DoxyCodeLine{03608\ \};}
\DoxyCodeLine{03609\ }
\DoxyCodeLine{03610\ }
\DoxyCodeLine{03611\ \}\ \textcolor{comment}{/*\ namespace\ OT\ */}}
\DoxyCodeLine{03612\ }
\DoxyCodeLine{03613\ }
\DoxyCodeLine{03614\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*\ HB\_OT\_LAYOUT\_COMMON\_HH\ */}\textcolor{preprocessor}{}}

\end{DoxyCode}

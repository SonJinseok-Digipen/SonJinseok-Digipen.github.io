Most of the time you will not need any custom configuration. The configuration options provided by {\ttfamily meson} should be enough. In particular, if you just want Harf\+Buzz library plus hb-\/shape / hb-\/view utilities, make sure Free\+Type and Cairo are available and found during configuration.

If you are building for distribution, you should more carefully consider whether you need Glib, ICU, Graphite2, as well as Core\+Text / Uniscribe / DWrite. Make sure the relevant ones are enabled.

If you are building for custom environment (embedded, downloadable app, etc) where you mostly just want to call {\ttfamily hb\+\_\+shape()} and the binary size of the resulting library is very important to you, the rest of this file guides you through your options to disable features you may not need, in exchange for binary size savings.\hypertarget{md__ase_sprite_aseprite_third_party_harfbuzz__c_o_n_f_i_g_autotoc_md1394}{}\doxysection{Compiler Options}\label{md__ase_sprite_aseprite_third_party_harfbuzz__c_o_n_f_i_g_autotoc_md1394}
Make sure you build with your compiler\textquotesingle{}s \char`\"{}optimize for size\char`\"{} option. On {\ttfamily gcc} this is {\ttfamily -\/Os}, and can be enabled by passing {\ttfamily CXXFLAGS=-\/Os}. On clang there is an even more extreme flag, {\ttfamily -\/Oz}. Meson also provides {\ttfamily -\/-\/buildtype=minsize} for more convenience.

Harf\+Buzz heavily uses inline functions and the optimize-\/size flag can make the library smaller by 20\% or more. Moreover, sometimes, based on the target CPU, the optimize-\/size builds perform {\itshape faster} as well, thanks to lower code footprint and caching effects. So, definitely try that even if size is not extremely tight but you have a huge application. For example, Chrome does that. Note that this configuration also automatically enables certain internal optimizations. Search for {\ttfamily HB\+\_\+\+OPTIMIZE\+\_\+\+SIZE} for details, if you are using other compilers, or continue reading.

Another compiler option to consider is \char`\"{}link-\/time optimization\char`\"{}, also known as \textquotesingle{}lto\textquotesingle{}. To enable that, feel free to use {\ttfamily -\/Db\+\_\+lto=true} of meson. This, also, can have a huge impact on the final size, 20\% or more.

Finally, if you are making a static library build or otherwise linking the library into your app, make sure your linker removes unused functions. This can be tricky and differ from environment to environment, but you definitely want to make sure this happens. Otherwise, every unused public function will be adding unneeded bytes to your binary. The following pointers might come handy\+:


\begin{DoxyItemize}
\item \href{https://lwn.net/Articles/741494/}{\texttt{ https\+://lwn.\+net/\+Articles/741494/}} (all of the four-\/part series)
\item \href{https://elinux.org/images/2/2d/ELC2010-gc-sections_Denys_Vlasenko.pdf}{\texttt{ https\+://elinux.\+org/images/2/2d/\+ELC2010-\/gc-\/sections\+\_\+\+Denys\+\_\+\+Vlasenko.\+pdf}}
\end{DoxyItemize}

Combining the above three build options should already shrink your library a lot. The rest of this file shows you ways to shrink the library even further at the expense of removing functionality (that may not be needed). The remaining options are all enabled by defining pre-\/processor macros, which can be done via {\ttfamily CXXFLAGS} or {\ttfamily CPPFLAGS} similarly.\hypertarget{md__ase_sprite_aseprite_third_party_harfbuzz__c_o_n_f_i_g_autotoc_md1395}{}\doxysection{Unicode-\/functions}\label{md__ase_sprite_aseprite_third_party_harfbuzz__c_o_n_f_i_g_autotoc_md1395}
Access to Unicode data can be configured at compile time as well as run-\/time. By default, Harf\+Buzz ships with its own compact subset of properties from Unicode Character Database that it needs. This is a highly-\/optimized implementation that depending on compile settings (optimize-\/size or not) takes around $\sim$40kb or $\sim$60kb. Using this implementation (default) is highly recommended, as Harf\+Buzz always ships with data from latest version of Unicode. This implementation can be disabled by defining {\ttfamily HB\+\_\+\+NO\+\_\+\+UCD}.

For example, if you are enabling ICU as a built-\/in option, or GLib, those can provide Unicode data as well, so defining {\ttfamily HB\+\_\+\+NO\+\_\+\+UCD} might save you space without reducing functionality (to the extent that the Unicode version of those implementations is recent.)

If, however, you provide your own Unicode data to Harf\+Buzz at run-\/time by calling {\ttfamily hb\+\_\+buffer\+\_\+set\+\_\+unicode\+\_\+funcs} on every buffer you create, and you do not rely on {\ttfamily hb\+\_\+unicode\+\_\+funcs\+\_\+get\+\_\+default()} results, you can disable the internal implementation by defining both {\ttfamily HB\+\_\+\+NO\+\_\+\+UCD} and {\ttfamily HB\+\_\+\+NO\+\_\+\+UNICODE\+\_\+\+FUNCS}. The latter is needed to guard against accidentally building a library without any default Unicode implementations.\hypertarget{md__ase_sprite_aseprite_third_party_harfbuzz__c_o_n_f_i_g_autotoc_md1396}{}\doxysection{Font-\/functions}\label{md__ase_sprite_aseprite_third_party_harfbuzz__c_o_n_f_i_g_autotoc_md1396}
Access to certain font functionalities can also be configured at run-\/time. By default, Harf\+Buzz uses an efficient internal implementation of Open\+Type functionality for this. This internal implementation is called {\ttfamily hb-\/ot-\/font}. All newly-\/created {\ttfamily \mbox{\hyperlink{structhb__font__t}{hb\+\_\+font\+\_\+t}}} objects by default use {\ttfamily hb-\/ot-\/font}. Using this is highly recommended, and is what fonts use by default when they are created.

Most embedded uses will probably use Harf\+Buzz with Free\+Type using {\ttfamily \mbox{\hyperlink{hb-ft_8h_source}{hb-\/ft.\+h}}}. In that case, or if you otherwise provide those functions by calling {\ttfamily hb\+\_\+font\+\_\+set\+\_\+funcs()} on every font you create, you can disable {\ttfamily hb-\/ot-\/font} without loss of functionality by defining {\ttfamily HB\+\_\+\+NO\+\_\+\+OT\+\_\+\+FONT}.\hypertarget{md__ase_sprite_aseprite_third_party_harfbuzz__c_o_n_f_i_g_autotoc_md1397}{}\doxysection{Shapers}\label{md__ase_sprite_aseprite_third_party_harfbuzz__c_o_n_f_i_g_autotoc_md1397}
Most Harf\+Buzz clients use it for the main shaper, called \char`\"{}ot\char`\"{}. However, it is legitimate to want to compile Harf\+Buzz with only another backend, eg. Core\+Text, for example for an i\+OS app. For that, you want {\ttfamily HB\+\_\+\+NO\+\_\+\+OT\+\_\+\+SHAPE}. If you are going down that route, check if you want {\ttfamily HB\+\_\+\+NO\+\_\+\+OT}.

This is very rarely what you need. Make sure you understand exactly what you are doing.

Defining {\ttfamily HB\+\_\+\+NO\+\_\+\+FALLBACK\+\_\+\+SHAPE} however is pretty harmless. That removes the (unused) \char`\"{}fallback\char`\"{} shaper.\hypertarget{md__ase_sprite_aseprite_third_party_harfbuzz__c_o_n_f_i_g_autotoc_md1398}{}\doxysection{Thread-\/safety}\label{md__ase_sprite_aseprite_third_party_harfbuzz__c_o_n_f_i_g_autotoc_md1398}
By default Harf\+Buzz builds as a thread-\/safe library. The exception is that the {\ttfamily HB\+\_\+\+TINY} predefined configuring (more below) disables thread-\/safety.

If you do {\itshape not} need thread-\/safety in the library (eg. you always call into Harf\+Buzz from the same thread), you can disable thread-\/safety by defining {\ttfamily HB\+\_\+\+NO\+\_\+\+MT}. As noted already, this is enabled by {\ttfamily HB\+\_\+\+TINY}.\hypertarget{md__ase_sprite_aseprite_third_party_harfbuzz__c_o_n_f_i_g_autotoc_md1399}{}\doxysection{Pre-\/defined configurations}\label{md__ase_sprite_aseprite_third_party_harfbuzz__c_o_n_f_i_g_autotoc_md1399}
The \href{src/hb-config.hh}{\texttt{ {\ttfamily hb-\/config.\+hh}}} internal header supports three pre-\/defined configurations as well grouping of various configuration options. The pre-\/defined configurations are\+:


\begin{DoxyItemize}
\item {\ttfamily HB\+\_\+\+MINI}\+: Disables shaping of AAT as well as legacy fonts. Ie. it produces a capable Open\+Type shaper only.
\item {\ttfamily HB\+\_\+\+LEAN}\+: Disables various non-\/shaping functionality in the library, as well as esoteric or rarely-\/used shaping features. See the definition for details.
\item {\ttfamily HB\+\_\+\+TINY}\+: Enables both {\ttfamily HB\+\_\+\+MINI} and {\ttfamily HB\+\_\+\+LEAN} configurations, as well as disabling thread-\/safety and debugging, and use even more size-\/optimized data tables.
\end{DoxyItemize}\hypertarget{md__ase_sprite_aseprite_third_party_harfbuzz__c_o_n_f_i_g_autotoc_md1400}{}\doxysection{Tailoring configuration}\label{md__ase_sprite_aseprite_third_party_harfbuzz__c_o_n_f_i_g_autotoc_md1400}
Most of the time, one of the pre-\/defined configuration is exactly what one needs. Sometimes, however, the pre-\/defined configuration cuts out features that might be desired in the library. Unfortunately there is no quick way to undo those configurations from the command-\/line.

However, configuration can still be overridden from a file. To do that, add your override instructions (mostly {\ttfamily undef} instructions) to a header file and define the macro {\ttfamily HB\+\_\+\+CONFIG\+\_\+\+OVERRIDE\+\_\+H} to the string containing to that header file\textquotesingle{}s name. Harf\+Buzz will then include that file at appropriate right place during configuration.

Up until Harf\+Buzz 3.\+1.\+2 the the configuration override header file\textquotesingle{}s name was fixed and called {\ttfamily config-\/override.\+h}, and was activated by defining the macro {\ttfamily HAVE\+\_\+\+CONFIG\+\_\+\+OVERRIDE\+\_\+H}. That still works.\hypertarget{md__ase_sprite_aseprite_third_party_harfbuzz__c_o_n_f_i_g_autotoc_md1401}{}\doxysection{Notes}\label{md__ase_sprite_aseprite_third_party_harfbuzz__c_o_n_f_i_g_autotoc_md1401}
Note that the config option {\ttfamily HB\+\_\+\+NO\+\_\+\+CFF}, which is enabled by {\ttfamily HB\+\_\+\+LEAN} and {\ttfamily HB\+\_\+\+TINY} does {\itshape not} mean that the resulting library won\textquotesingle{}t work with CFF fonts. The library can shape valid CFF fonts just fine, with or without this option. This option disables (among other things) the code to calculate glyph extents for CFF fonts. 
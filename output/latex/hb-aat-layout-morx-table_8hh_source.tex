\hypertarget{hb-aat-layout-morx-table_8hh_source}{}\doxysection{hb-\/aat-\/layout-\/morx-\/table.hh}
\label{hb-aat-layout-morx-table_8hh_source}\index{AseSprite/aseprite/third\_party/harfbuzz/src/hb-\/aat-\/layout-\/morx-\/table.hh@{AseSprite/aseprite/third\_party/harfbuzz/src/hb-\/aat-\/layout-\/morx-\/table.hh}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ *\ Copyright\ Â©\ 2017\ \ Google,\ Inc.}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ *\ \ This\ is\ part\ of\ HarfBuzz,\ a\ text\ shaping\ library.}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ *\ Permission\ is\ hereby\ granted,\ without\ written\ agreement\ and\ without}}
\DoxyCodeLine{00007\ \textcolor{comment}{\ *\ license\ or\ royalty\ fees,\ to\ use,\ copy,\ modify,\ and\ distribute\ this}}
\DoxyCodeLine{00008\ \textcolor{comment}{\ *\ software\ and\ its\ documentation\ for\ any\ purpose,\ provided\ that\ the}}
\DoxyCodeLine{00009\ \textcolor{comment}{\ *\ above\ copyright\ notice\ and\ the\ following\ two\ paragraphs\ appear\ in}}
\DoxyCodeLine{00010\ \textcolor{comment}{\ *\ all\ copies\ of\ this\ software.}}
\DoxyCodeLine{00011\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00012\ \textcolor{comment}{\ *\ IN\ NO\ EVENT\ SHALL\ THE\ COPYRIGHT\ HOLDER\ BE\ LIABLE\ TO\ ANY\ PARTY\ FOR}}
\DoxyCodeLine{00013\ \textcolor{comment}{\ *\ DIRECT,\ INDIRECT,\ SPECIAL,\ INCIDENTAL,\ OR\ CONSEQUENTIAL\ DAMAGES}}
\DoxyCodeLine{00014\ \textcolor{comment}{\ *\ ARISING\ OUT\ OF\ THE\ USE\ OF\ THIS\ SOFTWARE\ AND\ ITS\ DOCUMENTATION,\ EVEN}}
\DoxyCodeLine{00015\ \textcolor{comment}{\ *\ IF\ THE\ COPYRIGHT\ HOLDER\ HAS\ BEEN\ ADVISED\ OF\ THE\ POSSIBILITY\ OF\ SUCH}}
\DoxyCodeLine{00016\ \textcolor{comment}{\ *\ DAMAGE.}}
\DoxyCodeLine{00017\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00018\ \textcolor{comment}{\ *\ THE\ COPYRIGHT\ HOLDER\ SPECIFICALLY\ DISCLAIMS\ ANY\ WARRANTIES,\ INCLUDING,}}
\DoxyCodeLine{00019\ \textcolor{comment}{\ *\ BUT\ NOT\ LIMITED\ TO,\ THE\ IMPLIED\ WARRANTIES\ OF\ MERCHANTABILITY\ AND}}
\DoxyCodeLine{00020\ \textcolor{comment}{\ *\ FITNESS\ FOR\ A\ PARTICULAR\ PURPOSE.\ \ THE\ SOFTWARE\ PROVIDED\ HEREUNDER\ IS}}
\DoxyCodeLine{00021\ \textcolor{comment}{\ *\ ON\ AN\ "{}AS\ IS"{}\ BASIS,\ AND\ THE\ COPYRIGHT\ HOLDER\ HAS\ NO\ OBLIGATION\ TO}}
\DoxyCodeLine{00022\ \textcolor{comment}{\ *\ PROVIDE\ MAINTENANCE,\ SUPPORT,\ UPDATES,\ ENHANCEMENTS,\ OR\ MODIFICATIONS.}}
\DoxyCodeLine{00023\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00024\ \textcolor{comment}{\ *\ Google\ Author(s):\ Behdad\ Esfahbod}}
\DoxyCodeLine{00025\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#ifndef\ HB\_AAT\_LAYOUT\_MORX\_TABLE\_HH}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#define\ HB\_AAT\_LAYOUT\_MORX\_TABLE\_HH}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#include\ "{}hb-\/open-\/type.hh"{}}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#include\ "{}hb-\/aat-\/layout-\/common.hh"{}}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#include\ "{}hb-\/ot-\/layout-\/common.hh"{}}}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#include\ "{}hb-\/ot-\/layout-\/gdef-\/table.hh"{}}}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#include\ "{}hb-\/aat-\/map.hh"{}}}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \textcolor{comment}{/*}}
\DoxyCodeLine{00037\ \textcolor{comment}{\ *\ morx\ -\/-\/\ Extended\ Glyph\ Metamorphosis}}
\DoxyCodeLine{00038\ \textcolor{comment}{\ *\ https://developer.apple.com/fonts/TrueType-\/Reference-\/Manual/RM06/Chap6morx.html}}
\DoxyCodeLine{00039\ \textcolor{comment}{\ *\ https://developer.apple.com/fonts/TrueType-\/Reference-\/Manual/RM06/Chap6mort.html}}
\DoxyCodeLine{00040\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00041\ \textcolor{preprocessor}{\#define\ HB\_AAT\_TAG\_morx\ HB\_TAG('m','o','r','x')}}
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\#define\ HB\_AAT\_TAG\_mort\ HB\_TAG('m','o','r','t')}}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \textcolor{keyword}{namespace\ }AAT\ \{}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \textcolor{keyword}{using\ namespace\ }OT;}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Types>}
\DoxyCodeLine{00050\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_a_a_t_1_1_rearrangement_subtable}{RearrangementSubtable}}}
\DoxyCodeLine{00051\ \{}
\DoxyCodeLine{00052\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Types::HBUINT\ HBUINT;}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{void}\ EntryData;}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_a_a_t_1_1_rearrangement_subtable_1_1driver__context__t}{driver\_context\_t}}}
\DoxyCodeLine{00057\ \ \ \{}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{bool}\ in\_place\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keyword}{enum}\ Flags}
\DoxyCodeLine{00060\ \ \ \ \ \{}
\DoxyCodeLine{00061\ \ \ \ \ \ \ MarkFirst\ \ \ \ \ =\ 0x8000,\ \ \ \textcolor{comment}{/*\ If\ set,\ make\ the\ current\ glyph\ the\ first}}
\DoxyCodeLine{00062\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ glyph\ to\ be\ rearranged.\ */}}
\DoxyCodeLine{00063\ \ \ \ \ \ \ DontAdvance\ \ \ =\ 0x4000,\ \ \ \textcolor{comment}{/*\ If\ set,\ don't\ advance\ to\ the\ next\ glyph}}
\DoxyCodeLine{00064\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ before\ going\ to\ the\ new\ state.\ This\ means}}
\DoxyCodeLine{00065\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ that\ the\ glyph\ index\ doesn't\ change,\ even}}
\DoxyCodeLine{00066\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ if\ the\ glyph\ at\ that\ index\ has\ changed.\ */}}
\DoxyCodeLine{00067\ \ \ \ \ \ \ MarkLast\ \ \ \ \ \ =\ 0x2000,\ \ \ \textcolor{comment}{/*\ If\ set,\ make\ the\ current\ glyph\ the\ last}}
\DoxyCodeLine{00068\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ glyph\ to\ be\ rearranged.\ */}}
\DoxyCodeLine{00069\ \ \ \ \ \ \ Reserved\ \ \ \ \ \ =\ 0x1FF0,\ \ \ \textcolor{comment}{/*\ These\ bits\ are\ reserved\ and\ should\ be\ set\ to\ 0.\ */}}
\DoxyCodeLine{00070\ \ \ \ \ \ \ Verb\ \ \ \ \ \ =\ 0x000F,\ \ \ \textcolor{comment}{/*\ The\ type\ of\ rearrangement\ specified.\ */}}
\DoxyCodeLine{00071\ \ \ \ \ \};}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ \ \ \mbox{\hyperlink{struct_a_a_t_1_1_rearrangement_subtable_1_1driver__context__t}{driver\_context\_t}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_a_a_t_1_1_rearrangement_subtable}{RearrangementSubtable}}\ *table\ HB\_UNUSED)\ :}
\DoxyCodeLine{00074\ \ \ \ \ ret\ (\textcolor{keyword}{false}),}
\DoxyCodeLine{00075\ \ \ \ \ start\ (0),\ end\ (0)\ \{\}}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{keywordtype}{bool}\ is\_actionable\ (\mbox{\hyperlink{struct_a_a_t_1_1_state_table_driver}{StateTableDriver<Types,\ EntryData>}}\ *driver\ HB\_UNUSED,}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_a_a_t_1_1_entry}{Entry<EntryData>}}\ \&\mbox{\hyperlink{structentry}{entry}})}
\DoxyCodeLine{00079\ \ \ \ \ \{}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{structentry}{entry}}.flags\ \&\ Verb)\ \&\&\ start\ <\ end;}
\DoxyCodeLine{00081\ \ \ \ \ \}}
\DoxyCodeLine{00082\ \ \ \ \ \textcolor{keywordtype}{void}\ transition\ (\mbox{\hyperlink{struct_a_a_t_1_1_state_table_driver}{StateTableDriver<Types,\ EntryData>}}\ *driver,}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_a_a_t_1_1_entry}{Entry<EntryData>}}\ \&\mbox{\hyperlink{structentry}{entry}})}
\DoxyCodeLine{00084\ \ \ \ \ \{}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \mbox{\hyperlink{structhb__buffer__t}{hb\_buffer\_t}}\ *\mbox{\hyperlink{classbuffer}{buffer}}\ =\ driver-\/>buffer;}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ flags\ =\ \mbox{\hyperlink{structentry}{entry}}.flags;}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (flags\ \&\ MarkFirst)}
\DoxyCodeLine{00089\ \ \ \ \ start\ =\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>idx;}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00091\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (flags\ \&\ MarkLast)}
\DoxyCodeLine{00092\ \ \ \ \ end\ =\ hb\_min\ (\mbox{\hyperlink{classbuffer}{buffer}}-\/>idx\ +\ 1,\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>len);}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((flags\ \&\ Verb)\ \&\&\ start\ <\ end)}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00096\ \ \ \ \ \textcolor{comment}{/*\ The\ following\ map\ has\ two\ nibbles,\ for\ start-\/side}}
\DoxyCodeLine{00097\ \textcolor{comment}{\ \ \ \ \ *\ and\ end-\/side.\ Values\ of\ 0,1,2\ mean\ move\ that\ many}}
\DoxyCodeLine{00098\ \textcolor{comment}{\ \ \ \ \ *\ to\ the\ other\ side.\ Value\ of\ 3\ means\ move\ 2\ and}}
\DoxyCodeLine{00099\ \textcolor{comment}{\ \ \ \ \ *\ flip\ them.\ */}}
\DoxyCodeLine{00100\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ map[16]\ =}
\DoxyCodeLine{00101\ \ \ \ \ \{}
\DoxyCodeLine{00102\ \ \ \ \ \ \ 0x00,\ \textcolor{comment}{/*\ 0\ \ \ \ no\ change\ */}}
\DoxyCodeLine{00103\ \ \ \ \ \ \ 0x10,\ \textcolor{comment}{/*\ 1\ \ \ \ Ax\ =>\ xA\ */}}
\DoxyCodeLine{00104\ \ \ \ \ \ \ 0x01,\ \textcolor{comment}{/*\ 2\ \ \ \ xD\ =>\ Dx\ */}}
\DoxyCodeLine{00105\ \ \ \ \ \ \ 0x11,\ \textcolor{comment}{/*\ 3\ \ \ \ AxD\ =>\ DxA\ */}}
\DoxyCodeLine{00106\ \ \ \ \ \ \ 0x20,\ \textcolor{comment}{/*\ 4\ \ \ \ ABx\ =>\ xAB\ */}}
\DoxyCodeLine{00107\ \ \ \ \ \ \ 0x30,\ \textcolor{comment}{/*\ 5\ \ \ \ ABx\ =>\ xBA\ */}}
\DoxyCodeLine{00108\ \ \ \ \ \ \ 0x02,\ \textcolor{comment}{/*\ 6\ \ \ \ xCD\ =>\ CDx\ */}}
\DoxyCodeLine{00109\ \ \ \ \ \ \ 0x03,\ \textcolor{comment}{/*\ 7\ \ \ \ xCD\ =>\ DCx\ */}}
\DoxyCodeLine{00110\ \ \ \ \ \ \ 0x12,\ \textcolor{comment}{/*\ 8\ \ \ \ AxCD\ =>\ CDxA\ */}}
\DoxyCodeLine{00111\ \ \ \ \ \ \ 0x13,\ \textcolor{comment}{/*\ 9\ \ \ \ AxCD\ =>\ DCxA\ */}}
\DoxyCodeLine{00112\ \ \ \ \ \ \ 0x21,\ \textcolor{comment}{/*\ 10\ \ \ ABxD\ =>\ DxAB\ */}}
\DoxyCodeLine{00113\ \ \ \ \ \ \ 0x31,\ \textcolor{comment}{/*\ 11\ \ \ ABxD\ =>\ DxBA\ */}}
\DoxyCodeLine{00114\ \ \ \ \ \ \ 0x22,\ \textcolor{comment}{/*\ 12\ \ \ ABxCD\ =>\ CDxAB\ */}}
\DoxyCodeLine{00115\ \ \ \ \ \ \ 0x32,\ \textcolor{comment}{/*\ 13\ \ \ ABxCD\ =>\ CDxBA\ */}}
\DoxyCodeLine{00116\ \ \ \ \ \ \ 0x23,\ \textcolor{comment}{/*\ 14\ \ \ ABxCD\ =>\ DCxAB\ */}}
\DoxyCodeLine{00117\ \ \ \ \ \ \ 0x33,\ \textcolor{comment}{/*\ 15\ \ \ ABxCD\ =>\ DCxBA\ */}}
\DoxyCodeLine{00118\ \ \ \ \ \};}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ m\ =\ map[flags\ \&\ Verb];}
\DoxyCodeLine{00121\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ l\ =\ hb\_min\ (2u,\ m\ >>\ 4);}
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ r\ =\ hb\_min\ (2u,\ m\ \&\ 0x0F);}
\DoxyCodeLine{00123\ \ \ \ \ \textcolor{keywordtype}{bool}\ reverse\_l\ =\ 3\ ==\ (m\ >>\ 4);}
\DoxyCodeLine{00124\ \ \ \ \ \textcolor{keywordtype}{bool}\ reverse\_r\ =\ 3\ ==\ (m\ \&\ 0x0F);}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{keywordflow}{if}\ (end\ -\/\ start\ >=\ l\ +\ r)}
\DoxyCodeLine{00127\ \ \ \ \ \{}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \mbox{\hyperlink{classbuffer}{buffer}}-\/>merge\_clusters\ (start,\ hb\_min\ (\mbox{\hyperlink{classbuffer}{buffer}}-\/>idx\ +\ 1,\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>len));}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \mbox{\hyperlink{classbuffer}{buffer}}-\/>merge\_clusters\ (start,\ end);}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ \ \ \ \ \mbox{\hyperlink{structhb__glyph__info__t}{hb\_glyph\_info\_t}}\ *info\ =\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>info;}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \mbox{\hyperlink{structhb__glyph__info__t}{hb\_glyph\_info\_t}}\ \mbox{\hyperlink{structbuf}{buf}}[4];}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ \ \ \ \ \ \ memcpy\ (\mbox{\hyperlink{structbuf}{buf}},\ info\ +\ start,\ l\ *\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{structbuf}{buf}}[0]));}
\DoxyCodeLine{00135\ \ \ \ \ \ \ memcpy\ (\mbox{\hyperlink{structbuf}{buf}}\ +\ 2,\ info\ +\ end\ -\/\ r,\ r\ *\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{structbuf}{buf}}[0]));}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (l\ !=\ r)}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ memmove\ (info\ +\ start\ +\ r,\ info\ +\ start\ +\ l,\ (end\ -\/\ start\ -\/\ l\ -\/\ r)\ *\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{structbuf}{buf}}[0]));}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00140\ \ \ \ \ \ \ memcpy\ (info\ +\ start,\ \mbox{\hyperlink{structbuf}{buf}}\ +\ 2,\ r\ *\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{structbuf}{buf}}[0]));}
\DoxyCodeLine{00141\ \ \ \ \ \ \ memcpy\ (info\ +\ end\ -\/\ l,\ \mbox{\hyperlink{structbuf}{buf}},\ l\ *\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{structbuf}{buf}}[0]));}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (reverse\_l)}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structbuf}{buf}}[0]\ =\ info[end\ -\/\ 1];}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ info[end\ -\/\ 1]\ =\ info[end\ -\/\ 2];}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ info[end\ -\/\ 2]\ =\ \mbox{\hyperlink{structbuf}{buf}}[0];}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (reverse\_r)}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structbuf}{buf}}[0]\ =\ info[start];}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ info[start]\ =\ info[start\ +\ 1];}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ info[start\ +\ 1]\ =\ \mbox{\hyperlink{structbuf}{buf}}[0];}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00154\ \ \ \ \ \}}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00156\ \ \ \ \ \}}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00158\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00159\ \ \ \ \ \textcolor{keywordtype}{bool}\ ret;}
\DoxyCodeLine{00160\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00161\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ start;}
\DoxyCodeLine{00162\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ end;}
\DoxyCodeLine{00163\ \ \ \};}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00165\ \ \ \textcolor{keywordtype}{bool}\ apply\ (\mbox{\hyperlink{struct_a_a_t_1_1hb__aat__apply__context__t}{hb\_aat\_apply\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00166\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00167\ \ \ \ \ TRACE\_APPLY\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \ \ \ \ \mbox{\hyperlink{struct_a_a_t_1_1_rearrangement_subtable_1_1driver__context__t}{driver\_context\_t}}\ dc\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00171\ \ \ \ \ \mbox{\hyperlink{struct_a_a_t_1_1_state_table_driver}{StateTableDriver<Types,\ EntryData>}}\ driver\ (machine,\ c-\/>buffer,\ c-\/>face);}
\DoxyCodeLine{00172\ \ \ \ \ driver.drive\ (\&dc);}
\DoxyCodeLine{00173\ }
\DoxyCodeLine{00174\ \ \ \ \ return\_trace\ (dc.ret);}
\DoxyCodeLine{00175\ \ \ \}}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00177\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00178\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00179\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00180\ \ \ \ \ return\_trace\ (machine.sanitize\ (c));}
\DoxyCodeLine{00181\ \ \ \}}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00184\ \ \ StateTable<Types,\ EntryData>\ \ machine;}
\DoxyCodeLine{00185\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00186\ \ \ DEFINE\_SIZE\_STATIC\ (16);}
\DoxyCodeLine{00187\ \};}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00189\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Types>}
\DoxyCodeLine{00190\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_a_a_t_1_1_contextual_subtable}{ContextualSubtable}}}
\DoxyCodeLine{00191\ \{}
\DoxyCodeLine{00192\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Types::HBUINT\ HBUINT;}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_a_a_t_1_1_contextual_subtable_1_1_entry_data}{EntryData}}}
\DoxyCodeLine{00195\ \ \ \{}
\DoxyCodeLine{00196\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ \ \ markIndex;\ \ \textcolor{comment}{/*\ Index\ of\ the\ substitution\ table\ for\ the}}
\DoxyCodeLine{00197\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ marked\ glyph\ (use\ 0xFFFF\ for\ none).\ */}}
\DoxyCodeLine{00198\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ \ \ currentIndex;\ \ \ \textcolor{comment}{/*\ Index\ of\ the\ substitution\ table\ for\ the}}
\DoxyCodeLine{00199\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ current\ glyph\ (use\ 0xFFFF\ for\ none).\ */}}
\DoxyCodeLine{00200\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00201\ \ \ \ \ DEFINE\_SIZE\_STATIC\ (4);}
\DoxyCodeLine{00202\ \ \ \};}
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00204\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_a_a_t_1_1_contextual_subtable_1_1driver__context__t}{driver\_context\_t}}}
\DoxyCodeLine{00205\ \ \ \{}
\DoxyCodeLine{00206\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{bool}\ in\_place\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00207\ \ \ \ \ \textcolor{keyword}{enum}\ Flags}
\DoxyCodeLine{00208\ \ \ \ \ \{}
\DoxyCodeLine{00209\ \ \ \ \ \ \ SetMark\ \ \ \ \ \ \ =\ 0x8000,\ \ \ \textcolor{comment}{/*\ If\ set,\ make\ the\ current\ glyph\ the\ marked\ glyph.\ */}}
\DoxyCodeLine{00210\ \ \ \ \ \ \ DontAdvance\ \ \ =\ 0x4000,\ \ \ \textcolor{comment}{/*\ If\ set,\ don't\ advance\ to\ the\ next\ glyph\ before}}
\DoxyCodeLine{00211\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ going\ to\ the\ new\ state.\ */}}
\DoxyCodeLine{00212\ \ \ \ \ \ \ Reserved\ \ \ \ \ \ =\ 0x3FFF,\ \ \ \textcolor{comment}{/*\ These\ bits\ are\ reserved\ and\ should\ be\ set\ to\ 0.\ */}}
\DoxyCodeLine{00213\ \ \ \ \ \};}
\DoxyCodeLine{00214\ }
\DoxyCodeLine{00215\ \ \ \ \ \mbox{\hyperlink{struct_a_a_t_1_1_contextual_subtable_1_1driver__context__t}{driver\_context\_t}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_a_a_t_1_1_contextual_subtable}{ContextualSubtable}}\ *table\_,}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_a_a_t_1_1hb__aat__apply__context__t}{hb\_aat\_apply\_context\_t}}\ *c\_)\ :}
\DoxyCodeLine{00217\ \ \ \ \ ret\ (\textcolor{keyword}{false}),}
\DoxyCodeLine{00218\ \ \ \ \ c\ (c\_),}
\DoxyCodeLine{00219\ \ \ \ \ gdef\ (*c-\/>gdef\_table),}
\DoxyCodeLine{00220\ \ \ \ \ mark\_set\ (\textcolor{keyword}{false}),}
\DoxyCodeLine{00221\ \ \ \ \ has\_glyph\_classes\ (gdef.has\_glyph\_classes\ ()),}
\DoxyCodeLine{00222\ \ \ \ \ mark\ (0),}
\DoxyCodeLine{00223\ \ \ \ \ table\ (table\_),}
\DoxyCodeLine{00224\ \ \ \ \ subs\ (table+table-\/>substitutionTables)\ \{\}}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00226\ \ \ \ \ \textcolor{keywordtype}{bool}\ is\_actionable\ (\mbox{\hyperlink{struct_a_a_t_1_1_state_table_driver}{StateTableDriver<Types,\ EntryData>}}\ *driver,}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_a_a_t_1_1_entry}{Entry<EntryData>}}\ \&\mbox{\hyperlink{structentry}{entry}})}
\DoxyCodeLine{00228\ \ \ \ \ \{}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \mbox{\hyperlink{structhb__buffer__t}{hb\_buffer\_t}}\ *\mbox{\hyperlink{classbuffer}{buffer}}\ =\ driver-\/>buffer;}
\DoxyCodeLine{00230\ }
\DoxyCodeLine{00231\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classbuffer}{buffer}}-\/>idx\ ==\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>len\ \&\&\ !mark\_set)}
\DoxyCodeLine{00232\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00233\ }
\DoxyCodeLine{00234\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structentry}{entry}}.data.markIndex\ !=\ 0xFFFF\ ||\ \mbox{\hyperlink{structentry}{entry}}.data.currentIndex\ !=\ 0xFFFF;}
\DoxyCodeLine{00235\ \ \ \ \ \}}
\DoxyCodeLine{00236\ \ \ \ \ \textcolor{keywordtype}{void}\ transition\ (\mbox{\hyperlink{struct_a_a_t_1_1_state_table_driver}{StateTableDriver<Types,\ EntryData>}}\ *driver,}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_a_a_t_1_1_entry}{Entry<EntryData>}}\ \&\mbox{\hyperlink{structentry}{entry}})}
\DoxyCodeLine{00238\ \ \ \ \ \{}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \mbox{\hyperlink{structhb__buffer__t}{hb\_buffer\_t}}\ *\mbox{\hyperlink{classbuffer}{buffer}}\ =\ driver-\/>buffer;}
\DoxyCodeLine{00240\ }
\DoxyCodeLine{00241\ \ \ \ \ \ \ \textcolor{comment}{/*\ Looks\ like\ CoreText\ applies\ neither\ mark\ nor\ current\ substitution\ for}}
\DoxyCodeLine{00242\ \textcolor{comment}{\ \ \ \ \ \ \ *\ end-\/of-\/text\ if\ mark\ was\ not\ explicitly\ set.\ */}}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classbuffer}{buffer}}-\/>idx\ ==\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>len\ \&\&\ !mark\_set)}
\DoxyCodeLine{00244\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00245\ }
\DoxyCodeLine{00246\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_h_b_glyph_i_d16}{HBGlyphID16}}\ *replacement;}
\DoxyCodeLine{00247\ }
\DoxyCodeLine{00248\ \ \ \ \ \ \ replacement\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (Types::extended)}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00251\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structentry}{entry}}.data.markIndex\ !=\ 0xFFFF)}
\DoxyCodeLine{00252\ \ \ \ \ \{}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_a_a_t_1_1_lookup}{Lookup<HBGlyphID16>}}\ \&lookup\ =\ subs[\mbox{\hyperlink{structentry}{entry}}.data.markIndex];}
\DoxyCodeLine{00254\ \ \ \ \ \ \ replacement\ =\ lookup.get\_value\ (\mbox{\hyperlink{classbuffer}{buffer}}-\/>info[mark].codepoint,\ driver-\/>num\_glyphs);}
\DoxyCodeLine{00255\ \ \ \ \ \}}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00259\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ offset\ =\ \mbox{\hyperlink{structentry}{entry}}.data.markIndex\ +\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>info[mark].codepoint;}
\DoxyCodeLine{00260\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_unsized_array_of}{UnsizedArrayOf<HBGlyphID16>}}\ \&subs\_old\ =\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_unsized_array_of}{UnsizedArrayOf<HBGlyphID16>}}\ \&)\ subs;}
\DoxyCodeLine{00261\ \ \ \ \ replacement\ =\ \&subs\_old[Types::wordOffsetToIndex\ (offset,\ table,\ subs\_old.arrayZ)];}
\DoxyCodeLine{00262\ \ \ \ \ \textcolor{keywordflow}{if}\ (!replacement-\/>sanitize\ (\&c-\/>sanitizer)\ ||\ !*replacement)}
\DoxyCodeLine{00263\ \ \ \ \ \ \ replacement\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (replacement)}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00267\ \ \ \ \ \mbox{\hyperlink{classbuffer}{buffer}}-\/>unsafe\_to\_break\ (mark,\ hb\_min\ (\mbox{\hyperlink{classbuffer}{buffer}}-\/>idx\ +\ 1,\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>len));}
\DoxyCodeLine{00268\ \ \ \ \ \mbox{\hyperlink{classbuffer}{buffer}}-\/>info[mark].codepoint\ =\ *replacement;}
\DoxyCodeLine{00269\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_glyph\_classes)}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \_hb\_glyph\_info\_set\_glyph\_props\ (\&\mbox{\hyperlink{classbuffer}{buffer}}-\/>info[mark],}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ gdef.get\_glyph\_props\ (*replacement));}
\DoxyCodeLine{00272\ \ \ \ \ ret\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00274\ }
\DoxyCodeLine{00275\ \ \ \ \ \ \ replacement\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ idx\ =\ hb\_min\ (\mbox{\hyperlink{classbuffer}{buffer}}-\/>idx,\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>len\ -\/\ 1);}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (Types::extended)}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00279\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structentry}{entry}}.data.currentIndex\ !=\ 0xFFFF)}
\DoxyCodeLine{00280\ \ \ \ \ \{}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_a_a_t_1_1_lookup}{Lookup<HBGlyphID16>}}\ \&lookup\ =\ subs[\mbox{\hyperlink{structentry}{entry}}.data.currentIndex];}
\DoxyCodeLine{00282\ \ \ \ \ \ \ replacement\ =\ lookup.get\_value\ (\mbox{\hyperlink{classbuffer}{buffer}}-\/>info[idx].codepoint,\ driver-\/>num\_glyphs);}
\DoxyCodeLine{00283\ \ \ \ \ \}}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00287\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ offset\ =\ \mbox{\hyperlink{structentry}{entry}}.data.currentIndex\ +\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>info[idx].codepoint;}
\DoxyCodeLine{00288\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_unsized_array_of}{UnsizedArrayOf<HBGlyphID16>}}\ \&subs\_old\ =\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_unsized_array_of}{UnsizedArrayOf<HBGlyphID16>}}\ \&)\ subs;}
\DoxyCodeLine{00289\ \ \ \ \ replacement\ =\ \&subs\_old[Types::wordOffsetToIndex\ (offset,\ table,\ subs\_old.arrayZ)];}
\DoxyCodeLine{00290\ \ \ \ \ \textcolor{keywordflow}{if}\ (!replacement-\/>sanitize\ (\&c-\/>sanitizer)\ ||\ !*replacement)}
\DoxyCodeLine{00291\ \ \ \ \ \ \ replacement\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (replacement)}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00295\ \ \ \ \ \mbox{\hyperlink{classbuffer}{buffer}}-\/>info[idx].codepoint\ =\ *replacement;}
\DoxyCodeLine{00296\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_glyph\_classes)}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \_hb\_glyph\_info\_set\_glyph\_props\ (\&\mbox{\hyperlink{classbuffer}{buffer}}-\/>info[idx],}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ gdef.get\_glyph\_props\ (*replacement));}
\DoxyCodeLine{00299\ \ \ \ \ ret\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00301\ }
\DoxyCodeLine{00302\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structentry}{entry}}.flags\ \&\ SetMark)}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00304\ \ \ \ \ mark\_set\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00305\ \ \ \ \ mark\ =\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>idx;}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00307\ \ \ \ \ \}}
\DoxyCodeLine{00308\ }
\DoxyCodeLine{00309\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00310\ \ \ \ \ \textcolor{keywordtype}{bool}\ ret;}
\DoxyCodeLine{00311\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00312\ \ \ \ \ \mbox{\hyperlink{struct_a_a_t_1_1hb__aat__apply__context__t}{hb\_aat\_apply\_context\_t}}\ *c;}
\DoxyCodeLine{00313\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_g_d_e_f}{OT::GDEF}}\ \&gdef;}
\DoxyCodeLine{00314\ \ \ \ \ \textcolor{keywordtype}{bool}\ mark\_set;}
\DoxyCodeLine{00315\ \ \ \ \ \textcolor{keywordtype}{bool}\ has\_glyph\_classes;}
\DoxyCodeLine{00316\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ mark;}
\DoxyCodeLine{00317\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_a_a_t_1_1_contextual_subtable}{ContextualSubtable}}\ *table;}
\DoxyCodeLine{00318\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_unsized_list_of_offset16_to}{UnsizedListOfOffset16To<Lookup<HBGlyphID16>}},\ HBUINT,\ \textcolor{keyword}{false}>\ \&subs;}
\DoxyCodeLine{00319\ \ \ \};}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00321\ \ \ \textcolor{keywordtype}{bool}\ apply\ (\mbox{\hyperlink{struct_a_a_t_1_1hb__aat__apply__context__t}{hb\_aat\_apply\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00322\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00323\ \ \ \ \ TRACE\_APPLY\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00325\ \ \ \ \ \mbox{\hyperlink{struct_a_a_t_1_1_contextual_subtable_1_1driver__context__t}{driver\_context\_t}}\ dc\ (\textcolor{keyword}{this},\ c);}
\DoxyCodeLine{00326\ }
\DoxyCodeLine{00327\ \ \ \ \ \mbox{\hyperlink{struct_a_a_t_1_1_state_table_driver}{StateTableDriver<Types,\ EntryData>}}\ driver\ (machine,\ c-\/>buffer,\ c-\/>face);}
\DoxyCodeLine{00328\ \ \ \ \ driver.drive\ (\&dc);}
\DoxyCodeLine{00329\ }
\DoxyCodeLine{00330\ \ \ \ \ return\_trace\ (dc.ret);}
\DoxyCodeLine{00331\ \ \ \}}
\DoxyCodeLine{00332\ }
\DoxyCodeLine{00333\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00334\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00335\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00336\ }
\DoxyCodeLine{00337\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ num\_entries\ =\ 0;}
\DoxyCodeLine{00338\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!machine.sanitize\ (c,\ \&num\_entries)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{00339\ }
\DoxyCodeLine{00340\ \ \ \ \ \textcolor{keywordflow}{if}\ (!Types::extended)}
\DoxyCodeLine{00341\ \ \ \ \ \ \ return\_trace\ (substitutionTables.sanitize\ (c,\ \textcolor{keyword}{this},\ 0));}
\DoxyCodeLine{00342\ }
\DoxyCodeLine{00343\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ num\_lookups\ =\ 0;}
\DoxyCodeLine{00344\ }
\DoxyCodeLine{00345\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_a_a_t_1_1_entry}{Entry<EntryData>}}\ *entries\ =\ machine.get\_entries\ ();}
\DoxyCodeLine{00346\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_entries;\ i++)}
\DoxyCodeLine{00347\ \ \ \ \ \{}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \textcolor{keyword}{const}\ EntryData\ \&\mbox{\hyperlink{structdata}{data}}\ =\ entries[i].data;}
\DoxyCodeLine{00349\ }
\DoxyCodeLine{00350\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structdata}{data}}.markIndex\ !=\ 0xFFFF)}
\DoxyCodeLine{00351\ \ \ \ \ num\_lookups\ =\ hb\_max\ (num\_lookups,\ 1u\ +\ \mbox{\hyperlink{structdata}{data}}.markIndex);}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structdata}{data}}.currentIndex\ !=\ 0xFFFF)}
\DoxyCodeLine{00353\ \ \ \ \ num\_lookups\ =\ hb\_max\ (num\_lookups,\ 1u\ +\ \mbox{\hyperlink{structdata}{data}}.currentIndex);}
\DoxyCodeLine{00354\ \ \ \ \ \}}
\DoxyCodeLine{00355\ }
\DoxyCodeLine{00356\ \ \ \ \ return\_trace\ (substitutionTables.sanitize\ (c,\ \textcolor{keyword}{this},\ num\_lookups));}
\DoxyCodeLine{00357\ \ \ \}}
\DoxyCodeLine{00358\ }
\DoxyCodeLine{00359\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00360\ \ \ StateTable<Types,\ EntryData>}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ machine;}
\DoxyCodeLine{00362\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{NNOffsetTo<UnsizedListOfOffset16To<Lookup<HBGlyphID16>}},\ HBUINT,\ \textcolor{keyword}{false}>,\ HBUINT>}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ substitutionTables;}
\DoxyCodeLine{00364\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00365\ \ \ DEFINE\_SIZE\_STATIC\ (20);}
\DoxyCodeLine{00366\ \};}
\DoxyCodeLine{00367\ }
\DoxyCodeLine{00368\ }
\DoxyCodeLine{00369\ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{bool}\ extended>}
\DoxyCodeLine{00370\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_a_a_t_1_1_ligature_entry}{LigatureEntry}};}
\DoxyCodeLine{00371\ }
\DoxyCodeLine{00372\ \textcolor{keyword}{template}\ <>}
\DoxyCodeLine{00373\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_a_a_t_1_1_ligature_entry}{LigatureEntry}}<true>}
\DoxyCodeLine{00374\ \{}
\DoxyCodeLine{00375\ \ \ \textcolor{keyword}{enum}\ Flags}
\DoxyCodeLine{00376\ \ \ \{}
\DoxyCodeLine{00377\ \ \ \ \ SetComponent\ \ \ \ =\ 0x8000,\ \ \ \textcolor{comment}{/*\ Push\ this\ glyph\ onto\ the\ component\ stack\ for}}
\DoxyCodeLine{00378\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ eventual\ processing.\ */}}
\DoxyCodeLine{00379\ \ \ \ \ DontAdvance\ \ \ \ \ =\ 0x4000,\ \ \ \textcolor{comment}{/*\ Leave\ the\ glyph\ pointer\ at\ this\ glyph\ for\ the}}
\DoxyCodeLine{00380\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ next\ iteration.\ */}}
\DoxyCodeLine{00381\ \ \ \ \ PerformAction\ \ \ =\ 0x2000,\ \ \ \textcolor{comment}{/*\ Use\ the\ ligActionIndex\ to\ process\ a\ ligature}}
\DoxyCodeLine{00382\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ group.\ */}}
\DoxyCodeLine{00383\ \ \ \ \ Reserved\ \ \ \ \ \ \ \ =\ 0x1FFF,\ \ \ \textcolor{comment}{/*\ These\ bits\ are\ reserved\ and\ should\ be\ set\ to\ 0.\ */}}
\DoxyCodeLine{00384\ \ \ \};}
\DoxyCodeLine{00385\ }
\DoxyCodeLine{00386\ \ \ \textcolor{keyword}{struct\ }EntryData}
\DoxyCodeLine{00387\ \ \ \{}
\DoxyCodeLine{00388\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ \ \ ligActionIndex;\ \textcolor{comment}{/*\ Index\ to\ the\ first\ ligActionTable\ entry}}
\DoxyCodeLine{00389\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ for\ processing\ this\ group,\ if\ indicated}}
\DoxyCodeLine{00390\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ by\ the\ flags.\ */}}
\DoxyCodeLine{00391\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00392\ \ \ \ \ DEFINE\_SIZE\_STATIC\ (2);}
\DoxyCodeLine{00393\ \ \ \};}
\DoxyCodeLine{00394\ }
\DoxyCodeLine{00395\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ performAction\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_a_a_t_1_1_entry}{Entry<EntryData>}}\ \&\mbox{\hyperlink{structentry}{entry}})}
\DoxyCodeLine{00396\ \ \ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structentry}{entry}}.flags\ \&\ PerformAction;\ \}}
\DoxyCodeLine{00397\ }
\DoxyCodeLine{00398\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ligActionIndex\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_a_a_t_1_1_entry}{Entry<EntryData>}}\ \&\mbox{\hyperlink{structentry}{entry}})}
\DoxyCodeLine{00399\ \ \ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structentry}{entry}}.data.ligActionIndex;\ \}}
\DoxyCodeLine{00400\ \};}
\DoxyCodeLine{00401\ \textcolor{keyword}{template}\ <>}
\DoxyCodeLine{00402\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_a_a_t_1_1_ligature_entry}{LigatureEntry}}<false>}
\DoxyCodeLine{00403\ \{}
\DoxyCodeLine{00404\ \ \ \textcolor{keyword}{enum}\ Flags}
\DoxyCodeLine{00405\ \ \ \{}
\DoxyCodeLine{00406\ \ \ \ \ SetComponent\ \ \ \ =\ 0x8000,\ \ \ \textcolor{comment}{/*\ Push\ this\ glyph\ onto\ the\ component\ stack\ for}}
\DoxyCodeLine{00407\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ eventual\ processing.\ */}}
\DoxyCodeLine{00408\ \ \ \ \ DontAdvance\ \ \ \ \ =\ 0x4000,\ \ \ \textcolor{comment}{/*\ Leave\ the\ glyph\ pointer\ at\ this\ glyph\ for\ the}}
\DoxyCodeLine{00409\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ next\ iteration.\ */}}
\DoxyCodeLine{00410\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset}{Offset}}\ \ \ \ \ \ \ \ =\ 0x3FFF,\ \ \ \textcolor{comment}{/*\ Byte\ offset\ from\ beginning\ of\ subtable\ to\ the}}
\DoxyCodeLine{00411\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ ligature\ action\ list.\ This\ value\ must\ be\ a}}
\DoxyCodeLine{00412\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ multiple\ of\ 4.\ */}}
\DoxyCodeLine{00413\ \ \ \};}
\DoxyCodeLine{00414\ }
\DoxyCodeLine{00415\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{void}\ EntryData;}
\DoxyCodeLine{00416\ }
\DoxyCodeLine{00417\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ performAction\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_a_a_t_1_1_entry}{Entry<EntryData>}}\ \&\mbox{\hyperlink{structentry}{entry}})}
\DoxyCodeLine{00418\ \ \ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structentry}{entry}}.flags\ \&\ \mbox{\hyperlink{struct_o_t_1_1_offset}{Offset}};\ \}}
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00420\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ligActionIndex\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_a_a_t_1_1_entry}{Entry<EntryData>}}\ \&\mbox{\hyperlink{structentry}{entry}})}
\DoxyCodeLine{00421\ \ \ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structentry}{entry}}.flags\ \&\ \mbox{\hyperlink{struct_o_t_1_1_offset}{Offset}};\ \}}
\DoxyCodeLine{00422\ \};}
\DoxyCodeLine{00423\ }
\DoxyCodeLine{00424\ }
\DoxyCodeLine{00425\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Types>}
\DoxyCodeLine{00426\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_a_a_t_1_1_ligature_subtable}{LigatureSubtable}}}
\DoxyCodeLine{00427\ \{}
\DoxyCodeLine{00428\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Types::HBUINT\ HBUINT;}
\DoxyCodeLine{00429\ }
\DoxyCodeLine{00430\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{struct_a_a_t_1_1_ligature_entry}{LigatureEntry<Types::extended>}}\ \mbox{\hyperlink{struct_a_a_t_1_1_ligature_entry}{LigatureEntryT}};}
\DoxyCodeLine{00431\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ LigatureEntryT::EntryData\ EntryData;}
\DoxyCodeLine{00432\ }
\DoxyCodeLine{00433\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_a_a_t_1_1_ligature_subtable_1_1driver__context__t}{driver\_context\_t}}}
\DoxyCodeLine{00434\ \ \ \{}
\DoxyCodeLine{00435\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{bool}\ in\_place\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00436\ \ \ \ \ \textcolor{keyword}{enum}}
\DoxyCodeLine{00437\ \ \ \ \ \{}
\DoxyCodeLine{00438\ \ \ \ \ \ \ DontAdvance\ \ \ =\ LigatureEntryT::DontAdvance,}
\DoxyCodeLine{00439\ \ \ \ \ \};}
\DoxyCodeLine{00440\ \ \ \ \ \textcolor{keyword}{enum}\ LigActionFlags}
\DoxyCodeLine{00441\ \ \ \ \ \{}
\DoxyCodeLine{00442\ \ \ \ \ \ \ LigActionLast\ =\ 0x80000000,\ \ \ \textcolor{comment}{/*\ This\ is\ the\ last\ action\ in\ the\ list.\ This\ also}}
\DoxyCodeLine{00443\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ implies\ storage.\ */}}
\DoxyCodeLine{00444\ \ \ \ \ \ \ LigActionStore\ \ \ \ =\ 0x40000000,\ \ \ \textcolor{comment}{/*\ Store\ the\ ligature\ at\ the\ current\ cumulated\ index}}
\DoxyCodeLine{00445\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ in\ the\ ligature\ table\ in\ place\ of\ the\ marked}}
\DoxyCodeLine{00446\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ (i.e.\ currently-\/popped)\ glyph.\ */}}
\DoxyCodeLine{00447\ \ \ \ \ \ \ LigActionOffset\ \ \ =\ 0x3FFFFFFF,\ \ \ \textcolor{comment}{/*\ A\ 30-\/bit\ value\ which\ is\ sign-\/extended\ to\ 32-\/bits}}
\DoxyCodeLine{00448\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ and\ added\ to\ the\ glyph\ ID,\ resulting\ in\ an\ index}}
\DoxyCodeLine{00449\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ into\ the\ component\ table.\ */}}
\DoxyCodeLine{00450\ \ \ \ \ \};}
\DoxyCodeLine{00451\ }
\DoxyCodeLine{00452\ \ \ \ \ \mbox{\hyperlink{struct_a_a_t_1_1_ligature_subtable_1_1driver__context__t}{driver\_context\_t}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_a_a_t_1_1_ligature_subtable}{LigatureSubtable}}\ *table\_,}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_a_a_t_1_1hb__aat__apply__context__t}{hb\_aat\_apply\_context\_t}}\ *c\_)\ :}
\DoxyCodeLine{00454\ \ \ \ \ ret\ (\textcolor{keyword}{false}),}
\DoxyCodeLine{00455\ \ \ \ \ c\ (c\_),}
\DoxyCodeLine{00456\ \ \ \ \ table\ (table\_),}
\DoxyCodeLine{00457\ \ \ \ \ ligAction\ (table+table-\/>ligAction),}
\DoxyCodeLine{00458\ \ \ \ \ component\ (table+table-\/>component),}
\DoxyCodeLine{00459\ \ \ \ \ ligature\ (table+table-\/>ligature),}
\DoxyCodeLine{00460\ \ \ \ \ match\_length\ (0)\ \{\}}
\DoxyCodeLine{00461\ }
\DoxyCodeLine{00462\ \ \ \ \ \textcolor{keywordtype}{bool}\ is\_actionable\ (\mbox{\hyperlink{struct_a_a_t_1_1_state_table_driver}{StateTableDriver<Types,\ EntryData>}}\ *driver\ HB\_UNUSED,}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_a_a_t_1_1_entry}{Entry<EntryData>}}\ \&\mbox{\hyperlink{structentry}{entry}})}
\DoxyCodeLine{00464\ \ \ \ \ \{}
\DoxyCodeLine{00465\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ LigatureEntryT::performAction\ (\mbox{\hyperlink{structentry}{entry}});}
\DoxyCodeLine{00466\ \ \ \ \ \}}
\DoxyCodeLine{00467\ \ \ \ \ \textcolor{keywordtype}{void}\ transition\ (\mbox{\hyperlink{struct_a_a_t_1_1_state_table_driver}{StateTableDriver<Types,\ EntryData>}}\ *driver,}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_a_a_t_1_1_entry}{Entry<EntryData>}}\ \&\mbox{\hyperlink{structentry}{entry}})}
\DoxyCodeLine{00469\ \ \ \ \ \{}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \mbox{\hyperlink{structhb__buffer__t}{hb\_buffer\_t}}\ *\mbox{\hyperlink{classbuffer}{buffer}}\ =\ driver-\/>buffer;}
\DoxyCodeLine{00471\ }
\DoxyCodeLine{00472\ \ \ \ \ \ \ DEBUG\_MSG\ (APPLY,\ \textcolor{keyword}{nullptr},\ \textcolor{stringliteral}{"{}Ligature\ transition\ at\ \%u"{}},\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>idx);}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structentry}{entry}}.flags\ \&\ LigatureEntryT::SetComponent)}
\DoxyCodeLine{00474\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00475\ \ \ \ \ \textcolor{comment}{/*\ Never\ mark\ same\ index\ twice,\ in\ case\ DontAdvance\ was\ used...\ */}}
\DoxyCodeLine{00476\ \ \ \ \ \textcolor{keywordflow}{if}\ (match\_length\ \&\&\ match\_positions[(match\_length\ -\/\ 1u)\ \%\ ARRAY\_LENGTH\ (match\_positions)]\ ==\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>out\_len)}
\DoxyCodeLine{00477\ \ \ \ \ \ \ match\_length-\/-\/;}
\DoxyCodeLine{00478\ }
\DoxyCodeLine{00479\ \ \ \ \ match\_positions[match\_length++\ \%\ ARRAY\_LENGTH\ (match\_positions)]\ =\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>out\_len;}
\DoxyCodeLine{00480\ \ \ \ \ DEBUG\_MSG\ (APPLY,\ \textcolor{keyword}{nullptr},\ \textcolor{stringliteral}{"{}Set\ component\ at\ \%u"{}},\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>out\_len);}
\DoxyCodeLine{00481\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00482\ }
\DoxyCodeLine{00483\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (LigatureEntryT::performAction\ (\mbox{\hyperlink{structentry}{entry}}))}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00485\ \ \ \ \ DEBUG\_MSG\ (APPLY,\ \textcolor{keyword}{nullptr},\ \textcolor{stringliteral}{"{}Perform\ action\ with\ \%u"{}},\ match\_length);}
\DoxyCodeLine{00486\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ end\ =\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>out\_len;}
\DoxyCodeLine{00487\ }
\DoxyCodeLine{00488\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!match\_length))}
\DoxyCodeLine{00489\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00490\ }
\DoxyCodeLine{00491\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classbuffer}{buffer}}-\/>idx\ >=\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>len)}
\DoxyCodeLine{00492\ \ \ \ \ \ \ \textcolor{keywordflow}{return};\ \textcolor{comment}{/*\ TODO\ Work\ on\ previous\ instead?\ */}}
\DoxyCodeLine{00493\ }
\DoxyCodeLine{00494\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ cursor\ =\ match\_length;}
\DoxyCodeLine{00495\ }
\DoxyCodeLine{00496\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ action\_idx\ =\ LigatureEntryT::ligActionIndex\ (\mbox{\hyperlink{structentry}{entry}});}
\DoxyCodeLine{00497\ \ \ \ \ action\_idx\ =\ Types::offsetToIndex\ (action\_idx,\ table,\ ligAction.arrayZ);}
\DoxyCodeLine{00498\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT32}}\ *actionData\ =\ \&ligAction[action\_idx];}
\DoxyCodeLine{00499\ }
\DoxyCodeLine{00500\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ligature\_idx\ =\ 0;}
\DoxyCodeLine{00501\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ action;}
\DoxyCodeLine{00502\ \ \ \ \ \textcolor{keywordflow}{do}}
\DoxyCodeLine{00503\ \ \ \ \ \{}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!cursor))}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Stack\ underflow.\ \ Clear\ the\ stack.\ */}}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \ \ DEBUG\_MSG\ (APPLY,\ \textcolor{keyword}{nullptr},\ \textcolor{stringliteral}{"{}Stack\ underflow"{}});}
\DoxyCodeLine{00508\ \ \ \ \ \ \ \ \ match\_length\ =\ 0;}
\DoxyCodeLine{00509\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00511\ }
\DoxyCodeLine{00512\ \ \ \ \ \ \ DEBUG\_MSG\ (APPLY,\ \textcolor{keyword}{nullptr},\ \textcolor{stringliteral}{"{}Moving\ to\ stack\ position\ \%u"{}},\ cursor\ -\/\ 1);}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!\mbox{\hyperlink{classbuffer}{buffer}}-\/>move\_to\ (match\_positions[-\/-\/cursor\ \%\ ARRAY\_LENGTH\ (match\_positions)])))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00514\ }
\DoxyCodeLine{00515\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!actionData-\/>sanitize\ (\&c-\/>sanitizer)))\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00516\ \ \ \ \ \ \ action\ =\ *actionData;}
\DoxyCodeLine{00517\ }
\DoxyCodeLine{00518\ \ \ \ \ \ \ uint32\_t\ uoffset\ =\ action\ \&\ LigActionOffset;}
\DoxyCodeLine{00519\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (uoffset\ \&\ 0x20000000)}
\DoxyCodeLine{00520\ \ \ \ \ \ \ \ \ uoffset\ |=\ 0xC0000000;\ \textcolor{comment}{/*\ Sign-\/extend.\ */}}
\DoxyCodeLine{00521\ \ \ \ \ \ \ int32\_t\ offset\ =\ (int32\_t)\ uoffset;}
\DoxyCodeLine{00522\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ component\_idx\ =\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>cur().codepoint\ +\ offset;}
\DoxyCodeLine{00523\ \ \ \ \ \ \ component\_idx\ =\ Types::wordOffsetToIndex\ (component\_idx,\ table,\ component.arrayZ);}
\DoxyCodeLine{00524\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \&componentData\ =\ component[component\_idx];}
\DoxyCodeLine{00525\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!componentData.sanitize\ (\&c-\/>sanitizer)))\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00526\ \ \ \ \ \ \ ligature\_idx\ +=\ componentData;}
\DoxyCodeLine{00527\ }
\DoxyCodeLine{00528\ \ \ \ \ \ \ DEBUG\_MSG\ (APPLY,\ \textcolor{keyword}{nullptr},\ \textcolor{stringliteral}{"{}Action\ store\ \%u\ last\ \%u"{}},}
\DoxyCodeLine{00529\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ (action\ \&\ LigActionStore),}
\DoxyCodeLine{00530\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ (action\ \&\ LigActionLast));}
\DoxyCodeLine{00531\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (action\ \&\ (LigActionStore\ |\ LigActionLast))}
\DoxyCodeLine{00532\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00533\ \ \ \ \ \ \ \ \ ligature\_idx\ =\ Types::offsetToIndex\ (ligature\_idx,\ table,\ ligature.arrayZ);}
\DoxyCodeLine{00534\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_h_b_glyph_i_d16}{HBGlyphID16}}\ \&ligatureData\ =\ ligature[ligature\_idx];}
\DoxyCodeLine{00535\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!ligatureData.sanitize\ (\&c-\/>sanitizer)))\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00536\ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ lig\ =\ ligatureData;}
\DoxyCodeLine{00537\ }
\DoxyCodeLine{00538\ \ \ \ \ \ \ \ \ DEBUG\_MSG\ (APPLY,\ \textcolor{keyword}{nullptr},\ \textcolor{stringliteral}{"{}Produced\ ligature\ \%u"{}},\ lig);}
\DoxyCodeLine{00539\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!\mbox{\hyperlink{classbuffer}{buffer}}-\/>replace\_glyph\ (lig)))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00540\ }
\DoxyCodeLine{00541\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lig\_end\ =\ match\_positions[(match\_length\ -\/\ 1u)\ \%\ ARRAY\_LENGTH\ (match\_positions)]\ +\ 1u;}
\DoxyCodeLine{00542\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Now\ go\ and\ delete\ all\ subsequent\ components.\ */}}
\DoxyCodeLine{00543\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (match\_length\ -\/\ 1u\ >\ cursor)}
\DoxyCodeLine{00544\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00545\ \ \ \ \ \ \ \ \ \ \ DEBUG\_MSG\ (APPLY,\ \textcolor{keyword}{nullptr},\ \textcolor{stringliteral}{"{}Skipping\ ligature\ component"{}});}
\DoxyCodeLine{00546\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!\mbox{\hyperlink{classbuffer}{buffer}}-\/>move\_to\ (match\_positions[-\/-\/match\_length\ \%\ ARRAY\_LENGTH\ (match\_positions)])))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00547\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!\mbox{\hyperlink{classbuffer}{buffer}}-\/>replace\_glyph\ (DELETED\_GLYPH)))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00548\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00549\ }
\DoxyCodeLine{00550\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!\mbox{\hyperlink{classbuffer}{buffer}}-\/>move\_to\ (lig\_end)))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00551\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classbuffer}{buffer}}-\/>merge\_out\_clusters\ (match\_positions[cursor\ \%\ ARRAY\_LENGTH\ (match\_positions)],\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>out\_len);}
\DoxyCodeLine{00552\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00553\ }
\DoxyCodeLine{00554\ \ \ \ \ \ \ actionData++;}
\DoxyCodeLine{00555\ \ \ \ \ \}}
\DoxyCodeLine{00556\ \ \ \ \ \textcolor{keywordflow}{while}\ (!(action\ \&\ LigActionLast));}
\DoxyCodeLine{00557\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!\mbox{\hyperlink{classbuffer}{buffer}}-\/>move\_to\ (end)))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00558\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00559\ \ \ \ \ \}}
\DoxyCodeLine{00560\ }
\DoxyCodeLine{00561\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00562\ \ \ \ \ \textcolor{keywordtype}{bool}\ ret;}
\DoxyCodeLine{00563\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00564\ \ \ \ \ \mbox{\hyperlink{struct_a_a_t_1_1hb__aat__apply__context__t}{hb\_aat\_apply\_context\_t}}\ *c;}
\DoxyCodeLine{00565\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_a_a_t_1_1_ligature_subtable}{LigatureSubtable}}\ *table;}
\DoxyCodeLine{00566\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_unsized_array_of}{UnsizedArrayOf<HBUINT32>}}\ \&ligAction;}
\DoxyCodeLine{00567\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_unsized_array_of}{UnsizedArrayOf<HBUINT16>}}\ \&component;}
\DoxyCodeLine{00568\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_unsized_array_of}{UnsizedArrayOf<HBGlyphID16>}}\ \&ligature;}
\DoxyCodeLine{00569\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ match\_length;}
\DoxyCodeLine{00570\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ match\_positions[HB\_MAX\_CONTEXT\_LENGTH];}
\DoxyCodeLine{00571\ \ \ \};}
\DoxyCodeLine{00572\ }
\DoxyCodeLine{00573\ \ \ \textcolor{keywordtype}{bool}\ apply\ (\mbox{\hyperlink{struct_a_a_t_1_1hb__aat__apply__context__t}{hb\_aat\_apply\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00574\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00575\ \ \ \ \ TRACE\_APPLY\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00576\ }
\DoxyCodeLine{00577\ \ \ \ \ \mbox{\hyperlink{struct_a_a_t_1_1_ligature_subtable_1_1driver__context__t}{driver\_context\_t}}\ dc\ (\textcolor{keyword}{this},\ c);}
\DoxyCodeLine{00578\ }
\DoxyCodeLine{00579\ \ \ \ \ \mbox{\hyperlink{struct_a_a_t_1_1_state_table_driver}{StateTableDriver<Types,\ EntryData>}}\ driver\ (machine,\ c-\/>buffer,\ c-\/>face);}
\DoxyCodeLine{00580\ \ \ \ \ driver.drive\ (\&dc);}
\DoxyCodeLine{00581\ }
\DoxyCodeLine{00582\ \ \ \ \ return\_trace\ (dc.ret);}
\DoxyCodeLine{00583\ \ \ \}}
\DoxyCodeLine{00584\ }
\DoxyCodeLine{00585\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00586\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00587\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00588\ \ \ \ \ \textcolor{comment}{/*\ The\ rest\ of\ array\ sanitizations\ are\ done\ at\ run-\/time.\ */}}
\DoxyCodeLine{00589\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this})\ \&\&\ machine.sanitize\ (c)\ \&\&}
\DoxyCodeLine{00590\ \ \ \ \ \ \ \ \ \ \ ligAction\ \&\&\ component\ \&\&\ ligature);}
\DoxyCodeLine{00591\ \ \ \}}
\DoxyCodeLine{00592\ }
\DoxyCodeLine{00593\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00594\ \ \ StateTable<Types,\ EntryData>}
\DoxyCodeLine{00595\ \ \ \ \ \ \ \ \ machine;}
\DoxyCodeLine{00596\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{NNOffsetTo<UnsizedArrayOf<HBUINT32>}},\ HBUINT>}
\DoxyCodeLine{00597\ \ \ \ \ \ \ \ \ ligAction;\ \ \textcolor{comment}{/*\ Offset\ to\ the\ ligature\ action\ table.\ */}}
\DoxyCodeLine{00598\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{NNOffsetTo<UnsizedArrayOf<HBUINT16>}},\ HBUINT>}
\DoxyCodeLine{00599\ \ \ \ \ \ \ \ \ component;\ \ \textcolor{comment}{/*\ Offset\ to\ the\ component\ table.\ */}}
\DoxyCodeLine{00600\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{NNOffsetTo<UnsizedArrayOf<HBGlyphID16>}},\ HBUINT>}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \ \ ligature;\ \ \ \textcolor{comment}{/*\ Offset\ to\ the\ actual\ ligature\ lists.\ */}}
\DoxyCodeLine{00602\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00603\ \ \ DEFINE\_SIZE\_STATIC\ (28);}
\DoxyCodeLine{00604\ \};}
\DoxyCodeLine{00605\ }
\DoxyCodeLine{00606\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Types>}
\DoxyCodeLine{00607\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_a_a_t_1_1_noncontextual_subtable}{NoncontextualSubtable}}}
\DoxyCodeLine{00608\ \{}
\DoxyCodeLine{00609\ \ \ \textcolor{keywordtype}{bool}\ apply\ (\mbox{\hyperlink{struct_a_a_t_1_1hb__aat__apply__context__t}{hb\_aat\_apply\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00610\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00611\ \ \ \ \ TRACE\_APPLY\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00612\ }
\DoxyCodeLine{00613\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_g_d_e_f}{OT::GDEF}}\ \&gdef\ (*c-\/>gdef\_table);}
\DoxyCodeLine{00614\ \ \ \ \ \textcolor{keywordtype}{bool}\ has\_glyph\_classes\ =\ gdef.has\_glyph\_classes\ ();}
\DoxyCodeLine{00615\ }
\DoxyCodeLine{00616\ \ \ \ \ \textcolor{keywordtype}{bool}\ ret\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00617\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ num\_glyphs\ =\ c-\/>face-\/>get\_num\_glyphs\ ();}
\DoxyCodeLine{00618\ }
\DoxyCodeLine{00619\ \ \ \ \ \mbox{\hyperlink{structhb__glyph__info__t}{hb\_glyph\_info\_t}}\ *info\ =\ c-\/>buffer-\/>info;}
\DoxyCodeLine{00620\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ c-\/>buffer-\/>len;}
\DoxyCodeLine{00621\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{00622\ \ \ \ \ \{}
\DoxyCodeLine{00623\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_h_b_glyph_i_d16}{HBGlyphID16}}\ *replacement\ =\ substitute.get\_value\ (info[i].codepoint,\ num\_glyphs);}
\DoxyCodeLine{00624\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (replacement)}
\DoxyCodeLine{00625\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00626\ \ \ \ \ info[i].codepoint\ =\ *replacement;}
\DoxyCodeLine{00627\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_glyph\_classes)}
\DoxyCodeLine{00628\ \ \ \ \ \ \ \_hb\_glyph\_info\_set\_glyph\_props\ (\&info[i],}
\DoxyCodeLine{00629\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ gdef.get\_glyph\_props\ (*replacement));}
\DoxyCodeLine{00630\ \ \ \ \ ret\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00631\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00632\ \ \ \ \ \}}
\DoxyCodeLine{00633\ }
\DoxyCodeLine{00634\ \ \ \ \ return\_trace\ (ret);}
\DoxyCodeLine{00635\ \ \ \}}
\DoxyCodeLine{00636\ }
\DoxyCodeLine{00637\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00638\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00639\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00640\ \ \ \ \ return\_trace\ (substitute.sanitize\ (c));}
\DoxyCodeLine{00641\ \ \ \}}
\DoxyCodeLine{00642\ }
\DoxyCodeLine{00643\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00644\ \ \ \mbox{\hyperlink{struct_a_a_t_1_1_lookup}{Lookup<HBGlyphID16>}}\ \ \ \ substitute;}
\DoxyCodeLine{00645\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00646\ \ \ DEFINE\_SIZE\_MIN\ (2);}
\DoxyCodeLine{00647\ \};}
\DoxyCodeLine{00648\ }
\DoxyCodeLine{00649\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Types>}
\DoxyCodeLine{00650\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_a_a_t_1_1_insertion_subtable}{InsertionSubtable}}}
\DoxyCodeLine{00651\ \{}
\DoxyCodeLine{00652\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Types::HBUINT\ HBUINT;}
\DoxyCodeLine{00653\ }
\DoxyCodeLine{00654\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_a_a_t_1_1_insertion_subtable_1_1_entry_data}{EntryData}}}
\DoxyCodeLine{00655\ \ \ \{}
\DoxyCodeLine{00656\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ \ \ currentInsertIndex;\ \textcolor{comment}{/*\ Zero-\/based\ index\ into\ the\ insertion\ glyph\ table.}}
\DoxyCodeLine{00657\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ The\ number\ of\ glyphs\ to\ be\ inserted\ is\ contained}}
\DoxyCodeLine{00658\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ in\ the\ currentInsertCount\ field\ in\ the\ flags.}}
\DoxyCodeLine{00659\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ A\ value\ of\ 0xFFFF\ indicates\ no\ insertion\ is\ to}}
\DoxyCodeLine{00660\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ be\ done.\ */}}
\DoxyCodeLine{00661\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ \ \ markedInsertIndex;\ \ \textcolor{comment}{/*\ Zero-\/based\ index\ into\ the\ insertion\ glyph\ table.}}
\DoxyCodeLine{00662\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ The\ number\ of\ glyphs\ to\ be\ inserted\ is\ contained}}
\DoxyCodeLine{00663\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ in\ the\ markedInsertCount\ field\ in\ the\ flags.}}
\DoxyCodeLine{00664\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ A\ value\ of\ 0xFFFF\ indicates\ no\ insertion\ is\ to}}
\DoxyCodeLine{00665\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ be\ done.\ */}}
\DoxyCodeLine{00666\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00667\ \ \ \ \ DEFINE\_SIZE\_STATIC\ (4);}
\DoxyCodeLine{00668\ \ \ \};}
\DoxyCodeLine{00669\ }
\DoxyCodeLine{00670\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_a_a_t_1_1_insertion_subtable_1_1driver__context__t}{driver\_context\_t}}}
\DoxyCodeLine{00671\ \ \ \{}
\DoxyCodeLine{00672\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{bool}\ in\_place\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00673\ \ \ \ \ \textcolor{keyword}{enum}\ Flags}
\DoxyCodeLine{00674\ \ \ \ \ \{}
\DoxyCodeLine{00675\ \ \ \ \ \ \ SetMark\ \ \ \ \ \ \ =\ 0x8000,\ \ \ \textcolor{comment}{/*\ If\ set,\ mark\ the\ current\ glyph.\ */}}
\DoxyCodeLine{00676\ \ \ \ \ \ \ DontAdvance\ \ \ =\ 0x4000,\ \ \ \textcolor{comment}{/*\ If\ set,\ don't\ advance\ to\ the\ next\ glyph\ before}}
\DoxyCodeLine{00677\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ going\ to\ the\ new\ state.\ \ This\ does\ not\ mean}}
\DoxyCodeLine{00678\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ that\ the\ glyph\ pointed\ to\ is\ the\ same\ one\ as}}
\DoxyCodeLine{00679\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ before.\ If\ you've\ made\ insertions\ immediately}}
\DoxyCodeLine{00680\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ downstream\ of\ the\ current\ glyph,\ the\ next\ glyph}}
\DoxyCodeLine{00681\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ processed\ would\ in\ fact\ be\ the\ first\ one}}
\DoxyCodeLine{00682\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ inserted.\ */}}
\DoxyCodeLine{00683\ \ \ \ \ \ \ CurrentIsKashidaLike=\ 0x2000,\ \textcolor{comment}{/*\ If\ set,\ and\ the\ currentInsertList\ is\ nonzero,}}
\DoxyCodeLine{00684\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ then\ the\ specified\ glyph\ list\ will\ be\ inserted}}
\DoxyCodeLine{00685\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ as\ a\ kashida-\/like\ insertion,\ either\ before\ or}}
\DoxyCodeLine{00686\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ after\ the\ current\ glyph\ (depending\ on\ the\ state}}
\DoxyCodeLine{00687\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ of\ the\ currentInsertBefore\ flag).\ If\ clear,\ and}}
\DoxyCodeLine{00688\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ the\ currentInsertList\ is\ nonzero,\ then\ the}}
\DoxyCodeLine{00689\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ specified\ glyph\ list\ will\ be\ inserted\ as\ a}}
\DoxyCodeLine{00690\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ split-\/vowel-\/like\ insertion,\ either\ before\ or}}
\DoxyCodeLine{00691\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ after\ the\ current\ glyph\ (depending\ on\ the\ state}}
\DoxyCodeLine{00692\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ of\ the\ currentInsertBefore\ flag).\ */}}
\DoxyCodeLine{00693\ \ \ \ \ \ \ MarkedIsKashidaLike=\ 0x1000,\ \ \textcolor{comment}{/*\ If\ set,\ and\ the\ markedInsertList\ is\ nonzero,}}
\DoxyCodeLine{00694\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ then\ the\ specified\ glyph\ list\ will\ be\ inserted}}
\DoxyCodeLine{00695\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ as\ a\ kashida-\/like\ insertion,\ either\ before\ or}}
\DoxyCodeLine{00696\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ after\ the\ marked\ glyph\ (depending\ on\ the\ state}}
\DoxyCodeLine{00697\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ of\ the\ markedInsertBefore\ flag).\ If\ clear,\ and}}
\DoxyCodeLine{00698\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ the\ markedInsertList\ is\ nonzero,\ then\ the}}
\DoxyCodeLine{00699\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ specified\ glyph\ list\ will\ be\ inserted\ as\ a}}
\DoxyCodeLine{00700\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ split-\/vowel-\/like\ insertion,\ either\ before\ or}}
\DoxyCodeLine{00701\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ after\ the\ marked\ glyph\ (depending\ on\ the\ state}}
\DoxyCodeLine{00702\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ of\ the\ markedInsertBefore\ flag).\ */}}
\DoxyCodeLine{00703\ \ \ \ \ \ \ CurrentInsertBefore=\ 0x0800,\ \ \textcolor{comment}{/*\ If\ set,\ specifies\ that\ insertions\ are\ to\ be\ made}}
\DoxyCodeLine{00704\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ to\ the\ left\ of\ the\ current\ glyph.\ If\ clear,}}
\DoxyCodeLine{00705\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ they're\ made\ to\ the\ right\ of\ the\ current\ glyph.\ */}}
\DoxyCodeLine{00706\ \ \ \ \ \ \ MarkedInsertBefore=\ 0x0400,\ \ \ \textcolor{comment}{/*\ If\ set,\ specifies\ that\ insertions\ are\ to\ be}}
\DoxyCodeLine{00707\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ made\ to\ the\ left\ of\ the\ marked\ glyph.\ If\ clear,}}
\DoxyCodeLine{00708\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ they're\ made\ to\ the\ right\ of\ the\ marked\ glyph.\ */}}
\DoxyCodeLine{00709\ \ \ \ \ \ \ CurrentInsertCount=\ 0x3E0,\ \ \ \ \textcolor{comment}{/*\ This\ 5-\/bit\ field\ is\ treated\ as\ a\ count\ of\ the}}
\DoxyCodeLine{00710\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ number\ of\ glyphs\ to\ insert\ at\ the\ current}}
\DoxyCodeLine{00711\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ position.\ Since\ zero\ means\ no\ insertions,\ the}}
\DoxyCodeLine{00712\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ largest\ number\ of\ insertions\ at\ any\ given}}
\DoxyCodeLine{00713\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ current\ location\ is\ 31\ glyphs.\ */}}
\DoxyCodeLine{00714\ \ \ \ \ \ \ MarkedInsertCount=\ 0x001F,\ \ \ \ \textcolor{comment}{/*\ This\ 5-\/bit\ field\ is\ treated\ as\ a\ count\ of\ the}}
\DoxyCodeLine{00715\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ number\ of\ glyphs\ to\ insert\ at\ the\ marked}}
\DoxyCodeLine{00716\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ position.\ Since\ zero\ means\ no\ insertions,\ the}}
\DoxyCodeLine{00717\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ largest\ number\ of\ insertions\ at\ any\ given}}
\DoxyCodeLine{00718\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ marked\ location\ is\ 31\ glyphs.\ */}}
\DoxyCodeLine{00719\ \ \ \ \ \};}
\DoxyCodeLine{00720\ }
\DoxyCodeLine{00721\ \ \ \ \ \mbox{\hyperlink{struct_a_a_t_1_1_insertion_subtable_1_1driver__context__t}{driver\_context\_t}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_a_a_t_1_1_insertion_subtable}{InsertionSubtable}}\ *table,}
\DoxyCodeLine{00722\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_a_a_t_1_1hb__aat__apply__context__t}{hb\_aat\_apply\_context\_t}}\ *c\_)\ :}
\DoxyCodeLine{00723\ \ \ \ \ ret\ (\textcolor{keyword}{false}),}
\DoxyCodeLine{00724\ \ \ \ \ c\ (c\_),}
\DoxyCodeLine{00725\ \ \ \ \ mark\ (0),}
\DoxyCodeLine{00726\ \ \ \ \ insertionAction\ (table+table-\/>insertionAction)\ \{\}}
\DoxyCodeLine{00727\ }
\DoxyCodeLine{00728\ \ \ \ \ \textcolor{keywordtype}{bool}\ is\_actionable\ (\mbox{\hyperlink{struct_a_a_t_1_1_state_table_driver}{StateTableDriver<Types,\ EntryData>}}\ *driver\ HB\_UNUSED,}
\DoxyCodeLine{00729\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_a_a_t_1_1_entry}{Entry<EntryData>}}\ \&\mbox{\hyperlink{structentry}{entry}})}
\DoxyCodeLine{00730\ \ \ \ \ \{}
\DoxyCodeLine{00731\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{structentry}{entry}}.flags\ \&\ (CurrentInsertCount\ |\ MarkedInsertCount))\ \&\&}
\DoxyCodeLine{00732\ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{structentry}{entry}}.data.currentInsertIndex\ !=\ 0xFFFF\ ||\mbox{\hyperlink{structentry}{entry}}.data.markedInsertIndex\ !=\ 0xFFFF);}
\DoxyCodeLine{00733\ \ \ \ \ \}}
\DoxyCodeLine{00734\ \ \ \ \ \textcolor{keywordtype}{void}\ transition\ (\mbox{\hyperlink{struct_a_a_t_1_1_state_table_driver}{StateTableDriver<Types,\ EntryData>}}\ *driver,}
\DoxyCodeLine{00735\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_a_a_t_1_1_entry}{Entry<EntryData>}}\ \&\mbox{\hyperlink{structentry}{entry}})}
\DoxyCodeLine{00736\ \ \ \ \ \{}
\DoxyCodeLine{00737\ \ \ \ \ \ \ \mbox{\hyperlink{structhb__buffer__t}{hb\_buffer\_t}}\ *\mbox{\hyperlink{classbuffer}{buffer}}\ =\ driver-\/>buffer;}
\DoxyCodeLine{00738\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ flags\ =\ \mbox{\hyperlink{structentry}{entry}}.flags;}
\DoxyCodeLine{00739\ }
\DoxyCodeLine{00740\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ mark\_loc\ =\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>out\_len;}
\DoxyCodeLine{00741\ }
\DoxyCodeLine{00742\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structentry}{entry}}.data.markedInsertIndex\ !=\ 0xFFFF)}
\DoxyCodeLine{00743\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00744\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ (flags\ \&\ MarkedInsertCount);}
\DoxyCodeLine{00745\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ ((\mbox{\hyperlink{classbuffer}{buffer}}-\/>max\_ops\ -\/=\ count)\ <=\ 0))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00746\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ start\ =\ \mbox{\hyperlink{structentry}{entry}}.data.markedInsertIndex;}
\DoxyCodeLine{00747\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_h_b_glyph_i_d16}{HBGlyphID16}}\ *glyphs\ =\ \&insertionAction[start];}
\DoxyCodeLine{00748\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>sanitizer.check\_array\ (glyphs,\ count)))\ count\ =\ 0;}
\DoxyCodeLine{00749\ }
\DoxyCodeLine{00750\ \ \ \ \ \textcolor{keywordtype}{bool}\ before\ =\ flags\ \&\ MarkedInsertBefore;}
\DoxyCodeLine{00751\ }
\DoxyCodeLine{00752\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ end\ =\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>out\_len;}
\DoxyCodeLine{00753\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!\mbox{\hyperlink{classbuffer}{buffer}}-\/>move\_to\ (mark)))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00754\ }
\DoxyCodeLine{00755\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classbuffer}{buffer}}-\/>idx\ <\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>len\ \&\&\ !before)}
\DoxyCodeLine{00756\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!\mbox{\hyperlink{classbuffer}{buffer}}-\/>copy\_glyph\ ()))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00757\ \ \ \ \ \textcolor{comment}{/*\ TODO\ We\ ignore\ KashidaLike\ setting.\ */}}
\DoxyCodeLine{00758\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!\mbox{\hyperlink{classbuffer}{buffer}}-\/>replace\_glyphs\ (0,\ count,\ glyphs)))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00759\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classbuffer}{buffer}}-\/>idx\ <\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>len\ \&\&\ !before)}
\DoxyCodeLine{00760\ \ \ \ \ \ \ \mbox{\hyperlink{classbuffer}{buffer}}-\/>skip\_glyph\ ();}
\DoxyCodeLine{00761\ }
\DoxyCodeLine{00762\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!\mbox{\hyperlink{classbuffer}{buffer}}-\/>move\_to\ (end\ +\ count)))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00763\ }
\DoxyCodeLine{00764\ \ \ \ \ \mbox{\hyperlink{classbuffer}{buffer}}-\/>unsafe\_to\_break\_from\_outbuffer\ (mark,\ hb\_min\ (\mbox{\hyperlink{classbuffer}{buffer}}-\/>idx\ +\ 1,\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>len));}
\DoxyCodeLine{00765\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00766\ }
\DoxyCodeLine{00767\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (flags\ \&\ SetMark)}
\DoxyCodeLine{00768\ \ \ \ \ mark\ =\ mark\_loc;}
\DoxyCodeLine{00769\ }
\DoxyCodeLine{00770\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structentry}{entry}}.data.currentInsertIndex\ !=\ 0xFFFF)}
\DoxyCodeLine{00771\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00772\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ (flags\ \&\ CurrentInsertCount)\ >>\ 5;}
\DoxyCodeLine{00773\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ ((\mbox{\hyperlink{classbuffer}{buffer}}-\/>max\_ops\ -\/=\ count)\ <=\ 0))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00774\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ start\ =\ \mbox{\hyperlink{structentry}{entry}}.data.currentInsertIndex;}
\DoxyCodeLine{00775\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_h_b_glyph_i_d16}{HBGlyphID16}}\ *glyphs\ =\ \&insertionAction[start];}
\DoxyCodeLine{00776\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>sanitizer.check\_array\ (glyphs,\ count)))\ count\ =\ 0;}
\DoxyCodeLine{00777\ }
\DoxyCodeLine{00778\ \ \ \ \ \textcolor{keywordtype}{bool}\ before\ =\ flags\ \&\ CurrentInsertBefore;}
\DoxyCodeLine{00779\ }
\DoxyCodeLine{00780\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ end\ =\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>out\_len;}
\DoxyCodeLine{00781\ }
\DoxyCodeLine{00782\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classbuffer}{buffer}}-\/>idx\ <\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>len\ \&\&\ !before)}
\DoxyCodeLine{00783\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!\mbox{\hyperlink{classbuffer}{buffer}}-\/>copy\_glyph\ ()))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00784\ \ \ \ \ \textcolor{comment}{/*\ TODO\ We\ ignore\ KashidaLike\ setting.\ */}}
\DoxyCodeLine{00785\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!\mbox{\hyperlink{classbuffer}{buffer}}-\/>replace\_glyphs\ (0,\ count,\ glyphs)))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00786\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classbuffer}{buffer}}-\/>idx\ <\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>len\ \&\&\ !before)}
\DoxyCodeLine{00787\ \ \ \ \ \ \ \mbox{\hyperlink{classbuffer}{buffer}}-\/>skip\_glyph\ ();}
\DoxyCodeLine{00788\ }
\DoxyCodeLine{00789\ \ \ \ \ \textcolor{comment}{/*\ Humm.\ Not\ sure\ where\ to\ move\ to.\ \ There's\ this\ wording\ under}}
\DoxyCodeLine{00790\ \textcolor{comment}{\ \ \ \ \ *\ DontAdvance\ flag:}}
\DoxyCodeLine{00791\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00792\ \textcolor{comment}{\ \ \ \ \ *\ "{}If\ set,\ don't\ update\ the\ glyph\ index\ before\ going\ to\ the\ new\ state.}}
\DoxyCodeLine{00793\ \textcolor{comment}{\ \ \ \ \ *\ This\ does\ not\ mean\ that\ the\ glyph\ pointed\ to\ is\ the\ same\ one\ as}}
\DoxyCodeLine{00794\ \textcolor{comment}{\ \ \ \ \ *\ before.\ If\ you've\ made\ insertions\ immediately\ downstream\ of\ the}}
\DoxyCodeLine{00795\ \textcolor{comment}{\ \ \ \ \ *\ current\ glyph,\ the\ next\ glyph\ processed\ would\ in\ fact\ be\ the\ first}}
\DoxyCodeLine{00796\ \textcolor{comment}{\ \ \ \ \ *\ one\ inserted."{}}}
\DoxyCodeLine{00797\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00798\ \textcolor{comment}{\ \ \ \ \ *\ This\ suggests\ that\ if\ DontAdvance\ is\ NOT\ set,\ we\ should\ move\ to}}
\DoxyCodeLine{00799\ \textcolor{comment}{\ \ \ \ \ *\ end+count.\ \ If\ it\ *was*,\ then\ move\ to\ end,\ such\ that\ newly\ inserted}}
\DoxyCodeLine{00800\ \textcolor{comment}{\ \ \ \ \ *\ glyphs\ are\ now\ visible.}}
\DoxyCodeLine{00801\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00802\ \textcolor{comment}{\ \ \ \ \ *\ https://github.com/harfbuzz/harfbuzz/issues/1224\#issuecomment-\/427691417}}
\DoxyCodeLine{00803\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00804\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!\mbox{\hyperlink{classbuffer}{buffer}}-\/>move\_to\ ((flags\ \&\ DontAdvance)\ ?\ end\ :\ end\ +\ count)))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00805\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00806\ \ \ \ \ \}}
\DoxyCodeLine{00807\ }
\DoxyCodeLine{00808\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00809\ \ \ \ \ \textcolor{keywordtype}{bool}\ ret;}
\DoxyCodeLine{00810\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00811\ \ \ \ \ \mbox{\hyperlink{struct_a_a_t_1_1hb__aat__apply__context__t}{hb\_aat\_apply\_context\_t}}\ *c;}
\DoxyCodeLine{00812\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ mark;}
\DoxyCodeLine{00813\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_unsized_array_of}{UnsizedArrayOf<HBGlyphID16>}}\ \&insertionAction;}
\DoxyCodeLine{00814\ \ \ \};}
\DoxyCodeLine{00815\ }
\DoxyCodeLine{00816\ \ \ \textcolor{keywordtype}{bool}\ apply\ (\mbox{\hyperlink{struct_a_a_t_1_1hb__aat__apply__context__t}{hb\_aat\_apply\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00817\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00818\ \ \ \ \ TRACE\_APPLY\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00819\ }
\DoxyCodeLine{00820\ \ \ \ \ \mbox{\hyperlink{struct_a_a_t_1_1_insertion_subtable_1_1driver__context__t}{driver\_context\_t}}\ dc\ (\textcolor{keyword}{this},\ c);}
\DoxyCodeLine{00821\ }
\DoxyCodeLine{00822\ \ \ \ \ \mbox{\hyperlink{struct_a_a_t_1_1_state_table_driver}{StateTableDriver<Types,\ EntryData>}}\ driver\ (machine,\ c-\/>buffer,\ c-\/>face);}
\DoxyCodeLine{00823\ \ \ \ \ driver.drive\ (\&dc);}
\DoxyCodeLine{00824\ }
\DoxyCodeLine{00825\ \ \ \ \ return\_trace\ (dc.ret);}
\DoxyCodeLine{00826\ \ \ \}}
\DoxyCodeLine{00827\ }
\DoxyCodeLine{00828\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00829\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00830\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00831\ \ \ \ \ \textcolor{comment}{/*\ The\ rest\ of\ array\ sanitizations\ are\ done\ at\ run-\/time.\ */}}
\DoxyCodeLine{00832\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this})\ \&\&\ machine.sanitize\ (c)\ \&\&}
\DoxyCodeLine{00833\ \ \ \ \ \ \ \ \ \ \ insertionAction);}
\DoxyCodeLine{00834\ \ \ \}}
\DoxyCodeLine{00835\ }
\DoxyCodeLine{00836\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00837\ \ \ StateTable<Types,\ EntryData>}
\DoxyCodeLine{00838\ \ \ \ \ \ \ \ \ machine;}
\DoxyCodeLine{00839\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{NNOffsetTo<UnsizedArrayOf<HBGlyphID16>}},\ HBUINT>}
\DoxyCodeLine{00840\ \ \ \ \ \ \ \ \ insertionAction;\ \ \ \ \textcolor{comment}{/*\ Byte\ offset\ from\ stateHeader\ to\ the\ start\ of}}
\DoxyCodeLine{00841\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ the\ insertion\ glyph\ table.\ */}}
\DoxyCodeLine{00842\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00843\ \ \ DEFINE\_SIZE\_STATIC\ (20);}
\DoxyCodeLine{00844\ \};}
\DoxyCodeLine{00845\ }
\DoxyCodeLine{00846\ }
\DoxyCodeLine{00847\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_a_a_t_1_1_feature}{Feature}}}
\DoxyCodeLine{00848\ \{}
\DoxyCodeLine{00849\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00850\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00851\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00852\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this}));}
\DoxyCodeLine{00853\ \ \ \}}
\DoxyCodeLine{00854\ }
\DoxyCodeLine{00855\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00856\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ featureType;\ \ \ \ \textcolor{comment}{/*\ The\ type\ of\ feature.\ */}}
\DoxyCodeLine{00857\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ featureSetting;\ \textcolor{comment}{/*\ The\ feature's\ setting\ (aka\ selector).\ */}}
\DoxyCodeLine{00858\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT32}}\ \ enableFlags;\ \ \ \ \textcolor{comment}{/*\ Flags\ for\ the\ settings\ that\ this\ feature}}
\DoxyCodeLine{00859\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ and\ setting\ enables.\ */}}
\DoxyCodeLine{00860\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT32}}\ \ disableFlags;\ \ \ \textcolor{comment}{/*\ Complement\ of\ flags\ for\ the\ settings\ that\ this}}
\DoxyCodeLine{00861\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ feature\ and\ setting\ disable.\ */}}
\DoxyCodeLine{00862\ }
\DoxyCodeLine{00863\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00864\ \ \ DEFINE\_SIZE\_STATIC\ (12);}
\DoxyCodeLine{00865\ \};}
\DoxyCodeLine{00866\ }
\DoxyCodeLine{00867\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Types>}
\DoxyCodeLine{00868\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_a_a_t_1_1_chain_subtable}{ChainSubtable}}}
\DoxyCodeLine{00869\ \{}
\DoxyCodeLine{00870\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Types::HBUINT\ HBUINT;}
\DoxyCodeLine{00871\ }
\DoxyCodeLine{00872\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00873\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_a_a_t_1_1_chain}{Chain}};}
\DoxyCodeLine{00874\ }
\DoxyCodeLine{00875\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_size\ ()\textcolor{keyword}{\ const\ \ \ \ \ }\{\ \textcolor{keywordflow}{return}\ length;\ \}}
\DoxyCodeLine{00876\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_type\ ()\textcolor{keyword}{\ const\ \ \ \ \ }\{\ \textcolor{keywordflow}{return}\ coverage\ \&\ 0xFF;\ \}}
\DoxyCodeLine{00877\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_coverage\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ coverage\ >>\ (\textcolor{keyword}{sizeof}\ (HBUINT)\ *\ 8\ -\/\ 8);\ \}}
\DoxyCodeLine{00878\ }
\DoxyCodeLine{00879\ \ \ \textcolor{keyword}{enum}\ Coverage}
\DoxyCodeLine{00880\ \ \ \{}
\DoxyCodeLine{00881\ \ \ \ \ Vertical\ \ \ \ \ \ \ \ =\ 0x80,\ \textcolor{comment}{/*\ If\ set,\ this\ subtable\ will\ only\ be\ applied}}
\DoxyCodeLine{00882\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ to\ vertical\ text.\ If\ clear,\ this\ subtable}}
\DoxyCodeLine{00883\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ will\ only\ be\ applied\ to\ horizontal\ text.\ */}}
\DoxyCodeLine{00884\ \ \ \ \ Backwards\ \ \ \ \ \ \ =\ 0x40,\ \textcolor{comment}{/*\ If\ set,\ this\ subtable\ will\ process\ glyphs}}
\DoxyCodeLine{00885\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ in\ descending\ order.\ If\ clear,\ it\ will}}
\DoxyCodeLine{00886\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ process\ the\ glyphs\ in\ ascending\ order.\ */}}
\DoxyCodeLine{00887\ \ \ \ \ AllDirections\ \ \ =\ 0x20,\ \textcolor{comment}{/*\ If\ set,\ this\ subtable\ will\ be\ applied\ to}}
\DoxyCodeLine{00888\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ both\ horizontal\ and\ vertical\ text\ (i.e.}}
\DoxyCodeLine{00889\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ the\ state\ of\ bit\ 0x80000000\ is\ ignored).\ */}}
\DoxyCodeLine{00890\ \ \ \ \ Logical\ \ \ \ \ =\ 0x10,\ \textcolor{comment}{/*\ If\ set,\ this\ subtable\ will\ process\ glyphs}}
\DoxyCodeLine{00891\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ in\ logical\ order\ (or\ reverse\ logical\ order,}}
\DoxyCodeLine{00892\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ depending\ on\ the\ value\ of\ bit\ 0x80000000).\ */}}
\DoxyCodeLine{00893\ \ \ \};}
\DoxyCodeLine{00894\ \ \ \textcolor{keyword}{enum}\ Type}
\DoxyCodeLine{00895\ \ \ \{}
\DoxyCodeLine{00896\ \ \ \ \ Rearrangement\ \ \ =\ 0,}
\DoxyCodeLine{00897\ \ \ \ \ Contextual\ \ \ \ \ \ =\ 1,}
\DoxyCodeLine{00898\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_ligature}{Ligature}}\ \ \ \ \ \ \ \ =\ 2,}
\DoxyCodeLine{00899\ \ \ \ \ Noncontextual\ \ \ =\ 4,}
\DoxyCodeLine{00900\ \ \ \ \ Insertion\ \ \ \ \ \ \ =\ 5}
\DoxyCodeLine{00901\ \ \ \};}
\DoxyCodeLine{00902\ }
\DoxyCodeLine{00903\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ context\_t,\ \textcolor{keyword}{typename}\ ...Ts>}
\DoxyCodeLine{00904\ \ \ \textcolor{keyword}{typename}\ context\_t::return\_t\ dispatch\ (context\_t\ *c,\ Ts\&\&...\ ds)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00905\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00906\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ subtable\_type\ =\ get\_type\ ();}
\DoxyCodeLine{00907\ \ \ \ \ TRACE\_DISPATCH\ (\textcolor{keyword}{this},\ subtable\_type);}
\DoxyCodeLine{00908\ \ \ \ \ \textcolor{keywordflow}{switch}\ (subtable\_type)\ \{}
\DoxyCodeLine{00909\ \ \ \ \ \textcolor{keywordflow}{case}\ Rearrangement:\ \ \ \ \ return\_trace\ (c-\/>dispatch\ (u.rearrangement,\ std::forward<Ts>\ (ds)...));}
\DoxyCodeLine{00910\ \ \ \ \ \textcolor{keywordflow}{case}\ Contextual:\ \ \ \ \ \ \ \ return\_trace\ (c-\/>dispatch\ (u.contextual,\ std::forward<Ts>\ (ds)...));}
\DoxyCodeLine{00911\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{struct_o_t_1_1_ligature}{Ligature}}:\ \ \ \ \ \ return\_trace\ (c-\/>dispatch\ (u.ligature,\ std::forward<Ts>\ (ds)...));}
\DoxyCodeLine{00912\ \ \ \ \ \textcolor{keywordflow}{case}\ Noncontextual:\ \ \ \ \ return\_trace\ (c-\/>dispatch\ (u.noncontextual,\ std::forward<Ts>\ (ds)...));}
\DoxyCodeLine{00913\ \ \ \ \ \textcolor{keywordflow}{case}\ Insertion:\ \ \ \ \ return\_trace\ (c-\/>dispatch\ (u.insertion,\ std::forward<Ts>\ (ds)...));}
\DoxyCodeLine{00914\ \ \ \ \ \textcolor{keywordflow}{default}:\ \ \ \ \ \ \ \ \ \ \ \ return\_trace\ (c-\/>default\_return\_value\ ());}
\DoxyCodeLine{00915\ \ \ \ \ \}}
\DoxyCodeLine{00916\ \ \ \}}
\DoxyCodeLine{00917\ }
\DoxyCodeLine{00918\ \ \ \textcolor{keywordtype}{bool}\ apply\ (\mbox{\hyperlink{struct_a_a_t_1_1hb__aat__apply__context__t}{hb\_aat\_apply\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00919\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00920\ \ \ \ \ TRACE\_APPLY\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00921\ \ \ \ \ \mbox{\hyperlink{structhb__sanitize__with__object__t}{hb\_sanitize\_with\_object\_t}}\ with\ (\&c-\/>sanitizer,\ \textcolor{keyword}{this});}
\DoxyCodeLine{00922\ \ \ \ \ return\_trace\ (dispatch\ (c));}
\DoxyCodeLine{00923\ \ \ \}}
\DoxyCodeLine{00924\ }
\DoxyCodeLine{00925\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00926\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00927\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00928\ \ \ \ \ \textcolor{keywordflow}{if}\ (!length.sanitize\ (c)\ ||}
\DoxyCodeLine{00929\ \ \ \ \ length\ <=\ min\_size\ ||}
\DoxyCodeLine{00930\ \ \ \ \ !c-\/>check\_range\ (\textcolor{keyword}{this},\ length))}
\DoxyCodeLine{00931\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{00932\ }
\DoxyCodeLine{00933\ \ \ \ \ \mbox{\hyperlink{structhb__sanitize__with__object__t}{hb\_sanitize\_with\_object\_t}}\ with\ (c,\ \textcolor{keyword}{this});}
\DoxyCodeLine{00934\ \ \ \ \ return\_trace\ (dispatch\ (c));}
\DoxyCodeLine{00935\ \ \ \}}
\DoxyCodeLine{00936\ }
\DoxyCodeLine{00937\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00938\ \ \ HBUINT\ \ \ \ length;\ \ \ \ \ \textcolor{comment}{/*\ Total\ subtable\ length,\ including\ this\ header.\ */}}
\DoxyCodeLine{00939\ \ \ HBUINT\ \ \ \ coverage;\ \ \ \textcolor{comment}{/*\ Coverage\ flags\ and\ subtable\ type.\ */}}
\DoxyCodeLine{00940\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT32}}\ \ subFeatureFlags;\textcolor{comment}{/*\ The\ 32-\/bit\ mask\ identifying\ which\ subtable\ this\ is.\ */}}
\DoxyCodeLine{00941\ \ \ \textcolor{keyword}{union\ }\{}
\DoxyCodeLine{00942\ \ \ \mbox{\hyperlink{struct_a_a_t_1_1_rearrangement_subtable}{RearrangementSubtable<Types>}}\ \ rearrangement;}
\DoxyCodeLine{00943\ \ \ \mbox{\hyperlink{struct_a_a_t_1_1_contextual_subtable}{ContextualSubtable<Types>}}\ \ \ \ contextual;}
\DoxyCodeLine{00944\ \ \ \mbox{\hyperlink{struct_a_a_t_1_1_ligature_subtable}{LigatureSubtable<Types>}}\ \ \ \ ligature;}
\DoxyCodeLine{00945\ \ \ \mbox{\hyperlink{struct_a_a_t_1_1_noncontextual_subtable}{NoncontextualSubtable<Types>}}\ \ noncontextual;}
\DoxyCodeLine{00946\ \ \ \mbox{\hyperlink{struct_a_a_t_1_1_insertion_subtable}{InsertionSubtable<Types>}}\ \ insertion;}
\DoxyCodeLine{00947\ \ \ \}\ u;}
\DoxyCodeLine{00948\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00949\ \ \ DEFINE\_SIZE\_MIN\ (2\ *\ \textcolor{keyword}{sizeof}\ (HBUINT)\ +\ 4);}
\DoxyCodeLine{00950\ \};}
\DoxyCodeLine{00951\ }
\DoxyCodeLine{00952\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Types>}
\DoxyCodeLine{00953\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_a_a_t_1_1_chain}{Chain}}}
\DoxyCodeLine{00954\ \{}
\DoxyCodeLine{00955\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Types::HBUINT\ HBUINT;}
\DoxyCodeLine{00956\ }
\DoxyCodeLine{00957\ \ \ hb\_mask\_t\ compile\_flags\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__aat__map__builder__t}{hb\_aat\_map\_builder\_t}}\ *map)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00958\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00959\ \ \ \ \ hb\_mask\_t\ flags\ =\ defaultFlags;}
\DoxyCodeLine{00960\ \ \ \ \ \{}
\DoxyCodeLine{00961\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ featureCount;}
\DoxyCodeLine{00962\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{00963\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00964\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_a_a_t_1_1_feature}{Feature}}\ \&feature\ =\ featureZ[i];}
\DoxyCodeLine{00965\ \ \ \ \ hb\_aat\_layout\_feature\_type\_t\ type\ =\ (hb\_aat\_layout\_feature\_type\_t)\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int})\ feature.featureType;}
\DoxyCodeLine{00966\ \ \ \ \ hb\_aat\_layout\_feature\_selector\_t\ setting\ =\ (hb\_aat\_layout\_feature\_selector\_t)\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int})\ feature.featureSetting;}
\DoxyCodeLine{00967\ \ \ \ \ \ \ retry:}
\DoxyCodeLine{00968\ \ \ \ \ \textcolor{comment}{//\ Check\ whether\ this\ type/setting\ pair\ was\ requested\ in\ the\ map,\ and\ if\ so,\ apply\ its\ flags.}}
\DoxyCodeLine{00969\ \ \ \ \ \textcolor{comment}{//\ (The\ search\ here\ only\ looks\ at\ the\ type\ and\ setting\ fields\ of\ feature\_info\_t.)}}
\DoxyCodeLine{00970\ \ \ \ \ \mbox{\hyperlink{structhb__aat__map__builder__t_1_1feature__info__t}{hb\_aat\_map\_builder\_t::feature\_info\_t}}\ info\ =\ \{\ type,\ setting,\ \textcolor{keyword}{false},\ 0\ \};}
\DoxyCodeLine{00971\ \ \ \ \ \textcolor{keywordflow}{if}\ (map-\/>features.bsearch\ (info))}
\DoxyCodeLine{00972\ \ \ \ \ \{}
\DoxyCodeLine{00973\ \ \ \ \ \ \ flags\ \&=\ feature.disableFlags;}
\DoxyCodeLine{00974\ \ \ \ \ \ \ flags\ |=\ feature.enableFlags;}
\DoxyCodeLine{00975\ \ \ \ \ \}}
\DoxyCodeLine{00976\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (type\ ==\ HB\_AAT\_LAYOUT\_FEATURE\_TYPE\_LETTER\_CASE\ \&\&\ setting\ ==\ HB\_AAT\_LAYOUT\_FEATURE\_SELECTOR\_SMALL\_CAPS)}
\DoxyCodeLine{00977\ \ \ \ \ \{}
\DoxyCodeLine{00978\ \ \ \ \ \ \ \textcolor{comment}{/*\ Deprecated.\ https://github.com/harfbuzz/harfbuzz/issues/1342\ */}}
\DoxyCodeLine{00979\ \ \ \ \ \ \ type\ =\ HB\_AAT\_LAYOUT\_FEATURE\_TYPE\_LOWER\_CASE;}
\DoxyCodeLine{00980\ \ \ \ \ \ \ setting\ =\ HB\_AAT\_LAYOUT\_FEATURE\_SELECTOR\_LOWER\_CASE\_SMALL\_CAPS;}
\DoxyCodeLine{00981\ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ retry;}
\DoxyCodeLine{00982\ \ \ \ \ \}}
\DoxyCodeLine{00983\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00984\ \ \ \ \ \}}
\DoxyCodeLine{00985\ \ \ \ \ \textcolor{keywordflow}{return}\ flags;}
\DoxyCodeLine{00986\ \ \ \}}
\DoxyCodeLine{00987\ }
\DoxyCodeLine{00988\ \ \ \textcolor{keywordtype}{void}\ apply\ (\mbox{\hyperlink{struct_a_a_t_1_1hb__aat__apply__context__t}{hb\_aat\_apply\_context\_t}}\ *c,}
\DoxyCodeLine{00989\ \ \ \ \ \ \ \ \ \ \ hb\_mask\_t\ flags)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00990\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00991\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_a_a_t_1_1_chain_subtable}{ChainSubtable<Types>}}\ *subtable\ =\ \&StructAfter<ChainSubtable<Types>>\ (featureZ.as\_array\ (featureCount));}
\DoxyCodeLine{00992\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ subtableCount;}
\DoxyCodeLine{00993\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{00994\ \ \ \ \ \{}
\DoxyCodeLine{00995\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ reverse;}
\DoxyCodeLine{00996\ }
\DoxyCodeLine{00997\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!(subtable-\/>subFeatureFlags\ \&\ flags))}
\DoxyCodeLine{00998\ \ \ \ \ \textcolor{keywordflow}{goto}\ skip;}
\DoxyCodeLine{00999\ }
\DoxyCodeLine{01000\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!(subtable-\/>get\_coverage()\ \&\ \mbox{\hyperlink{struct_a_a_t_1_1_chain_subtable}{ChainSubtable<Types>::AllDirections}})\ \&\&}
\DoxyCodeLine{01001\ \ \ \ \ \ \ HB\_DIRECTION\_IS\_VERTICAL\ (c-\/>buffer-\/>props.direction)\ !=}
\DoxyCodeLine{01002\ \ \ \ \ \ \ bool\ (subtable-\/>get\_coverage()\ \&\ \mbox{\hyperlink{struct_a_a_t_1_1_chain_subtable}{ChainSubtable<Types>::Vertical}}))}
\DoxyCodeLine{01003\ \ \ \ \ \textcolor{keywordflow}{goto}\ skip;}
\DoxyCodeLine{01004\ }
\DoxyCodeLine{01005\ \ \ \ \ \ \ \textcolor{comment}{/*\ Buffer\ contents\ is\ always\ in\ logical\ direction.\ \ Determine\ if}}
\DoxyCodeLine{01006\ \textcolor{comment}{\ \ \ \ \ \ \ *\ we\ need\ to\ reverse\ before\ applying\ this\ subtable.\ \ We\ reverse}}
\DoxyCodeLine{01007\ \textcolor{comment}{\ \ \ \ \ \ \ *\ back\ after\ if\ we\ did\ reverse\ indeed.}}
\DoxyCodeLine{01008\ \textcolor{comment}{\ \ \ \ \ \ \ *}}
\DoxyCodeLine{01009\ \textcolor{comment}{\ \ \ \ \ \ \ *\ Quoting\ the\ spac:}}
\DoxyCodeLine{01010\ \textcolor{comment}{\ \ \ \ \ \ \ *\ "{}"{}"{}}}
\DoxyCodeLine{01011\ \textcolor{comment}{\ \ \ \ \ \ \ *\ Bits\ 28\ and\ 30\ of\ the\ coverage\ field\ control\ the\ order\ in\ which}}
\DoxyCodeLine{01012\ \textcolor{comment}{\ \ \ \ \ \ \ *\ glyphs\ are\ processed\ when\ the\ subtable\ is\ run\ by\ the\ layout\ engine.}}
\DoxyCodeLine{01013\ \textcolor{comment}{\ \ \ \ \ \ \ *\ Bit\ 28\ is\ used\ to\ indicate\ if\ the\ glyph\ processing\ direction\ is}}
\DoxyCodeLine{01014\ \textcolor{comment}{\ \ \ \ \ \ \ *\ the\ same\ as\ logical\ order\ or\ layout\ order.\ Bit\ 30\ is\ used\ to}}
\DoxyCodeLine{01015\ \textcolor{comment}{\ \ \ \ \ \ \ *\ indicate\ whether\ glyphs\ are\ processed\ forwards\ or\ backwards\ within}}
\DoxyCodeLine{01016\ \textcolor{comment}{\ \ \ \ \ \ \ *\ that\ order.}}
\DoxyCodeLine{01017\ \textcolor{comment}{}}
\DoxyCodeLine{01018\ \textcolor{comment}{\ \ \ \ \ \ \ \ Bit\ 30\ \ Bit\ 28\ \ Interpretation\ for\ Horizontal\ Text}}
\DoxyCodeLine{01019\ \textcolor{comment}{\ \ \ \ \ \ \ \ 0\ \ \ 0\ \ \ The\ subtable\ is\ processed\ in\ layout\ order}}
\DoxyCodeLine{01020\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (the\ same\ order\ as\ the\ glyphs,\ which\ is}}
\DoxyCodeLine{01021\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ always\ left-\/to-\/right).}}
\DoxyCodeLine{01022\ \textcolor{comment}{\ \ \ \ \ \ \ \ 1\ \ \ 0\ \ \ The\ subtable\ is\ processed\ in\ reverse\ layout\ order}}
\DoxyCodeLine{01023\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (the\ order\ opposite\ that\ of\ the\ glyphs,\ which\ is}}
\DoxyCodeLine{01024\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ always\ right-\/to-\/left).}}
\DoxyCodeLine{01025\ \textcolor{comment}{\ \ \ \ \ \ \ \ 0\ \ \ 1\ \ \ The\ subtable\ is\ processed\ in\ logical\ order}}
\DoxyCodeLine{01026\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (the\ same\ order\ as\ the\ characters,\ which\ may\ be}}
\DoxyCodeLine{01027\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ left-\/to-\/right\ or\ right-\/to-\/left).}}
\DoxyCodeLine{01028\ \textcolor{comment}{\ \ \ \ \ \ \ \ 1\ \ \ 1\ \ \ The\ subtable\ is\ processed\ in\ reverse\ logical\ order}}
\DoxyCodeLine{01029\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (the\ order\ opposite\ that\ of\ the\ characters,\ which}}
\DoxyCodeLine{01030\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ may\ be\ right-\/to-\/left\ or\ left-\/to-\/right).}}
\DoxyCodeLine{01031\ \textcolor{comment}{\ \ \ \ \ \ \ */}}
\DoxyCodeLine{01032\ \ \ \ \ \ \ reverse\ =\ subtable-\/>get\_coverage\ ()\ \&\ \mbox{\hyperlink{struct_a_a_t_1_1_chain_subtable}{ChainSubtable<Types>::Logical}}\ ?}
\DoxyCodeLine{01033\ \ \ \ \ \ \ \ \ bool\ (subtable-\/>get\_coverage\ ()\ \&\ \mbox{\hyperlink{struct_a_a_t_1_1_chain_subtable}{ChainSubtable<Types>::Backwards}})\ :}
\DoxyCodeLine{01034\ \ \ \ \ \ \ \ \ bool\ (subtable-\/>get\_coverage\ ()\ \&\ \mbox{\hyperlink{struct_a_a_t_1_1_chain_subtable}{ChainSubtable<Types>::Backwards}})\ !=}
\DoxyCodeLine{01035\ \ \ \ \ \ \ \ \ HB\_DIRECTION\_IS\_BACKWARD\ (c-\/>buffer-\/>props.direction);}
\DoxyCodeLine{01036\ }
\DoxyCodeLine{01037\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!c-\/>buffer-\/>message\ (c-\/>font,\ \textcolor{stringliteral}{"{}start\ chainsubtable\ \%d"{}},\ c-\/>lookup\_index))}
\DoxyCodeLine{01038\ \ \ \ \ \textcolor{keywordflow}{goto}\ skip;}
\DoxyCodeLine{01039\ }
\DoxyCodeLine{01040\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (reverse)}
\DoxyCodeLine{01041\ \ \ \ \ \_hb\_ot\_layout\_reverse\_graphemes\ (c-\/>buffer);}
\DoxyCodeLine{01042\ }
\DoxyCodeLine{01043\ \ \ \ \ \ \ subtable-\/>apply\ (c);}
\DoxyCodeLine{01044\ }
\DoxyCodeLine{01045\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (reverse)}
\DoxyCodeLine{01046\ \ \ \ \ \_hb\_ot\_layout\_reverse\_graphemes\ (c-\/>buffer);}
\DoxyCodeLine{01047\ }
\DoxyCodeLine{01048\ \ \ \ \ \ \ (void)\ c-\/>buffer-\/>message\ (c-\/>font,\ \textcolor{stringliteral}{"{}end\ chainsubtable\ \%d"{}},\ c-\/>lookup\_index);}
\DoxyCodeLine{01049\ }
\DoxyCodeLine{01050\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>buffer-\/>successful))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01051\ }
\DoxyCodeLine{01052\ \ \ \ \ skip:}
\DoxyCodeLine{01053\ \ \ \ \ \ \ subtable\ =\ \&StructAfter<ChainSubtable<Types>>\ (*subtable);}
\DoxyCodeLine{01054\ \ \ \ \ \ \ c-\/>set\_lookup\_index\ (c-\/>lookup\_index\ +\ 1);}
\DoxyCodeLine{01055\ \ \ \ \ \}}
\DoxyCodeLine{01056\ \ \ \}}
\DoxyCodeLine{01057\ }
\DoxyCodeLine{01058\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_size\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ length;\ \}}
\DoxyCodeLine{01059\ }
\DoxyCodeLine{01060\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ version\ HB\_UNUSED)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01061\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01062\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01063\ \ \ \ \ \textcolor{keywordflow}{if}\ (!length.sanitize\ (c)\ ||}
\DoxyCodeLine{01064\ \ \ \ \ length\ <\ min\_size\ ||}
\DoxyCodeLine{01065\ \ \ \ \ !c-\/>check\_range\ (\textcolor{keyword}{this},\ length))}
\DoxyCodeLine{01066\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01067\ }
\DoxyCodeLine{01068\ \ \ \ \ \textcolor{keywordflow}{if}\ (!c-\/>check\_array\ (featureZ.arrayZ,\ featureCount))}
\DoxyCodeLine{01069\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01070\ }
\DoxyCodeLine{01071\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_a_a_t_1_1_chain_subtable}{ChainSubtable<Types>}}\ *subtable\ =\ \&StructAfter<ChainSubtable<Types>>\ (featureZ.as\_array\ (featureCount));}
\DoxyCodeLine{01072\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ subtableCount;}
\DoxyCodeLine{01073\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{01074\ \ \ \ \ \{}
\DoxyCodeLine{01075\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!subtable-\/>sanitize\ (c))}
\DoxyCodeLine{01076\ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01077\ \ \ \ \ \ \ subtable\ =\ \&StructAfter<ChainSubtable<Types>>\ (*subtable);}
\DoxyCodeLine{01078\ \ \ \ \ \}}
\DoxyCodeLine{01079\ }
\DoxyCodeLine{01080\ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{01081\ \ \ \}}
\DoxyCodeLine{01082\ }
\DoxyCodeLine{01083\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{01084\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT32}}\ \ defaultFlags;\ \ \ \textcolor{comment}{/*\ The\ default\ specification\ for\ subtables.\ */}}
\DoxyCodeLine{01085\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT32}}\ \ length;\ \ \ \ \ \textcolor{comment}{/*\ Total\ byte\ count,\ including\ this\ header.\ */}}
\DoxyCodeLine{01086\ \ \ HBUINT\ \ \ \ featureCount;\ \ \ \textcolor{comment}{/*\ Number\ of\ feature\ subtable\ entries.\ */}}
\DoxyCodeLine{01087\ \ \ HBUINT\ \ \ \ subtableCount;\ \ \textcolor{comment}{/*\ The\ number\ of\ subtables\ in\ the\ chain.\ */}}
\DoxyCodeLine{01088\ }
\DoxyCodeLine{01089\ \ \ \mbox{\hyperlink{struct_o_t_1_1_unsized_array_of}{UnsizedArrayOf<Feature>}}\ \ \ \ featureZ;\ \ \ \textcolor{comment}{/*\ Features.\ */}}
\DoxyCodeLine{01090\ \textcolor{comment}{/*ChainSubtable\ firstSubtable;*/}\textcolor{comment}{/*\ Subtables.\ */}}
\DoxyCodeLine{01091\ \textcolor{comment}{/*subtableGlyphCoverageArray*/}\ \ \textcolor{comment}{/*\ Only\ if\ version\ >=\ 3.\ We\ don't\ use.\ */}}
\DoxyCodeLine{01092\ }
\DoxyCodeLine{01093\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01094\ \ \ DEFINE\_SIZE\_MIN\ (8\ +\ 2\ *\ \textcolor{keyword}{sizeof}\ (HBUINT));}
\DoxyCodeLine{01095\ \};}
\DoxyCodeLine{01096\ }
\DoxyCodeLine{01097\ }
\DoxyCodeLine{01098\ \textcolor{comment}{/*}}
\DoxyCodeLine{01099\ \textcolor{comment}{\ *\ The\ 'mort'/'morx'\ Table}}
\DoxyCodeLine{01100\ \textcolor{comment}{\ */}}
\DoxyCodeLine{01101\ }
\DoxyCodeLine{01102\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Types,\ hb\_tag\_t\ TAG>}
\DoxyCodeLine{01103\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_a_a_t_1_1mortmorx}{mortmorx}}}
\DoxyCodeLine{01104\ \{}
\DoxyCodeLine{01105\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ hb\_tag\_t\ tableTag\ =\ TAG;}
\DoxyCodeLine{01106\ }
\DoxyCodeLine{01107\ \ \ \textcolor{keywordtype}{bool}\ has\_data\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ version\ !=\ 0;\ \}}
\DoxyCodeLine{01108\ }
\DoxyCodeLine{01109\ \ \ \textcolor{keywordtype}{void}\ compile\_flags\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__aat__map__builder__t}{hb\_aat\_map\_builder\_t}}\ *mapper,}
\DoxyCodeLine{01110\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__aat__map__t}{hb\_aat\_map\_t}}\ *map)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01111\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01112\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_a_a_t_1_1_chain}{Chain<Types>}}\ *chain\ =\ \&firstChain;}
\DoxyCodeLine{01113\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ chainCount;}
\DoxyCodeLine{01114\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{01115\ \ \ \ \ \{}
\DoxyCodeLine{01116\ \ \ \ \ \ \ map-\/>chain\_flags.push\ (chain-\/>compile\_flags\ (mapper));}
\DoxyCodeLine{01117\ \ \ \ \ \ \ chain\ =\ \&StructAfter<Chain<Types>>\ (*chain);}
\DoxyCodeLine{01118\ \ \ \ \ \}}
\DoxyCodeLine{01119\ \ \ \}}
\DoxyCodeLine{01120\ }
\DoxyCodeLine{01121\ \ \ \textcolor{keywordtype}{void}\ apply\ (\mbox{\hyperlink{struct_a_a_t_1_1hb__aat__apply__context__t}{hb\_aat\_apply\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01122\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01123\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>buffer-\/>successful))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01124\ \ \ \ \ c-\/>set\_lookup\_index\ (0);}
\DoxyCodeLine{01125\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_a_a_t_1_1_chain}{Chain<Types>}}\ *chain\ =\ \&firstChain;}
\DoxyCodeLine{01126\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ chainCount;}
\DoxyCodeLine{01127\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{01128\ \ \ \ \ \{}
\DoxyCodeLine{01129\ \ \ \ \ \ \ chain-\/>apply\ (c,\ c-\/>plan-\/>aat\_map.chain\_flags[i]);}
\DoxyCodeLine{01130\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>buffer-\/>successful))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01131\ \ \ \ \ \ \ chain\ =\ \&StructAfter<Chain<Types>>\ (*chain);}
\DoxyCodeLine{01132\ \ \ \ \ \}}
\DoxyCodeLine{01133\ \ \ \}}
\DoxyCodeLine{01134\ }
\DoxyCodeLine{01135\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01136\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01137\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01138\ \ \ \ \ \textcolor{keywordflow}{if}\ (!version.sanitize\ (c)\ ||\ !version\ ||\ !chainCount.sanitize\ (c))}
\DoxyCodeLine{01139\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01140\ }
\DoxyCodeLine{01141\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_a_a_t_1_1_chain}{Chain<Types>}}\ *chain\ =\ \&firstChain;}
\DoxyCodeLine{01142\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ chainCount;}
\DoxyCodeLine{01143\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{01144\ \ \ \ \ \{}
\DoxyCodeLine{01145\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!chain-\/>sanitize\ (c,\ version))}
\DoxyCodeLine{01146\ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01147\ \ \ \ \ \ \ chain\ =\ \&StructAfter<Chain<Types>>\ (*chain);}
\DoxyCodeLine{01148\ \ \ \ \ \}}
\DoxyCodeLine{01149\ }
\DoxyCodeLine{01150\ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{01151\ \ \ \}}
\DoxyCodeLine{01152\ }
\DoxyCodeLine{01153\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{01154\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ version;\ \ \ \ \textcolor{comment}{/*\ Version\ number\ of\ the\ glyph\ metamorphosis\ table.}}
\DoxyCodeLine{01155\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ 1,\ 2,\ or\ 3.\ */}}
\DoxyCodeLine{01156\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ unused;\ \ \ \ \ \textcolor{comment}{/*\ Set\ to\ 0.\ */}}
\DoxyCodeLine{01157\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT32}}\ \ chainCount;\ \textcolor{comment}{/*\ Number\ of\ metamorphosis\ chains\ contained\ in\ this}}
\DoxyCodeLine{01158\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ table.\ */}}
\DoxyCodeLine{01159\ \ \ \mbox{\hyperlink{struct_a_a_t_1_1_chain}{Chain<Types>}}\ \ firstChain;\ \textcolor{comment}{/*\ Chains.\ */}}
\DoxyCodeLine{01160\ }
\DoxyCodeLine{01161\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01162\ \ \ DEFINE\_SIZE\_MIN\ (8);}
\DoxyCodeLine{01163\ \};}
\DoxyCodeLine{01164\ }
\DoxyCodeLine{01165\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_a_a_t_1_1morx}{morx}}\ :\ \mbox{\hyperlink{struct_a_a_t_1_1mortmorx}{mortmorx}}<ExtendedTypes,\ HB\_AAT\_TAG\_morx>\ \{\};}
\DoxyCodeLine{01166\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_a_a_t_1_1mort}{mort}}\ :\ \mbox{\hyperlink{struct_a_a_t_1_1mortmorx}{mortmorx}}<ObsoleteTypes,\ HB\_AAT\_TAG\_mort>\ \{\};}
\DoxyCodeLine{01167\ }
\DoxyCodeLine{01168\ }
\DoxyCodeLine{01169\ \}\ \textcolor{comment}{/*\ namespace\ AAT\ */}}
\DoxyCodeLine{01170\ }
\DoxyCodeLine{01171\ }
\DoxyCodeLine{01172\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*\ HB\_AAT\_LAYOUT\_MORX\_TABLE\_HH\ */}\textcolor{preprocessor}{}}

\end{DoxyCode}

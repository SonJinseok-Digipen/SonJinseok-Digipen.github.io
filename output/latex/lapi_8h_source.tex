\hypertarget{lapi_8h_source}{}\doxysection{lapi.\+h}
\label{lapi_8h_source}\index{AseSprite/aseprite/third\_party/lua/lapi.h@{AseSprite/aseprite/third\_party/lua/lapi.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{00002\ \textcolor{comment}{**\ \$Id:\ lapi.h\ \$}}
\DoxyCodeLine{00003\ \textcolor{comment}{**\ Auxiliary\ functions\ from\ Lua\ API}}
\DoxyCodeLine{00004\ \textcolor{comment}{**\ See\ Copyright\ Notice\ in\ lua.h}}
\DoxyCodeLine{00005\ \textcolor{comment}{*/}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#ifndef\ lapi\_h}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#define\ lapi\_h}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ "{}llimits.h"{}}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ "{}lstate.h"{}}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{comment}{/*\ Increments\ 'L-\/>top',\ checking\ for\ stack\ overflows\ */}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#define\ api\_incr\_top(L)\ \ \ \{L-\/>top++;\ api\_check(L,\ L-\/>top\ <=\ L-\/>ci-\/>top,\ \(\backslash\)}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ "{}stack\ overflow"{}});\}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{comment}{/*}}
\DoxyCodeLine{00021\ \textcolor{comment}{**\ If\ a\ call\ returns\ too\ many\ multiple\ returns,\ the\ callee\ may\ not\ have}}
\DoxyCodeLine{00022\ \textcolor{comment}{**\ stack\ space\ to\ accommodate\ all\ results.\ In\ this\ case,\ this\ macro}}
\DoxyCodeLine{00023\ \textcolor{comment}{**\ increases\ its\ stack\ space\ ('L-\/>ci-\/>top').}}
\DoxyCodeLine{00024\ \textcolor{comment}{*/}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#define\ adjustresults(L,nres)\ \(\backslash\)}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\ \ \ \ \{\ if\ ((nres)\ <=\ LUA\_MULTRET\ \&\&\ L-\/>ci-\/>top\ <\ L-\/>top)\ L-\/>ci-\/>top\ =\ L-\/>top;\ \}}}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \textcolor{comment}{/*\ Ensure\ the\ stack\ has\ at\ least\ 'n'\ elements\ */}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#define\ api\_checknelems(L,n)\ \ \ \ api\_check(L,\ (n)\ <\ (L-\/>top\ -\/\ L-\/>ci-\/>func),\ \(\backslash\)}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ "{}not\ enough\ elements\ in\ the\ stack"{}})}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \textcolor{comment}{/*}}
\DoxyCodeLine{00035\ \textcolor{comment}{**\ To\ reduce\ the\ overhead\ of\ returning\ from\ C\ functions,\ the\ presence\ of}}
\DoxyCodeLine{00036\ \textcolor{comment}{**\ to-\/be-\/closed\ variables\ in\ these\ functions\ is\ coded\ in\ the\ CallInfo's}}
\DoxyCodeLine{00037\ \textcolor{comment}{**\ field\ 'nresults',\ in\ a\ way\ that\ functions\ with\ no\ to-\/be-\/closed\ variables}}
\DoxyCodeLine{00038\ \textcolor{comment}{**\ with\ zero,\ one,\ or\ "{}all"{}\ wanted\ results\ have\ no\ overhead.\ Functions}}
\DoxyCodeLine{00039\ \textcolor{comment}{**\ with\ other\ number\ of\ wanted\ results,\ as\ well\ as\ functions\ with}}
\DoxyCodeLine{00040\ \textcolor{comment}{**\ variables\ to\ be\ closed,\ have\ an\ extra\ check.}}
\DoxyCodeLine{00041\ \textcolor{comment}{*/}}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \textcolor{preprocessor}{\#define\ hastocloseCfunc(n)\ \ ((n)\ <\ LUA\_MULTRET)}}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \textcolor{comment}{/*\ Map\ [-\/1,\ inf)\ (range\ of\ 'nresults')\ into\ (-\/inf,\ -\/2]\ */}}
\DoxyCodeLine{00046\ \textcolor{preprocessor}{\#define\ codeNresults(n)\ \ \ \ \ (-\/(n)\ -\/\ 3)}}
\DoxyCodeLine{00047\ \textcolor{preprocessor}{\#define\ decodeNresults(n)\ \ \ (-\/(n)\ -\/\ 3)}}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}

\hypertarget{hb-ot-cmap-table_8hh_source}{}\doxysection{hb-\/ot-\/cmap-\/table.hh}
\label{hb-ot-cmap-table_8hh_source}\index{AseSprite/aseprite/third\_party/harfbuzz/src/hb-\/ot-\/cmap-\/table.hh@{AseSprite/aseprite/third\_party/harfbuzz/src/hb-\/ot-\/cmap-\/table.hh}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ *\ Copyright\ Â©\ 2014\ \ Google,\ Inc.}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ *\ \ This\ is\ part\ of\ HarfBuzz,\ a\ text\ shaping\ library.}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ *\ Permission\ is\ hereby\ granted,\ without\ written\ agreement\ and\ without}}
\DoxyCodeLine{00007\ \textcolor{comment}{\ *\ license\ or\ royalty\ fees,\ to\ use,\ copy,\ modify,\ and\ distribute\ this}}
\DoxyCodeLine{00008\ \textcolor{comment}{\ *\ software\ and\ its\ documentation\ for\ any\ purpose,\ provided\ that\ the}}
\DoxyCodeLine{00009\ \textcolor{comment}{\ *\ above\ copyright\ notice\ and\ the\ following\ two\ paragraphs\ appear\ in}}
\DoxyCodeLine{00010\ \textcolor{comment}{\ *\ all\ copies\ of\ this\ software.}}
\DoxyCodeLine{00011\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00012\ \textcolor{comment}{\ *\ IN\ NO\ EVENT\ SHALL\ THE\ COPYRIGHT\ HOLDER\ BE\ LIABLE\ TO\ ANY\ PARTY\ FOR}}
\DoxyCodeLine{00013\ \textcolor{comment}{\ *\ DIRECT,\ INDIRECT,\ SPECIAL,\ INCIDENTAL,\ OR\ CONSEQUENTIAL\ DAMAGES}}
\DoxyCodeLine{00014\ \textcolor{comment}{\ *\ ARISING\ OUT\ OF\ THE\ USE\ OF\ THIS\ SOFTWARE\ AND\ ITS\ DOCUMENTATION,\ EVEN}}
\DoxyCodeLine{00015\ \textcolor{comment}{\ *\ IF\ THE\ COPYRIGHT\ HOLDER\ HAS\ BEEN\ ADVISED\ OF\ THE\ POSSIBILITY\ OF\ SUCH}}
\DoxyCodeLine{00016\ \textcolor{comment}{\ *\ DAMAGE.}}
\DoxyCodeLine{00017\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00018\ \textcolor{comment}{\ *\ THE\ COPYRIGHT\ HOLDER\ SPECIFICALLY\ DISCLAIMS\ ANY\ WARRANTIES,\ INCLUDING,}}
\DoxyCodeLine{00019\ \textcolor{comment}{\ *\ BUT\ NOT\ LIMITED\ TO,\ THE\ IMPLIED\ WARRANTIES\ OF\ MERCHANTABILITY\ AND}}
\DoxyCodeLine{00020\ \textcolor{comment}{\ *\ FITNESS\ FOR\ A\ PARTICULAR\ PURPOSE.\ \ THE\ SOFTWARE\ PROVIDED\ HEREUNDER\ IS}}
\DoxyCodeLine{00021\ \textcolor{comment}{\ *\ ON\ AN\ "{}AS\ IS"{}\ BASIS,\ AND\ THE\ COPYRIGHT\ HOLDER\ HAS\ NO\ OBLIGATION\ TO}}
\DoxyCodeLine{00022\ \textcolor{comment}{\ *\ PROVIDE\ MAINTENANCE,\ SUPPORT,\ UPDATES,\ ENHANCEMENTS,\ OR\ MODIFICATIONS.}}
\DoxyCodeLine{00023\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00024\ \textcolor{comment}{\ *\ Google\ Author(s):\ Behdad\ Esfahbod}}
\DoxyCodeLine{00025\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#ifndef\ HB\_OT\_CMAP\_TABLE\_HH}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#define\ HB\_OT\_CMAP\_TABLE\_HH}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#include\ "{}hb-\/open-\/type.hh"{}}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#include\ "{}hb-\/set.hh"{}}}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \textcolor{comment}{/*}}
\DoxyCodeLine{00034\ \textcolor{comment}{\ *\ cmap\ -\/-\/\ Character\ to\ Glyph\ Index\ Mapping}}
\DoxyCodeLine{00035\ \textcolor{comment}{\ *\ https://docs.microsoft.com/en-\/us/typography/opentype/spec/cmap}}
\DoxyCodeLine{00036\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\#define\ HB\_OT\_TAG\_cmap\ HB\_TAG('c','m','a','p')}}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \textcolor{keyword}{namespace\ }OT\ \{}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_format0}{CmapSubtableFormat0}}}
\DoxyCodeLine{00043\ \{}
\DoxyCodeLine{00044\ \ \ \textcolor{keywordtype}{bool}\ get\_glyph\ (hb\_codepoint\_t\ codepoint,\ hb\_codepoint\_t\ *glyph)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00045\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00046\ \ \ \ \ hb\_codepoint\_t\ gid\ =\ codepoint\ <\ 256\ ?\ glyphIdArray[codepoint]\ :\ 0;}
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{keywordflow}{if}\ (!gid)}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00049\ \ \ \ \ *glyph\ =\ gid;}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00051\ \ \ \}}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \ \ \textcolor{keywordtype}{unsigned}\ get\_language\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00054\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{keywordflow}{return}\ language;}
\DoxyCodeLine{00056\ \ \ \}}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00058\ \ \ \textcolor{keywordtype}{void}\ collect\_unicodes\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *out)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00059\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ 256;\ i++)}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (glyphIdArray[i])}
\DoxyCodeLine{00062\ \ \ \ \ out-\/>add\ (i);}
\DoxyCodeLine{00063\ \ \ \}}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \ \ \textcolor{keywordtype}{void}\ collect\_mapping\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *unicodes,\ \textcolor{comment}{/*\ OUT\ */}}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *mapping\ \textcolor{comment}{/*\ OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{00067\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ 0;\ i\ <\ 256;\ i++)}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (glyphIdArray[i])}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00071\ \ \ \ \ hb\_codepoint\_t\ glyph\ =\ glyphIdArray[i];}
\DoxyCodeLine{00072\ \ \ \ \ unicodes-\/>add\ (i);}
\DoxyCodeLine{00073\ \ \ \ \ mapping-\/>set\ (i,\ glyph);}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00075\ \ \ \}}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00078\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00079\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00080\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this}));}
\DoxyCodeLine{00081\ \ \ \}}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00084\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ format;\ \ \ \ \ \textcolor{comment}{/*\ Format\ number\ is\ set\ to\ 0.\ */}}
\DoxyCodeLine{00085\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ length;\ \ \ \ \ \textcolor{comment}{/*\ Byte\ length\ of\ this\ subtable.\ */}}
\DoxyCodeLine{00086\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ language;\ \ \ \textcolor{comment}{/*\ Ignore.\ */}}
\DoxyCodeLine{00087\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT8}}\ \ \ \ glyphIdArray[256];\textcolor{comment}{/*\ An\ array\ that\ maps\ character}}
\DoxyCodeLine{00088\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ code\ to\ glyph\ index\ values.\ */}}
\DoxyCodeLine{00089\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00090\ \ \ DEFINE\_SIZE\_STATIC\ (6\ +\ 256);}
\DoxyCodeLine{00091\ \};}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_format4}{CmapSubtableFormat4}}}
\DoxyCodeLine{00094\ \{}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Iterator,}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \textcolor{keyword}{typename}\ Writer,}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ hb\_requires\ (hb\_is\_iterator\ (Iterator))>}
\DoxyCodeLine{00100\ \ \ \textcolor{keywordtype}{void}\ to\_ranges\ (Iterator\ it,\ Writer\&\ range\_writer)}
\DoxyCodeLine{00101\ \ \ \{}
\DoxyCodeLine{00102\ \ \ \ \ hb\_codepoint\_t\ start\_cp\ =\ 0,\ prev\_run\_start\_cp\ =\ 0,\ run\_start\_cp\ =\ 0,\ end\_cp\ =\ 0,\ last\_gid\ =\ 0;}
\DoxyCodeLine{00103\ \ \ \ \ \textcolor{keywordtype}{int}\ run\_length\ =\ 0\ ,\ delta\ =\ 0,\ prev\_delta\ =\ 0;}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \ \ \ \ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{00106\ \ \ \ \ \ \ FIRST\_SUB\_RANGE,}
\DoxyCodeLine{00107\ \ \ \ \ \ \ FOLLOWING\_SUB\_RANGE,}
\DoxyCodeLine{00108\ \ \ \ \ \}\ mode;}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ \ \ \ \ \textcolor{keywordflow}{while}\ (it)\ \{}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \textcolor{comment}{//\ Start\ a\ new\ range}}
\DoxyCodeLine{00112\ \ \ \ \ \ \ start\_cp\ =\ (*it).first;}
\DoxyCodeLine{00113\ \ \ \ \ \ \ prev\_run\_start\_cp\ =\ (*it).first;}
\DoxyCodeLine{00114\ \ \ \ \ \ \ run\_start\_cp\ =\ (*it).first;}
\DoxyCodeLine{00115\ \ \ \ \ \ \ end\_cp\ =\ (*it).first;}
\DoxyCodeLine{00116\ \ \ \ \ \ \ last\_gid\ =\ (*it).second;}
\DoxyCodeLine{00117\ \ \ \ \ \ \ run\_length\ =\ 1;}
\DoxyCodeLine{00118\ \ \ \ \ \ \ prev\_delta\ =\ 0;}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \ \ \ \ \ \ delta\ =\ (*it).second\ -\/\ (*it).first;}
\DoxyCodeLine{00121\ \ \ \ \ \ \ mode\ =\ FIRST\_SUB\_RANGE;}
\DoxyCodeLine{00122\ \ \ \ \ \ \ it++;}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00124\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (it)\ \{}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Process\ range}}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ next\_cp\ =\ (*it).first;}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ next\_gid\ =\ (*it).second;}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (next\_cp\ !=\ end\_cp\ +\ 1)\ \{}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Current\ range\ is\ over,\ stop\ processing.}}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (next\_gid\ ==\ last\_gid\ +\ 1)\ \{}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ current\ run\ continues.}}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \ \ end\_cp\ =\ next\_cp;}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ run\_length++;}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ last\_gid\ =\ next\_gid;}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ it++;}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ A\ new\ run\ is\ starting,\ decide\ if\ we\ want\ to\ commit\ the\ current\ run.}}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ split\_cost\ =\ (mode\ ==\ FIRST\_SUB\_RANGE)\ ?\ 8\ :\ 16;}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ run\_cost\ =\ run\_length\ *\ 2;}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (run\_cost\ >=\ split\_cost)\ \{}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ commit\_current\_range(start\_cp,}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ prev\_run\_start\_cp,}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ run\_start\_cp,}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ end\_cp,}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ delta,}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ prev\_delta,}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ split\_cost,}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ range\_writer);}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \ \ start\_cp\ =\ next\_cp;}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00156\ }
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Start\ the\ new\ run}}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ mode\ =\ FOLLOWING\_SUB\_RANGE;}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ prev\_run\_start\_cp\ =\ run\_start\_cp;}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ run\_start\_cp\ =\ next\_cp;}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ end\_cp\ =\ next\_cp;}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ prev\_delta\ =\ delta;}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ delta\ =\ next\_gid\ -\/\ run\_start\_cp;}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ run\_length\ =\ 1;}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ last\_gid\ =\ next\_gid;}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ it++;}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \ \ \ \ \ \ \textcolor{comment}{//\ Finalize\ range}}
\DoxyCodeLine{00170\ \ \ \ \ \ \ commit\_current\_range\ (start\_cp,}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ prev\_run\_start\_cp,}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ run\_start\_cp,}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ end\_cp,}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ delta,}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ prev\_delta,}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 8,}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ range\_writer);}
\DoxyCodeLine{00178\ \ \ \ \ \}}
\DoxyCodeLine{00179\ }
\DoxyCodeLine{00180\ \ \ \ \ \textcolor{keywordflow}{if}\ (likely\ (end\_cp\ !=\ 0xFFFF))\ \{}
\DoxyCodeLine{00181\ \ \ \ \ \ \ range\_writer\ (0xFFFF,\ 0xFFFF,\ 1);}
\DoxyCodeLine{00182\ \ \ \ \ \}}
\DoxyCodeLine{00183\ \ \ \}}
\DoxyCodeLine{00184\ }
\DoxyCodeLine{00185\ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00186\ \textcolor{comment}{\ \ \ *\ Writes\ the\ current\ range\ as\ either\ one\ or\ two\ ranges\ depending\ on\ what\ is\ most\ efficient.}}
\DoxyCodeLine{00187\ \textcolor{comment}{\ \ \ */}}
\DoxyCodeLine{00188\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Writer>}
\DoxyCodeLine{00189\ \ \ \textcolor{keywordtype}{void}\ commit\_current\_range\ (hb\_codepoint\_t\ start,}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ prev\_run\_start,}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ run\_start,}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ end,}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ run\_delta,}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ previous\_run\_delta,}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ split\_cost,}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Writer\&\ range\_writer)\ \{}
\DoxyCodeLine{00197\ \ \ \ \ \textcolor{keywordtype}{bool}\ should\_split\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00198\ \ \ \ \ \textcolor{keywordflow}{if}\ (start\ <\ run\_start\ \&\&\ run\_start\ <\ end)\ \{}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ run\_cost\ =\ (end\ -\/\ run\_start\ +\ 1)\ *\ 2;}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (run\_cost\ >=\ split\_cost)\ \{}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ should\_split\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00203\ \ \ \ \ \}}
\DoxyCodeLine{00204\ }
\DoxyCodeLine{00205\ \ \ \ \ \textcolor{comment}{//\ TODO(grieger):\ handle\ case\ where\ delta\ is\ legitimately\ 0,\ mark\ range\ offset\ array\ instead?}}
\DoxyCodeLine{00206\ \ \ \ \ \textcolor{keywordflow}{if}\ (should\_split)\ \{}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (start\ ==\ prev\_run\_start)}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ range\_writer\ (start,\ run\_start\ -\/\ 1,\ previous\_run\_delta);}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ range\_writer\ (start,\ run\_start\ -\/\ 1,\ 0);}
\DoxyCodeLine{00211\ \ \ \ \ \ \ range\_writer\ (run\_start,\ end,\ run\_delta);}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00213\ \ \ \ \ \}}
\DoxyCodeLine{00214\ }
\DoxyCodeLine{00215\ }
\DoxyCodeLine{00216\ \ \ \ \ \textcolor{keywordflow}{if}\ (start\ ==\ run\_start)\ \{}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \textcolor{comment}{//\ Range\ is\ only\ a\ run}}
\DoxyCodeLine{00218\ \ \ \ \ \ \ range\_writer\ (start,\ end,\ run\_delta);}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00220\ \ \ \ \ \}}
\DoxyCodeLine{00221\ }
\DoxyCodeLine{00222\ \ \ \ \ \textcolor{comment}{//\ Write\ only\ a\ single\ non-\/run\ range.}}
\DoxyCodeLine{00223\ \ \ \ \ range\_writer\ (start,\ end,\ 0);}
\DoxyCodeLine{00224\ \ \ \}}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00226\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Iterator,}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \ hb\_requires\ (hb\_is\_iterator\ (Iterator))>}
\DoxyCodeLine{00228\ \ \ \textcolor{keywordtype}{unsigned}\ serialize\_find\_segcount\ (Iterator\ it)\ \{}
\DoxyCodeLine{00229\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{class_counter}{Counter}}\ \{}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ segcount\ =\ 0;}
\DoxyCodeLine{00231\ }
\DoxyCodeLine{00232\ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ operator()\ (hb\_codepoint\_t\ start,}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ end,}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ delta)\ \{}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ segcount++;}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00237\ \ \ \ \ \}\ counter;}
\DoxyCodeLine{00238\ }
\DoxyCodeLine{00239\ \ \ \ \ to\_ranges\ (+it,\ counter);}
\DoxyCodeLine{00240\ \ \ \ \ \textcolor{keywordflow}{return}\ counter.segcount;}
\DoxyCodeLine{00241\ \ \ \}}
\DoxyCodeLine{00242\ }
\DoxyCodeLine{00243\ }
\DoxyCodeLine{00244\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Iterator,}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ hb\_requires\ (hb\_is\_iterator\ (Iterator))>}
\DoxyCodeLine{00246\ \ \ \textcolor{keywordtype}{bool}\ serialize\_start\_end\_delta\_arrays\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Iterator\ it,}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ segcount)}
\DoxyCodeLine{00249\ \ \ \{}
\DoxyCodeLine{00250\ \ \ \ \ \textcolor{keyword}{struct\ }Writer\ \{}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *serializer\_;}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}*\ end\_code\_;}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}*\ start\_code\_;}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBINT16}}*\ id\_delta\_;}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ index\_;}
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00257\ \ \ \ \ \ \ Writer(\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *serializer)}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ \ \ :\ serializer\_(serializer),}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \ \ \ \ end\_code\_(\textcolor{keyword}{nullptr}),}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \ \ \ \ start\_code\_(\textcolor{keyword}{nullptr}),}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \ \ \ \ id\_delta\_(\textcolor{keyword}{nullptr}),}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \ \ \ \ index\_\ (0)\ \{\}}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ operator()\ (hb\_codepoint\_t\ start,}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ end,}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ delta)\ \{}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ start\_code\_[index\_]\ =\ start;}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ end\_code\_[index\_]\ =\ end;}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ id\_delta\_[index\_]\ =\ delta;}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ index\_++;}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00271\ \ \ \ \ \}\ writer(c);}
\DoxyCodeLine{00272\ }
\DoxyCodeLine{00273\ \ \ \ \ writer.end\_code\_\ =\ c-\/>allocate\_size<\mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}>\ (HBUINT16::static\_size\ *\ segcount);}
\DoxyCodeLine{00274\ \ \ \ \ c-\/>allocate\_size<\mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}>\ (2);\ \textcolor{comment}{//\ padding}}
\DoxyCodeLine{00275\ \ \ \ \ writer.start\_code\_\ =\ c-\/>allocate\_size<\mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}>\ (HBUINT16::static\_size\ *\ segcount);}
\DoxyCodeLine{00276\ \ \ \ \ writer.id\_delta\_\ =\ c-\/>allocate\_size<\mbox{\hyperlink{struct_o_t_1_1_int_type}{HBINT16}}>\ (HBINT16::static\_size\ *\ segcount);}
\DoxyCodeLine{00277\ }
\DoxyCodeLine{00278\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!writer.end\_code\_\ ||\ !writer.start\_code\_\ ||\ !writer.id\_delta\_))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00280\ \ \ \ \ to\_ranges\ (+it,\ writer);}
\DoxyCodeLine{00281\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00282\ \ \ \}}
\DoxyCodeLine{00283\ }
\DoxyCodeLine{00284\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Iterator,}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ hb\_requires\ (hb\_is\_iterator\ (Iterator))>}
\DoxyCodeLine{00286\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}*\ serialize\_rangeoffset\_glyid\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Iterator\ it,}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *endCode,}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *startCode,}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBINT16}}\ *idDelta,}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ segcount)}
\DoxyCodeLine{00292\ \ \ \{}
\DoxyCodeLine{00293\ \ \ \ \ \mbox{\hyperlink{structhb__hashmap__t}{hb\_hashmap\_t<hb\_codepoint\_t,\ hb\_codepoint\_t>}}\ cp\_to\_gid;}
\DoxyCodeLine{00294\ \ \ \ \ +\ it\ |\ hb\_sink\ (cp\_to\_gid);}
\DoxyCodeLine{00295\ }
\DoxyCodeLine{00296\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *idRangeOffset\ =\ c-\/>allocate\_size<\mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}>\ (HBUINT16::static\_size\ *\ segcount);}
\DoxyCodeLine{00297\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>check\_success\ (idRangeOffset)))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00298\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ ((\textcolor{keywordtype}{char}\ *)idRangeOffset\ -\/\ (\textcolor{keywordtype}{char}\ *)idDelta\ !=\ (\textcolor{keywordtype}{int})\ segcount\ *\ (\textcolor{keywordtype}{int})\ HBINT16::static\_size))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00299\ }
\DoxyCodeLine{00300\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ :\ +\ hb\_range\ (segcount)}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ hb\_filter\ ([\&]\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \_)\ \{\ \textcolor{keywordflow}{return}\ idDelta[\_]\ ==\ 0;\ \}))}
\DoxyCodeLine{00302\ \ \ \ \ \{}
\DoxyCodeLine{00303\ \ \ \ \ \ \ idRangeOffset[i]\ =\ 2\ *\ (c-\/>start\_embed<\mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}>\ ()\ -\/\ idRangeOffset\ -\/\ i);}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (hb\_codepoint\_t\ cp\ =\ startCode[i];\ cp\ <=\ endCode[i];\ cp++)}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ gid;}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ gid\ =\ cp\_to\_gid[cp];}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ c-\/>copy<\mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}>\ (gid);}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00310\ \ \ \ \ \}}
\DoxyCodeLine{00311\ }
\DoxyCodeLine{00312\ \ \ \ \ \textcolor{keywordflow}{return}\ idRangeOffset;}
\DoxyCodeLine{00313\ \ \ \}}
\DoxyCodeLine{00314\ }
\DoxyCodeLine{00315\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Iterator,}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ hb\_requires\ (hb\_is\_iterator\ (Iterator))>}
\DoxyCodeLine{00317\ \ \ \textcolor{keywordtype}{void}\ serialize\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \ \ Iterator\ it)}
\DoxyCodeLine{00319\ \ \ \{}
\DoxyCodeLine{00320\ \ \ \ \ \textcolor{keyword}{auto}\ format4\_iter\ =}
\DoxyCodeLine{00321\ \ \ \ \ +\ it}
\DoxyCodeLine{00322\ \ \ \ \ |\ hb\_filter\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__pair__t}{hb\_pair\_t<hb\_codepoint\_t,\ hb\_codepoint\_t>}}\ \_)}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \ \{\ \textcolor{keywordflow}{return}\ \_.first\ <=\ 0xFFFF;\ \})}
\DoxyCodeLine{00324\ \ \ \ \ ;}
\DoxyCodeLine{00325\ }
\DoxyCodeLine{00326\ \ \ \ \ \textcolor{keywordflow}{if}\ (format4\_iter.len\ ()\ ==\ 0)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00328\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ table\_initpos\ =\ c-\/>length\ ();}
\DoxyCodeLine{00329\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>extend\_min\ (\textcolor{keyword}{this})))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00330\ \ \ \ \ this-\/>format\ =\ 4;}
\DoxyCodeLine{00331\ }
\DoxyCodeLine{00332\ \ \ \ \ \textcolor{comment}{//serialize\ endCode[],\ startCode[],\ idDelta[]}}
\DoxyCodeLine{00333\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}*\ endCode\ =\ c-\/>start\_embed<\mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}>\ ();}
\DoxyCodeLine{00334\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ segcount\ =\ serialize\_find\_segcount\ (format4\_iter);}
\DoxyCodeLine{00335\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!serialize\_start\_end\_delta\_arrays\ (c,\ format4\_iter,\ segcount)))}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00337\ }
\DoxyCodeLine{00338\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *startCode\ =\ endCode\ +\ segcount\ +\ 1;}
\DoxyCodeLine{00339\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBINT16}}\ *idDelta\ =\ ((\mbox{\hyperlink{struct_o_t_1_1_int_type}{HBINT16}}*)startCode)\ +\ segcount;}
\DoxyCodeLine{00340\ }
\DoxyCodeLine{00341\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *idRangeOffset\ =\ serialize\_rangeoffset\_glyid\ (c,\ format4\_iter,\ endCode,\ startCode,\ idDelta,\ segcount);}
\DoxyCodeLine{00342\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>check\_success\ (idRangeOffset)))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00343\ }
\DoxyCodeLine{00344\ \ \ \ \ this-\/>length\ =\ c-\/>length\ ()\ -\/\ table\_initpos;}
\DoxyCodeLine{00345\ \ \ \ \ \textcolor{keywordflow}{if}\ ((\textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long})\ this-\/>length\ !=\ (\textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long})\ c-\/>length\ ()\ -\/\ table\_initpos)}
\DoxyCodeLine{00346\ \ \ \ \ \{}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \textcolor{comment}{//\ Length\ overflowed.\ Discard\ the\ current\ object\ before\ setting\ the\ error\ condition,\ otherwise}}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \textcolor{comment}{//\ discard\ is\ a\ noop\ which\ prevents\ the\ higher\ level\ code\ from\ reverting\ the\ serializer\ to\ the}}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \textcolor{comment}{//\ pre-\/error\ state\ in\ cmap4\ overflow\ handling\ code.}}
\DoxyCodeLine{00350\ \ \ \ \ \ \ c-\/>pop\_discard\ ();}
\DoxyCodeLine{00351\ \ \ \ \ \ \ c-\/>err\ (HB\_SERIALIZE\_ERROR\_INT\_OVERFLOW);}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00353\ \ \ \ \ \}}
\DoxyCodeLine{00354\ }
\DoxyCodeLine{00355\ \ \ \ \ this-\/>segCountX2\ =\ segcount\ *\ 2;}
\DoxyCodeLine{00356\ \ \ \ \ this-\/>entrySelector\ =\ hb\_max\ (1u,\ hb\_bit\_storage\ (segcount))\ -\/\ 1;}
\DoxyCodeLine{00357\ \ \ \ \ this-\/>searchRange\ =\ 2\ *\ (1u\ <<\ this-\/>entrySelector);}
\DoxyCodeLine{00358\ \ \ \ \ this-\/>rangeShift\ =\ segcount\ *\ 2\ >\ this-\/>searchRange}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ?\ 2\ *\ segcount\ -\/\ this-\/>searchRange}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ 0;}
\DoxyCodeLine{00361\ \ \ \}}
\DoxyCodeLine{00362\ }
\DoxyCodeLine{00363\ \ \ \textcolor{keywordtype}{unsigned}\ get\_language\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00364\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00365\ \ \ \ \ \textcolor{keywordflow}{return}\ language;}
\DoxyCodeLine{00366\ \ \ \}}
\DoxyCodeLine{00367\ }
\DoxyCodeLine{00368\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_format4_1_1accelerator__t}{accelerator\_t}}}
\DoxyCodeLine{00369\ \ \ \{}
\DoxyCodeLine{00370\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_format4_1_1accelerator__t}{accelerator\_t}}\ ()\ \{\}}
\DoxyCodeLine{00371\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_format4_1_1accelerator__t}{accelerator\_t}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_format4}{CmapSubtableFormat4}}\ *subtable)\ \{\ init\ (subtable);\ \}}
\DoxyCodeLine{00372\ }
\DoxyCodeLine{00373\ \ \ \ \ \textcolor{keywordtype}{void}\ init\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_format4}{CmapSubtableFormat4}}\ *subtable)}
\DoxyCodeLine{00374\ \ \ \ \ \{}
\DoxyCodeLine{00375\ \ \ \ \ \ \ segCount\ =\ subtable-\/>segCountX2\ /\ 2;}
\DoxyCodeLine{00376\ \ \ \ \ \ \ endCount\ =\ subtable-\/>values.arrayZ;}
\DoxyCodeLine{00377\ \ \ \ \ \ \ startCount\ =\ endCount\ +\ segCount\ +\ 1;}
\DoxyCodeLine{00378\ \ \ \ \ \ \ idDelta\ =\ startCount\ +\ segCount;}
\DoxyCodeLine{00379\ \ \ \ \ \ \ idRangeOffset\ =\ idDelta\ +\ segCount;}
\DoxyCodeLine{00380\ \ \ \ \ \ \ glyphIdArray\ =\ idRangeOffset\ +\ segCount;}
\DoxyCodeLine{00381\ \ \ \ \ \ \ glyphIdArrayLength\ =\ (subtable-\/>length\ -\/\ 16\ -\/\ 8\ *\ segCount)\ /\ 2;}
\DoxyCodeLine{00382\ \ \ \ \ \}}
\DoxyCodeLine{00383\ }
\DoxyCodeLine{00384\ \ \ \ \ \textcolor{keywordtype}{bool}\ get\_glyph\ (hb\_codepoint\_t\ codepoint,\ hb\_codepoint\_t\ *glyph)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00385\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \textcolor{keyword}{struct\ }CustomRange}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00388\ \ \ \ \ \textcolor{keywordtype}{int}\ cmp\ (hb\_codepoint\_t\ k,}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ distance)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00390\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (k\ >\ last)\ \textcolor{keywordflow}{return}\ +1;}
\DoxyCodeLine{00392\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (k\ <\ (\&last)[distance])\ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00393\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00394\ \ \ \ \ \}}
\DoxyCodeLine{00395\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ last;}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \};}
\DoxyCodeLine{00397\ }
\DoxyCodeLine{00398\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *found\ =\ hb\_bsearch\ (codepoint,}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>endCount,}
\DoxyCodeLine{00400\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>segCount,}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 2,}
\DoxyCodeLine{00402\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_hb\_cmp\_method<hb\_codepoint\_t,\ CustomRange,\ unsigned>,}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>segCount\ +\ 1);}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!found)}
\DoxyCodeLine{00405\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ found\ -\/\ endCount;}
\DoxyCodeLine{00407\ }
\DoxyCodeLine{00408\ \ \ \ \ \ \ hb\_codepoint\_t\ gid;}
\DoxyCodeLine{00409\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ rangeOffset\ =\ this-\/>idRangeOffset[i];}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (rangeOffset\ ==\ 0)}
\DoxyCodeLine{00411\ \ \ \ \ gid\ =\ codepoint\ +\ this-\/>idDelta[i];}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00414\ \ \ \ \ \textcolor{comment}{/*\ Somebody\ has\ been\ smoking...\ */}}
\DoxyCodeLine{00415\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ index\ =\ rangeOffset\ /\ 2\ +\ (codepoint\ -\/\ this-\/>startCount[i])\ +\ i\ -\/\ this-\/>segCount;}
\DoxyCodeLine{00416\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (index\ >=\ this-\/>glyphIdArrayLength))}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00418\ \ \ \ \ gid\ =\ this-\/>glyphIdArray[index];}
\DoxyCodeLine{00419\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!gid))}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00421\ \ \ \ \ gid\ +=\ this-\/>idDelta[i];}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00423\ \ \ \ \ \ \ gid\ \&=\ 0xFFFFu;}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!gid)}
\DoxyCodeLine{00425\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00426\ \ \ \ \ \ \ *glyph\ =\ gid;}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00428\ \ \ \ \ \}}
\DoxyCodeLine{00429\ }
\DoxyCodeLine{00430\ \ \ \ \ HB\_INTERNAL\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ get\_glyph\_func\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *obj,\ hb\_codepoint\_t\ codepoint,\ hb\_codepoint\_t\ *glyph)}
\DoxyCodeLine{00431\ \ \ \ \ \{\ \textcolor{keywordflow}{return}\ ((\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_format4_1_1accelerator__t}{accelerator\_t}}\ *)\ obj)-\/>get\_glyph\ (codepoint,\ glyph);\ \}}
\DoxyCodeLine{00432\ }
\DoxyCodeLine{00433\ \ \ \ \ \textcolor{keywordtype}{void}\ collect\_unicodes\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *out)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00434\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ this-\/>segCount;}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (count\ \&\&\ this-\/>startCount[count\ -\/\ 1]\ ==\ 0xFFFFu)}
\DoxyCodeLine{00437\ \ \ \ \ count-\/-\/;\ \textcolor{comment}{/*\ Skip\ sentinel\ segment.\ */}}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00440\ \ \ \ \ hb\_codepoint\_t\ start\ =\ this-\/>startCount[i];}
\DoxyCodeLine{00441\ \ \ \ \ hb\_codepoint\_t\ end\ =\ this-\/>endCount[i];}
\DoxyCodeLine{00442\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ rangeOffset\ =\ this-\/>idRangeOffset[i];}
\DoxyCodeLine{00443\ \ \ \ \ \textcolor{keywordflow}{if}\ (rangeOffset\ ==\ 0)}
\DoxyCodeLine{00444\ \ \ \ \ \{}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (hb\_codepoint\_t\ codepoint\ =\ start;\ codepoint\ <=\ end;\ codepoint++)}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ gid\ =\ (codepoint\ +\ this-\/>idDelta[i])\ \&\ 0xFFFFu;}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!gid))}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \ \ out-\/>add\ (codepoint);}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00452\ \ \ \ \ \}}
\DoxyCodeLine{00453\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00454\ \ \ \ \ \{}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (hb\_codepoint\_t\ codepoint\ =\ start;\ codepoint\ <=\ end;\ codepoint++)}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00457\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ index\ =\ rangeOffset\ /\ 2\ +\ (codepoint\ -\/\ this-\/>startCount[i])\ +\ i\ -\/\ this-\/>segCount;}
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (index\ >=\ this-\/>glyphIdArrayLength))}
\DoxyCodeLine{00459\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ gid\ =\ this-\/>glyphIdArray[index];}
\DoxyCodeLine{00461\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!gid))}
\DoxyCodeLine{00462\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \ \ out-\/>add\ (codepoint);}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00465\ \ \ \ \ \}}
\DoxyCodeLine{00466\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00467\ \ \ \ \ \}}
\DoxyCodeLine{00468\ }
\DoxyCodeLine{00469\ \ \ \ \ \textcolor{keywordtype}{void}\ collect\_mapping\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *unicodes,\ \textcolor{comment}{/*\ OUT\ */}}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *mapping\ \textcolor{comment}{/*\ OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{00471\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ count\ =\ this-\/>segCount;}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (count\ \&\&\ this-\/>startCount[count\ -\/\ 1]\ ==\ 0xFFFFu)}
\DoxyCodeLine{00474\ \ \ \ \ count-\/-\/;\ \textcolor{comment}{/*\ Skip\ sentinel\ segment.\ */}}
\DoxyCodeLine{00475\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{00476\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00477\ \ \ \ \ hb\_codepoint\_t\ start\ =\ this-\/>startCount[i];}
\DoxyCodeLine{00478\ \ \ \ \ hb\_codepoint\_t\ end\ =\ this-\/>endCount[i];}
\DoxyCodeLine{00479\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ rangeOffset\ =\ this-\/>idRangeOffset[i];}
\DoxyCodeLine{00480\ \ \ \ \ \textcolor{keywordflow}{if}\ (rangeOffset\ ==\ 0)}
\DoxyCodeLine{00481\ \ \ \ \ \{}
\DoxyCodeLine{00482\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (hb\_codepoint\_t\ codepoint\ =\ start;\ codepoint\ <=\ end;\ codepoint++)}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ gid\ =\ (codepoint\ +\ this-\/>idDelta[i])\ \&\ 0xFFFFu;}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!gid))}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \ \ unicodes-\/>add\ (codepoint);}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ mapping-\/>set\ (codepoint,\ gid);}
\DoxyCodeLine{00489\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00490\ \ \ \ \ \}}
\DoxyCodeLine{00491\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00492\ \ \ \ \ \{}
\DoxyCodeLine{00493\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (hb\_codepoint\_t\ codepoint\ =\ start;\ codepoint\ <=\ end;\ codepoint++)}
\DoxyCodeLine{00494\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00495\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ index\ =\ rangeOffset\ /\ 2\ +\ (codepoint\ -\/\ this-\/>startCount[i])\ +\ i\ -\/\ this-\/>segCount;}
\DoxyCodeLine{00496\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (index\ >=\ this-\/>glyphIdArrayLength))}
\DoxyCodeLine{00497\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00498\ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ gid\ =\ this-\/>glyphIdArray[index];}
\DoxyCodeLine{00499\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!gid))}
\DoxyCodeLine{00500\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00501\ \ \ \ \ \ \ \ \ unicodes-\/>add\ (codepoint);}
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ mapping-\/>set\ (codepoint,\ gid);}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00504\ \ \ \ \ \}}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00506\ \ \ \ \ \}}
\DoxyCodeLine{00507\ }
\DoxyCodeLine{00508\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *endCount;}
\DoxyCodeLine{00509\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *startCount;}
\DoxyCodeLine{00510\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *idDelta;}
\DoxyCodeLine{00511\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *idRangeOffset;}
\DoxyCodeLine{00512\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *glyphIdArray;}
\DoxyCodeLine{00513\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ segCount;}
\DoxyCodeLine{00514\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ glyphIdArrayLength;}
\DoxyCodeLine{00515\ \ \ \};}
\DoxyCodeLine{00516\ }
\DoxyCodeLine{00517\ \ \ \textcolor{keywordtype}{bool}\ get\_glyph\ (hb\_codepoint\_t\ codepoint,\ hb\_codepoint\_t\ *glyph)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00518\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00519\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_format4_1_1accelerator__t}{accelerator\_t}}\ accel\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00520\ \ \ \ \ \textcolor{keywordflow}{return}\ accel.get\_glyph\_func\ (\&accel,\ codepoint,\ glyph);}
\DoxyCodeLine{00521\ \ \ \}}
\DoxyCodeLine{00522\ \ \ \textcolor{keywordtype}{void}\ collect\_unicodes\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *out)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00523\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00524\ \ \ \ \ accelerator\_t\ accel\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00525\ \ \ \ \ accel.collect\_unicodes\ (out);}
\DoxyCodeLine{00526\ \ \ \}}
\DoxyCodeLine{00527\ }
\DoxyCodeLine{00528\ \ \ \textcolor{keywordtype}{void}\ collect\_mapping\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *unicodes,\ \textcolor{comment}{/*\ OUT\ */}}
\DoxyCodeLine{00529\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *mapping\ \textcolor{comment}{/*\ OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{00530\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00531\ \ \ \ \ accelerator\_t\ accel\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00532\ \ \ \ \ accel.collect\_mapping\ (unicodes,\ mapping);}
\DoxyCodeLine{00533\ \ \ \}}
\DoxyCodeLine{00534\ }
\DoxyCodeLine{00535\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00536\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00537\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00538\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>check\_struct\ (\textcolor{keyword}{this})))}
\DoxyCodeLine{00539\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{00540\ }
\DoxyCodeLine{00541\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>check\_range\ (\textcolor{keyword}{this},\ length)))}
\DoxyCodeLine{00542\ \ \ \ \ \{}
\DoxyCodeLine{00543\ \ \ \ \ \ \ \textcolor{comment}{/*\ Some\ broken\ fonts\ have\ too\ long\ of\ a\ "{}length"{}\ value.}}
\DoxyCodeLine{00544\ \textcolor{comment}{\ \ \ \ \ \ \ *\ If\ that\ is\ the\ case,\ just\ change\ the\ value\ to\ truncate}}
\DoxyCodeLine{00545\ \textcolor{comment}{\ \ \ \ \ \ \ *\ the\ subtable\ at\ the\ end\ of\ the\ blob.\ */}}
\DoxyCodeLine{00546\ \ \ \ \ \ \ uint16\_t\ new\_length\ =\ (uint16\_t)\ hb\_min\ ((uintptr\_t)\ 65535,}
\DoxyCodeLine{00547\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (uintptr\_t)\ (c-\/>end\ -\/}
\DoxyCodeLine{00548\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{char}\ *)\ \textcolor{keyword}{this}));}
\DoxyCodeLine{00549\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!c-\/>try\_set\ (\&length,\ new\_length))}
\DoxyCodeLine{00550\ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{00551\ \ \ \ \ \}}
\DoxyCodeLine{00552\ }
\DoxyCodeLine{00553\ \ \ \ \ return\_trace\ (16\ +\ 4\ *\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int})\ segCountX2\ <=\ length);}
\DoxyCodeLine{00554\ \ \ \}}
\DoxyCodeLine{00555\ }
\DoxyCodeLine{00556\ }
\DoxyCodeLine{00557\ }
\DoxyCodeLine{00558\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00559\ \ \ HBUINT16\ \ format;\ \ \ \ \ \textcolor{comment}{/*\ Format\ number\ is\ set\ to\ 4.\ */}}
\DoxyCodeLine{00560\ \ \ HBUINT16\ \ length;\ \ \ \ \ \textcolor{comment}{/*\ This\ is\ the\ length\ in\ bytes\ of\ the}}
\DoxyCodeLine{00561\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ subtable.\ */}}
\DoxyCodeLine{00562\ \ \ HBUINT16\ \ language;\ \ \ \textcolor{comment}{/*\ Ignore.\ */}}
\DoxyCodeLine{00563\ \ \ HBUINT16\ \ segCountX2;\ \textcolor{comment}{/*\ 2\ x\ segCount.\ */}}
\DoxyCodeLine{00564\ \ \ HBUINT16\ \ searchRange;\ \ \ \ \textcolor{comment}{/*\ 2\ *\ (2**floor(log2(segCount)))\ */}}
\DoxyCodeLine{00565\ \ \ HBUINT16\ \ entrySelector;\ \ \textcolor{comment}{/*\ log2(searchRange/2)\ */}}
\DoxyCodeLine{00566\ \ \ HBUINT16\ \ rangeShift;\ \textcolor{comment}{/*\ 2\ x\ segCount\ -\/\ searchRange\ */}}
\DoxyCodeLine{00567\ }
\DoxyCodeLine{00568\ \ \ UnsizedArrayOf<HBUINT16>}
\DoxyCodeLine{00569\ \ \ \ \ \ \ \ \ values;}
\DoxyCodeLine{00570\ \textcolor{preprocessor}{\#if\ 0}}
\DoxyCodeLine{00571\ \ \ HBUINT16\ \ endCount[segCount];\ \textcolor{comment}{/*\ End\ characterCode\ for\ each\ segment,}}
\DoxyCodeLine{00572\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ last=0xFFFFu.\ */}}
\DoxyCodeLine{00573\ \ \ HBUINT16\ \ reservedPad;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Set\ to\ 0.\ */}}
\DoxyCodeLine{00574\ \ \ HBUINT16\ \ startCount[segCount];\ \ \ \textcolor{comment}{/*\ Start\ character\ code\ for\ each\ segment.\ */}}
\DoxyCodeLine{00575\ \ \ HBINT16\ \ \ \ \ \ \ idDelta[segCount];\ \ \textcolor{comment}{/*\ Delta\ for\ all\ character\ codes\ in\ segment.\ */}}
\DoxyCodeLine{00576\ \ \ HBUINT16\ \ idRangeOffset[segCount];\textcolor{comment}{/*\ Offsets\ into\ glyphIdArray\ or\ 0\ */}}
\DoxyCodeLine{00577\ \ \ UnsizedArrayOf<HBUINT16>}
\DoxyCodeLine{00578\ \ \ \ \ \ \ \ \ glyphIdArray;\ \ \ \textcolor{comment}{/*\ Glyph\ index\ array\ (arbitrary\ length)\ */}}
\DoxyCodeLine{00579\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00580\ }
\DoxyCodeLine{00581\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00582\ \ \ DEFINE\_SIZE\_ARRAY\ (14,\ values);}
\DoxyCodeLine{00583\ \};}
\DoxyCodeLine{00584\ }
\DoxyCodeLine{00585\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_long_group}{CmapSubtableLongGroup}}}
\DoxyCodeLine{00586\ \{}
\DoxyCodeLine{00587\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_format12}{CmapSubtableFormat12}};}
\DoxyCodeLine{00588\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_format13}{CmapSubtableFormat13}};}
\DoxyCodeLine{00589\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ U>}
\DoxyCodeLine{00590\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_long_segmented}{CmapSubtableLongSegmented}};}
\DoxyCodeLine{00591\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1cmap}{cmap}};}
\DoxyCodeLine{00592\ }
\DoxyCodeLine{00593\ \ \ \textcolor{keywordtype}{int}\ cmp\ (hb\_codepoint\_t\ codepoint)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00594\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00595\ \ \ \ \ \textcolor{keywordflow}{if}\ (codepoint\ <\ startCharCode)\ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00596\ \ \ \ \ \textcolor{keywordflow}{if}\ (codepoint\ >\ endCharCode)\ \ \ \textcolor{keywordflow}{return}\ +1;}
\DoxyCodeLine{00597\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00598\ \ \ \}}
\DoxyCodeLine{00599\ }
\DoxyCodeLine{00600\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00601\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00602\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00603\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this}));}
\DoxyCodeLine{00604\ \ \ \}}
\DoxyCodeLine{00605\ }
\DoxyCodeLine{00606\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00607\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT32}}\ \ \ \ \ \ startCharCode;\ \ \textcolor{comment}{/*\ First\ character\ code\ in\ this\ group.\ */}}
\DoxyCodeLine{00608\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT32}}\ \ \ \ \ \ endCharCode;\ \ \ \ \textcolor{comment}{/*\ Last\ character\ code\ in\ this\ group.\ */}}
\DoxyCodeLine{00609\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT32}}\ \ \ \ \ \ glyphID;\ \ \ \ \textcolor{comment}{/*\ Glyph\ index;\ interpretation\ depends\ on}}
\DoxyCodeLine{00610\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ subtable\ format.\ */}}
\DoxyCodeLine{00611\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00612\ \ \ DEFINE\_SIZE\_STATIC\ (12);}
\DoxyCodeLine{00613\ \};}
\DoxyCodeLine{00614\ DECLARE\_NULL\_NAMESPACE\_BYTES\ (OT,\ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_long_group}{CmapSubtableLongGroup}});}
\DoxyCodeLine{00615\ }
\DoxyCodeLine{00616\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ UINT>}
\DoxyCodeLine{00617\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_trimmed}{CmapSubtableTrimmed}}}
\DoxyCodeLine{00618\ \{}
\DoxyCodeLine{00619\ \ \ \textcolor{keywordtype}{bool}\ get\_glyph\ (hb\_codepoint\_t\ codepoint,\ hb\_codepoint\_t\ *glyph)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00620\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00621\ \ \ \ \ \textcolor{comment}{/*\ Rely\ on\ our\ implicit\ array\ bound-\/checking.\ */}}
\DoxyCodeLine{00622\ \ \ \ \ hb\_codepoint\_t\ gid\ =\ glyphIdArray[codepoint\ -\/\ startCharCode];}
\DoxyCodeLine{00623\ \ \ \ \ \textcolor{keywordflow}{if}\ (!gid)}
\DoxyCodeLine{00624\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00625\ \ \ \ \ *glyph\ =\ gid;}
\DoxyCodeLine{00626\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00627\ \ \ \}}
\DoxyCodeLine{00628\ }
\DoxyCodeLine{00629\ \ \ \textcolor{keywordtype}{unsigned}\ get\_language\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00630\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00631\ \ \ \ \ \textcolor{keywordflow}{return}\ language;}
\DoxyCodeLine{00632\ \ \ \}}
\DoxyCodeLine{00633\ }
\DoxyCodeLine{00634\ \ \ \textcolor{keywordtype}{void}\ collect\_unicodes\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *out)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00635\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00636\ \ \ \ \ hb\_codepoint\_t\ start\ =\ startCharCode;}
\DoxyCodeLine{00637\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ glyphIdArray.len;}
\DoxyCodeLine{00638\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{00639\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (glyphIdArray[i])}
\DoxyCodeLine{00640\ \ \ \ \ out-\/>add\ (start\ +\ i);}
\DoxyCodeLine{00641\ \ \ \}}
\DoxyCodeLine{00642\ }
\DoxyCodeLine{00643\ \ \ \textcolor{keywordtype}{void}\ collect\_mapping\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *unicodes,\ \textcolor{comment}{/*\ OUT\ */}}
\DoxyCodeLine{00644\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *mapping\ \textcolor{comment}{/*\ OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{00645\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00646\ \ \ \ \ hb\_codepoint\_t\ start\_cp\ =\ startCharCode;}
\DoxyCodeLine{00647\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ count\ =\ glyphIdArray.len;}
\DoxyCodeLine{00648\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{00649\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (glyphIdArray[i])}
\DoxyCodeLine{00650\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00651\ \ \ \ \ hb\_codepoint\_t\ unicode\ =\ start\_cp\ +\ i;}
\DoxyCodeLine{00652\ \ \ \ \ hb\_codepoint\_t\ glyphid\ =\ glyphIdArray[i];}
\DoxyCodeLine{00653\ \ \ \ \ unicodes-\/>add\ (unicode);}
\DoxyCodeLine{00654\ \ \ \ \ mapping-\/>set\ (unicode,\ glyphid);}
\DoxyCodeLine{00655\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00656\ \ \ \}}
\DoxyCodeLine{00657\ }
\DoxyCodeLine{00658\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00659\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00660\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00661\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this})\ \&\&\ glyphIdArray.sanitize\ (c));}
\DoxyCodeLine{00662\ \ \ \}}
\DoxyCodeLine{00663\ }
\DoxyCodeLine{00664\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00665\ \ \ UINT\ \ \ \ \ \ formatReserved;\ \textcolor{comment}{/*\ Subtable\ format\ and\ (maybe)\ padding.\ */}}
\DoxyCodeLine{00666\ \ \ UINT\ \ \ \ \ \ length;\ \ \ \ \ \textcolor{comment}{/*\ Byte\ length\ of\ this\ subtable.\ */}}
\DoxyCodeLine{00667\ \ \ UINT\ \ \ \ \ \ language;\ \ \ \textcolor{comment}{/*\ Ignore.\ */}}
\DoxyCodeLine{00668\ \ \ UINT\ \ \ \ \ \ startCharCode;\ \ \textcolor{comment}{/*\ First\ character\ code\ covered.\ */}}
\DoxyCodeLine{00669\ \ \ \mbox{\hyperlink{struct_o_t_1_1_array_of}{ArrayOf<HBGlyphID16,\ UINT>}}}
\DoxyCodeLine{00670\ \ \ \ \ \ \ \ \ glyphIdArray;\ \ \ \textcolor{comment}{/*\ Array\ of\ glyph\ index\ values\ for\ character}}
\DoxyCodeLine{00671\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ codes\ in\ the\ range.\ */}}
\DoxyCodeLine{00672\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00673\ \ \ DEFINE\_SIZE\_ARRAY\ (5\ *\ \textcolor{keyword}{sizeof}\ (UINT),\ glyphIdArray);}
\DoxyCodeLine{00674\ \};}
\DoxyCodeLine{00675\ }
\DoxyCodeLine{00676\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_format6}{CmapSubtableFormat6}}\ \ :\ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_trimmed}{CmapSubtableTrimmed}}<HBUINT16>\ \{\};}
\DoxyCodeLine{00677\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_format10}{CmapSubtableFormat10}}\ :\ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_trimmed}{CmapSubtableTrimmed}}<HBUINT32\ >\ \{\};}
\DoxyCodeLine{00678\ }
\DoxyCodeLine{00679\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00680\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_long_segmented}{CmapSubtableLongSegmented}}}
\DoxyCodeLine{00681\ \{}
\DoxyCodeLine{00682\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1cmap}{cmap}};}
\DoxyCodeLine{00683\ }
\DoxyCodeLine{00684\ \ \ \textcolor{keywordtype}{bool}\ get\_glyph\ (hb\_codepoint\_t\ codepoint,\ hb\_codepoint\_t\ *glyph)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00685\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00686\ \ \ \ \ hb\_codepoint\_t\ gid\ =\ T::group\_get\_glyph\ (groups.bsearch\ (codepoint),\ codepoint);}
\DoxyCodeLine{00687\ \ \ \ \ \textcolor{keywordflow}{if}\ (!gid)}
\DoxyCodeLine{00688\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00689\ \ \ \ \ *glyph\ =\ gid;}
\DoxyCodeLine{00690\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00691\ \ \ \}}
\DoxyCodeLine{00692\ }
\DoxyCodeLine{00693\ \ \ \textcolor{keywordtype}{unsigned}\ get\_language\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00694\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00695\ \ \ \ \ \textcolor{keywordflow}{return}\ language;}
\DoxyCodeLine{00696\ \ \ \}}
\DoxyCodeLine{00697\ }
\DoxyCodeLine{00698\ \ \ \textcolor{keywordtype}{void}\ collect\_unicodes\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *out,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ num\_glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00699\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00700\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ this-\/>groups.len;\ i++)}
\DoxyCodeLine{00701\ \ \ \ \ \{}
\DoxyCodeLine{00702\ \ \ \ \ \ \ hb\_codepoint\_t\ start\ =\ this-\/>groups[i].startCharCode;}
\DoxyCodeLine{00703\ \ \ \ \ \ \ hb\_codepoint\_t\ end\ =\ hb\_min\ ((hb\_codepoint\_t)\ this-\/>groups[i].endCharCode,}
\DoxyCodeLine{00704\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (hb\_codepoint\_t)\ HB\_UNICODE\_MAX);}
\DoxyCodeLine{00705\ \ \ \ \ \ \ hb\_codepoint\_t\ gid\ =\ this-\/>groups[i].glyphID;}
\DoxyCodeLine{00706\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!gid)}
\DoxyCodeLine{00707\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00708\ \ \ \ \ \textcolor{comment}{/*\ Intention\ is:\ if\ (hb\_is\_same\ (T,\ CmapSubtableFormat13))\ continue;\ */}}
\DoxyCodeLine{00709\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\ T::group\_get\_glyph\ (this-\/>groups[i],\ end))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00710\ \ \ \ \ start++;}
\DoxyCodeLine{00711\ \ \ \ \ gid++;}
\DoxyCodeLine{00712\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00713\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ ((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int})\ gid\ >=\ num\_glyphs))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00714\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ ((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int})\ (gid\ +\ end\ -\/\ start)\ >=\ num\_glyphs))}
\DoxyCodeLine{00715\ \ \ \ \ end\ =\ start\ +\ (hb\_codepoint\_t)\ num\_glyphs\ -\/\ gid;}
\DoxyCodeLine{00716\ }
\DoxyCodeLine{00717\ \ \ \ \ \ \ out-\/>add\_range\ (start,\ end);}
\DoxyCodeLine{00718\ \ \ \ \ \}}
\DoxyCodeLine{00719\ \ \ \}}
\DoxyCodeLine{00720\ }
\DoxyCodeLine{00721\ \ \ \textcolor{keywordtype}{void}\ collect\_mapping\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *unicodes,\ \textcolor{comment}{/*\ OUT\ */}}
\DoxyCodeLine{00722\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *mapping,\ \textcolor{comment}{/*\ OUT\ */}}
\DoxyCodeLine{00723\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ num\_glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00724\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00725\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ 0;\ i\ <\ this-\/>groups.len;\ i++)}
\DoxyCodeLine{00726\ \ \ \ \ \{}
\DoxyCodeLine{00727\ \ \ \ \ \ \ hb\_codepoint\_t\ start\ =\ this-\/>groups[i].startCharCode;}
\DoxyCodeLine{00728\ \ \ \ \ \ \ hb\_codepoint\_t\ end\ =\ hb\_min\ ((hb\_codepoint\_t)\ this-\/>groups[i].endCharCode,}
\DoxyCodeLine{00729\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (hb\_codepoint\_t)\ HB\_UNICODE\_MAX);}
\DoxyCodeLine{00730\ \ \ \ \ \ \ hb\_codepoint\_t\ gid\ =\ this-\/>groups[i].glyphID;}
\DoxyCodeLine{00731\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!gid)}
\DoxyCodeLine{00732\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00733\ \ \ \ \ \textcolor{comment}{/*\ Intention\ is:\ if\ (hb\_is\_same\ (T,\ CmapSubtableFormat13))\ continue;\ */}}
\DoxyCodeLine{00734\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\ T::group\_get\_glyph\ (this-\/>groups[i],\ end))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00735\ \ \ \ \ start++;}
\DoxyCodeLine{00736\ \ \ \ \ gid++;}
\DoxyCodeLine{00737\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00738\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ ((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int})\ gid\ >=\ num\_glyphs))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00739\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ ((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int})\ (gid\ +\ end\ -\/\ start)\ >=\ num\_glyphs))}
\DoxyCodeLine{00740\ \ \ \ \ end\ =\ start\ +\ (hb\_codepoint\_t)\ num\_glyphs\ -\/\ gid;}
\DoxyCodeLine{00741\ }
\DoxyCodeLine{00742\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ cp\ =\ start;\ cp\ <=\ end;\ cp++)}
\DoxyCodeLine{00743\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00744\ \ \ \ \ unicodes-\/>add\ (cp);}
\DoxyCodeLine{00745\ \ \ \ \ mapping-\/>set\ (cp,\ gid);}
\DoxyCodeLine{00746\ \ \ \ \ gid++;}
\DoxyCodeLine{00747\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00748\ \ \ \ \ \}}
\DoxyCodeLine{00749\ \ \ \}}
\DoxyCodeLine{00750\ }
\DoxyCodeLine{00751\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00752\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00753\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00754\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this})\ \&\&\ groups.sanitize\ (c));}
\DoxyCodeLine{00755\ \ \ \}}
\DoxyCodeLine{00756\ }
\DoxyCodeLine{00757\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00758\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ format;\ \ \ \ \ \textcolor{comment}{/*\ Subtable\ format;\ set\ to\ 12.\ */}}
\DoxyCodeLine{00759\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ reserved;\ \ \ \textcolor{comment}{/*\ Reserved;\ set\ to\ 0.\ */}}
\DoxyCodeLine{00760\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT32}}\ \ length;\ \ \ \ \ \textcolor{comment}{/*\ Byte\ length\ of\ this\ subtable.\ */}}
\DoxyCodeLine{00761\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT32}}\ \ language;\ \ \ \textcolor{comment}{/*\ Ignore.\ */}}
\DoxyCodeLine{00762\ \ \ \mbox{\hyperlink{struct_o_t_1_1_sorted_array_of}{SortedArray32Of<CmapSubtableLongGroup>}}}
\DoxyCodeLine{00763\ \ \ \ \ \ \ \ \ groups;\ \ \ \ \ \textcolor{comment}{/*\ Groupings.\ */}}
\DoxyCodeLine{00764\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00765\ \ \ DEFINE\_SIZE\_ARRAY\ (16,\ groups);}
\DoxyCodeLine{00766\ \};}
\DoxyCodeLine{00767\ }
\DoxyCodeLine{00768\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_format12}{CmapSubtableFormat12}}\ :\ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_long_segmented}{CmapSubtableLongSegmented}}<CmapSubtableFormat12>}
\DoxyCodeLine{00769\ \{}
\DoxyCodeLine{00770\ \ \ \textcolor{keyword}{static}\ hb\_codepoint\_t\ group\_get\_glyph\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_long_group}{CmapSubtableLongGroup}}\ \&\mbox{\hyperlink{structgroup}{group}},}
\DoxyCodeLine{00771\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ u)}
\DoxyCodeLine{00772\ \ \ \{\ \textcolor{keywordflow}{return}\ likely\ (\mbox{\hyperlink{structgroup}{group}}.startCharCode\ <=\ \mbox{\hyperlink{structgroup}{group}}.endCharCode)\ ?}
\DoxyCodeLine{00773\ \ \ \ \ \ \ \ \mbox{\hyperlink{structgroup}{group}}.glyphID\ +\ (u\ -\/\ \mbox{\hyperlink{structgroup}{group}}.startCharCode)\ :\ 0;\ \}}
\DoxyCodeLine{00774\ }
\DoxyCodeLine{00775\ }
\DoxyCodeLine{00776\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Iterator,}
\DoxyCodeLine{00777\ \ \ \ \ \ \ \ hb\_requires\ (hb\_is\_iterator\ (Iterator))>}
\DoxyCodeLine{00778\ \ \ \textcolor{keywordtype}{void}\ serialize\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{00779\ \ \ \ \ \ \ \ \ \ \ Iterator\ it)}
\DoxyCodeLine{00780\ \ \ \{}
\DoxyCodeLine{00781\ \ \ \ \ \textcolor{keywordflow}{if}\ (it.len\ ()\ ==\ 0)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00782\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ table\_initpos\ =\ c-\/>length\ ();}
\DoxyCodeLine{00783\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>extend\_min\ (\textcolor{keyword}{this})))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00784\ }
\DoxyCodeLine{00785\ \ \ \ \ hb\_codepoint\_t\ startCharCode\ =\ 0xFFFF,\ endCharCode\ =\ 0xFFFF;}
\DoxyCodeLine{00786\ \ \ \ \ hb\_codepoint\_t\ glyphID\ =\ 0;}
\DoxyCodeLine{00787\ }
\DoxyCodeLine{00788\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \_\ :\ +it)}
\DoxyCodeLine{00789\ \ \ \ \ \{}
\DoxyCodeLine{00790\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (startCharCode\ ==\ 0xFFFF)}
\DoxyCodeLine{00791\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00792\ \ \ \ \ startCharCode\ =\ \_.first;}
\DoxyCodeLine{00793\ \ \ \ \ endCharCode\ =\ \_.first;}
\DoxyCodeLine{00794\ \ \ \ \ glyphID\ =\ \_.second;}
\DoxyCodeLine{00795\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00796\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!\_is\_gid\_consecutive\ (endCharCode,\ startCharCode,\ glyphID,\ \_.first,\ \_.second))}
\DoxyCodeLine{00797\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00798\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_long_group}{CmapSubtableLongGroup}}\ \ grouprecord;}
\DoxyCodeLine{00799\ \ \ \ \ grouprecord.startCharCode\ =\ startCharCode;}
\DoxyCodeLine{00800\ \ \ \ \ grouprecord.endCharCode\ =\ endCharCode;}
\DoxyCodeLine{00801\ \ \ \ \ grouprecord.glyphID\ =\ glyphID;}
\DoxyCodeLine{00802\ \ \ \ \ c-\/>copy<\mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_long_group}{CmapSubtableLongGroup}}>\ (grouprecord);}
\DoxyCodeLine{00803\ }
\DoxyCodeLine{00804\ \ \ \ \ startCharCode\ =\ \_.first;}
\DoxyCodeLine{00805\ \ \ \ \ endCharCode\ =\ \_.first;}
\DoxyCodeLine{00806\ \ \ \ \ glyphID\ =\ \_.second;}
\DoxyCodeLine{00807\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00808\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00809\ \ \ \ \ endCharCode\ =\ \_.first;}
\DoxyCodeLine{00810\ \ \ \ \ \}}
\DoxyCodeLine{00811\ }
\DoxyCodeLine{00812\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_long_group}{CmapSubtableLongGroup}}\ record;}
\DoxyCodeLine{00813\ \ \ \ \ record.startCharCode\ =\ startCharCode;}
\DoxyCodeLine{00814\ \ \ \ \ record.endCharCode\ =\ endCharCode;}
\DoxyCodeLine{00815\ \ \ \ \ record.glyphID\ =\ glyphID;}
\DoxyCodeLine{00816\ \ \ \ \ c-\/>copy<\mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_long_group}{CmapSubtableLongGroup}}>\ (record);}
\DoxyCodeLine{00817\ }
\DoxyCodeLine{00818\ \ \ \ \ this-\/>format\ =\ 12;}
\DoxyCodeLine{00819\ \ \ \ \ this-\/>reserved\ =\ 0;}
\DoxyCodeLine{00820\ \ \ \ \ this-\/>length\ =\ c-\/>length\ ()\ -\/\ table\_initpos;}
\DoxyCodeLine{00821\ \ \ \ \ this-\/>groups.len\ =\ (this-\/>length\ -\/\ min\_size)/CmapSubtableLongGroup::static\_size;}
\DoxyCodeLine{00822\ \ \ \}}
\DoxyCodeLine{00823\ }
\DoxyCodeLine{00824\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{size\_t}\ get\_sub\_table\_size\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__vector__t}{hb\_sorted\_vector\_t<CmapSubtableLongGroup>}}\ \&groups\_data)}
\DoxyCodeLine{00825\ \ \ \{\ \textcolor{keywordflow}{return}\ 16\ +\ 12\ *\ groups\_data.length;\ \}}
\DoxyCodeLine{00826\ }
\DoxyCodeLine{00827\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00828\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ \_is\_gid\_consecutive\ (hb\_codepoint\_t\ endCharCode,}
\DoxyCodeLine{00829\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ startCharCode,}
\DoxyCodeLine{00830\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ glyphID,}
\DoxyCodeLine{00831\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ cp,}
\DoxyCodeLine{00832\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ new\_gid)}
\DoxyCodeLine{00833\ \ \ \{}
\DoxyCodeLine{00834\ \ \ \ \ \textcolor{keywordflow}{return}\ (cp\ -\/\ 1\ ==\ endCharCode)\ \&\&}
\DoxyCodeLine{00835\ \ \ \ \ new\_gid\ ==\ glyphID\ +\ (cp\ -\/\ startCharCode);}
\DoxyCodeLine{00836\ \ \ \}}
\DoxyCodeLine{00837\ }
\DoxyCodeLine{00838\ \};}
\DoxyCodeLine{00839\ }
\DoxyCodeLine{00840\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_format13}{CmapSubtableFormat13}}\ :\ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_long_segmented}{CmapSubtableLongSegmented}}<CmapSubtableFormat13>}
\DoxyCodeLine{00841\ \{}
\DoxyCodeLine{00842\ \ \ \textcolor{keyword}{static}\ hb\_codepoint\_t\ group\_get\_glyph\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_long_group}{CmapSubtableLongGroup}}\ \&\mbox{\hyperlink{structgroup}{group}},}
\DoxyCodeLine{00843\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ u\ HB\_UNUSED)}
\DoxyCodeLine{00844\ \ \ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structgroup}{group}}.glyphID;\ \}}
\DoxyCodeLine{00845\ \};}
\DoxyCodeLine{00846\ }
\DoxyCodeLine{00847\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{enum}}
\DoxyCodeLine{00848\ \{}
\DoxyCodeLine{00849\ \ \ GLYPH\_VARIANT\_NOT\_FOUND\ =\ 0,}
\DoxyCodeLine{00850\ \ \ GLYPH\_VARIANT\_FOUND\ =\ 1,}
\DoxyCodeLine{00851\ \ \ GLYPH\_VARIANT\_USE\_DEFAULT\ =\ 2}
\DoxyCodeLine{00852\ \}\ glyph\_variant\_t;}
\DoxyCodeLine{00853\ }
\DoxyCodeLine{00854\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_unicode_value_range}{UnicodeValueRange}}}
\DoxyCodeLine{00855\ \{}
\DoxyCodeLine{00856\ \ \ \textcolor{keywordtype}{int}\ cmp\ (\textcolor{keyword}{const}\ hb\_codepoint\_t\ \&codepoint)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00857\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00858\ \ \ \ \ \textcolor{keywordflow}{if}\ (codepoint\ <\ startUnicodeValue)\ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00859\ \ \ \ \ \textcolor{keywordflow}{if}\ (codepoint\ >\ startUnicodeValue\ +\ additionalCount)\ \textcolor{keywordflow}{return}\ +1;}
\DoxyCodeLine{00860\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00861\ \ \ \}}
\DoxyCodeLine{00862\ }
\DoxyCodeLine{00863\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00864\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00865\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00866\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this}));}
\DoxyCodeLine{00867\ \ \ \}}
\DoxyCodeLine{00868\ }
\DoxyCodeLine{00869\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT24}}\ \ startUnicodeValue;\ \ \textcolor{comment}{/*\ First\ value\ in\ this\ range.\ */}}
\DoxyCodeLine{00870\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT8}}\ \ \ \ additionalCount;\ \ \ \ \textcolor{comment}{/*\ Number\ of\ additional\ values\ in\ this}}
\DoxyCodeLine{00871\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ range.\ */}}
\DoxyCodeLine{00872\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00873\ \ \ DEFINE\_SIZE\_STATIC\ (4);}
\DoxyCodeLine{00874\ \};}
\DoxyCodeLine{00875\ }
\DoxyCodeLine{00876\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_default_u_v_s}{DefaultUVS}}\ :\ \mbox{\hyperlink{struct_o_t_1_1_sorted_array_of}{SortedArray32Of}}<UnicodeValueRange>}
\DoxyCodeLine{00877\ \{}
\DoxyCodeLine{00878\ \ \ \textcolor{keywordtype}{void}\ collect\_unicodes\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *out)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00879\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00880\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ len;}
\DoxyCodeLine{00881\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{00882\ \ \ \ \ \{}
\DoxyCodeLine{00883\ \ \ \ \ \ \ hb\_codepoint\_t\ first\ =\ arrayZ[i].startUnicodeValue;}
\DoxyCodeLine{00884\ \ \ \ \ \ \ hb\_codepoint\_t\ last\ =\ hb\_min\ ((hb\_codepoint\_t)\ (first\ +\ arrayZ[i].additionalCount),}
\DoxyCodeLine{00885\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (hb\_codepoint\_t)\ HB\_UNICODE\_MAX);}
\DoxyCodeLine{00886\ \ \ \ \ \ \ out-\/>add\_range\ (first,\ last);}
\DoxyCodeLine{00887\ \ \ \ \ \}}
\DoxyCodeLine{00888\ \ \ \}}
\DoxyCodeLine{00889\ }
\DoxyCodeLine{00890\ \ \ \mbox{\hyperlink{struct_o_t_1_1_default_u_v_s}{DefaultUVS}}*\ copy\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{00891\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *unicodes)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00892\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00893\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_default_u_v_s}{DefaultUVS}}\ *out\ =\ c-\/>start\_embed<\mbox{\hyperlink{struct_o_t_1_1_default_u_v_s}{DefaultUVS}}>\ ();}
\DoxyCodeLine{00894\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!out))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00895\ \ \ \ \ \textcolor{keyword}{auto}\ snap\ =\ c-\/>snapshot\ ();}
\DoxyCodeLine{00896\ }
\DoxyCodeLine{00897\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT32}}\ len;}
\DoxyCodeLine{00898\ \ \ \ \ len\ =\ 0;}
\DoxyCodeLine{00899\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>copy<\mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT32}}>\ (len)))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00900\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ init\_len\ =\ c-\/>length\ ();}
\DoxyCodeLine{00901\ }
\DoxyCodeLine{00902\ \ \ \ \ hb\_codepoint\_t\ lastCode\ =\ HB\_MAP\_VALUE\_INVALID;}
\DoxyCodeLine{00903\ \ \ \ \ \textcolor{keywordtype}{int}\ count\ =\ -\/1;}
\DoxyCodeLine{00904\ }
\DoxyCodeLine{00905\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_unicode_value_range}{UnicodeValueRange}}\&\ \_\ :\ as\_array\ ())}
\DoxyCodeLine{00906\ \ \ \ \ \{}
\DoxyCodeLine{00907\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ addcnt\ :\ hb\_range\ ((\textcolor{keywordtype}{unsigned})\ \_.additionalCount\ +\ 1))}
\DoxyCodeLine{00908\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00909\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ curEntry\ =\ (unsigned)\ \_.startUnicodeValue\ +\ addcnt;}
\DoxyCodeLine{00910\ \ \ \ \ if\ (!unicodes-\/>has\ (curEntry))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00911\ \ \ \ \ count\ +=\ 1;}
\DoxyCodeLine{00912\ \ \ \ \ \textcolor{keywordflow}{if}\ (lastCode\ ==\ HB\_MAP\_VALUE\_INVALID)}
\DoxyCodeLine{00913\ \ \ \ \ \ \ lastCode\ =\ curEntry;}
\DoxyCodeLine{00914\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (lastCode\ +\ count\ !=\ curEntry)}
\DoxyCodeLine{00915\ \ \ \ \ \{}
\DoxyCodeLine{00916\ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_unicode_value_range}{UnicodeValueRange}}\ rec;}
\DoxyCodeLine{00917\ \ \ \ \ \ \ rec.startUnicodeValue\ =\ lastCode;}
\DoxyCodeLine{00918\ \ \ \ \ \ \ rec.additionalCount\ =\ count\ -\/\ 1;}
\DoxyCodeLine{00919\ \ \ \ \ \ \ c-\/>copy<\mbox{\hyperlink{struct_o_t_1_1_unicode_value_range}{UnicodeValueRange}}>\ (rec);}
\DoxyCodeLine{00920\ }
\DoxyCodeLine{00921\ \ \ \ \ \ \ lastCode\ =\ curEntry;}
\DoxyCodeLine{00922\ \ \ \ \ \ \ count\ =\ 0;}
\DoxyCodeLine{00923\ \ \ \ \ \}}
\DoxyCodeLine{00924\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00925\ \ \ \ \ \}}
\DoxyCodeLine{00926\ }
\DoxyCodeLine{00927\ \ \ \ \ \textcolor{keywordflow}{if}\ (lastCode\ !=\ HB\_MAP\_VALUE\_INVALID)}
\DoxyCodeLine{00928\ \ \ \ \ \{}
\DoxyCodeLine{00929\ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_unicode_value_range}{UnicodeValueRange}}\ rec;}
\DoxyCodeLine{00930\ \ \ \ \ \ \ rec.startUnicodeValue\ =\ lastCode;}
\DoxyCodeLine{00931\ \ \ \ \ \ \ rec.additionalCount\ =\ count;}
\DoxyCodeLine{00932\ \ \ \ \ \ \ c-\/>copy<\mbox{\hyperlink{struct_o_t_1_1_unicode_value_range}{UnicodeValueRange}}>\ (rec);}
\DoxyCodeLine{00933\ \ \ \ \ \}}
\DoxyCodeLine{00934\ }
\DoxyCodeLine{00935\ \ \ \ \ \textcolor{keywordflow}{if}\ (c-\/>length\ ()\ -\/\ init\_len\ ==\ 0)}
\DoxyCodeLine{00936\ \ \ \ \ \{}
\DoxyCodeLine{00937\ \ \ \ \ \ \ c-\/>revert\ (snap);}
\DoxyCodeLine{00938\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00939\ \ \ \ \ \}}
\DoxyCodeLine{00940\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00941\ \ \ \ \ \{}
\DoxyCodeLine{00942\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>check\_assign\ (out-\/>len,}
\DoxyCodeLine{00943\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (c-\/>length\ ()\ -\/\ init\_len)\ /\ UnicodeValueRange::static\_size,}
\DoxyCodeLine{00944\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ HB\_SERIALIZE\_ERROR\_INT\_OVERFLOW)))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00945\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ out;}
\DoxyCodeLine{00946\ \ \ \ \ \}}
\DoxyCodeLine{00947\ \ \ \}}
\DoxyCodeLine{00948\ }
\DoxyCodeLine{00949\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00950\ \ \ DEFINE\_SIZE\_ARRAY\ (4,\ *\textcolor{keyword}{this});}
\DoxyCodeLine{00951\ \};}
\DoxyCodeLine{00952\ }
\DoxyCodeLine{00953\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_u_v_s_mapping}{UVSMapping}}}
\DoxyCodeLine{00954\ \{}
\DoxyCodeLine{00955\ \ \ \textcolor{keywordtype}{int}\ cmp\ (\textcolor{keyword}{const}\ hb\_codepoint\_t\ \&codepoint)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00956\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ unicodeValue.cmp\ (codepoint);\ \}}
\DoxyCodeLine{00957\ }
\DoxyCodeLine{00958\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00959\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00960\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00961\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this}));}
\DoxyCodeLine{00962\ \ \ \}}
\DoxyCodeLine{00963\ }
\DoxyCodeLine{00964\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT24}}\ \ unicodeValue;\ \ \ \textcolor{comment}{/*\ Base\ Unicode\ value\ of\ the\ UVS\ */}}
\DoxyCodeLine{00965\ \ \ \mbox{\hyperlink{struct_o_t_1_1_h_b_glyph_i_d16}{HBGlyphID16}}\ \ \ \ glyphID;\ \ \ \ \textcolor{comment}{/*\ Glyph\ ID\ of\ the\ UVS\ */}}
\DoxyCodeLine{00966\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00967\ \ \ DEFINE\_SIZE\_STATIC\ (5);}
\DoxyCodeLine{00968\ \};}
\DoxyCodeLine{00969\ }
\DoxyCodeLine{00970\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_non_default_u_v_s}{NonDefaultUVS}}\ :\ \mbox{\hyperlink{struct_o_t_1_1_sorted_array_of}{SortedArray32Of}}<UVSMapping>}
\DoxyCodeLine{00971\ \{}
\DoxyCodeLine{00972\ \ \ \textcolor{keywordtype}{void}\ collect\_unicodes\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *out)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00973\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00974\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{structa}{a}}\ :\ as\_array\ ())}
\DoxyCodeLine{00975\ \ \ \ \ \ \ out-\/>add\ (\mbox{\hyperlink{structa}{a}}.unicodeValue);}
\DoxyCodeLine{00976\ \ \ \}}
\DoxyCodeLine{00977\ }
\DoxyCodeLine{00978\ \ \ \textcolor{keywordtype}{void}\ collect\_mapping\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *unicodes,\ \textcolor{comment}{/*\ OUT\ */}}
\DoxyCodeLine{00979\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *mapping\ \textcolor{comment}{/*\ OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{00980\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00981\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{structa}{a}}\ :\ as\_array\ ())}
\DoxyCodeLine{00982\ \ \ \ \ \{}
\DoxyCodeLine{00983\ \ \ \ \ \ \ hb\_codepoint\_t\ unicode\ =\ \mbox{\hyperlink{structa}{a}}.unicodeValue;}
\DoxyCodeLine{00984\ \ \ \ \ \ \ hb\_codepoint\_t\ glyphid\ =\ \mbox{\hyperlink{structa}{a}}.glyphID;}
\DoxyCodeLine{00985\ \ \ \ \ \ \ unicodes-\/>add\ (unicode);}
\DoxyCodeLine{00986\ \ \ \ \ \ \ mapping-\/>set\ (unicode,\ glyphid);}
\DoxyCodeLine{00987\ \ \ \ \ \}}
\DoxyCodeLine{00988\ \ \ \}}
\DoxyCodeLine{00989\ }
\DoxyCodeLine{00990\ \ \ \textcolor{keywordtype}{void}\ closure\_glyphs\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \ \ \ \ \ *unicodes,}
\DoxyCodeLine{00991\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \ \ \ \ \ \ \ \ \ \ \ *glyphset)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00992\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00993\ \ \ \ \ +\ as\_array\ ()}
\DoxyCodeLine{00994\ \ \ \ \ |\ hb\_filter\ (unicodes,\ \&UVSMapping::unicodeValue)}
\DoxyCodeLine{00995\ \ \ \ \ |\ hb\_map\ (\&UVSMapping::glyphID)}
\DoxyCodeLine{00996\ \ \ \ \ |\ hb\_sink\ (glyphset)}
\DoxyCodeLine{00997\ \ \ \ \ ;}
\DoxyCodeLine{00998\ \ \ \}}
\DoxyCodeLine{00999\ }
\DoxyCodeLine{01000\ \ \ \mbox{\hyperlink{struct_o_t_1_1_non_default_u_v_s}{NonDefaultUVS}}*\ copy\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{01001\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *unicodes,}
\DoxyCodeLine{01002\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs\_requested,}
\DoxyCodeLine{01003\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *glyph\_map)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01004\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01005\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_non_default_u_v_s}{NonDefaultUVS}}\ *out\ =\ c-\/>start\_embed<\mbox{\hyperlink{struct_o_t_1_1_non_default_u_v_s}{NonDefaultUVS}}>\ ();}
\DoxyCodeLine{01006\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!out))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01007\ }
\DoxyCodeLine{01008\ \ \ \ \ \textcolor{keyword}{auto}\ it\ =}
\DoxyCodeLine{01009\ \ \ \ \ +\ as\_array\ ()}
\DoxyCodeLine{01010\ \ \ \ \ |\ hb\_filter\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_u_v_s_mapping}{UVSMapping}}\&\ \_)}
\DoxyCodeLine{01011\ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01012\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ unicodes-\/>has\ (\_.unicodeValue)\ ||\ glyphs\_requested-\/>has\ (\_.glyphID);}
\DoxyCodeLine{01013\ \ \ \ \ \ \ \ \ \ \})}
\DoxyCodeLine{01014\ \ \ \ \ ;}
\DoxyCodeLine{01015\ }
\DoxyCodeLine{01016\ \ \ \ \ \textcolor{keywordflow}{if}\ (!it)\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01017\ }
\DoxyCodeLine{01018\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT32}}\ len;}
\DoxyCodeLine{01019\ \ \ \ \ len\ =\ it.len\ ();}
\DoxyCodeLine{01020\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>copy<\mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT32}}>\ (len)))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01021\ }
\DoxyCodeLine{01022\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_u_v_s_mapping}{UVSMapping}}\&\ \_\ :\ it)}
\DoxyCodeLine{01023\ \ \ \ \ \{}
\DoxyCodeLine{01024\ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_u_v_s_mapping}{UVSMapping}}\ mapping;}
\DoxyCodeLine{01025\ \ \ \ \ \ \ mapping.unicodeValue\ =\ \_.unicodeValue;}
\DoxyCodeLine{01026\ \ \ \ \ \ \ mapping.glyphID\ =\ glyph\_map-\/>get\ (\_.glyphID);}
\DoxyCodeLine{01027\ \ \ \ \ \ \ c-\/>copy<\mbox{\hyperlink{struct_o_t_1_1_u_v_s_mapping}{UVSMapping}}>\ (mapping);}
\DoxyCodeLine{01028\ \ \ \ \ \}}
\DoxyCodeLine{01029\ }
\DoxyCodeLine{01030\ \ \ \ \ \textcolor{keywordflow}{return}\ out;}
\DoxyCodeLine{01031\ \ \ \}}
\DoxyCodeLine{01032\ }
\DoxyCodeLine{01033\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01034\ \ \ DEFINE\_SIZE\_ARRAY\ (4,\ *\textcolor{keyword}{this});}
\DoxyCodeLine{01035\ \};}
\DoxyCodeLine{01036\ }
\DoxyCodeLine{01037\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_variation_selector_record}{VariationSelectorRecord}}}
\DoxyCodeLine{01038\ \{}
\DoxyCodeLine{01039\ \ \ glyph\_variant\_t\ get\_glyph\ (hb\_codepoint\_t\ codepoint,}
\DoxyCodeLine{01040\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ *glyph,}
\DoxyCodeLine{01041\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01042\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01043\ \ \ \ \ \textcolor{keywordflow}{if}\ ((base+defaultUVS).bfind\ (codepoint))}
\DoxyCodeLine{01044\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GLYPH\_VARIANT\_USE\_DEFAULT;}
\DoxyCodeLine{01045\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_u_v_s_mapping}{UVSMapping}}\ \&nonDefault\ =\ (base+nonDefaultUVS).bsearch\ (codepoint);}
\DoxyCodeLine{01046\ \ \ \ \ \textcolor{keywordflow}{if}\ (nonDefault.glyphID)}
\DoxyCodeLine{01047\ \ \ \ \ \{}
\DoxyCodeLine{01048\ \ \ \ \ \ \ *glyph\ =\ nonDefault.glyphID;}
\DoxyCodeLine{01049\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GLYPH\_VARIANT\_FOUND;}
\DoxyCodeLine{01050\ \ \ \ \ \}}
\DoxyCodeLine{01051\ \ \ \ \ \textcolor{keywordflow}{return}\ GLYPH\_VARIANT\_NOT\_FOUND;}
\DoxyCodeLine{01052\ \ \ \}}
\DoxyCodeLine{01053\ }
\DoxyCodeLine{01054\ \ \ \mbox{\hyperlink{struct_o_t_1_1_variation_selector_record}{VariationSelectorRecord}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_variation_selector_record}{VariationSelectorRecord}}\&\ other)}
\DoxyCodeLine{01055\ \ \ \{}
\DoxyCodeLine{01056\ \ \ \ \ *\textcolor{keyword}{this}\ =\ other;}
\DoxyCodeLine{01057\ \ \ \}}
\DoxyCodeLine{01058\ }
\DoxyCodeLine{01059\ \ \ \textcolor{keywordtype}{void}\ operator=\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_variation_selector_record}{VariationSelectorRecord}}\&\ other)}
\DoxyCodeLine{01060\ \ \ \{}
\DoxyCodeLine{01061\ \ \ \ \ varSelector\ =\ other.varSelector;}
\DoxyCodeLine{01062\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT32}}\ offset\ =\ other.defaultUVS;}
\DoxyCodeLine{01063\ \ \ \ \ defaultUVS\ =\ offset;}
\DoxyCodeLine{01064\ \ \ \ \ offset\ =\ other.nonDefaultUVS;}
\DoxyCodeLine{01065\ \ \ \ \ nonDefaultUVS\ =\ offset;}
\DoxyCodeLine{01066\ \ \ \}}
\DoxyCodeLine{01067\ }
\DoxyCodeLine{01068\ \ \ \textcolor{keywordtype}{void}\ collect\_unicodes\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *out,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01069\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01070\ \ \ \ \ (base+defaultUVS).collect\_unicodes\ (out);}
\DoxyCodeLine{01071\ \ \ \ \ (base+nonDefaultUVS).collect\_unicodes\ (out);}
\DoxyCodeLine{01072\ \ \ \}}
\DoxyCodeLine{01073\ }
\DoxyCodeLine{01074\ \ \ \textcolor{keywordtype}{void}\ collect\_mapping\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base,}
\DoxyCodeLine{01075\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *unicodes,\ \textcolor{comment}{/*\ OUT\ */}}
\DoxyCodeLine{01076\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *mapping\ \textcolor{comment}{/*\ OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{01077\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01078\ \ \ \ \ (base+defaultUVS).collect\_unicodes\ (unicodes);}
\DoxyCodeLine{01079\ \ \ \ \ (base+nonDefaultUVS).collect\_mapping\ (unicodes,\ mapping);}
\DoxyCodeLine{01080\ \ \ \}}
\DoxyCodeLine{01081\ }
\DoxyCodeLine{01082\ \ \ \textcolor{keywordtype}{int}\ cmp\ (\textcolor{keyword}{const}\ hb\_codepoint\_t\ \&variation\_selector)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01083\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ varSelector.cmp\ (variation\_selector);\ \}}
\DoxyCodeLine{01084\ }
\DoxyCodeLine{01085\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01086\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01087\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01088\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this})\ \&\&}
\DoxyCodeLine{01089\ \ \ \ \ \ \ \ \ \ \ defaultUVS.sanitize\ (c,\ base)\ \&\&}
\DoxyCodeLine{01090\ \ \ \ \ \ \ \ \ \ \ nonDefaultUVS.sanitize\ (c,\ base));}
\DoxyCodeLine{01091\ \ \ \}}
\DoxyCodeLine{01092\ }
\DoxyCodeLine{01093\ \ \ \mbox{\hyperlink{structhb__pair__t}{hb\_pair\_t<unsigned,\ unsigned>}}}
\DoxyCodeLine{01094\ \ \ copy\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{01095\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *unicodes,}
\DoxyCodeLine{01096\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs\_requested,}
\DoxyCodeLine{01097\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *glyph\_map,}
\DoxyCodeLine{01098\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01099\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01100\ \ \ \ \ \textcolor{keyword}{auto}\ snap\ =\ c-\/>snapshot\ ();}
\DoxyCodeLine{01101\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>embed<\mbox{\hyperlink{struct_o_t_1_1_variation_selector_record}{VariationSelectorRecord}}>\ (*this);}
\DoxyCodeLine{01102\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!out))\ \textcolor{keywordflow}{return}\ hb\_pair\ (0,\ 0);}
\DoxyCodeLine{01103\ }
\DoxyCodeLine{01104\ \ \ \ \ out-\/>defaultUVS\ =\ 0;}
\DoxyCodeLine{01105\ \ \ \ \ out-\/>nonDefaultUVS\ =\ 0;}
\DoxyCodeLine{01106\ }
\DoxyCodeLine{01107\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ non\_default\_uvs\_objidx\ =\ 0;}
\DoxyCodeLine{01108\ \ \ \ \ \textcolor{keywordflow}{if}\ (nonDefaultUVS\ !=\ 0)}
\DoxyCodeLine{01109\ \ \ \ \ \{}
\DoxyCodeLine{01110\ \ \ \ \ \ \ c-\/>push\ ();}
\DoxyCodeLine{01111\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (c-\/>copy\ (base+nonDefaultUVS,\ unicodes,\ glyphs\_requested,\ glyph\_map))}
\DoxyCodeLine{01112\ \ \ \ \ non\_default\_uvs\_objidx\ =\ c-\/>pop\_pack\ ();}
\DoxyCodeLine{01113\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ c-\/>pop\_discard\ ();}
\DoxyCodeLine{01114\ \ \ \ \ \}}
\DoxyCodeLine{01115\ }
\DoxyCodeLine{01116\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ default\_uvs\_objidx\ =\ 0;}
\DoxyCodeLine{01117\ \ \ \ \ \textcolor{keywordflow}{if}\ (defaultUVS\ !=\ 0)}
\DoxyCodeLine{01118\ \ \ \ \ \{}
\DoxyCodeLine{01119\ \ \ \ \ \ \ c-\/>push\ ();}
\DoxyCodeLine{01120\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (c-\/>copy\ (base+defaultUVS,\ unicodes))}
\DoxyCodeLine{01121\ \ \ \ \ default\_uvs\_objidx\ =\ c-\/>pop\_pack\ ();}
\DoxyCodeLine{01122\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ c-\/>pop\_discard\ ();}
\DoxyCodeLine{01123\ \ \ \ \ \}}
\DoxyCodeLine{01124\ }
\DoxyCodeLine{01125\ }
\DoxyCodeLine{01126\ \ \ \ \ \textcolor{keywordflow}{if}\ (!default\_uvs\_objidx\ \&\&\ !non\_default\_uvs\_objidx)}
\DoxyCodeLine{01127\ \ \ \ \ \ \ c-\/>revert\ (snap);}
\DoxyCodeLine{01128\ }
\DoxyCodeLine{01129\ \ \ \ \ \textcolor{keywordflow}{return}\ hb\_pair\ (default\_uvs\_objidx,\ non\_default\_uvs\_objidx);}
\DoxyCodeLine{01130\ \ \ \}}
\DoxyCodeLine{01131\ }
\DoxyCodeLine{01132\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT24}}\ \ varSelector;\ \ \ \ \textcolor{comment}{/*\ Variation\ selector.\ */}}
\DoxyCodeLine{01133\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset32To<DefaultUVS>}}}
\DoxyCodeLine{01134\ \ \ \ \ \ \ \ \ defaultUVS;\ \textcolor{comment}{/*\ Offset\ to\ Default\ UVS\ Table.\ \ May\ be\ 0.\ */}}
\DoxyCodeLine{01135\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset32To<NonDefaultUVS>}}}
\DoxyCodeLine{01136\ \ \ \ \ \ \ \ \ nonDefaultUVS;\ \ \textcolor{comment}{/*\ Offset\ to\ Non-\/Default\ UVS\ Table.\ \ May\ be\ 0.\ */}}
\DoxyCodeLine{01137\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01138\ \ \ DEFINE\_SIZE\_STATIC\ (11);}
\DoxyCodeLine{01139\ \};}
\DoxyCodeLine{01140\ }
\DoxyCodeLine{01141\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_format14}{CmapSubtableFormat14}}}
\DoxyCodeLine{01142\ \{}
\DoxyCodeLine{01143\ \ \ glyph\_variant\_t\ get\_glyph\_variant\ (hb\_codepoint\_t\ codepoint,}
\DoxyCodeLine{01144\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ variation\_selector,}
\DoxyCodeLine{01145\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ *glyph)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01146\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ record.bsearch\ (variation\_selector).get\_glyph\ (codepoint,\ glyph,\ \textcolor{keyword}{this});\ \}}
\DoxyCodeLine{01147\ }
\DoxyCodeLine{01148\ \ \ \textcolor{keywordtype}{void}\ collect\_variation\_selectors\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *out)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01149\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01150\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{structa}{a}}\ :\ record.as\_array\ ())}
\DoxyCodeLine{01151\ \ \ \ \ \ \ out-\/>add\ (\mbox{\hyperlink{structa}{a}}.varSelector);}
\DoxyCodeLine{01152\ \ \ \}}
\DoxyCodeLine{01153\ \ \ \textcolor{keywordtype}{void}\ collect\_variation\_unicodes\ (hb\_codepoint\_t\ variation\_selector,}
\DoxyCodeLine{01154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *out)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01155\ \textcolor{keyword}{\ \ }\{\ record.bsearch\ (variation\_selector).collect\_unicodes\ (out,\ \textcolor{keyword}{this});\ \}}
\DoxyCodeLine{01156\ }
\DoxyCodeLine{01157\ \ \ \textcolor{keywordtype}{void}\ serialize\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{01158\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *unicodes,}
\DoxyCodeLine{01159\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs\_requested,}
\DoxyCodeLine{01160\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *glyph\_map,}
\DoxyCodeLine{01161\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base)}
\DoxyCodeLine{01162\ \ \ \{}
\DoxyCodeLine{01163\ \ \ \ \ \textcolor{keyword}{auto}\ snap\ =\ c-\/>snapshot\ ();}
\DoxyCodeLine{01164\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ table\_initpos\ =\ c-\/>length\ ();}
\DoxyCodeLine{01165\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ init\_tail\ =\ c-\/>tail;}
\DoxyCodeLine{01166\ }
\DoxyCodeLine{01167\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>extend\_min\ (\textcolor{keyword}{this})))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01168\ \ \ \ \ this-\/>format\ =\ 14;}
\DoxyCodeLine{01169\ }
\DoxyCodeLine{01170\ \ \ \ \ \textcolor{keyword}{auto}\ src\_tbl\ =\ \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_format14}{CmapSubtableFormat14}}*\textcolor{keyword}{>}\ (base);}
\DoxyCodeLine{01171\ }
\DoxyCodeLine{01172\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01173\ \textcolor{comment}{\ \ \ \ \ *\ Some\ versions\ of\ OTS\ require\ that\ offsets\ are\ in\ order.\ Due\ to\ the\ use}}
\DoxyCodeLine{01174\ \textcolor{comment}{\ \ \ \ \ *\ of\ push()/pop\_pack()\ serializing\ the\ variation\ records\ in\ order\ results}}
\DoxyCodeLine{01175\ \textcolor{comment}{\ \ \ \ \ *\ in\ the\ offsets\ being\ in\ reverse\ order\ (first\ record\ has\ the\ largest}}
\DoxyCodeLine{01176\ \textcolor{comment}{\ \ \ \ \ *\ offset).\ While\ this\ is\ perfectly\ valid,\ it\ will\ cause\ some\ versions\ of}}
\DoxyCodeLine{01177\ \textcolor{comment}{\ \ \ \ \ *\ OTS\ to\ consider\ this\ table\ bad.}}
\DoxyCodeLine{01178\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{01179\ \textcolor{comment}{\ \ \ \ \ *\ So\ to\ prevent\ this\ issue\ we\ serialize\ the\ variation\ records\ in\ reverse}}
\DoxyCodeLine{01180\ \textcolor{comment}{\ \ \ \ \ *\ order,\ so\ that\ the\ offsets\ are\ ordered\ from\ small\ to\ large.\ Since}}
\DoxyCodeLine{01181\ \textcolor{comment}{\ \ \ \ \ *\ variation\ records\ are\ supposed\ to\ be\ in\ increasing\ order\ of\ varSelector}}
\DoxyCodeLine{01182\ \textcolor{comment}{\ \ \ \ \ *\ we\ then\ have\ to\ reverse\ the\ order\ of\ the\ written\ variation\ selector}}
\DoxyCodeLine{01183\ \textcolor{comment}{\ \ \ \ \ *\ records\ after\ everything\ is\ finalized.}}
\DoxyCodeLine{01184\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01185\ \ \ \ \ \mbox{\hyperlink{structhb__vector__t}{hb\_vector\_t<hb\_pair\_t<unsigned,\ unsigned>}}>\ obj\_indices;}
\DoxyCodeLine{01186\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ src\_tbl-\/>record.len\ -\/\ 1;\ i\ >=\ 0;\ i-\/-\/)}
\DoxyCodeLine{01187\ \ \ \ \ \{}
\DoxyCodeLine{01188\ \ \ \ \ \ \ \mbox{\hyperlink{structhb__pair__t}{hb\_pair\_t<unsigned,\ unsigned>}}\ result\ =\ src\_tbl-\/>record[i].copy\ (c,\ unicodes,\ glyphs\_requested,\ glyph\_map,\ base);}
\DoxyCodeLine{01189\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (result.first\ ||\ result.second)}
\DoxyCodeLine{01190\ \ \ \ \ obj\_indices.push\ (result);}
\DoxyCodeLine{01191\ \ \ \ \ \}}
\DoxyCodeLine{01192\ }
\DoxyCodeLine{01193\ \ \ \ \ \textcolor{keywordflow}{if}\ (c-\/>length\ ()\ -\/\ table\_initpos\ ==\ CmapSubtableFormat14::min\_size)}
\DoxyCodeLine{01194\ \ \ \ \ \{}
\DoxyCodeLine{01195\ \ \ \ \ \ \ c-\/>revert\ (snap);}
\DoxyCodeLine{01196\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01197\ \ \ \ \ \}}
\DoxyCodeLine{01198\ }
\DoxyCodeLine{01199\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>check\_success\ (!obj\_indices.in\_error\ ())))}
\DoxyCodeLine{01200\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01201\ }
\DoxyCodeLine{01202\ \ \ \ \ \textcolor{keywordtype}{int}\ tail\_len\ =\ init\_tail\ -\/\ c-\/>tail;}
\DoxyCodeLine{01203\ \ \ \ \ c-\/>check\_assign\ (this-\/>length,\ c-\/>length\ ()\ -\/\ table\_initpos\ +\ tail\_len,}
\DoxyCodeLine{01204\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ HB\_SERIALIZE\_ERROR\_INT\_OVERFLOW);}
\DoxyCodeLine{01205\ \ \ \ \ c-\/>check\_assign\ (this-\/>record.len,}
\DoxyCodeLine{01206\ \ \ \ \ \ \ \ \ \ \ \ \ \ (c-\/>length\ ()\ -\/\ table\_initpos\ -\/\ CmapSubtableFormat14::min\_size)\ /}
\DoxyCodeLine{01207\ \ \ \ \ \ \ \ \ \ \ \ \ \ VariationSelectorRecord::static\_size,}
\DoxyCodeLine{01208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ HB\_SERIALIZE\_ERROR\_INT\_OVERFLOW);}
\DoxyCodeLine{01209\ }
\DoxyCodeLine{01210\ \ \ \ \ \textcolor{comment}{/*\ Correct\ the\ incorrect\ write\ order\ by\ reversing\ the\ order\ of\ the\ variation}}
\DoxyCodeLine{01211\ \textcolor{comment}{\ \ \ \ \ \ \ records\ array.\ */}}
\DoxyCodeLine{01212\ \ \ \ \ \_reverse\_variation\_records\ ();}
\DoxyCodeLine{01213\ }
\DoxyCodeLine{01214\ \ \ \ \ \textcolor{comment}{/*\ Now\ that\ records\ are\ in\ the\ right\ order,\ we\ can\ set\ up\ the\ offsets.\ */}}
\DoxyCodeLine{01215\ \ \ \ \ \_add\_links\_to\_variation\_records\ (c,\ obj\_indices);}
\DoxyCodeLine{01216\ \ \ \}}
\DoxyCodeLine{01217\ }
\DoxyCodeLine{01218\ \ \ \textcolor{keywordtype}{void}\ \_reverse\_variation\_records\ ()}
\DoxyCodeLine{01219\ \ \ \{}
\DoxyCodeLine{01220\ \ \ \ \ record.as\_array\ ().reverse\ ();}
\DoxyCodeLine{01221\ \ \ \}}
\DoxyCodeLine{01222\ }
\DoxyCodeLine{01223\ \ \ \textcolor{keywordtype}{void}\ \_add\_links\_to\_variation\_records\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{01224\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__vector__t}{hb\_vector\_t}}<\mbox{\hyperlink{structhb__pair__t}{hb\_pair\_t<unsigned,\ unsigned>}}>\&\ obj\_indices)}
\DoxyCodeLine{01225\ \ \ \{}
\DoxyCodeLine{01226\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ 0;\ i\ <\ obj\_indices.length;\ i++)}
\DoxyCodeLine{01227\ \ \ \ \ \{}
\DoxyCodeLine{01228\ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{01229\ \textcolor{comment}{\ \ \ \ \ \ \ *\ Since\ the\ record\ array\ has\ been\ reversed\ (see\ comments\ in\ copy())}}
\DoxyCodeLine{01230\ \textcolor{comment}{\ \ \ \ \ \ \ *\ but\ obj\_indices\ has\ not\ been,\ the\ indices\ at\ obj\_indices[i]}}
\DoxyCodeLine{01231\ \textcolor{comment}{\ \ \ \ \ \ \ *\ are\ for\ the\ variation\ record\ at\ record[j].}}
\DoxyCodeLine{01232\ \textcolor{comment}{\ \ \ \ \ \ \ */}}
\DoxyCodeLine{01233\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ j\ =\ obj\_indices.length\ -\/\ 1\ -\/\ i;}
\DoxyCodeLine{01234\ \ \ \ \ \ \ c-\/>add\_link\ (record[j].defaultUVS,\ obj\_indices[i].first);}
\DoxyCodeLine{01235\ \ \ \ \ \ \ c-\/>add\_link\ (record[j].nonDefaultUVS,\ obj\_indices[i].second);}
\DoxyCodeLine{01236\ \ \ \ \ \}}
\DoxyCodeLine{01237\ \ \ \}}
\DoxyCodeLine{01238\ }
\DoxyCodeLine{01239\ \ \ \textcolor{keywordtype}{void}\ closure\_glyphs\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \ \ \ \ \ *unicodes,}
\DoxyCodeLine{01240\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \ \ \ \ \ \ \ \ \ \ \ *glyphset)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01241\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01242\ \ \ \ \ +\ hb\_iter\ (record)}
\DoxyCodeLine{01243\ \ \ \ \ |\ hb\_filter\ (hb\_bool,\ \&VariationSelectorRecord::nonDefaultUVS)}
\DoxyCodeLine{01244\ \ \ \ \ |\ hb\_map\ (\&VariationSelectorRecord::nonDefaultUVS)}
\DoxyCodeLine{01245\ \ \ \ \ |\ hb\_map\ (hb\_add\ (\textcolor{keyword}{this}))}
\DoxyCodeLine{01246\ \ \ \ \ |\ hb\_apply\ ([=]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_non_default_u_v_s}{NonDefaultUVS}}\&\ \_)\ \{\ \_.closure\_glyphs\ (unicodes,\ glyphset);\ \})}
\DoxyCodeLine{01247\ \ \ \ \ ;}
\DoxyCodeLine{01248\ \ \ \}}
\DoxyCodeLine{01249\ }
\DoxyCodeLine{01250\ \ \ \textcolor{keywordtype}{void}\ collect\_unicodes\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *out)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01251\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01252\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_variation_selector_record}{VariationSelectorRecord}}\&\ \_\ :\ record)}
\DoxyCodeLine{01253\ \ \ \ \ \ \ \_.collect\_unicodes\ (out,\ \textcolor{keyword}{this});}
\DoxyCodeLine{01254\ \ \ \}}
\DoxyCodeLine{01255\ }
\DoxyCodeLine{01256\ \ \ \textcolor{keywordtype}{void}\ collect\_mapping\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *unicodes,\ \textcolor{comment}{/*\ OUT\ */}}
\DoxyCodeLine{01257\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *mapping\ \textcolor{comment}{/*\ OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{01258\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01259\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_variation_selector_record}{VariationSelectorRecord}}\&\ \_\ :\ record)}
\DoxyCodeLine{01260\ \ \ \ \ \ \ \_.collect\_mapping\ (\textcolor{keyword}{this},\ unicodes,\ mapping);}
\DoxyCodeLine{01261\ \ \ \}}
\DoxyCodeLine{01262\ }
\DoxyCodeLine{01263\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01264\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01265\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01266\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this})\ \&\&}
\DoxyCodeLine{01267\ \ \ \ \ \ \ \ \ \ \ record.sanitize\ (c,\ \textcolor{keyword}{this}));}
\DoxyCodeLine{01268\ \ \ \}}
\DoxyCodeLine{01269\ }
\DoxyCodeLine{01270\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{01271\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ format;\ \ \ \ \ \textcolor{comment}{/*\ Format\ number\ is\ set\ to\ 14.\ */}}
\DoxyCodeLine{01272\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT32}}\ \ length;\ \ \ \ \ \textcolor{comment}{/*\ Byte\ length\ of\ this\ subtable.\ */}}
\DoxyCodeLine{01273\ \ \ \mbox{\hyperlink{struct_o_t_1_1_sorted_array_of}{SortedArray32Of<VariationSelectorRecord>}}}
\DoxyCodeLine{01274\ \ \ \ \ \ \ \ \ record;\ \ \ \ \ \textcolor{comment}{/*\ Variation\ selector\ records;\ sorted}}
\DoxyCodeLine{01275\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ in\ increasing\ order\ of\ `varSelector'.\ */}}
\DoxyCodeLine{01276\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01277\ \ \ DEFINE\_SIZE\_ARRAY\ (10,\ record);}
\DoxyCodeLine{01278\ \};}
\DoxyCodeLine{01279\ }
\DoxyCodeLine{01280\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_cmap_subtable}{CmapSubtable}}}
\DoxyCodeLine{01281\ \{}
\DoxyCodeLine{01282\ \ \ \textcolor{comment}{/*\ Note:\ We\ intentionally\ do\ NOT\ implement\ subtable\ formats\ 2\ and\ 8.\ */}}
\DoxyCodeLine{01283\ }
\DoxyCodeLine{01284\ \ \ \textcolor{keywordtype}{bool}\ get\_glyph\ (hb\_codepoint\_t\ codepoint,}
\DoxyCodeLine{01285\ \ \ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ *glyph)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01286\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01287\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)\ \{}
\DoxyCodeLine{01288\ \ \ \ \ \textcolor{keywordflow}{case}\ \ 0:\ \textcolor{keywordflow}{return}\ u.format0\ .get\_glyph\ (codepoint,\ glyph);}
\DoxyCodeLine{01289\ \ \ \ \ \textcolor{keywordflow}{case}\ \ 4:\ \textcolor{keywordflow}{return}\ u.format4\ .get\_glyph\ (codepoint,\ glyph);}
\DoxyCodeLine{01290\ \ \ \ \ \textcolor{keywordflow}{case}\ \ 6:\ \textcolor{keywordflow}{return}\ u.format6\ .get\_glyph\ (codepoint,\ glyph);}
\DoxyCodeLine{01291\ \ \ \ \ \textcolor{keywordflow}{case}\ 10:\ \textcolor{keywordflow}{return}\ u.format10.get\_glyph\ (codepoint,\ glyph);}
\DoxyCodeLine{01292\ \ \ \ \ \textcolor{keywordflow}{case}\ 12:\ \textcolor{keywordflow}{return}\ u.format12.get\_glyph\ (codepoint,\ glyph);}
\DoxyCodeLine{01293\ \ \ \ \ \textcolor{keywordflow}{case}\ 13:\ \textcolor{keywordflow}{return}\ u.format13.get\_glyph\ (codepoint,\ glyph);}
\DoxyCodeLine{01294\ \ \ \ \ \textcolor{keywordflow}{case}\ 14:}
\DoxyCodeLine{01295\ \ \ \ \ \textcolor{keywordflow}{default}:\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01296\ \ \ \ \ \}}
\DoxyCodeLine{01297\ \ \ \}}
\DoxyCodeLine{01298\ \ \ \textcolor{keywordtype}{void}\ collect\_unicodes\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *out,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ num\_glyphs\ =\ UINT\_MAX)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01299\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01300\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)\ \{}
\DoxyCodeLine{01301\ \ \ \ \ \textcolor{keywordflow}{case}\ \ 0:\ u.format0\ .collect\_unicodes\ (out);\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01302\ \ \ \ \ \textcolor{keywordflow}{case}\ \ 4:\ u.format4\ .collect\_unicodes\ (out);\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01303\ \ \ \ \ \textcolor{keywordflow}{case}\ \ 6:\ u.format6\ .collect\_unicodes\ (out);\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01304\ \ \ \ \ \textcolor{keywordflow}{case}\ 10:\ u.format10.collect\_unicodes\ (out);\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01305\ \ \ \ \ \textcolor{keywordflow}{case}\ 12:\ u.format12.collect\_unicodes\ (out,\ num\_glyphs);\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01306\ \ \ \ \ \textcolor{keywordflow}{case}\ 13:\ u.format13.collect\_unicodes\ (out,\ num\_glyphs);\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01307\ \ \ \ \ \textcolor{keywordflow}{case}\ 14:}
\DoxyCodeLine{01308\ \ \ \ \ \textcolor{keywordflow}{default}:\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01309\ \ \ \ \ \}}
\DoxyCodeLine{01310\ \ \ \}}
\DoxyCodeLine{01311\ }
\DoxyCodeLine{01312\ \ \ \textcolor{keywordtype}{void}\ collect\_mapping\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *unicodes,\ \textcolor{comment}{/*\ OUT\ */}}
\DoxyCodeLine{01313\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *mapping,\ \textcolor{comment}{/*\ OUT\ */}}
\DoxyCodeLine{01314\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ num\_glyphs\ =\ UINT\_MAX)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01315\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01316\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)\ \{}
\DoxyCodeLine{01317\ \ \ \ \ \textcolor{keywordflow}{case}\ \ 0:\ u.format0\ .collect\_mapping\ (unicodes,\ mapping);\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01318\ \ \ \ \ \textcolor{keywordflow}{case}\ \ 4:\ u.format4\ .collect\_mapping\ (unicodes,\ mapping);\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01319\ \ \ \ \ \textcolor{keywordflow}{case}\ \ 6:\ u.format6\ .collect\_mapping\ (unicodes,\ mapping);\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01320\ \ \ \ \ \textcolor{keywordflow}{case}\ 10:\ u.format10.collect\_mapping\ (unicodes,\ mapping);\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01321\ \ \ \ \ \textcolor{keywordflow}{case}\ 12:\ u.format12.collect\_mapping\ (unicodes,\ mapping,\ num\_glyphs);\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01322\ \ \ \ \ \textcolor{keywordflow}{case}\ 13:\ u.format13.collect\_mapping\ (unicodes,\ mapping,\ num\_glyphs);\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01323\ \ \ \ \ \textcolor{keywordflow}{case}\ 14:}
\DoxyCodeLine{01324\ \ \ \ \ \textcolor{keywordflow}{default}:\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01325\ \ \ \ \ \}}
\DoxyCodeLine{01326\ \ \ \}}
\DoxyCodeLine{01327\ }
\DoxyCodeLine{01328\ \ \ \textcolor{keywordtype}{unsigned}\ get\_language\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{01329\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01330\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)\ \{}
\DoxyCodeLine{01331\ \ \ \ \ \textcolor{keywordflow}{case}\ \ 0:\ \textcolor{keywordflow}{return}\ u.format0\ .get\_language\ ();}
\DoxyCodeLine{01332\ \ \ \ \ \textcolor{keywordflow}{case}\ \ 4:\ \textcolor{keywordflow}{return}\ u.format4\ .get\_language\ ();}
\DoxyCodeLine{01333\ \ \ \ \ \textcolor{keywordflow}{case}\ \ 6:\ \textcolor{keywordflow}{return}\ u.format6\ .get\_language\ ();}
\DoxyCodeLine{01334\ \ \ \ \ \textcolor{keywordflow}{case}\ 10:\ \textcolor{keywordflow}{return}\ u.format10.get\_language\ ();}
\DoxyCodeLine{01335\ \ \ \ \ \textcolor{keywordflow}{case}\ 12:\ \textcolor{keywordflow}{return}\ u.format12.get\_language\ ();}
\DoxyCodeLine{01336\ \ \ \ \ \textcolor{keywordflow}{case}\ 13:\ \textcolor{keywordflow}{return}\ u.format13.get\_language\ ();}
\DoxyCodeLine{01337\ \ \ \ \ \textcolor{keywordflow}{case}\ 14:}
\DoxyCodeLine{01338\ \ \ \ \ \textcolor{keywordflow}{default}:\ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01339\ \ \ \ \ \}}
\DoxyCodeLine{01340\ \ \ \}}
\DoxyCodeLine{01341\ }
\DoxyCodeLine{01342\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Iterator,}
\DoxyCodeLine{01343\ \ \ \ \ \ \ \ hb\_requires\ (hb\_is\_iterator\ (Iterator))>}
\DoxyCodeLine{01344\ \ \ \textcolor{keywordtype}{void}\ serialize\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{01345\ \ \ \ \ \ \ \ \ \ \ Iterator\ it,}
\DoxyCodeLine{01346\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ format,}
\DoxyCodeLine{01347\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__subset__plan__t}{hb\_subset\_plan\_t}}\ *plan,}
\DoxyCodeLine{01348\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base)}
\DoxyCodeLine{01349\ \ \ \{}
\DoxyCodeLine{01350\ \ \ \ \ \textcolor{keywordflow}{switch}\ (format)\ \{}
\DoxyCodeLine{01351\ \ \ \ \ \textcolor{keywordflow}{case}\ \ 4:\ \textcolor{keywordflow}{return}\ u.format4.serialize\ (c,\ it);}
\DoxyCodeLine{01352\ \ \ \ \ \textcolor{keywordflow}{case}\ 12:\ \textcolor{keywordflow}{return}\ u.format12.serialize\ (c,\ it);}
\DoxyCodeLine{01353\ \ \ \ \ \textcolor{keywordflow}{case}\ 14:\ \textcolor{keywordflow}{return}\ u.format14.serialize\ (c,\ plan-\/>unicodes,\ plan-\/>glyphs\_requested,\ plan-\/>glyph\_map,\ base);}
\DoxyCodeLine{01354\ \ \ \ \ \textcolor{keywordflow}{default}:\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01355\ \ \ \ \ \}}
\DoxyCodeLine{01356\ \ \ \}}
\DoxyCodeLine{01357\ }
\DoxyCodeLine{01358\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01359\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01360\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01361\ \ \ \ \ \textcolor{keywordflow}{if}\ (!u.format.sanitize\ (c))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01362\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)\ \{}
\DoxyCodeLine{01363\ \ \ \ \ \textcolor{keywordflow}{case}\ \ 0:\ return\_trace\ (u.format0\ .sanitize\ (c));}
\DoxyCodeLine{01364\ \ \ \ \ \textcolor{keywordflow}{case}\ \ 4:\ return\_trace\ (u.format4\ .sanitize\ (c));}
\DoxyCodeLine{01365\ \ \ \ \ \textcolor{keywordflow}{case}\ \ 6:\ return\_trace\ (u.format6\ .sanitize\ (c));}
\DoxyCodeLine{01366\ \ \ \ \ \textcolor{keywordflow}{case}\ 10:\ return\_trace\ (u.format10.sanitize\ (c));}
\DoxyCodeLine{01367\ \ \ \ \ \textcolor{keywordflow}{case}\ 12:\ return\_trace\ (u.format12.sanitize\ (c));}
\DoxyCodeLine{01368\ \ \ \ \ \textcolor{keywordflow}{case}\ 13:\ return\_trace\ (u.format13.sanitize\ (c));}
\DoxyCodeLine{01369\ \ \ \ \ \textcolor{keywordflow}{case}\ 14:\ return\_trace\ (u.format14.sanitize\ (c));}
\DoxyCodeLine{01370\ \ \ \ \ \textcolor{keywordflow}{default}:return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{01371\ \ \ \ \ \}}
\DoxyCodeLine{01372\ \ \ \}}
\DoxyCodeLine{01373\ }
\DoxyCodeLine{01374\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01375\ \ \ \textcolor{keyword}{union\ }\{}
\DoxyCodeLine{01376\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ \ \ \ \ format;\ \ \ \ \ \textcolor{comment}{/*\ Format\ identifier\ */}}
\DoxyCodeLine{01377\ \ \ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_format0}{CmapSubtableFormat0}}\ \ \ \ format0;}
\DoxyCodeLine{01378\ \ \ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_format4}{CmapSubtableFormat4}}\ \ \ \ format4;}
\DoxyCodeLine{01379\ \ \ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_format6}{CmapSubtableFormat6}}\ \ \ \ format6;}
\DoxyCodeLine{01380\ \ \ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_format10}{CmapSubtableFormat10}}\ \ format10;}
\DoxyCodeLine{01381\ \ \ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_format12}{CmapSubtableFormat12}}\ \ format12;}
\DoxyCodeLine{01382\ \ \ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_format13}{CmapSubtableFormat13}}\ \ format13;}
\DoxyCodeLine{01383\ \ \ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_format14}{CmapSubtableFormat14}}\ \ format14;}
\DoxyCodeLine{01384\ \ \ \}\ u;}
\DoxyCodeLine{01385\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01386\ \ \ DEFINE\_SIZE\_UNION\ (2,\ format);}
\DoxyCodeLine{01387\ \};}
\DoxyCodeLine{01388\ }
\DoxyCodeLine{01389\ }
\DoxyCodeLine{01390\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_encoding_record}{EncodingRecord}}}
\DoxyCodeLine{01391\ \{}
\DoxyCodeLine{01392\ \ \ \textcolor{keywordtype}{int}\ cmp\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_encoding_record}{EncodingRecord}}\ \&other)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01393\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01394\ \ \ \ \ \textcolor{keywordtype}{int}\ ret;}
\DoxyCodeLine{01395\ \ \ \ \ ret\ =\ platformID.cmp\ (other.platformID);}
\DoxyCodeLine{01396\ \ \ \ \ \textcolor{keywordflow}{if}\ (ret)\ \textcolor{keywordflow}{return}\ ret;}
\DoxyCodeLine{01397\ \ \ \ \ ret\ =\ encodingID.cmp\ (other.encodingID);}
\DoxyCodeLine{01398\ \ \ \ \ \textcolor{keywordflow}{if}\ (ret)\ \textcolor{keywordflow}{return}\ ret;}
\DoxyCodeLine{01399\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01400\ \ \ \}}
\DoxyCodeLine{01401\ }
\DoxyCodeLine{01402\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01403\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01404\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01405\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this})\ \&\&}
\DoxyCodeLine{01406\ \ \ \ \ \ \ \ \ \ \ subtable.sanitize\ (c,\ base));}
\DoxyCodeLine{01407\ \ \ \}}
\DoxyCodeLine{01408\ }
\DoxyCodeLine{01409\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Iterator,}
\DoxyCodeLine{01410\ \ \ \ \ \ \ \ hb\_requires\ (hb\_is\_iterator\ (Iterator))>}
\DoxyCodeLine{01411\ \ \ \mbox{\hyperlink{struct_o_t_1_1_encoding_record}{EncodingRecord}}*\ copy\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{01412\ \ \ \ \ \ \ \ \ \ \ \ \ Iterator\ it,}
\DoxyCodeLine{01413\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ format,}
\DoxyCodeLine{01414\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base,}
\DoxyCodeLine{01415\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__subset__plan__t}{hb\_subset\_plan\_t}}\ *plan,}
\DoxyCodeLine{01416\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ INOUT\ */}\ \textcolor{keywordtype}{unsigned}\ *objidx)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01417\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01418\ \ \ \ \ TRACE\_SERIALIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01419\ \ \ \ \ \textcolor{keyword}{auto}\ snap\ =\ c-\/>snapshot\ ();}
\DoxyCodeLine{01420\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>embed\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01421\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!out))\ return\_trace\ (\textcolor{keyword}{nullptr});}
\DoxyCodeLine{01422\ \ \ \ \ out-\/>subtable\ =\ 0;}
\DoxyCodeLine{01423\ }
\DoxyCodeLine{01424\ \ \ \ \ \textcolor{keywordflow}{if}\ (*objidx\ ==\ 0)}
\DoxyCodeLine{01425\ \ \ \ \ \{}
\DoxyCodeLine{01426\ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable}{CmapSubtable}}\ *cmapsubtable\ =\ c-\/>push<\mbox{\hyperlink{struct_o_t_1_1_cmap_subtable}{CmapSubtable}}>\ ();}
\DoxyCodeLine{01427\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ origin\_length\ =\ c-\/>length\ ();}
\DoxyCodeLine{01428\ \ \ \ \ \ \ cmapsubtable-\/>serialize\ (c,\ it,\ format,\ plan,\ \&(base+subtable));}
\DoxyCodeLine{01429\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (c-\/>length\ ()\ -\/\ origin\_length\ >\ 0)\ *objidx\ =\ c-\/>pop\_pack\ ();}
\DoxyCodeLine{01430\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ c-\/>pop\_discard\ ();}
\DoxyCodeLine{01431\ \ \ \ \ \}}
\DoxyCodeLine{01432\ }
\DoxyCodeLine{01433\ \ \ \ \ \textcolor{keywordflow}{if}\ (*objidx\ ==\ 0)}
\DoxyCodeLine{01434\ \ \ \ \ \{}
\DoxyCodeLine{01435\ \ \ \ \ \ \ c-\/>revert\ (snap);}
\DoxyCodeLine{01436\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{nullptr});}
\DoxyCodeLine{01437\ \ \ \ \ \}}
\DoxyCodeLine{01438\ }
\DoxyCodeLine{01439\ \ \ \ \ c-\/>add\_link\ (out-\/>subtable,\ *objidx);}
\DoxyCodeLine{01440\ \ \ \ \ return\_trace\ (out);}
\DoxyCodeLine{01441\ \ \ \}}
\DoxyCodeLine{01442\ }
\DoxyCodeLine{01443\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ platformID;\ \textcolor{comment}{/*\ Platform\ ID.\ */}}
\DoxyCodeLine{01444\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ encodingID;\ \textcolor{comment}{/*\ Platform-\/specific\ encoding\ ID.\ */}}
\DoxyCodeLine{01445\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset32To<CmapSubtable>}}}
\DoxyCodeLine{01446\ \ \ \ \ \ \ \ \ subtable;\ \ \ \textcolor{comment}{/*\ Byte\ offset\ from\ beginning\ of\ table\ to\ the\ subtable\ for\ this\ encoding.\ */}}
\DoxyCodeLine{01447\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01448\ \ \ DEFINE\_SIZE\_STATIC\ (8);}
\DoxyCodeLine{01449\ \};}
\DoxyCodeLine{01450\ }
\DoxyCodeLine{01451\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1cmap}{cmap}}}
\DoxyCodeLine{01452\ \{}
\DoxyCodeLine{01453\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ hb\_tag\_t\ tableTag\ =\ HB\_OT\_TAG\_cmap;}
\DoxyCodeLine{01454\ }
\DoxyCodeLine{01455\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Iterator,\ \textcolor{keyword}{typename}\ EncodingRecIter,}
\DoxyCodeLine{01456\ \ \ \ \ \ \ \ hb\_requires\ (hb\_is\_iterator\ (EncodingRecIter))>}
\DoxyCodeLine{01457\ \ \ \textcolor{keywordtype}{bool}\ serialize\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{01458\ \ \ \ \ \ \ \ \ \ \ Iterator\ it,}
\DoxyCodeLine{01459\ \ \ \ \ \ \ \ \ \ \ EncodingRecIter\ encodingrec\_iter,}
\DoxyCodeLine{01460\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *base,}
\DoxyCodeLine{01461\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__subset__plan__t}{hb\_subset\_plan\_t}}\ *plan,}
\DoxyCodeLine{01462\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ drop\_format\_4\ =\ \textcolor{keyword}{false})}
\DoxyCodeLine{01463\ \ \ \{}
\DoxyCodeLine{01464\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>extend\_min\ ((*\textcolor{keyword}{this}))))\ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01465\ \ \ \ \ this-\/>version\ =\ 0;}
\DoxyCodeLine{01466\ }
\DoxyCodeLine{01467\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ format4objidx\ =\ 0,\ format12objidx\ =\ 0,\ format14objidx\ =\ 0;}
\DoxyCodeLine{01468\ \ \ \ \ \textcolor{keyword}{auto}\ snap\ =\ c-\/>snapshot\ ();}
\DoxyCodeLine{01469\ }
\DoxyCodeLine{01470\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_encoding_record}{EncodingRecord}}\&\ \_\ :\ encodingrec\_iter)}
\DoxyCodeLine{01471\ \ \ \ \ \{}
\DoxyCodeLine{01472\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (c-\/>in\_error\ ())}
\DoxyCodeLine{01473\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01474\ }
\DoxyCodeLine{01475\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ format\ =\ (base+\_.subtable).u.format;}
\DoxyCodeLine{01476\ \ \ \ \ \ \ if\ (format\ !=\ 4\ \&\&\ format\ !=\ 12\ \&\&\ format\ !=\ 14)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01477\ }
\DoxyCodeLine{01478\ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ unicodes\_set;}
\DoxyCodeLine{01479\ \ \ \ \ \ \ (base+\_.subtable).collect\_unicodes\ (\&unicodes\_set);}
\DoxyCodeLine{01480\ }
\DoxyCodeLine{01481\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!drop\_format\_4\ \&\&\ format\ ==\ 4)}
\DoxyCodeLine{01482\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01483\ \ \ \ \ \ \ \ \ c-\/>copy\ (\_,\ +\ it\ |\ hb\_filter\ (unicodes\_set,\ hb\_first),\ 4u,\ base,\ plan,\ \&format4objidx);}
\DoxyCodeLine{01484\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (c-\/>in\_error\ ()\ \&\&\ c-\/>only\_overflow\ ())}
\DoxyCodeLine{01485\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01486\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ cmap4\ overflowed,\ reset\ and\ retry\ serialization\ without\ format\ 4\ subtables.}}
\DoxyCodeLine{01487\ \ \ \ \ \ \ \ \ \ \ c-\/>revert\ (snap);}
\DoxyCodeLine{01488\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ serialize\ (c,\ it,}
\DoxyCodeLine{01489\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ encodingrec\_iter,}
\DoxyCodeLine{01490\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ base,}
\DoxyCodeLine{01491\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ plan,}
\DoxyCodeLine{01492\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{true});}
\DoxyCodeLine{01493\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01494\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01495\ }
\DoxyCodeLine{01496\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format\ ==\ 12)}
\DoxyCodeLine{01497\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01498\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_can\_drop\ (\_,\ unicodes\_set,\ base,\ +\ it\ |\ hb\_map\ (hb\_first),\ encodingrec\_iter))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01499\ \ \ \ \ \ \ \ \ c-\/>copy\ (\_,\ +\ it\ |\ hb\_filter\ (unicodes\_set,\ hb\_first),\ 12u,\ base,\ plan,\ \&format12objidx);}
\DoxyCodeLine{01500\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01501\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format\ ==\ 14)\ c-\/>copy\ (\_,\ it,\ 14u,\ base,\ plan,\ \&format14objidx);}
\DoxyCodeLine{01502\ \ \ \ \ \}}
\DoxyCodeLine{01503\ \ \ \ \ c-\/>check\_assign(this-\/>encodingRecord.len,}
\DoxyCodeLine{01504\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (c-\/>length\ ()\ -\/\ cmap::min\_size)/EncodingRecord::static\_size,}
\DoxyCodeLine{01505\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ HB\_SERIALIZE\_ERROR\_INT\_OVERFLOW);}
\DoxyCodeLine{01506\ }
\DoxyCodeLine{01507\ \ \ \ \ \textcolor{comment}{//\ Fail\ if\ format\ 4\ was\ dropped\ and\ there\ is\ no\ cmap12.}}
\DoxyCodeLine{01508\ \ \ \ \ \textcolor{keywordflow}{return}\ !drop\_format\_4\ ||\ format12objidx;}
\DoxyCodeLine{01509\ \ \ \}}
\DoxyCodeLine{01510\ }
\DoxyCodeLine{01511\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Iterator,\ \textcolor{keyword}{typename}\ EncodingRecordIterator,}
\DoxyCodeLine{01512\ \ \ \ \ \ \ hb\_requires\ (hb\_is\_iterator\ (Iterator)),}
\DoxyCodeLine{01513\ \ \ \ \ \ \ hb\_requires\ (hb\_is\_iterator\ (EncodingRecordIterator))>}
\DoxyCodeLine{01514\ \ \ \textcolor{keywordtype}{bool}\ \_can\_drop\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_encoding_record}{EncodingRecord}}\&\ cmap12,}
\DoxyCodeLine{01515\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\&\ cmap12\_unicodes,}
\DoxyCodeLine{01516\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ base,}
\DoxyCodeLine{01517\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Iterator\ subset\_unicodes,}
\DoxyCodeLine{01518\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ EncodingRecordIterator\ encoding\_records)}
\DoxyCodeLine{01519\ \ \ \{}
\DoxyCodeLine{01520\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ cp\ :\ +\ subset\_unicodes\ |\ hb\_filter\ (cmap12\_unicodes))}
\DoxyCodeLine{01521\ \ \ \ \ \{}
\DoxyCodeLine{01522\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (cp\ >=\ 0x10000)\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01523\ \ \ \ \ \}}
\DoxyCodeLine{01524\ }
\DoxyCodeLine{01525\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ target\_platform;}
\DoxyCodeLine{01526\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ target\_encoding;}
\DoxyCodeLine{01527\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ target\_language\ =\ (base+cmap12.subtable).get\_language\ ();}
\DoxyCodeLine{01528\ }
\DoxyCodeLine{01529\ \ \ \ \ \textcolor{keywordflow}{if}\ (cmap12.platformID\ ==\ 0\ \&\&\ cmap12.encodingID\ ==\ 4)}
\DoxyCodeLine{01530\ \ \ \ \ \{}
\DoxyCodeLine{01531\ \ \ \ \ \ \ target\_platform\ =\ 0;}
\DoxyCodeLine{01532\ \ \ \ \ \ \ target\_encoding\ =\ 3;}
\DoxyCodeLine{01533\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmap12.platformID\ ==\ 3\ \&\&\ cmap12.encodingID\ ==\ 10)\ \{}
\DoxyCodeLine{01534\ \ \ \ \ \ \ target\_platform\ =\ 3;}
\DoxyCodeLine{01535\ \ \ \ \ \ \ target\_encoding\ =\ 1;}
\DoxyCodeLine{01536\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01537\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01538\ \ \ \ \ \}}
\DoxyCodeLine{01539\ }
\DoxyCodeLine{01540\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \_\ :\ encoding\_records)}
\DoxyCodeLine{01541\ \ \ \ \ \{}
\DoxyCodeLine{01542\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_.platformID\ !=\ target\_platform}
\DoxyCodeLine{01543\ \ \ \ \ \ \ \ \ \ \ ||\ \_.encodingID\ !=\ target\_encoding}
\DoxyCodeLine{01544\ \ \ \ \ \ \ \ \ \ \ ||\ (base+\_.subtable).get\_language()\ !=\ target\_language)}
\DoxyCodeLine{01545\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01546\ }
\DoxyCodeLine{01547\ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ sibling\_unicodes;}
\DoxyCodeLine{01548\ \ \ \ \ \ \ (base+\_.subtable).collect\_unicodes\ (\&sibling\_unicodes);}
\DoxyCodeLine{01549\ }
\DoxyCodeLine{01550\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ cmap12\ =\ +\ subset\_unicodes\ |\ hb\_filter\ (cmap12\_unicodes);}
\DoxyCodeLine{01551\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ sibling\ =\ +\ subset\_unicodes\ |\ hb\_filter\ (sibling\_unicodes);}
\DoxyCodeLine{01552\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ cmap12\ \&\&\ sibling;\ cmap12++,\ sibling++)}
\DoxyCodeLine{01553\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01554\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{structa}{a}}\ =\ *cmap12;}
\DoxyCodeLine{01555\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ b\ =\ *sibling;}
\DoxyCodeLine{01556\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structa}{a}}\ !=\ b)\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01557\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01558\ }
\DoxyCodeLine{01559\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ !cmap12\ \&\&\ !sibling;}
\DoxyCodeLine{01560\ \ \ \ \ \}}
\DoxyCodeLine{01561\ }
\DoxyCodeLine{01562\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01563\ \ \ \}}
\DoxyCodeLine{01564\ }
\DoxyCodeLine{01565\ \ \ \textcolor{keywordtype}{void}\ closure\_glyphs\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \ \ \ \ \ *unicodes,}
\DoxyCodeLine{01566\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \ \ \ \ \ \ \ \ \ \ \ *glyphset)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01567\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01568\ \ \ \ \ +\ hb\_iter\ (encodingRecord)}
\DoxyCodeLine{01569\ \ \ \ \ |\ hb\_map\ (\&EncodingRecord::subtable)}
\DoxyCodeLine{01570\ \ \ \ \ |\ hb\_map\ (hb\_add\ (\textcolor{keyword}{this}))}
\DoxyCodeLine{01571\ \ \ \ \ |\ hb\_filter\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable}{CmapSubtable}}\&\ \_)\ \{\ \textcolor{keywordflow}{return}\ \_.u.format\ ==\ 14;\ \})}
\DoxyCodeLine{01572\ \ \ \ \ |\ hb\_apply\ ([=]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable}{CmapSubtable}}\&\ \_)\ \{\ \_.u.format14.closure\_glyphs\ (unicodes,\ glyphset);\ \})}
\DoxyCodeLine{01573\ \ \ \ \ ;}
\DoxyCodeLine{01574\ \ \ \}}
\DoxyCodeLine{01575\ }
\DoxyCodeLine{01576\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01577\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01578\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01579\ }
\DoxyCodeLine{01580\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1cmap}{cmap}}\ *cmap\_prime\ =\ c-\/>serializer-\/>start\_embed<\mbox{\hyperlink{struct_o_t_1_1cmap}{cmap}}>\ ();}
\DoxyCodeLine{01581\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>serializer-\/>check\_success\ (cmap\_prime)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01582\ }
\DoxyCodeLine{01583\ \ \ \ \ \textcolor{keyword}{auto}\ encodingrec\_iter\ =}
\DoxyCodeLine{01584\ \ \ \ \ +\ hb\_iter\ (encodingRecord)}
\DoxyCodeLine{01585\ \ \ \ \ |\ hb\_filter\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_encoding_record}{EncodingRecord}}\&\ \_)}
\DoxyCodeLine{01586\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01587\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\_.platformID\ ==\ 0\ \&\&\ \_.encodingID\ ==\ 3)\ ||}
\DoxyCodeLine{01588\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\_.platformID\ ==\ 0\ \&\&\ \_.encodingID\ ==\ 4)\ ||}
\DoxyCodeLine{01589\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\_.platformID\ ==\ 3\ \&\&\ \_.encodingID\ ==\ 1)\ ||}
\DoxyCodeLine{01590\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\_.platformID\ ==\ 3\ \&\&\ \_.encodingID\ ==\ 10)\ ||}
\DoxyCodeLine{01591\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keyword}{this}\ +\ \_.subtable).u.format\ ==\ 14)}
\DoxyCodeLine{01592\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01593\ }
\DoxyCodeLine{01594\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01595\ \ \ \ \ \ \ \ \ \})}
\DoxyCodeLine{01596\ \ \ \ \ ;}
\DoxyCodeLine{01597\ }
\DoxyCodeLine{01598\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!encodingrec\_iter.len\ ()))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01599\ }
\DoxyCodeLine{01600\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_encoding_record}{EncodingRecord}}\ *unicode\_bmp=\ \textcolor{keyword}{nullptr},\ *unicode\_ucs4\ =\ \textcolor{keyword}{nullptr},\ *ms\_bmp\ =\ \textcolor{keyword}{nullptr},\ *ms\_ucs4\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01601\ \ \ \ \ \textcolor{keywordtype}{bool}\ has\_format12\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01602\ }
\DoxyCodeLine{01603\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_encoding_record}{EncodingRecord}}\&\ \_\ :\ encodingrec\_iter)}
\DoxyCodeLine{01604\ \ \ \ \ \{}
\DoxyCodeLine{01605\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ format\ =\ (\textcolor{keyword}{this}\ +\ \_.subtable).u.format;}
\DoxyCodeLine{01606\ \ \ \ \ \ \ if\ (format\ ==\ 12)\ has\_format12\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01607\ }
\DoxyCodeLine{01608\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_encoding_record}{EncodingRecord}}\ *table\ =\ std::addressof\ (\_);}
\DoxyCodeLine{01609\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \ \ \ \ \ (\_.platformID\ ==\ 0\ \&\&\ \_.encodingID\ ==\ \ 3)\ unicode\_bmp\ =\ table;}
\DoxyCodeLine{01610\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_.platformID\ ==\ 0\ \&\&\ \_.encodingID\ ==\ \ 4)\ unicode\_ucs4\ =\ table;}
\DoxyCodeLine{01611\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_.platformID\ ==\ 3\ \&\&\ \_.encodingID\ ==\ \ 1)\ ms\_bmp\ =\ table;}
\DoxyCodeLine{01612\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_.platformID\ ==\ 3\ \&\&\ \_.encodingID\ ==\ 10)\ ms\_ucs4\ =\ table;}
\DoxyCodeLine{01613\ \ \ \ \ \}}
\DoxyCodeLine{01614\ }
\DoxyCodeLine{01615\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!has\_format12\ \&\&\ !unicode\_bmp\ \&\&\ !ms\_bmp))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01616\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (has\_format12\ \&\&\ (!unicode\_ucs4\ \&\&\ !ms\_ucs4)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01617\ }
\DoxyCodeLine{01618\ \ \ \ \ \textcolor{keyword}{auto}\ it\ =}
\DoxyCodeLine{01619\ \ \ \ \ +\ hb\_iter\ (c-\/>plan-\/>unicodes)}
\DoxyCodeLine{01620\ \ \ \ \ |\ hb\_map\ ([\&]\ (hb\_codepoint\_t\ \_)}
\DoxyCodeLine{01621\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01622\ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ new\_gid\ =\ HB\_MAP\_VALUE\_INVALID;}
\DoxyCodeLine{01623\ \ \ \ \ \ \ \ \ c-\/>plan-\/>new\_gid\_for\_codepoint\ (\_,\ \&new\_gid);}
\DoxyCodeLine{01624\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structhb__pair__t}{hb\_pair\_t<hb\_codepoint\_t,\ hb\_codepoint\_t>}}\ (\_,\ new\_gid);}
\DoxyCodeLine{01625\ \ \ \ \ \ \ \ \ \ \ \})}
\DoxyCodeLine{01626\ \ \ \ \ |\ hb\_filter\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__pair__t}{hb\_pair\_t<hb\_codepoint\_t,\ hb\_codepoint\_t>}}\ \_)}
\DoxyCodeLine{01627\ \ \ \ \ \ \ \ \ \ \{\ \textcolor{keywordflow}{return}\ (\_.second\ !=\ HB\_MAP\_VALUE\_INVALID);\ \})}
\DoxyCodeLine{01628\ \ \ \ \ ;}
\DoxyCodeLine{01629\ }
\DoxyCodeLine{01630\ \ \ \ \ return\_trace\ (cmap\_prime-\/>serialize\ (c-\/>serializer,\ it,\ encodingrec\_iter,\ \textcolor{keyword}{this},\ c-\/>plan));}
\DoxyCodeLine{01631\ \ \ \}}
\DoxyCodeLine{01632\ }
\DoxyCodeLine{01633\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable}{CmapSubtable}}\ *find\_best\_subtable\ (\textcolor{keywordtype}{bool}\ *symbol\ =\ \textcolor{keyword}{nullptr})\textcolor{keyword}{\ const}}
\DoxyCodeLine{01634\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01635\ \ \ \ \ \textcolor{keywordflow}{if}\ (symbol)\ *symbol\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01636\ }
\DoxyCodeLine{01637\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable}{CmapSubtable}}\ *subtable;}
\DoxyCodeLine{01638\ }
\DoxyCodeLine{01639\ \ \ \ \ \textcolor{comment}{/*\ Symbol\ subtable.}}
\DoxyCodeLine{01640\ \textcolor{comment}{\ \ \ \ \ *\ Prefer\ symbol\ if\ available.}}
\DoxyCodeLine{01641\ \textcolor{comment}{\ \ \ \ \ *\ https://github.com/harfbuzz/harfbuzz/issues/1918\ */}}
\DoxyCodeLine{01642\ \ \ \ \ \textcolor{keywordflow}{if}\ ((subtable\ =\ this-\/>find\_subtable\ (3,\ 0)))}
\DoxyCodeLine{01643\ \ \ \ \ \{}
\DoxyCodeLine{01644\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (symbol)\ *symbol\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01645\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ subtable;}
\DoxyCodeLine{01646\ \ \ \ \ \}}
\DoxyCodeLine{01647\ }
\DoxyCodeLine{01648\ \ \ \ \ \textcolor{comment}{/*\ 32-\/bit\ subtables.\ */}}
\DoxyCodeLine{01649\ \ \ \ \ \textcolor{keywordflow}{if}\ ((subtable\ =\ this-\/>find\_subtable\ (3,\ 10)))\ \textcolor{keywordflow}{return}\ subtable;}
\DoxyCodeLine{01650\ \ \ \ \ \textcolor{keywordflow}{if}\ ((subtable\ =\ this-\/>find\_subtable\ (0,\ 6)))\ \textcolor{keywordflow}{return}\ subtable;}
\DoxyCodeLine{01651\ \ \ \ \ \textcolor{keywordflow}{if}\ ((subtable\ =\ this-\/>find\_subtable\ (0,\ 4)))\ \textcolor{keywordflow}{return}\ subtable;}
\DoxyCodeLine{01652\ }
\DoxyCodeLine{01653\ \ \ \ \ \textcolor{comment}{/*\ 16-\/bit\ subtables.\ */}}
\DoxyCodeLine{01654\ \ \ \ \ \textcolor{keywordflow}{if}\ ((subtable\ =\ this-\/>find\_subtable\ (3,\ 1)))\ \textcolor{keywordflow}{return}\ subtable;}
\DoxyCodeLine{01655\ \ \ \ \ \textcolor{keywordflow}{if}\ ((subtable\ =\ this-\/>find\_subtable\ (0,\ 3)))\ \textcolor{keywordflow}{return}\ subtable;}
\DoxyCodeLine{01656\ \ \ \ \ \textcolor{keywordflow}{if}\ ((subtable\ =\ this-\/>find\_subtable\ (0,\ 2)))\ \textcolor{keywordflow}{return}\ subtable;}
\DoxyCodeLine{01657\ \ \ \ \ \textcolor{keywordflow}{if}\ ((subtable\ =\ this-\/>find\_subtable\ (0,\ 1)))\ \textcolor{keywordflow}{return}\ subtable;}
\DoxyCodeLine{01658\ \ \ \ \ \textcolor{keywordflow}{if}\ ((subtable\ =\ this-\/>find\_subtable\ (0,\ 0)))\ \textcolor{keywordflow}{return}\ subtable;}
\DoxyCodeLine{01659\ }
\DoxyCodeLine{01660\ \ \ \ \ \textcolor{comment}{/*\ Meh.\ */}}
\DoxyCodeLine{01661\ \ \ \ \ \textcolor{keywordflow}{return}\ \&\mbox{\hyperlink{struct_null}{Null}}\ (\mbox{\hyperlink{struct_o_t_1_1_cmap_subtable}{CmapSubtable}});}
\DoxyCodeLine{01662\ \ \ \}}
\DoxyCodeLine{01663\ }
\DoxyCodeLine{01664\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1cmap_1_1accelerator__t}{accelerator\_t}}}
\DoxyCodeLine{01665\ \ \ \{}
\DoxyCodeLine{01666\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1cmap_1_1accelerator__t}{accelerator\_t}}\ (\mbox{\hyperlink{structhb__face__t}{hb\_face\_t}}\ *face)}
\DoxyCodeLine{01667\ \ \ \ \ \{}
\DoxyCodeLine{01668\ \ \ \ \ \ \ this-\/>table\ =\ \mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ ().reference\_table<\mbox{\hyperlink{struct_o_t_1_1cmap}{cmap}}>\ (face);}
\DoxyCodeLine{01669\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ symbol;}
\DoxyCodeLine{01670\ \ \ \ \ \ \ this-\/>subtable\ =\ table-\/>find\_best\_subtable\ (\&symbol);}
\DoxyCodeLine{01671\ \ \ \ \ \ \ this-\/>subtable\_uvs\ =\ \&\mbox{\hyperlink{struct_null}{Null}}\ (\mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_format14}{CmapSubtableFormat14}});}
\DoxyCodeLine{01672\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01673\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable}{CmapSubtable}}\ *st\ =\ table-\/>find\_subtable\ (0,\ 5);}
\DoxyCodeLine{01674\ \ \ \ \ \textcolor{keywordflow}{if}\ (st\ \&\&\ st-\/>u.format\ ==\ 14)}
\DoxyCodeLine{01675\ \ \ \ \ \ \ subtable\_uvs\ =\ \&st-\/>u.format14;}
\DoxyCodeLine{01676\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01677\ }
\DoxyCodeLine{01678\ \ \ \ \ \ \ this-\/>get\_glyph\_data\ =\ subtable;}
\DoxyCodeLine{01679\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (symbol))}
\DoxyCodeLine{01680\ \ \ \ \ this-\/>get\_glyph\_funcZ\ =\ get\_glyph\_from\_symbol<CmapSubtable>;}
\DoxyCodeLine{01681\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01682\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01683\ \ \ \ \ \textcolor{keywordflow}{switch}\ (subtable-\/>u.format)\ \{}
\DoxyCodeLine{01684\ \ \ \ \ \textcolor{comment}{/*\ Accelerate\ format\ 4\ and\ format\ 12.\ */}}
\DoxyCodeLine{01685\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01686\ \ \ \ \ \ \ this-\/>get\_glyph\_funcZ\ =\ get\_glyph\_from<CmapSubtable>;}
\DoxyCodeLine{01687\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01688\ \ \ \ \ \textcolor{keywordflow}{case}\ 12:}
\DoxyCodeLine{01689\ \ \ \ \ \ \ this-\/>get\_glyph\_funcZ\ =\ get\_glyph\_from<CmapSubtableFormat12>;}
\DoxyCodeLine{01690\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01691\ \ \ \ \ \textcolor{keywordflow}{case}\ \ 4:}
\DoxyCodeLine{01692\ \ \ \ \ \{}
\DoxyCodeLine{01693\ \ \ \ \ \ \ this-\/>format4\_accel.init\ (\&subtable-\/>u.format4);}
\DoxyCodeLine{01694\ \ \ \ \ \ \ this-\/>get\_glyph\_data\ =\ \&this-\/>format4\_accel;}
\DoxyCodeLine{01695\ \ \ \ \ \ \ this-\/>get\_glyph\_funcZ\ =\ this-\/>format4\_accel.get\_glyph\_func;}
\DoxyCodeLine{01696\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01697\ \ \ \ \ \}}
\DoxyCodeLine{01698\ \ \ \ \ \}}
\DoxyCodeLine{01699\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01700\ \ \ \ \ \}}
\DoxyCodeLine{01701\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1cmap_1_1accelerator__t}{\string~accelerator\_t}}\ ()\ \{\ this-\/>table.destroy\ ();\ \}}
\DoxyCodeLine{01702\ }
\DoxyCodeLine{01703\ \ \ \ \ \textcolor{keywordtype}{bool}\ get\_nominal\_glyph\ (hb\_codepoint\_t\ \ unicode,}
\DoxyCodeLine{01704\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ *glyph)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01705\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{01706\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!this-\/>get\_glyph\_funcZ))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01707\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>get\_glyph\_funcZ\ (this-\/>get\_glyph\_data,\ unicode,\ glyph);}
\DoxyCodeLine{01708\ \ \ \ \ \}}
\DoxyCodeLine{01709\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_nominal\_glyphs\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count,}
\DoxyCodeLine{01710\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ hb\_codepoint\_t\ *first\_unicode,}
\DoxyCodeLine{01711\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ unicode\_stride,}
\DoxyCodeLine{01712\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ *first\_glyph,}
\DoxyCodeLine{01713\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ glyph\_stride)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01714\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{01715\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!this-\/>get\_glyph\_funcZ))\ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01716\ }
\DoxyCodeLine{01717\ \ \ \ \ \ \ hb\_cmap\_get\_glyph\_func\_t\ get\_glyph\_funcZ\ =\ this-\/>get\_glyph\_funcZ;}
\DoxyCodeLine{01718\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *get\_glyph\_data\ =\ this-\/>get\_glyph\_data;}
\DoxyCodeLine{01719\ }
\DoxyCodeLine{01720\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ done;}
\DoxyCodeLine{01721\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (done\ =\ 0;}
\DoxyCodeLine{01722\ \ \ \ \ \ \ \ done\ <\ count\ \&\&\ get\_glyph\_funcZ\ (get\_glyph\_data,\ *first\_unicode,\ first\_glyph);}
\DoxyCodeLine{01723\ \ \ \ \ \ \ \ done++)}
\DoxyCodeLine{01724\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01725\ \ \ \ \ first\_unicode\ =\ \&StructAtOffsetUnaligned<hb\_codepoint\_t>\ (first\_unicode,\ unicode\_stride);}
\DoxyCodeLine{01726\ \ \ \ \ first\_glyph\ =\ \&StructAtOffsetUnaligned<hb\_codepoint\_t>\ (first\_glyph,\ glyph\_stride);}
\DoxyCodeLine{01727\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01728\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ done;}
\DoxyCodeLine{01729\ \ \ \ \ \}}
\DoxyCodeLine{01730\ }
\DoxyCodeLine{01731\ \ \ \ \ \textcolor{keywordtype}{bool}\ get\_variation\_glyph\ (hb\_codepoint\_t\ \ unicode,}
\DoxyCodeLine{01732\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ \ variation\_selector,}
\DoxyCodeLine{01733\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ *glyph)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01734\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{01735\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (this-\/>subtable\_uvs-\/>get\_glyph\_variant\ (unicode,}
\DoxyCodeLine{01736\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ variation\_selector,}
\DoxyCodeLine{01737\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ glyph))}
\DoxyCodeLine{01738\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01739\ \ \ \ \ \textcolor{keywordflow}{case}\ GLYPH\_VARIANT\_NOT\_FOUND:\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01740\ \ \ \ \ \textcolor{keywordflow}{case}\ GLYPH\_VARIANT\_FOUND:\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01741\ \ \ \ \ \textcolor{keywordflow}{case}\ GLYPH\_VARIANT\_USE\_DEFAULT:\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01742\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01743\ }
\DoxyCodeLine{01744\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ get\_nominal\_glyph\ (unicode,\ glyph);}
\DoxyCodeLine{01745\ \ \ \ \ \}}
\DoxyCodeLine{01746\ }
\DoxyCodeLine{01747\ \ \ \ \ \textcolor{keywordtype}{void}\ collect\_unicodes\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *out,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ num\_glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01748\ \textcolor{keyword}{\ \ \ \ }\{\ subtable-\/>collect\_unicodes\ (out,\ num\_glyphs);\ \}}
\DoxyCodeLine{01749\ \ \ \ \ \textcolor{keywordtype}{void}\ collect\_mapping\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *unicodes,\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *mapping,}
\DoxyCodeLine{01750\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ num\_glyphs\ =\ UINT\_MAX)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01751\ \textcolor{keyword}{\ \ \ \ }\{\ subtable-\/>collect\_mapping\ (unicodes,\ mapping,\ num\_glyphs);\ \}}
\DoxyCodeLine{01752\ \ \ \ \ \textcolor{keywordtype}{void}\ collect\_variation\_selectors\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *out)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01753\ \textcolor{keyword}{\ \ \ \ }\{\ subtable\_uvs-\/>collect\_variation\_selectors\ (out);\ \}}
\DoxyCodeLine{01754\ \ \ \ \ \textcolor{keywordtype}{void}\ collect\_variation\_unicodes\ (hb\_codepoint\_t\ variation\_selector,}
\DoxyCodeLine{01755\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *out)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01756\ \textcolor{keyword}{\ \ \ \ }\{\ subtable\_uvs-\/>collect\_variation\_unicodes\ (variation\_selector,\ out);\ \}}
\DoxyCodeLine{01757\ }
\DoxyCodeLine{01758\ \ \ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{01759\ \ \ \ \ \textcolor{keyword}{typedef}\ bool\ (*hb\_cmap\_get\_glyph\_func\_t)\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *obj,}
\DoxyCodeLine{01760\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ codepoint,}
\DoxyCodeLine{01761\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ *glyph);}
\DoxyCodeLine{01762\ }
\DoxyCodeLine{01763\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Type>}
\DoxyCodeLine{01764\ \ \ \ \ HB\_INTERNAL\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ get\_glyph\_from\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *obj,}
\DoxyCodeLine{01765\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ codepoint,}
\DoxyCodeLine{01766\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ *glyph)}
\DoxyCodeLine{01767\ \ \ \ \ \{}
\DoxyCodeLine{01768\ \ \ \ \ \ \ \textcolor{keyword}{const}\ Type\ *typed\_obj\ =\ (\textcolor{keyword}{const}\ Type\ *)\ obj;}
\DoxyCodeLine{01769\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ typed\_obj-\/>get\_glyph\ (codepoint,\ glyph);}
\DoxyCodeLine{01770\ \ \ \ \ \}}
\DoxyCodeLine{01771\ }
\DoxyCodeLine{01772\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Type>}
\DoxyCodeLine{01773\ \ \ \ \ HB\_INTERNAL\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ get\_glyph\_from\_symbol\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *obj,}
\DoxyCodeLine{01774\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ codepoint,}
\DoxyCodeLine{01775\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ *glyph)}
\DoxyCodeLine{01776\ \ \ \ \ \{}
\DoxyCodeLine{01777\ \ \ \ \ \ \ \textcolor{keyword}{const}\ Type\ *typed\_obj\ =\ (\textcolor{keyword}{const}\ Type\ *)\ obj;}
\DoxyCodeLine{01778\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (likely\ (typed\_obj-\/>get\_glyph\ (codepoint,\ glyph)))}
\DoxyCodeLine{01779\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01780\ }
\DoxyCodeLine{01781\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (codepoint\ <=\ 0x00FFu)}
\DoxyCodeLine{01782\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01783\ \ \ \ \ \textcolor{comment}{/*\ For\ symbol-\/encoded\ OpenType\ fonts,\ we\ duplicate\ the}}
\DoxyCodeLine{01784\ \textcolor{comment}{\ \ \ \ \ *\ U+F000..F0FF\ range\ at\ U+0000..U+00FF.\ \ That's\ what}}
\DoxyCodeLine{01785\ \textcolor{comment}{\ \ \ \ \ *\ Windows\ seems\ to\ do,\ and\ that's\ hinted\ about\ at:}}
\DoxyCodeLine{01786\ \textcolor{comment}{\ \ \ \ \ *\ https://docs.microsoft.com/en-\/us/typography/opentype/spec/recom}}
\DoxyCodeLine{01787\ \textcolor{comment}{\ \ \ \ \ *\ under\ "{}Non-\/Standard\ (Symbol)\ Fonts"{}.\ */}}
\DoxyCodeLine{01788\ \ \ \ \ \textcolor{keywordflow}{return}\ typed\_obj-\/>get\_glyph\ (0xF000u\ +\ codepoint,\ glyph);}
\DoxyCodeLine{01789\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01790\ }
\DoxyCodeLine{01791\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01792\ \ \ \ \ \}}
\DoxyCodeLine{01793\ }
\DoxyCodeLine{01794\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{01795\ \ \ \ \ \mbox{\hyperlink{structhb__nonnull__ptr__t}{hb\_nonnull\_ptr\_t<const\ CmapSubtable>}}\ subtable;}
\DoxyCodeLine{01796\ \ \ \ \ \mbox{\hyperlink{structhb__nonnull__ptr__t}{hb\_nonnull\_ptr\_t<const\ CmapSubtableFormat14>}}\ subtable\_uvs;}
\DoxyCodeLine{01797\ }
\DoxyCodeLine{01798\ \ \ \ \ hb\_cmap\_get\_glyph\_func\_t\ get\_glyph\_funcZ;}
\DoxyCodeLine{01799\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *get\_glyph\_data;}
\DoxyCodeLine{01800\ }
\DoxyCodeLine{01801\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable_format4_1_1accelerator__t}{CmapSubtableFormat4::accelerator\_t}}\ format4\_accel;}
\DoxyCodeLine{01802\ }
\DoxyCodeLine{01803\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01804\ \ \ \ \ \mbox{\hyperlink{structhb__blob__ptr__t}{hb\_blob\_ptr\_t<cmap>}}\ table;}
\DoxyCodeLine{01805\ \ \ \};}
\DoxyCodeLine{01806\ }
\DoxyCodeLine{01807\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{01808\ }
\DoxyCodeLine{01809\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_cmap_subtable}{CmapSubtable}}\ *find\_subtable\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ platform\_id,}
\DoxyCodeLine{01810\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ encoding\_id)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01811\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01812\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_encoding_record}{EncodingRecord}}\ key;}
\DoxyCodeLine{01813\ \ \ \ \ key.platformID\ =\ platform\_id;}
\DoxyCodeLine{01814\ \ \ \ \ key.encodingID\ =\ encoding\_id;}
\DoxyCodeLine{01815\ }
\DoxyCodeLine{01816\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_encoding_record}{EncodingRecord}}\ \&result\ =\ encodingRecord.bsearch\ (key);}
\DoxyCodeLine{01817\ \ \ \ \ \textcolor{keywordflow}{if}\ (!result.subtable)}
\DoxyCodeLine{01818\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01819\ }
\DoxyCodeLine{01820\ \ \ \ \ \textcolor{keywordflow}{return}\ \&(\textcolor{keyword}{this}+result.subtable);}
\DoxyCodeLine{01821\ \ \ \}}
\DoxyCodeLine{01822\ }
\DoxyCodeLine{01823\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_encoding_record}{EncodingRecord}}\ *find\_encodingrec\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ platform\_id,}
\DoxyCodeLine{01824\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ encoding\_id)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01825\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01826\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_encoding_record}{EncodingRecord}}\ key;}
\DoxyCodeLine{01827\ \ \ \ \ key.platformID\ =\ platform\_id;}
\DoxyCodeLine{01828\ \ \ \ \ key.encodingID\ =\ encoding\_id;}
\DoxyCodeLine{01829\ }
\DoxyCodeLine{01830\ \ \ \ \ \textcolor{keywordflow}{return}\ encodingRecord.as\_array\ ().bsearch\ (key);}
\DoxyCodeLine{01831\ \ \ \}}
\DoxyCodeLine{01832\ }
\DoxyCodeLine{01833\ \ \ \textcolor{keywordtype}{bool}\ find\_subtable\ (\textcolor{keywordtype}{unsigned}\ format)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01834\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01835\ \ \ \ \ \textcolor{keyword}{auto}\ it\ =}
\DoxyCodeLine{01836\ \ \ \ \ +\ hb\_iter\ (encodingRecord)}
\DoxyCodeLine{01837\ \ \ \ \ |\ hb\_map\ (\&EncodingRecord::subtable)}
\DoxyCodeLine{01838\ \ \ \ \ |\ hb\_map\ (hb\_add\ (\textcolor{keyword}{this}))}
\DoxyCodeLine{01839\ \ \ \ \ |\ hb\_filter\ ([\&]\ (\textcolor{keyword}{const}\ CmapSubtable\&\ \_)\ \{\ \textcolor{keywordflow}{return}\ \_.u.format\ ==\ format;\ \})}
\DoxyCodeLine{01840\ \ \ \ \ ;}
\DoxyCodeLine{01841\ }
\DoxyCodeLine{01842\ \ \ \ \ \textcolor{keywordflow}{return}\ it.len\ ();}
\DoxyCodeLine{01843\ \ \ \}}
\DoxyCodeLine{01844\ }
\DoxyCodeLine{01845\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01846\ }
\DoxyCodeLine{01847\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01848\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01849\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01850\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this})\ \&\&}
\DoxyCodeLine{01851\ \ \ \ \ \ \ \ \ \ \ likely\ (version\ ==\ 0)\ \&\&}
\DoxyCodeLine{01852\ \ \ \ \ \ \ \ \ \ \ encodingRecord.sanitize\ (c,\ \textcolor{keyword}{this}));}
\DoxyCodeLine{01853\ \ \ \}}
\DoxyCodeLine{01854\ }
\DoxyCodeLine{01855\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{01856\ \ \ HBUINT16\ \ version;\ \ \ \ \textcolor{comment}{/*\ Table\ version\ number\ (0).\ */}}
\DoxyCodeLine{01857\ \ \ SortedArray16Of<EncodingRecord>}
\DoxyCodeLine{01858\ \ \ \ \ \ \ \ \ encodingRecord;\ \textcolor{comment}{/*\ Encoding\ tables.\ */}}
\DoxyCodeLine{01859\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01860\ \ \ DEFINE\_SIZE\_ARRAY\ (4,\ encodingRecord);}
\DoxyCodeLine{01861\ \};}
\DoxyCodeLine{01862\ }
\DoxyCodeLine{01863\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1cmap__accelerator__t}{cmap\_accelerator\_t}}\ :\ \mbox{\hyperlink{struct_o_t_1_1cmap_1_1accelerator__t}{cmap::accelerator\_t}}\ \{}
\DoxyCodeLine{01864\ \ \ \mbox{\hyperlink{struct_o_t_1_1cmap__accelerator__t}{cmap\_accelerator\_t}}\ (\mbox{\hyperlink{structhb__face__t}{hb\_face\_t}}\ *face)\ :\ \mbox{\hyperlink{struct_o_t_1_1cmap_1_1accelerator__t}{cmap::accelerator\_t}}\ (face)\ \{\}}
\DoxyCodeLine{01865\ \};}
\DoxyCodeLine{01866\ }
\DoxyCodeLine{01867\ \}\ \textcolor{comment}{/*\ namespace\ OT\ */}}
\DoxyCodeLine{01868\ }
\DoxyCodeLine{01869\ }
\DoxyCodeLine{01870\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*\ HB\_OT\_CMAP\_TABLE\_HH\ */}\textcolor{preprocessor}{}}

\end{DoxyCode}

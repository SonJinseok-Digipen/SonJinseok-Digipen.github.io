\hypertarget{hb-ot-var-gvar-table_8hh_source}{}\doxysection{hb-\/ot-\/var-\/gvar-\/table.hh}
\label{hb-ot-var-gvar-table_8hh_source}\index{AseSprite/aseprite/third\_party/harfbuzz/src/hb-\/ot-\/var-\/gvar-\/table.hh@{AseSprite/aseprite/third\_party/harfbuzz/src/hb-\/ot-\/var-\/gvar-\/table.hh}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ *\ Copyright\ ©\ 2019\ \ Adobe\ Inc.}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ *\ Copyright\ ©\ 2019\ \ Ebrahim\ Byagowi}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ *\ \ This\ is\ part\ of\ HarfBuzz,\ a\ text\ shaping\ library.}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00007\ \textcolor{comment}{\ *\ Permission\ is\ hereby\ granted,\ without\ written\ agreement\ and\ without}}
\DoxyCodeLine{00008\ \textcolor{comment}{\ *\ license\ or\ royalty\ fees,\ to\ use,\ copy,\ modify,\ and\ distribute\ this}}
\DoxyCodeLine{00009\ \textcolor{comment}{\ *\ software\ and\ its\ documentation\ for\ any\ purpose,\ provided\ that\ the}}
\DoxyCodeLine{00010\ \textcolor{comment}{\ *\ above\ copyright\ notice\ and\ the\ following\ two\ paragraphs\ appear\ in}}
\DoxyCodeLine{00011\ \textcolor{comment}{\ *\ all\ copies\ of\ this\ software.}}
\DoxyCodeLine{00012\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00013\ \textcolor{comment}{\ *\ IN\ NO\ EVENT\ SHALL\ THE\ COPYRIGHT\ HOLDER\ BE\ LIABLE\ TO\ ANY\ PARTY\ FOR}}
\DoxyCodeLine{00014\ \textcolor{comment}{\ *\ DIRECT,\ INDIRECT,\ SPECIAL,\ INCIDENTAL,\ OR\ CONSEQUENTIAL\ DAMAGES}}
\DoxyCodeLine{00015\ \textcolor{comment}{\ *\ ARISING\ OUT\ OF\ THE\ USE\ OF\ THIS\ SOFTWARE\ AND\ ITS\ DOCUMENTATION,\ EVEN}}
\DoxyCodeLine{00016\ \textcolor{comment}{\ *\ IF\ THE\ COPYRIGHT\ HOLDER\ HAS\ BEEN\ ADVISED\ OF\ THE\ POSSIBILITY\ OF\ SUCH}}
\DoxyCodeLine{00017\ \textcolor{comment}{\ *\ DAMAGE.}}
\DoxyCodeLine{00018\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00019\ \textcolor{comment}{\ *\ THE\ COPYRIGHT\ HOLDER\ SPECIFICALLY\ DISCLAIMS\ ANY\ WARRANTIES,\ INCLUDING,}}
\DoxyCodeLine{00020\ \textcolor{comment}{\ *\ BUT\ NOT\ LIMITED\ TO,\ THE\ IMPLIED\ WARRANTIES\ OF\ MERCHANTABILITY\ AND}}
\DoxyCodeLine{00021\ \textcolor{comment}{\ *\ FITNESS\ FOR\ A\ PARTICULAR\ PURPOSE.\ \ THE\ SOFTWARE\ PROVIDED\ HEREUNDER\ IS}}
\DoxyCodeLine{00022\ \textcolor{comment}{\ *\ ON\ AN\ "{}AS\ IS"{}\ BASIS,\ AND\ THE\ COPYRIGHT\ HOLDER\ HAS\ NO\ OBLIGATION\ TO}}
\DoxyCodeLine{00023\ \textcolor{comment}{\ *\ PROVIDE\ MAINTENANCE,\ SUPPORT,\ UPDATES,\ ENHANCEMENTS,\ OR\ MODIFICATIONS.}}
\DoxyCodeLine{00024\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00025\ \textcolor{comment}{\ *\ Adobe\ Author(s):\ Michiharu\ Ariza}}
\DoxyCodeLine{00026\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#ifndef\ HB\_OT\_VAR\_GVAR\_TABLE\_HH}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#define\ HB\_OT\_VAR\_GVAR\_TABLE\_HH}}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#include\ "{}hb-\/open-\/type.hh"{}}}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \textcolor{comment}{/*}}
\DoxyCodeLine{00034\ \textcolor{comment}{\ *\ gvar\ -\/-\/\ Glyph\ Variation\ Table}}
\DoxyCodeLine{00035\ \textcolor{comment}{\ *\ https://docs.microsoft.com/en-\/us/typography/opentype/spec/gvar}}
\DoxyCodeLine{00036\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\#define\ HB\_OT\_TAG\_gvar\ HB\_TAG('g','v','a','r')}}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \textcolor{keyword}{namespace\ }OT\ \{}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1contour__point__t}{contour\_point\_t}}}
\DoxyCodeLine{00042\ \{}
\DoxyCodeLine{00043\ \ \ \textcolor{keywordtype}{void}\ init\ (\textcolor{keywordtype}{float}\ x\_\ =\ 0.f,\ \textcolor{keywordtype}{float}\ y\_\ =\ 0.f,\ \textcolor{keywordtype}{bool}\ is\_end\_point\_\ =\ \textcolor{keyword}{false})}
\DoxyCodeLine{00044\ \ \ \{\ flag\ =\ 0;\ x\ =\ x\_;\ y\ =\ y\_;\ is\_end\_point\ =\ is\_end\_point\_;\ \}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ \textcolor{keywordtype}{void}\ translate\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1contour__point__t}{contour\_point\_t}}\ \&p)\ \{\ x\ +=\ p.x;\ y\ +=\ p.y;\ \}}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ uint8\_t\ flag;}
\DoxyCodeLine{00049\ \ \ \textcolor{keywordtype}{float}\ x,\ y;}
\DoxyCodeLine{00050\ \ \ \textcolor{keywordtype}{bool}\ is\_end\_point;}
\DoxyCodeLine{00051\ \};}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1contour__point__vector__t}{contour\_point\_vector\_t}}\ :\ \mbox{\hyperlink{structhb__vector__t}{hb\_vector\_t}}<contour\_point\_t>}
\DoxyCodeLine{00054\ \{}
\DoxyCodeLine{00055\ \ \ \textcolor{keywordtype}{void}\ extend\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__array__t}{hb\_array\_t<contour\_point\_t>}}\ \&\mbox{\hyperlink{structa}{a}})}
\DoxyCodeLine{00056\ \ \ \{}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ old\_len\ =\ length;}
\DoxyCodeLine{00058\ \ \ \ \ resize\ (old\_len\ +\ \mbox{\hyperlink{structa}{a}}.length);}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{structa}{a}}.length;\ i++)}
\DoxyCodeLine{00060\ \ \ \ \ \ \ (*\textcolor{keyword}{this})[old\_len\ +\ i]\ =\ \mbox{\hyperlink{structa}{a}}[i];}
\DoxyCodeLine{00061\ \ \ \}}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \ \ \textcolor{keywordtype}{void}\ transform\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{float}\ (\&matrix)[4])}
\DoxyCodeLine{00064\ \ \ \{}
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ length;\ i++)}
\DoxyCodeLine{00066\ \ \ \ \ \{}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1contour__point__t}{contour\_point\_t}}\ \&p\ =\ (*this)[i];}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ x\_\ =\ p.x\ *\ matrix[0]\ +\ p.y\ *\ matrix[2];}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ p.y\ =\ p.x\ *\ matrix[1]\ +\ p.y\ *\ matrix[3];}
\DoxyCodeLine{00070\ \ \ \ \ \ \ p.x\ =\ x\_;}
\DoxyCodeLine{00071\ \ \ \ \ \}}
\DoxyCodeLine{00072\ \ \ \}}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \ \ \textcolor{keywordtype}{void}\ translate\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1contour__point__t}{contour\_point\_t}}\&\ delta)}
\DoxyCodeLine{00075\ \ \ \{}
\DoxyCodeLine{00076\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ length;\ i++)}
\DoxyCodeLine{00077\ \ \ \ \ \ \ (*\textcolor{keyword}{this})[i].translate\ (delta);}
\DoxyCodeLine{00078\ \ \ \}}
\DoxyCodeLine{00079\ \};}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ \textcolor{comment}{/*\ https://docs.microsoft.com/en-\/us/typography/opentype/spec/otvarcommonformats\#tuplevariationheader\ */}}
\DoxyCodeLine{00082\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_tuple_variation_header}{TupleVariationHeader}}}
\DoxyCodeLine{00083\ \{}
\DoxyCodeLine{00084\ \ \ \textcolor{keywordtype}{unsigned}\ get\_size\ (\textcolor{keywordtype}{unsigned}\ axis\_count)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00085\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ min\_size\ +\ get\_all\_tuples\ (axis\_count).get\_size\ ();\ \}}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \textcolor{keywordtype}{unsigned}\ get\_data\_size\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ varDataSize;\ \}}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_tuple_variation_header}{TupleVariationHeader}}\ \&get\_next\ (\textcolor{keywordtype}{unsigned}\ axis\_count)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00090\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ StructAtOffset<TupleVariationHeader>\ (\textcolor{keyword}{this},\ get\_size\ (axis\_count));\ \}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \ \ \textcolor{keywordtype}{float}\ calculate\_scalar\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ *coords,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ coord\_count,}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__array__t}{hb\_array\_t<const\ F2DOT14>}}\ shared\_tuples)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00094\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00095\ \ \ \ \ \mbox{\hyperlink{structhb__array__t}{hb\_array\_t<const\ F2DOT14>}}\ peak\_tuple;}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_peak\ ())}
\DoxyCodeLine{00098\ \ \ \ \ \ \ peak\_tuple\ =\ get\_peak\_tuple\ (coord\_count);}
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00100\ \ \ \ \ \{}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ index\ =\ get\_index\ ();}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (index\ *\ coord\_count\ >=\ shared\_tuples.length))}
\DoxyCodeLine{00103\ \ \ \ \ \textcolor{keywordflow}{return}\ 0.f;}
\DoxyCodeLine{00104\ \ \ \ \ \ \ peak\_tuple\ =\ shared\_tuples.sub\_array\ (coord\_count\ *\ index,\ coord\_count);}
\DoxyCodeLine{00105\ \ \ \ \ \}}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \ \ \ \ \mbox{\hyperlink{structhb__array__t}{hb\_array\_t<const\ F2DOT14>}}\ start\_tuple;}
\DoxyCodeLine{00108\ \ \ \ \ \mbox{\hyperlink{structhb__array__t}{hb\_array\_t<const\ F2DOT14>}}\ end\_tuple;}
\DoxyCodeLine{00109\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_intermediate\ ())}
\DoxyCodeLine{00110\ \ \ \ \ \{}
\DoxyCodeLine{00111\ \ \ \ \ \ \ start\_tuple\ =\ get\_start\_tuple\ (coord\_count);}
\DoxyCodeLine{00112\ \ \ \ \ \ \ end\_tuple\ =\ get\_end\_tuple\ (coord\_count);}
\DoxyCodeLine{00113\ \ \ \ \ \}}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{keywordtype}{float}\ scalar\ =\ 1.f;}
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ coord\_count;\ i++)}
\DoxyCodeLine{00117\ \ \ \ \ \{}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ v\ =\ coords[i];}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ peak\ =\ peak\_tuple[i];}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!peak\ ||\ v\ ==\ peak)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_intermediate\ ())}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00124\ \ \ \ \ \textcolor{keywordtype}{int}\ start\ =\ start\_tuple[i];}
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{keywordtype}{int}\ end\ =\ end\_tuple[i];}
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (start\ >\ peak\ ||\ peak\ >\ end\ ||}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (start\ <\ 0\ \&\&\ end\ >\ 0\ \&\&\ peak)))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00128\ \ \ \ \ \textcolor{keywordflow}{if}\ (v\ <\ start\ ||\ v\ >\ end)\ \textcolor{keywordflow}{return}\ 0.f;}
\DoxyCodeLine{00129\ \ \ \ \ \textcolor{keywordflow}{if}\ (v\ <\ peak)}
\DoxyCodeLine{00130\ \ \ \ \ \{\ \textcolor{keywordflow}{if}\ (peak\ !=\ start)\ scalar\ *=\ (float)\ (v\ -\/\ start)\ /\ (peak\ -\/\ start);\ \}}
\DoxyCodeLine{00131\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00132\ \ \ \ \ \{\ \textcolor{keywordflow}{if}\ (peak\ !=\ end)\ scalar\ *=\ (float)\ (end\ -\/\ v)\ /\ (end\ -\/\ peak);\ \}}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!v\ ||\ v\ <\ hb\_min\ (0,\ peak)\ ||\ v\ >\ hb\_max\ (0,\ peak))\ \textcolor{keywordflow}{return}\ 0.f;}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00136\ \ \ \ \ scalar\ *=\ (float)\ v\ /\ peak;}
\DoxyCodeLine{00137\ \ \ \ \ \}}
\DoxyCodeLine{00138\ \ \ \ \ \textcolor{keywordflow}{return}\ scalar;}
\DoxyCodeLine{00139\ \ \ \}}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \ \ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \ \ \ \ has\_peak\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ tupleIndex\ \&\ TuppleIndex::EmbeddedPeakTuple;\ \}}
\DoxyCodeLine{00142\ \ \ \textcolor{keywordtype}{bool}\ \ \ has\_intermediate\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ tupleIndex\ \&\ TuppleIndex::IntermediateRegion;\ \}}
\DoxyCodeLine{00143\ \ \ \textcolor{keywordtype}{bool}\ has\_private\_points\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ tupleIndex\ \&\ TuppleIndex::PrivatePointNumbers;\ \}}
\DoxyCodeLine{00144\ \ \ \textcolor{keywordtype}{unsigned}\ \ \ \ \ \ get\_index\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ tupleIndex\ \&\ TuppleIndex::TupleIndexMask;\ \}}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00147\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_tuple_variation_header_1_1_tupple_index}{TuppleIndex}}\ :\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}}
\DoxyCodeLine{00148\ \ \ \{}
\DoxyCodeLine{00149\ \ \ \ \ \textcolor{keyword}{enum}\ Flags\ \{}
\DoxyCodeLine{00150\ \ \ \ \ \ \ EmbeddedPeakTuple\ \ \ =\ 0x8000u,}
\DoxyCodeLine{00151\ \ \ \ \ \ \ IntermediateRegion\ \ =\ 0x4000u,}
\DoxyCodeLine{00152\ \ \ \ \ \ \ PrivatePointNumbers\ =\ 0x2000u,}
\DoxyCodeLine{00153\ \ \ \ \ \ \ TupleIndexMask\ \ \ \ \ \ =\ 0x0FFFu}
\DoxyCodeLine{00154\ \ \ \ \ \};}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ \ \ \ \ DEFINE\_SIZE\_STATIC\ (2);}
\DoxyCodeLine{00157\ \ \ \};}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00159\ \ \ \mbox{\hyperlink{structhb__array__t}{hb\_array\_t<const\ F2DOT14>}}\ get\_all\_tuples\ (\textcolor{keywordtype}{unsigned}\ axis\_count)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00160\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ StructAfter<UnsizedArrayOf<F2DOT14>>\ (tupleIndex).as\_array\ ((has\_peak\ ()\ +\ has\_intermediate\ ()\ *\ 2)\ *\ axis\_count);\ \}}
\DoxyCodeLine{00161\ \ \ \mbox{\hyperlink{structhb__array__t}{hb\_array\_t<const\ F2DOT14>}}\ get\_peak\_tuple\ (\textcolor{keywordtype}{unsigned}\ axis\_count)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00162\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ get\_all\_tuples\ (axis\_count).sub\_array\ (0,\ axis\_count);\ \}}
\DoxyCodeLine{00163\ \ \ \mbox{\hyperlink{structhb__array__t}{hb\_array\_t<const\ F2DOT14>}}\ get\_start\_tuple\ (\textcolor{keywordtype}{unsigned}\ axis\_count)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00164\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ get\_all\_tuples\ (axis\_count).sub\_array\ (has\_peak\ ()\ *\ axis\_count,\ axis\_count);\ \}}
\DoxyCodeLine{00165\ \ \ \mbox{\hyperlink{structhb__array__t}{hb\_array\_t<const\ F2DOT14>}}\ get\_end\_tuple\ (\textcolor{keywordtype}{unsigned}\ axis\_count)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00166\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ get\_all\_tuples\ (axis\_count).sub\_array\ (has\_peak\ ()\ *\ axis\_count\ +\ axis\_count,\ axis\_count);\ \}}
\DoxyCodeLine{00167\ }
\DoxyCodeLine{00168\ \ \ HBUINT16\ \ varDataSize;\ \ \ \ \textcolor{comment}{/*\ The\ size\ in\ bytes\ of\ the\ serialized}}
\DoxyCodeLine{00169\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ data\ for\ this\ tuple\ variation\ table.\ */}}
\DoxyCodeLine{00170\ \ \ TuppleIndex\ \ \ tupleIndex;\ \textcolor{comment}{/*\ A\ packed\ field.\ The\ high\ 4\ bits\ are\ flags\ (see\ below).}}
\DoxyCodeLine{00171\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ The\ low\ 12\ bits\ are\ an\ index\ into\ a\ shared\ tuple}}
\DoxyCodeLine{00172\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ records\ array.\ */}}
\DoxyCodeLine{00173\ \ \ \textcolor{comment}{/*\ UnsizedArrayOf<F2DOT14>\ peakTuple\ -\/\ optional\ */}}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Peak\ tuple\ record\ for\ this\ tuple\ variation\ table\ —\ optional,}}
\DoxyCodeLine{00175\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ determined\ by\ flags\ in\ the\ tupleIndex\ value.}}
\DoxyCodeLine{00176\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *}}
\DoxyCodeLine{00177\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ Note\ that\ this\ must\ always\ be\ included\ in\ the\ 'cvar'\ table.\ */}}
\DoxyCodeLine{00178\ \ \ \textcolor{comment}{/*\ UnsizedArrayOf<F2DOT14>\ intermediateStartTuple\ -\/\ optional\ */}}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Intermediate\ start\ tuple\ record\ for\ this\ tuple\ variation\ table\ —\ optional,}}
\DoxyCodeLine{00180\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ determined\ by\ flags\ in\ the\ tupleIndex\ value.\ */}}
\DoxyCodeLine{00181\ \ \ \textcolor{comment}{/*\ UnsizedArrayOf<F2DOT14>\ intermediateEndTuple\ -\/\ optional\ */}}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Intermediate\ end\ tuple\ record\ for\ this\ tuple\ variation\ table\ —\ optional,}}
\DoxyCodeLine{00183\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ determined\ by\ flags\ in\ the\ tupleIndex\ value.\ */}}
\DoxyCodeLine{00184\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00185\ \ \ DEFINE\_SIZE\_MIN\ (4);}
\DoxyCodeLine{00186\ \};}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00188\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_glyph_variation_data}{GlyphVariationData}}}
\DoxyCodeLine{00189\ \{}
\DoxyCodeLine{00190\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_tuple_variation_header}{TupleVariationHeader}}\ \&get\_tuple\_var\_header\ (\textcolor{keywordtype}{void})\textcolor{keyword}{\ const}}
\DoxyCodeLine{00191\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ StructAfter<TupleVariationHeader>\ (\mbox{\hyperlink{structdata}{data}});\ \}}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_glyph_variation_data_1_1tuple__iterator__t}{tuple\_iterator\_t}}}
\DoxyCodeLine{00194\ \ \ \{}
\DoxyCodeLine{00195\ \ \ \ \ \textcolor{keywordtype}{void}\ init\ (\mbox{\hyperlink{structhb__array__t}{hb\_bytes\_t}}\ var\_data\_bytes\_,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ axis\_count\_)}
\DoxyCodeLine{00196\ \ \ \ \ \{}
\DoxyCodeLine{00197\ \ \ \ \ \ \ var\_data\_bytes\ =\ var\_data\_bytes\_;}
\DoxyCodeLine{00198\ \ \ \ \ \ \ var\_data\ =\ var\_data\_bytes\_.as<\mbox{\hyperlink{struct_o_t_1_1_glyph_variation_data}{GlyphVariationData}}>\ ();}
\DoxyCodeLine{00199\ \ \ \ \ \ \ index\ =\ 0;}
\DoxyCodeLine{00200\ \ \ \ \ \ \ axis\_count\ =\ axis\_count\_;}
\DoxyCodeLine{00201\ \ \ \ \ \ \ current\_tuple\ =\ \&var\_data-\/>get\_tuple\_var\_header\ ();}
\DoxyCodeLine{00202\ \ \ \ \ \ \ data\_offset\ =\ 0;}
\DoxyCodeLine{00203\ \ \ \ \ \}}
\DoxyCodeLine{00204\ }
\DoxyCodeLine{00205\ \ \ \ \ \textcolor{keywordtype}{bool}\ get\_shared\_indices\ (\mbox{\hyperlink{structhb__vector__t}{hb\_vector\_t<unsigned\ int>}}\ \&shared\_indices\ \textcolor{comment}{/*\ OUT\ */})}
\DoxyCodeLine{00206\ \ \ \ \ \{}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (var\_data-\/>has\_shared\_point\_numbers\ ())}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00209\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT8}}\ *base\ =\ \&(var\_data+var\_data-\/>data);}
\DoxyCodeLine{00210\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT8}}\ *p\ =\ base;}
\DoxyCodeLine{00211\ \ \ \ \ \textcolor{keywordflow}{if}\ (!unpack\_points\ (p,\ shared\_indices,\ var\_data\_bytes))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00212\ \ \ \ \ data\_offset\ =\ p\ -\/\ base;}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00215\ \ \ \ \ \}}
\DoxyCodeLine{00216\ }
\DoxyCodeLine{00217\ \ \ \ \ \textcolor{keywordtype}{bool}\ is\_valid\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00218\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (index\ <\ var\_data-\/>tupleVarCount.get\_count\ ())\ \&\&}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \ var\_data\_bytes.check\_range\ (current\_tuple,\ TupleVariationHeader::min\_size)\ \&\&}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \ var\_data\_bytes.check\_range\ (current\_tuple,\ hb\_max\ (current\_tuple-\/>get\_data\_size\ (),\ current\_tuple-\/>get\_size\ (axis\_count)))\ \&\&}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \ current\_tuple-\/>get\_size\ (axis\_count);}
\DoxyCodeLine{00223\ \ \ \ \ \}}
\DoxyCodeLine{00224\ }
\DoxyCodeLine{00225\ \ \ \ \ \textcolor{keywordtype}{bool}\ move\_to\_next\ ()}
\DoxyCodeLine{00226\ \ \ \ \ \{}
\DoxyCodeLine{00227\ \ \ \ \ \ \ data\_offset\ +=\ current\_tuple-\/>get\_data\_size\ ();}
\DoxyCodeLine{00228\ \ \ \ \ \ \ current\_tuple\ =\ \&current\_tuple-\/>get\_next\ (axis\_count);}
\DoxyCodeLine{00229\ \ \ \ \ \ \ index++;}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ is\_valid\ ();}
\DoxyCodeLine{00231\ \ \ \ \ \}}
\DoxyCodeLine{00232\ }
\DoxyCodeLine{00233\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT8}}\ *get\_serialized\_data\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00234\ \textcolor{keyword}{\ \ \ \ }\{\ \textcolor{keywordflow}{return}\ \&(var\_data+var\_data-\/>data)\ +\ data\_offset;\ \}}
\DoxyCodeLine{00235\ }
\DoxyCodeLine{00236\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00237\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_glyph_variation_data}{GlyphVariationData}}\ *var\_data;}
\DoxyCodeLine{00238\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ index;}
\DoxyCodeLine{00239\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ axis\_count;}
\DoxyCodeLine{00240\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ data\_offset;}
\DoxyCodeLine{00241\ }
\DoxyCodeLine{00242\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00243\ \ \ \ \ \mbox{\hyperlink{structhb__array__t}{hb\_bytes\_t}}\ var\_data\_bytes;}
\DoxyCodeLine{00244\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_tuple_variation_header}{TupleVariationHeader}}\ *current\_tuple;}
\DoxyCodeLine{00245\ \ \ \};}
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00247\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ get\_tuple\_iterator\ (\mbox{\hyperlink{structhb__array__t}{hb\_bytes\_t}}\ var\_data\_bytes,\ \textcolor{keywordtype}{unsigned}\ axis\_count,}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__vector__t}{hb\_vector\_t<unsigned\ int>}}\ \&shared\_indices\ \textcolor{comment}{/*\ OUT\ */},}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_glyph_variation_data_1_1tuple__iterator__t}{tuple\_iterator\_t}}\ *iterator\ \textcolor{comment}{/*\ OUT\ */})}
\DoxyCodeLine{00250\ \ \ \{}
\DoxyCodeLine{00251\ \ \ \ \ iterator-\/>init\ (var\_data\_bytes,\ axis\_count);}
\DoxyCodeLine{00252\ \ \ \ \ \textcolor{keywordflow}{if}\ (!iterator-\/>get\_shared\_indices\ (shared\_indices))}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00254\ \ \ \ \ \textcolor{keywordflow}{return}\ iterator-\/>is\_valid\ ();}
\DoxyCodeLine{00255\ \ \ \}}
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00257\ \ \ \textcolor{keywordtype}{bool}\ has\_shared\_point\_numbers\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ tupleVarCount.has\_shared\_point\_numbers\ ();\ \}}
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00259\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ unpack\_points\ (\textcolor{keyword}{const}\ HBUINT8\ *\&p\ \textcolor{comment}{/*\ IN/OUT\ */},}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__vector__t}{hb\_vector\_t<unsigned\ int>}}\ \&points\ \textcolor{comment}{/*\ OUT\ */},}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__array__t}{hb\_bytes\_t}}\ \&\mbox{\hyperlink{classbytes}{bytes}})}
\DoxyCodeLine{00262\ \ \ \{}
\DoxyCodeLine{00263\ \ \ \ \ \textcolor{keyword}{enum}\ packed\_point\_flag\_t}
\DoxyCodeLine{00264\ \ \ \ \ \{}
\DoxyCodeLine{00265\ \ \ \ \ \ \ POINTS\_ARE\_WORDS\ \ \ \ \ =\ 0x80,}
\DoxyCodeLine{00266\ \ \ \ \ \ \ POINT\_RUN\_COUNT\_MASK\ =\ 0x7F}
\DoxyCodeLine{00267\ \ \ \ \ \};}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00269\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!\mbox{\hyperlink{classbytes}{bytes}}.check\_range\ (p)))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00270\ }
\DoxyCodeLine{00271\ \ \ \ \ uint16\_t\ count\ =\ *p++;}
\DoxyCodeLine{00272\ \ \ \ \ \textcolor{keywordflow}{if}\ (count\ \&\ POINTS\_ARE\_WORDS)}
\DoxyCodeLine{00273\ \ \ \ \ \{}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!\mbox{\hyperlink{classbytes}{bytes}}.check\_range\ (p)))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00275\ \ \ \ \ \ \ count\ =\ ((count\ \&\ POINT\_RUN\_COUNT\_MASK)\ <<\ 8)\ |\ *p++;}
\DoxyCodeLine{00276\ \ \ \ \ \}}
\DoxyCodeLine{00277\ \ \ \ \ points.resize\ (count);}
\DoxyCodeLine{00278\ }
\DoxyCodeLine{00279\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ n\ =\ 0;}
\DoxyCodeLine{00280\ \ \ \ \ uint16\_t\ i\ =\ 0;}
\DoxyCodeLine{00281\ \ \ \ \ \textcolor{keywordflow}{while}\ (i\ <\ count)}
\DoxyCodeLine{00282\ \ \ \ \ \{}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!\mbox{\hyperlink{classbytes}{bytes}}.check\_range\ (p)))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00284\ \ \ \ \ \ \ uint16\_t\ j;}
\DoxyCodeLine{00285\ \ \ \ \ \ \ uint8\_t\ control\ =\ *p++;}
\DoxyCodeLine{00286\ \ \ \ \ \ \ uint16\_t\ run\_count\ =\ (control\ \&\ POINT\_RUN\_COUNT\_MASK)\ +\ 1;}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (control\ \&\ POINTS\_ARE\_WORDS)}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00289\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0;\ j\ <\ run\_count\ \&\&\ i\ <\ count;\ j++,\ i++)}
\DoxyCodeLine{00290\ \ \ \ \ \{}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!\mbox{\hyperlink{classbytes}{bytes}}.check\_range\ ((\textcolor{keyword}{const}\ HBUINT16\ *)\ p)))}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00293\ \ \ \ \ \ \ n\ +=\ *(\textcolor{keyword}{const}\ HBUINT16\ *)p;}
\DoxyCodeLine{00294\ \ \ \ \ \ \ points[i]\ =\ n;}
\DoxyCodeLine{00295\ \ \ \ \ \ \ p\ +=\ HBUINT16::static\_size;}
\DoxyCodeLine{00296\ \ \ \ \ \}}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00300\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0;\ j\ <\ run\_count\ \&\&\ i\ <\ count;\ j++,\ i++)}
\DoxyCodeLine{00301\ \ \ \ \ \{}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!\mbox{\hyperlink{classbytes}{bytes}}.check\_range\ (p)))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00303\ \ \ \ \ \ \ n\ +=\ *p++;}
\DoxyCodeLine{00304\ \ \ \ \ \ \ points[i]\ =\ n;}
\DoxyCodeLine{00305\ \ \ \ \ \}}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ <\ run\_count)\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00308\ \ \ \ \ \}}
\DoxyCodeLine{00309\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00310\ \ \ \}}
\DoxyCodeLine{00311\ }
\DoxyCodeLine{00312\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ unpack\_deltas\ (\textcolor{keyword}{const}\ HBUINT8\ *\&p\ \textcolor{comment}{/*\ IN/OUT\ */},}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__vector__t}{hb\_vector\_t<int>}}\ \&deltas\ \textcolor{comment}{/*\ IN/OUT\ */},}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__array__t}{hb\_bytes\_t}}\ \&\mbox{\hyperlink{classbytes}{bytes}})}
\DoxyCodeLine{00315\ \ \ \{}
\DoxyCodeLine{00316\ \ \ \ \ \textcolor{keyword}{enum}\ packed\_delta\_flag\_t}
\DoxyCodeLine{00317\ \ \ \ \ \{}
\DoxyCodeLine{00318\ \ \ \ \ \ \ DELTAS\_ARE\_ZERO\ \ \ \ \ \ =\ 0x80,}
\DoxyCodeLine{00319\ \ \ \ \ \ \ DELTAS\_ARE\_WORDS\ \ \ \ \ =\ 0x40,}
\DoxyCodeLine{00320\ \ \ \ \ \ \ DELTA\_RUN\_COUNT\_MASK\ =\ 0x3F}
\DoxyCodeLine{00321\ \ \ \ \ \};}
\DoxyCodeLine{00322\ }
\DoxyCodeLine{00323\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;}
\DoxyCodeLine{00324\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ deltas.length;}
\DoxyCodeLine{00325\ \ \ \ \ \textcolor{keywordflow}{while}\ (i\ <\ count)}
\DoxyCodeLine{00326\ \ \ \ \ \{}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!\mbox{\hyperlink{classbytes}{bytes}}.check\_range\ (p)))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00328\ \ \ \ \ \ \ uint8\_t\ control\ =\ *p++;}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ run\_count\ =\ (control\ \&\ DELTA\_RUN\_COUNT\_MASK)\ +\ 1;}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j;}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (control\ \&\ DELTAS\_ARE\_ZERO)}
\DoxyCodeLine{00332\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0;\ j\ <\ run\_count\ \&\&\ i\ <\ count;\ j++,\ i++)}
\DoxyCodeLine{00333\ \ \ \ \ \ \ deltas[i]\ =\ 0;}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (control\ \&\ DELTAS\_ARE\_WORDS)}
\DoxyCodeLine{00335\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0;\ j\ <\ run\_count\ \&\&\ i\ <\ count;\ j++,\ i++)}
\DoxyCodeLine{00336\ \ \ \ \ \{}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!\mbox{\hyperlink{classbytes}{bytes}}.check\_range\ ((\textcolor{keyword}{const}\ HBUINT16\ *)\ p)))}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00339\ \ \ \ \ \ \ deltas[i]\ =\ *(\textcolor{keyword}{const}\ HBINT16\ *)\ p;}
\DoxyCodeLine{00340\ \ \ \ \ \ \ p\ +=\ HBUINT16::static\_size;}
\DoxyCodeLine{00341\ \ \ \ \ \}}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00343\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0;\ j\ <\ run\_count\ \&\&\ i\ <\ count;\ j++,\ i++)}
\DoxyCodeLine{00344\ \ \ \ \ \{}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!\mbox{\hyperlink{classbytes}{bytes}}.check\_range\ (p)))}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00347\ \ \ \ \ \ \ deltas[i]\ =\ *(\textcolor{keyword}{const}\ HBINT8\ *)\ p++;}
\DoxyCodeLine{00348\ \ \ \ \ \}}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ <\ run\_count)}
\DoxyCodeLine{00350\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00351\ \ \ \ \ \}}
\DoxyCodeLine{00352\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00353\ \ \ \}}
\DoxyCodeLine{00354\ }
\DoxyCodeLine{00355\ \ \ \textcolor{keywordtype}{bool}\ has\_data\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ tupleVarCount;\ \}}
\DoxyCodeLine{00356\ }
\DoxyCodeLine{00357\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00358\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_glyph_variation_data_1_1_tuple_var_count}{TupleVarCount}}\ :\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}}
\DoxyCodeLine{00359\ \ \ \{}
\DoxyCodeLine{00360\ \ \ \ \ \textcolor{keywordtype}{bool}\ has\_shared\_point\_numbers\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ ((*\textcolor{keyword}{this})\ \&\ SharedPointNumbers);\ \}}
\DoxyCodeLine{00361\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_count\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ (*\textcolor{keyword}{this})\ \&\ CountMask;\ \}}
\DoxyCodeLine{00362\ }
\DoxyCodeLine{00363\ \ \ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00364\ \ \ \ \ \textcolor{keyword}{enum}\ Flags}
\DoxyCodeLine{00365\ \ \ \ \ \{}
\DoxyCodeLine{00366\ \ \ \ \ \ \ SharedPointNumbers=\ 0x8000u,}
\DoxyCodeLine{00367\ \ \ \ \ \ \ CountMask\ \ \ \ \ =\ 0x0FFFu}
\DoxyCodeLine{00368\ \ \ \ \ \};}
\DoxyCodeLine{00369\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00370\ \ \ \ \ DEFINE\_SIZE\_STATIC\ (2);}
\DoxyCodeLine{00371\ \ \ \};}
\DoxyCodeLine{00372\ }
\DoxyCodeLine{00373\ \ \ \mbox{\hyperlink{struct_o_t_1_1_glyph_variation_data_1_1_tuple_var_count}{TupleVarCount}}\ \ \ \ tupleVarCount;\ \ \textcolor{comment}{/*\ A\ packed\ field.\ The\ high\ 4\ bits\ are\ flags,\ and\ the}}
\DoxyCodeLine{00374\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ low\ 12\ bits\ are\ the\ number\ of\ tuple\ variation\ tables}}
\DoxyCodeLine{00375\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ for\ this\ glyph.\ The\ number\ of\ tuple\ variation\ tables}}
\DoxyCodeLine{00376\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ can\ be\ any\ number\ between\ 1\ and\ 4095.\ */}}
\DoxyCodeLine{00377\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<HBUINT8>}}}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdata}{data}};\ \ \ \ \ \ \ \textcolor{comment}{/*\ Offset\ from\ the\ start\ of\ the\ GlyphVariationData\ table}}
\DoxyCodeLine{00379\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ to\ the\ serialized\ data.\ */}}
\DoxyCodeLine{00380\ \ \ \textcolor{comment}{/*\ TupleVariationHeader\ tupleVariationHeaders[]\ */}\textcolor{comment}{/*\ Array\ of\ tuple\ variation\ headers.\ */}}
\DoxyCodeLine{00381\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00382\ \ \ DEFINE\_SIZE\_MIN\ (4);}
\DoxyCodeLine{00383\ \};}
\DoxyCodeLine{00384\ }
\DoxyCodeLine{00385\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1gvar}{gvar}}}
\DoxyCodeLine{00386\ \{}
\DoxyCodeLine{00387\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ hb\_tag\_t\ tableTag\ =\ HB\_OT\_TAG\_gvar;}
\DoxyCodeLine{00388\ }
\DoxyCodeLine{00389\ \ \ \textcolor{keywordtype}{bool}\ sanitize\_shallow\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00390\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00391\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00392\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this})\ \&\&\ (version.major\ ==\ 1)\ \&\&}
\DoxyCodeLine{00393\ \ \ \ \ \ \ \ \ \ \ (glyphCount\ ==\ c-\/>get\_num\_glyphs\ ())\ \&\&}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ \ \ sharedTuples.sanitize\ (c,\ \textcolor{keyword}{this},\ axisCount\ *\ sharedTupleCount)\ \&\&}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ \ \ (is\_long\_offset\ ()\ ?}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \ \ \ \ \ c-\/>check\_array\ (get\_long\_offset\_array\ (),\ glyphCount+1)\ :}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \ \ \ \ \ \ \ c-\/>check\_array\ (get\_short\_offset\_array\ (),\ glyphCount+1))\ \&\&}
\DoxyCodeLine{00398\ \ \ \ \ \ \ \ \ \ \ c-\/>check\_array\ (((\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT8}}*)\&(\textcolor{keyword}{this}+dataZ))\ +\ get\_offset\ (0),}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_offset\ (glyphCount)\ -\/\ get\_offset\ (0)));}
\DoxyCodeLine{00400\ \ \ \}}
\DoxyCodeLine{00401\ }
\DoxyCodeLine{00402\ \ \ \textcolor{comment}{/*\ GlyphVariationData\ not\ sanitized\ here;\ must\ be\ checked\ while\ accessing\ each\ glyph\ variation\ data\ */}}
\DoxyCodeLine{00403\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00404\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ sanitize\_shallow\ (c);\ \}}
\DoxyCodeLine{00405\ }
\DoxyCodeLine{00406\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00407\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00408\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00409\ }
\DoxyCodeLine{00410\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1gvar}{gvar}}\ *out\ =\ c-\/>serializer-\/>allocate\_min<\mbox{\hyperlink{struct_o_t_1_1gvar}{gvar}}>\ ();}
\DoxyCodeLine{00411\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!out))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{00412\ }
\DoxyCodeLine{00413\ \ \ \ \ out-\/>version.major\ =\ 1;}
\DoxyCodeLine{00414\ \ \ \ \ out-\/>version.minor\ =\ 0;}
\DoxyCodeLine{00415\ \ \ \ \ out-\/>axisCount\ =\ axisCount;}
\DoxyCodeLine{00416\ \ \ \ \ out-\/>sharedTupleCount\ =\ sharedTupleCount;}
\DoxyCodeLine{00417\ }
\DoxyCodeLine{00418\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ num\_glyphs\ =\ c-\/>plan-\/>num\_output\_glyphs\ ();}
\DoxyCodeLine{00419\ \ \ \ \ out-\/>glyphCount\ =\ num\_glyphs;}
\DoxyCodeLine{00420\ }
\DoxyCodeLine{00421\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ subset\_data\_size\ =\ 0;}
\DoxyCodeLine{00422\ \ \ \ \ \textcolor{keywordflow}{for}\ (hb\_codepoint\_t\ gid\ =\ (c-\/>plan-\/>flags\ \&\ HB\_SUBSET\_FLAGS\_NOTDEF\_OUTLINE)\ ?\ 0\ :\ 1;}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ \ gid\ <\ num\_glyphs;}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ \ gid++)}
\DoxyCodeLine{00425\ \ \ \ \ \{}
\DoxyCodeLine{00426\ \ \ \ \ \ \ hb\_codepoint\_t\ old\_gid;}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!c-\/>plan-\/>old\_gid\_for\_new\_gid\ (gid,\ \&old\_gid))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00428\ \ \ \ \ \ \ subset\_data\_size\ +=\ get\_glyph\_var\_data\_bytes\ (c-\/>source\_blob,\ old\_gid).length;}
\DoxyCodeLine{00429\ \ \ \ \ \}}
\DoxyCodeLine{00430\ }
\DoxyCodeLine{00431\ \ \ \ \ \textcolor{keywordtype}{bool}\ long\_offset\ =\ subset\_data\_size\ \&\ \string~0xFFFFu;}
\DoxyCodeLine{00432\ \ \ \ \ out-\/>flags\ =\ long\_offset\ ?\ 1\ :\ 0;}
\DoxyCodeLine{00433\ }
\DoxyCodeLine{00434\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT8}}\ *subset\_offsets\ =\ c-\/>serializer-\/>allocate\_size<\mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT8}}>\ ((long\_offset\ ?\ 4\ :\ 2)\ *\ (num\_glyphs\ +\ 1));}
\DoxyCodeLine{00435\ \ \ \ \ \textcolor{keywordflow}{if}\ (!subset\_offsets)\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{00436\ }
\DoxyCodeLine{00437\ \ \ \ \ \textcolor{comment}{/*\ shared\ tuples\ */}}
\DoxyCodeLine{00438\ \ \ \ \ \textcolor{keywordflow}{if}\ (!sharedTupleCount\ ||\ !sharedTuples)}
\DoxyCodeLine{00439\ \ \ \ \ \ \ out-\/>sharedTuples\ =\ 0;}
\DoxyCodeLine{00440\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00441\ \ \ \ \ \{}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ shared\_tuple\_size\ =\ F2DOT14::static\_size\ *\ axisCount\ *\ sharedTupleCount;}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_f2_d_o_t14}{F2DOT14}}\ *tuples\ =\ c-\/>serializer-\/>allocate\_size<\mbox{\hyperlink{struct_o_t_1_1_f2_d_o_t14}{F2DOT14}}>\ (shared\_tuple\_size);}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!tuples)\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{00445\ \ \ \ \ \ \ out-\/>sharedTuples\ =\ (\textcolor{keywordtype}{char}\ *)\ tuples\ -\/\ (\textcolor{keywordtype}{char}\ *)\ out;}
\DoxyCodeLine{00446\ \ \ \ \ \ \ memcpy\ (tuples,\ \textcolor{keyword}{this}+sharedTuples,\ shared\_tuple\_size);}
\DoxyCodeLine{00447\ \ \ \ \ \}}
\DoxyCodeLine{00448\ }
\DoxyCodeLine{00449\ \ \ \ \ \textcolor{keywordtype}{char}\ *subset\_data\ =\ c-\/>serializer-\/>allocate\_size<\textcolor{keywordtype}{char}>\ (subset\_data\_size);}
\DoxyCodeLine{00450\ \ \ \ \ \textcolor{keywordflow}{if}\ (!subset\_data)\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{00451\ \ \ \ \ out-\/>dataZ\ =\ subset\_data\ -\/\ (\textcolor{keywordtype}{char}\ *)\ out;}
\DoxyCodeLine{00452\ }
\DoxyCodeLine{00453\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ glyph\_offset\ =\ 0;}
\DoxyCodeLine{00454\ \ \ \ \ \textcolor{keywordflow}{for}\ (hb\_codepoint\_t\ gid\ =\ (c-\/>plan-\/>flags\ \&\ HB\_SUBSET\_FLAGS\_NOTDEF\_OUTLINE)\ ?\ 0\ :\ 1;}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ \ gid\ <\ num\_glyphs;}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \ \ \ gid++)}
\DoxyCodeLine{00457\ \ \ \ \ \{}
\DoxyCodeLine{00458\ \ \ \ \ \ \ hb\_codepoint\_t\ old\_gid;}
\DoxyCodeLine{00459\ \ \ \ \ \ \ \mbox{\hyperlink{structhb__array__t}{hb\_bytes\_t}}\ var\_data\_bytes\ =\ c-\/>plan-\/>old\_gid\_for\_new\_gid\ (gid,\ \&old\_gid)}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ?\ get\_glyph\_var\_data\_bytes\ (c-\/>source\_blob,\ old\_gid)}
\DoxyCodeLine{00461\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{structhb__array__t}{hb\_bytes\_t}}\ ();}
\DoxyCodeLine{00462\ }
\DoxyCodeLine{00463\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (long\_offset)}
\DoxyCodeLine{00464\ \ \ \ \ ((\mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT32}}\ *)\ subset\_offsets)[gid]\ =\ glyph\_offset;}
\DoxyCodeLine{00465\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00466\ \ \ \ \ ((\mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *)\ subset\_offsets)[gid]\ =\ glyph\_offset\ /\ 2;}
\DoxyCodeLine{00467\ }
\DoxyCodeLine{00468\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (var\_data\_bytes.length\ >\ 0)}
\DoxyCodeLine{00469\ \ \ \ \ memcpy\ (subset\_data,\ var\_data\_bytes.arrayZ,\ var\_data\_bytes.length);}
\DoxyCodeLine{00470\ \ \ \ \ \ \ subset\_data\ +=\ var\_data\_bytes.length;}
\DoxyCodeLine{00471\ \ \ \ \ \ \ glyph\_offset\ +=\ var\_data\_bytes.length;}
\DoxyCodeLine{00472\ \ \ \ \ \}}
\DoxyCodeLine{00473\ \ \ \ \ \textcolor{keywordflow}{if}\ (long\_offset)}
\DoxyCodeLine{00474\ \ \ \ \ \ \ ((\mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT32}}\ *)\ subset\_offsets)[num\_glyphs]\ =\ glyph\_offset;}
\DoxyCodeLine{00475\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00476\ \ \ \ \ \ \ ((\mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *)\ subset\_offsets)[num\_glyphs]\ =\ glyph\_offset\ /\ 2;}
\DoxyCodeLine{00477\ }
\DoxyCodeLine{00478\ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{00479\ \ \ \}}
\DoxyCodeLine{00480\ }
\DoxyCodeLine{00481\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00482\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__array__t}{hb\_bytes\_t}}\ get\_glyph\_var\_data\_bytes\ (\mbox{\hyperlink{structhb__blob__t}{hb\_blob\_t}}\ *blob,\ hb\_codepoint\_t\ glyph)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00483\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00484\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ start\_offset\ =\ get\_offset\ (glyph);}
\DoxyCodeLine{00485\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ length\ =\ get\_offset\ (glyph+1)\ -\/\ start\_offset;}
\DoxyCodeLine{00486\ \ \ \ \ \mbox{\hyperlink{structhb__array__t}{hb\_bytes\_t}}\ var\_data\ =\ blob-\/>as\_bytes\ ().sub\_array\ (((\textcolor{keywordtype}{unsigned})\ dataZ)\ +\ start\_offset,\ length);}
\DoxyCodeLine{00487\ \ \ \ \ \textcolor{keywordflow}{return}\ likely\ (var\_data.length\ >=\ GlyphVariationData::min\_size)\ ?\ var\_data\ :\ \mbox{\hyperlink{structhb__array__t}{hb\_bytes\_t}}\ ();}
\DoxyCodeLine{00488\ \ \ \}}
\DoxyCodeLine{00489\ }
\DoxyCodeLine{00490\ \ \ \textcolor{keywordtype}{bool}\ is\_long\_offset\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ flags\ \&\ 1;\ \}}
\DoxyCodeLine{00491\ }
\DoxyCodeLine{00492\ \ \ \textcolor{keywordtype}{unsigned}\ get\_offset\ (\textcolor{keywordtype}{unsigned}\ i)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00493\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ is\_long\_offset\ ()\ ?\ get\_long\_offset\_array\ ()[i]\ :\ get\_short\_offset\_array\ ()[i]\ *\ 2;\ \}}
\DoxyCodeLine{00494\ }
\DoxyCodeLine{00495\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT32}}\ *\ get\_long\_offset\_array\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT32}}\ *)\ \&offsetZ;\ \}}
\DoxyCodeLine{00496\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *get\_short\_offset\_array\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *)\ \&offsetZ;\ \}}
\DoxyCodeLine{00497\ }
\DoxyCodeLine{00498\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00499\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1gvar_1_1accelerator__t}{accelerator\_t}}}
\DoxyCodeLine{00500\ \ \ \{}
\DoxyCodeLine{00501\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1gvar_1_1accelerator__t}{accelerator\_t}}\ (\mbox{\hyperlink{structhb__face__t}{hb\_face\_t}}\ *face)}
\DoxyCodeLine{00502\ \ \ \ \ \{\ table\ =\ \mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ ().reference\_table<\mbox{\hyperlink{struct_o_t_1_1gvar}{gvar}}>\ (face);\ \}}
\DoxyCodeLine{00503\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1gvar_1_1accelerator__t}{\string~accelerator\_t}}\ ()\ \{\ table.destroy\ ();\ \}}
\DoxyCodeLine{00504\ }
\DoxyCodeLine{00505\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00506\ \ \ \ \ \textcolor{keyword}{struct\ }x\_getter\ \{\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{float}\ get\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1contour__point__t}{contour\_point\_t}}\ \&p)\ \{\ \textcolor{keywordflow}{return}\ p.x;\ \}\ \};}
\DoxyCodeLine{00507\ \ \ \ \ \textcolor{keyword}{struct\ }y\_getter\ \{\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{float}\ get\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1contour__point__t}{contour\_point\_t}}\ \&p)\ \{\ \textcolor{keywordflow}{return}\ p.y;\ \}\ \};}
\DoxyCodeLine{00508\ }
\DoxyCodeLine{00509\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00510\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{float}\ infer\_delta\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__array__t}{hb\_array\_t<contour\_point\_t>}}\ points,}
\DoxyCodeLine{00511\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__array__t}{hb\_array\_t<contour\_point\_t>}}\ deltas,}
\DoxyCodeLine{00512\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ target,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ prev,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ next)}
\DoxyCodeLine{00513\ \ \ \ \ \{}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ target\_val\ =\ T::get\ (points[target]);}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ prev\_val\ =\ T::get\ (points[prev]);}
\DoxyCodeLine{00516\ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ next\_val\ =\ T::get\ (points[next]);}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ prev\_delta\ =\ T::get\ (deltas[prev]);}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ next\_delta\ =\ T::get\ (deltas[next]);}
\DoxyCodeLine{00519\ }
\DoxyCodeLine{00520\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (prev\_val\ ==\ next\_val)}
\DoxyCodeLine{00521\ \ \ \ \ \textcolor{keywordflow}{return}\ (prev\_delta\ ==\ next\_delta)\ ?\ prev\_delta\ :\ 0.f;}
\DoxyCodeLine{00522\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (target\_val\ <=\ hb\_min\ (prev\_val,\ next\_val))}
\DoxyCodeLine{00523\ \ \ \ \ \textcolor{keywordflow}{return}\ (prev\_val\ <\ next\_val)\ ?\ prev\_delta\ :\ next\_delta;}
\DoxyCodeLine{00524\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (target\_val\ >=\ hb\_max\ (prev\_val,\ next\_val))}
\DoxyCodeLine{00525\ \ \ \ \ \textcolor{keywordflow}{return}\ (prev\_val\ >\ next\_val)\ ?\ prev\_delta\ :\ next\_delta;}
\DoxyCodeLine{00526\ }
\DoxyCodeLine{00527\ \ \ \ \ \ \ \textcolor{comment}{/*\ linear\ interpolation\ */}}
\DoxyCodeLine{00528\ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ r\ =\ (target\_val\ -\/\ prev\_val)\ /\ (next\_val\ -\/\ prev\_val);}
\DoxyCodeLine{00529\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (1.f\ -\/\ r)\ *\ prev\_delta\ +\ r\ *\ next\_delta;}
\DoxyCodeLine{00530\ \ \ \ \ \}}
\DoxyCodeLine{00531\ }
\DoxyCodeLine{00532\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ next\_index\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ start,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ end)}
\DoxyCodeLine{00533\ \ \ \ \ \{\ \textcolor{keywordflow}{return}\ (i\ >=\ end)\ ?\ start\ :\ (i\ +\ 1);\ \}}
\DoxyCodeLine{00534\ }
\DoxyCodeLine{00535\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00536\ \ \ \ \ \textcolor{keywordtype}{bool}\ apply\_deltas\_to\_points\ (hb\_codepoint\_t\ glyph,\ \mbox{\hyperlink{structhb__font__t}{hb\_font\_t}}\ *font,}
\DoxyCodeLine{00537\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__array__t}{hb\_array\_t<contour\_point\_t>}}\ points)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00538\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00539\ \ \ \ \ \ \ \textcolor{comment}{/*\ num\_coords\ should\ exactly\ match\ gvar's\ axisCount\ due\ to\ how\ GlyphVariationData\ tuples\ are\ aligned\ */}}
\DoxyCodeLine{00540\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!font-\/>num\_coords\ ||\ font-\/>num\_coords\ !=\ table-\/>axisCount)\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00541\ }
\DoxyCodeLine{00542\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (glyph\ >=\ table-\/>glyphCount))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00543\ }
\DoxyCodeLine{00544\ \ \ \ \ \ \ \mbox{\hyperlink{structhb__array__t}{hb\_bytes\_t}}\ var\_data\_bytes\ =\ table-\/>get\_glyph\_var\_data\_bytes\ (table.get\_blob\ (),\ glyph);}
\DoxyCodeLine{00545\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!var\_data\_bytes.as<\mbox{\hyperlink{struct_o_t_1_1_glyph_variation_data}{GlyphVariationData}}>\ ()-\/>has\_data\ ())\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00546\ \ \ \ \ \ \ \mbox{\hyperlink{structhb__vector__t}{hb\_vector\_t<unsigned\ int>}}\ shared\_indices;}
\DoxyCodeLine{00547\ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_glyph_variation_data_1_1tuple__iterator__t}{GlyphVariationData::tuple\_iterator\_t}}\ iterator;}
\DoxyCodeLine{00548\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!GlyphVariationData::get\_tuple\_iterator\ (var\_data\_bytes,\ table-\/>axisCount,}
\DoxyCodeLine{00549\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ shared\_indices,\ \&iterator))}
\DoxyCodeLine{00550\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};\ \textcolor{comment}{/*\ so\ isn't\ applied\ at\ all\ */}}
\DoxyCodeLine{00551\ }
\DoxyCodeLine{00552\ \ \ \ \ \ \ \textcolor{comment}{/*\ Save\ original\ points\ for\ inferred\ delta\ calculation\ */}}
\DoxyCodeLine{00553\ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1contour__point__vector__t}{contour\_point\_vector\_t}}\ orig\_points;}
\DoxyCodeLine{00554\ \ \ \ \ \ \ orig\_points.resize\ (points.length);}
\DoxyCodeLine{00555\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ orig\_points.length;\ i++)}
\DoxyCodeLine{00556\ \ \ \ \ orig\_points[i]\ =\ points[i];}
\DoxyCodeLine{00557\ }
\DoxyCodeLine{00558\ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1contour__point__vector__t}{contour\_point\_vector\_t}}\ deltas;\ \textcolor{comment}{/*\ flag\ is\ used\ to\ indicate\ referenced\ point\ */}}
\DoxyCodeLine{00559\ \ \ \ \ \ \ deltas.resize\ (points.length);}
\DoxyCodeLine{00560\ }
\DoxyCodeLine{00561\ \ \ \ \ \ \ \mbox{\hyperlink{structhb__vector__t}{hb\_vector\_t<unsigned>}}\ end\_points;}
\DoxyCodeLine{00562\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ 0;\ i\ <\ points.length;\ ++i)}
\DoxyCodeLine{00563\ \ \ \ \ \textcolor{keywordflow}{if}\ (points[i].is\_end\_point)}
\DoxyCodeLine{00564\ \ \ \ \ \ \ end\_points.push\ (i);}
\DoxyCodeLine{00565\ }
\DoxyCodeLine{00566\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ *coords\ =\ font-\/>coords;}
\DoxyCodeLine{00567\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ num\_coords\ =\ font-\/>num\_coords;}
\DoxyCodeLine{00568\ \ \ \ \ \ \ \mbox{\hyperlink{structhb__array__t}{hb\_array\_t<const\ F2DOT14>}}\ shared\_tuples\ =\ (table+table-\/>sharedTuples).as\_array\ (table-\/>sharedTupleCount\ *\ table-\/>axisCount);}
\DoxyCodeLine{00569\ \ \ \ \ \ \ \textcolor{keywordflow}{do}}
\DoxyCodeLine{00570\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00571\ \ \ \ \ \textcolor{keywordtype}{float}\ scalar\ =\ iterator.current\_tuple-\/>calculate\_scalar\ (coords,\ num\_coords,\ shared\_tuples);}
\DoxyCodeLine{00572\ \ \ \ \ \textcolor{keywordflow}{if}\ (scalar\ ==\ 0.f)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00573\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT8}}\ *p\ =\ iterator.get\_serialized\_data\ ();}
\DoxyCodeLine{00574\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ length\ =\ iterator.current\_tuple-\/>get\_data\_size\ ();}
\DoxyCodeLine{00575\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!iterator.var\_data\_bytes.check\_range\ (p,\ length)))}
\DoxyCodeLine{00576\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00577\ }
\DoxyCodeLine{00578\ \ \ \ \ \mbox{\hyperlink{structhb__array__t}{hb\_bytes\_t}}\ \mbox{\hyperlink{classbytes}{bytes}}\ ((\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *)\ p,\ length);}
\DoxyCodeLine{00579\ \ \ \ \ \mbox{\hyperlink{structhb__vector__t}{hb\_vector\_t<unsigned\ int>}}\ private\_indices;}
\DoxyCodeLine{00580\ \ \ \ \ \textcolor{keywordflow}{if}\ (iterator.current\_tuple-\/>has\_private\_points\ ()\ \&\&}
\DoxyCodeLine{00581\ \ \ \ \ \ \ \ \ !GlyphVariationData::unpack\_points\ (p,\ private\_indices,\ \mbox{\hyperlink{classbytes}{bytes}}))}
\DoxyCodeLine{00582\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00583\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__array__t}{hb\_array\_t<unsigned\ int>}}\ \&indices\ =\ private\_indices.length\ ?\ private\_indices\ :\ shared\_indices;}
\DoxyCodeLine{00584\ }
\DoxyCodeLine{00585\ \ \ \ \ \textcolor{keywordtype}{bool}\ apply\_to\_all\ =\ (indices.length\ ==\ 0);}
\DoxyCodeLine{00586\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ num\_deltas\ =\ apply\_to\_all\ ?\ points.length\ :\ indices.length;}
\DoxyCodeLine{00587\ \ \ \ \ \mbox{\hyperlink{structhb__vector__t}{hb\_vector\_t<int>}}\ x\_deltas;}
\DoxyCodeLine{00588\ \ \ \ \ x\_deltas.resize\ (num\_deltas);}
\DoxyCodeLine{00589\ \ \ \ \ \textcolor{keywordflow}{if}\ (!GlyphVariationData::unpack\_deltas\ (p,\ x\_deltas,\ \mbox{\hyperlink{classbytes}{bytes}}))}
\DoxyCodeLine{00590\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00591\ \ \ \ \ \mbox{\hyperlink{structhb__vector__t}{hb\_vector\_t<int>}}\ y\_deltas;}
\DoxyCodeLine{00592\ \ \ \ \ y\_deltas.resize\ (num\_deltas);}
\DoxyCodeLine{00593\ \ \ \ \ \textcolor{keywordflow}{if}\ (!GlyphVariationData::unpack\_deltas\ (p,\ y\_deltas,\ \mbox{\hyperlink{classbytes}{bytes}}))}
\DoxyCodeLine{00594\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00595\ }
\DoxyCodeLine{00596\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ deltas.length;\ i++)}
\DoxyCodeLine{00597\ \ \ \ \ \ \ deltas[i].init\ ();}
\DoxyCodeLine{00598\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_deltas;\ i++)}
\DoxyCodeLine{00599\ \ \ \ \ \{}
\DoxyCodeLine{00600\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ pt\_index\ =\ apply\_to\_all\ ?\ i\ :\ indices[i];}
\DoxyCodeLine{00601\ \ \ \ \ \ \ deltas[pt\_index].flag\ =\ 1;\ \ \ \ \textcolor{comment}{/*\ this\ point\ is\ referenced,\ i.e.,\ explicit\ deltas\ specified\ */}}
\DoxyCodeLine{00602\ \ \ \ \ \ \ deltas[pt\_index].x\ +=\ x\_deltas[i]\ *\ scalar;}
\DoxyCodeLine{00603\ \ \ \ \ \ \ deltas[pt\_index].y\ +=\ y\_deltas[i]\ *\ scalar;}
\DoxyCodeLine{00604\ \ \ \ \ \}}
\DoxyCodeLine{00605\ }
\DoxyCodeLine{00606\ \ \ \ \ \textcolor{comment}{/*\ infer\ deltas\ for\ unreferenced\ points\ */}}
\DoxyCodeLine{00607\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ start\_point\ =\ 0;}
\DoxyCodeLine{00608\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ c\ =\ 0;\ c\ <\ end\_points.length;\ c++)}
\DoxyCodeLine{00609\ \ \ \ \ \{}
\DoxyCodeLine{00610\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ end\_point\ =\ end\_points[c];}
\DoxyCodeLine{00611\ }
\DoxyCodeLine{00612\ \ \ \ \ \ \ \textcolor{comment}{/*\ Check\ the\ number\ of\ unreferenced\ points\ in\ a\ contour.\ If\ no\ unref\ points\ or\ no\ ref\ points,\ nothing\ to\ do.\ */}}
\DoxyCodeLine{00613\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ unref\_count\ =\ 0;}
\DoxyCodeLine{00614\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ start\_point;\ i\ <=\ end\_point;\ i++)}
\DoxyCodeLine{00615\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!deltas[i].flag)\ unref\_count++;}
\DoxyCodeLine{00616\ }
\DoxyCodeLine{00617\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ j\ =\ start\_point;}
\DoxyCodeLine{00618\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unref\_count\ ==\ 0\ ||\ unref\_count\ >\ end\_point\ -\/\ start\_point)}
\DoxyCodeLine{00619\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ no\_more\_gaps;}
\DoxyCodeLine{00620\ }
\DoxyCodeLine{00621\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;;)}
\DoxyCodeLine{00622\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00623\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Locate\ the\ next\ gap\ of\ unreferenced\ points\ between\ two\ referenced\ points\ prev\ and\ next.}}
\DoxyCodeLine{00624\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ Note\ that\ a\ gap\ may\ wrap\ around\ at\ left\ (start\_point)\ and/or\ at\ right\ (end\_point).}}
\DoxyCodeLine{00625\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00626\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ prev,\ next,\ i;}
\DoxyCodeLine{00627\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;;)}
\DoxyCodeLine{00628\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00629\ \ \ \ \ \ \ \ \ \ \ i\ =\ j;}
\DoxyCodeLine{00630\ \ \ \ \ \ \ \ \ \ \ j\ =\ next\_index\ (i,\ start\_point,\ end\_point);}
\DoxyCodeLine{00631\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (deltas[i].flag\ \&\&\ !deltas[j].flag)\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00632\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00633\ \ \ \ \ \ \ \ \ prev\ =\ j\ =\ i;}
\DoxyCodeLine{00634\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;;)}
\DoxyCodeLine{00635\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00636\ \ \ \ \ \ \ \ \ \ \ i\ =\ j;}
\DoxyCodeLine{00637\ \ \ \ \ \ \ \ \ \ \ j\ =\ next\_index\ (i,\ start\_point,\ end\_point);}
\DoxyCodeLine{00638\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!deltas[i].flag\ \&\&\ deltas[j].flag)\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00639\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00640\ \ \ \ \ \ \ \ \ next\ =\ j;}
\DoxyCodeLine{00641\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Infer\ deltas\ for\ all\ unref\ points\ in\ the\ gap\ between\ prev\ and\ next\ */}}
\DoxyCodeLine{00642\ \ \ \ \ \ \ \ \ i\ =\ prev;}
\DoxyCodeLine{00643\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;;)}
\DoxyCodeLine{00644\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00645\ \ \ \ \ \ \ \ \ \ \ i\ =\ next\_index\ (i,\ start\_point,\ end\_point);}
\DoxyCodeLine{00646\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ ==\ next)\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00647\ \ \ \ \ \ \ \ \ \ \ deltas[i].x\ =\ infer\_delta<x\_getter>\ (orig\_points.as\_array\ (),\ deltas.as\_array\ (),\ i,\ prev,\ next);}
\DoxyCodeLine{00648\ \ \ \ \ \ \ \ \ \ \ deltas[i].y\ =\ infer\_delta<y\_getter>\ (orig\_points.as\_array\ (),\ deltas.as\_array\ (),\ i,\ prev,\ next);}
\DoxyCodeLine{00649\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (-\/-\/unref\_count\ ==\ 0)\ \textcolor{keywordflow}{goto}\ no\_more\_gaps;}
\DoxyCodeLine{00650\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00651\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00652\ no\_more\_gaps:}
\DoxyCodeLine{00653\ \ \ \ \ \ \ start\_point\ =\ end\_point\ +\ 1;}
\DoxyCodeLine{00654\ \ \ \ \ \}}
\DoxyCodeLine{00655\ }
\DoxyCodeLine{00656\ \ \ \ \ \textcolor{comment}{/*\ apply\ specified\ /\ inferred\ deltas\ to\ points\ */}}
\DoxyCodeLine{00657\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ points.length;\ i++)}
\DoxyCodeLine{00658\ \ \ \ \ \{}
\DoxyCodeLine{00659\ \ \ \ \ \ \ points[i].x\ +=\ deltas[i].x;}
\DoxyCodeLine{00660\ \ \ \ \ \ \ points[i].y\ +=\ deltas[i].y;}
\DoxyCodeLine{00661\ \ \ \ \ \}}
\DoxyCodeLine{00662\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{while}\ (iterator.move\_to\_next\ ());}
\DoxyCodeLine{00663\ }
\DoxyCodeLine{00664\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00665\ \ \ \ \ \}}
\DoxyCodeLine{00666\ }
\DoxyCodeLine{00667\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_axis\_count\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ table-\/>axisCount;\ \}}
\DoxyCodeLine{00668\ }
\DoxyCodeLine{00669\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00670\ \ \ \ \ \mbox{\hyperlink{structhb__blob__ptr__t}{hb\_blob\_ptr\_t<gvar>}}\ table;}
\DoxyCodeLine{00671\ \ \ \};}
\DoxyCodeLine{00672\ }
\DoxyCodeLine{00673\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00674\ \ \ \mbox{\hyperlink{struct_o_t_1_1_fixed_version}{FixedVersion<>}}version;\ \ \textcolor{comment}{/*\ Version\ number\ of\ the\ glyph\ variations\ table}}
\DoxyCodeLine{00675\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ Set\ to\ 0x00010000u.\ */}}
\DoxyCodeLine{00676\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ axisCount;\ \ \textcolor{comment}{/*\ The\ number\ of\ variation\ axes\ for\ this\ font.\ This\ must\ be}}
\DoxyCodeLine{00677\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ the\ same\ number\ as\ axisCount\ in\ the\ 'fvar'\ table.\ */}}
\DoxyCodeLine{00678\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ sharedTupleCount;}
\DoxyCodeLine{00679\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ The\ number\ of\ shared\ tuple\ records.\ Shared\ tuple\ records}}
\DoxyCodeLine{00680\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ can\ be\ referenced\ within\ glyph\ variation\ data\ tables\ for}}
\DoxyCodeLine{00681\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ multiple\ glyphs,\ as\ opposed\ to\ other\ tuple\ records\ stored}}
\DoxyCodeLine{00682\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ directly\ within\ a\ glyph\ variation\ data\ table.\ */}}
\DoxyCodeLine{00683\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{NNOffset32To<UnsizedArrayOf<F2DOT14>}}>}
\DoxyCodeLine{00684\ \ \ \ \ \ \ \ \ sharedTuples;\ \ \ \textcolor{comment}{/*\ Offset\ from\ the\ start\ of\ this\ table\ to\ the\ shared\ tuple\ records.}}
\DoxyCodeLine{00685\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ Array\ of\ tuple\ records\ shared\ across\ all\ glyph\ variation\ data\ tables.\ */}}
\DoxyCodeLine{00686\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ glyphCount;\ \textcolor{comment}{/*\ The\ number\ of\ glyphs\ in\ this\ font.\ This\ must\ match\ the\ number\ of}}
\DoxyCodeLine{00687\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ glyphs\ stored\ elsewhere\ in\ the\ font.\ */}}
\DoxyCodeLine{00688\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ flags;\ \ \ \ \ \ \textcolor{comment}{/*\ Bit-\/field\ that\ gives\ the\ format\ of\ the\ offset\ array\ that\ follows.}}
\DoxyCodeLine{00689\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ If\ bit\ 0\ is\ clear,\ the\ offsets\ are\ uint16;\ if\ bit\ 0\ is\ set,\ the}}
\DoxyCodeLine{00690\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ offsets\ are\ uint32.\ */}}
\DoxyCodeLine{00691\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset32To<GlyphVariationData>}}}
\DoxyCodeLine{00692\ \ \ \ \ \ \ \ \ dataZ;\ \ \ \ \ \ \textcolor{comment}{/*\ Offset\ from\ the\ start\ of\ this\ table\ to\ the\ array\ of}}
\DoxyCodeLine{00693\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ GlyphVariationData\ tables.\ */}}
\DoxyCodeLine{00694\ \ \ \mbox{\hyperlink{struct_o_t_1_1_unsized_array_of}{UnsizedArrayOf<HBUINT8>}}}
\DoxyCodeLine{00695\ \ \ \ \ \ \ \ \ offsetZ;\ \ \ \ \textcolor{comment}{/*\ Offsets\ from\ the\ start\ of\ the\ GlyphVariationData\ array}}
\DoxyCodeLine{00696\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ to\ each\ GlyphVariationData\ table.\ */}}
\DoxyCodeLine{00697\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00698\ \ \ DEFINE\_SIZE\_MIN\ (20);}
\DoxyCodeLine{00699\ \};}
\DoxyCodeLine{00700\ }
\DoxyCodeLine{00701\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1gvar__accelerator__t}{gvar\_accelerator\_t}}\ :\ \mbox{\hyperlink{struct_o_t_1_1gvar_1_1accelerator__t}{gvar::accelerator\_t}}\ \{}
\DoxyCodeLine{00702\ \ \ \mbox{\hyperlink{struct_o_t_1_1gvar__accelerator__t}{gvar\_accelerator\_t}}\ (\mbox{\hyperlink{structhb__face__t}{hb\_face\_t}}\ *face)\ :\ \mbox{\hyperlink{struct_o_t_1_1gvar_1_1accelerator__t}{gvar::accelerator\_t}}\ (face)\ \{\}}
\DoxyCodeLine{00703\ \};}
\DoxyCodeLine{00704\ }
\DoxyCodeLine{00705\ \}\ \textcolor{comment}{/*\ namespace\ OT\ */}}
\DoxyCodeLine{00706\ }
\DoxyCodeLine{00707\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*\ HB\_OT\_VAR\_GVAR\_TABLE\_HH\ */}\textcolor{preprocessor}{}}

\end{DoxyCode}

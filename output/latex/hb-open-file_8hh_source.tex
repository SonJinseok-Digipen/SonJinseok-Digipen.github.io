\hypertarget{hb-open-file_8hh_source}{}\doxysection{hb-\/open-\/file.hh}
\label{hb-open-file_8hh_source}\index{AseSprite/aseprite/third\_party/harfbuzz/src/hb-\/open-\/file.hh@{AseSprite/aseprite/third\_party/harfbuzz/src/hb-\/open-\/file.hh}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ *\ Copyright\ ©\ 2007,2008,2009\ \ Red\ Hat,\ Inc.}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ *\ Copyright\ ©\ 2012\ \ Google,\ Inc.}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ *\ \ This\ is\ part\ of\ HarfBuzz,\ a\ text\ shaping\ library.}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00007\ \textcolor{comment}{\ *\ Permission\ is\ hereby\ granted,\ without\ written\ agreement\ and\ without}}
\DoxyCodeLine{00008\ \textcolor{comment}{\ *\ license\ or\ royalty\ fees,\ to\ use,\ copy,\ modify,\ and\ distribute\ this}}
\DoxyCodeLine{00009\ \textcolor{comment}{\ *\ software\ and\ its\ documentation\ for\ any\ purpose,\ provided\ that\ the}}
\DoxyCodeLine{00010\ \textcolor{comment}{\ *\ above\ copyright\ notice\ and\ the\ following\ two\ paragraphs\ appear\ in}}
\DoxyCodeLine{00011\ \textcolor{comment}{\ *\ all\ copies\ of\ this\ software.}}
\DoxyCodeLine{00012\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00013\ \textcolor{comment}{\ *\ IN\ NO\ EVENT\ SHALL\ THE\ COPYRIGHT\ HOLDER\ BE\ LIABLE\ TO\ ANY\ PARTY\ FOR}}
\DoxyCodeLine{00014\ \textcolor{comment}{\ *\ DIRECT,\ INDIRECT,\ SPECIAL,\ INCIDENTAL,\ OR\ CONSEQUENTIAL\ DAMAGES}}
\DoxyCodeLine{00015\ \textcolor{comment}{\ *\ ARISING\ OUT\ OF\ THE\ USE\ OF\ THIS\ SOFTWARE\ AND\ ITS\ DOCUMENTATION,\ EVEN}}
\DoxyCodeLine{00016\ \textcolor{comment}{\ *\ IF\ THE\ COPYRIGHT\ HOLDER\ HAS\ BEEN\ ADVISED\ OF\ THE\ POSSIBILITY\ OF\ SUCH}}
\DoxyCodeLine{00017\ \textcolor{comment}{\ *\ DAMAGE.}}
\DoxyCodeLine{00018\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00019\ \textcolor{comment}{\ *\ THE\ COPYRIGHT\ HOLDER\ SPECIFICALLY\ DISCLAIMS\ ANY\ WARRANTIES,\ INCLUDING,}}
\DoxyCodeLine{00020\ \textcolor{comment}{\ *\ BUT\ NOT\ LIMITED\ TO,\ THE\ IMPLIED\ WARRANTIES\ OF\ MERCHANTABILITY\ AND}}
\DoxyCodeLine{00021\ \textcolor{comment}{\ *\ FITNESS\ FOR\ A\ PARTICULAR\ PURPOSE.\ \ THE\ SOFTWARE\ PROVIDED\ HEREUNDER\ IS}}
\DoxyCodeLine{00022\ \textcolor{comment}{\ *\ ON\ AN\ "{}AS\ IS"{}\ BASIS,\ AND\ THE\ COPYRIGHT\ HOLDER\ HAS\ NO\ OBLIGATION\ TO}}
\DoxyCodeLine{00023\ \textcolor{comment}{\ *\ PROVIDE\ MAINTENANCE,\ SUPPORT,\ UPDATES,\ ENHANCEMENTS,\ OR\ MODIFICATIONS.}}
\DoxyCodeLine{00024\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00025\ \textcolor{comment}{\ *\ Red\ Hat\ Author(s):\ Behdad\ Esfahbod}}
\DoxyCodeLine{00026\ \textcolor{comment}{\ *\ Google\ Author(s):\ Behdad\ Esfahbod}}
\DoxyCodeLine{00027\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#ifndef\ HB\_OPEN\_FILE\_HH}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#define\ HB\_OPEN\_FILE\_HH}}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#include\ "{}hb-\/open-\/type.hh"{}}}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#include\ "{}hb-\/ot-\/head-\/table.hh"{}}}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \textcolor{keyword}{namespace\ }OT\ \{}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \textcolor{comment}{/*}}
\DoxyCodeLine{00039\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00040\ \textcolor{comment}{\ *\ The\ OpenType\ Font\ File}}
\DoxyCodeLine{00041\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00042\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \textcolor{comment}{/*}}
\DoxyCodeLine{00046\ \textcolor{comment}{\ *\ Organization\ of\ an\ OpenType\ Font}}
\DoxyCodeLine{00047\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \textcolor{keyword}{struct\ }OpenTypeFontFile;}
\DoxyCodeLine{00050\ \textcolor{keyword}{struct\ }OpenTypeOffsetTable;}
\DoxyCodeLine{00051\ \textcolor{keyword}{struct\ }TTCHeader;}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_table_record}{TableRecord}}}
\DoxyCodeLine{00055\ \{}
\DoxyCodeLine{00056\ \ \ \textcolor{keywordtype}{int}\ cmp\ (\mbox{\hyperlink{struct_o_t_1_1_tag}{Tag}}\ t)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ -\/t.cmp\ (tag);\ \}}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00058\ \ \ HB\_INTERNAL\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ cmp\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *pa,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *pb)}
\DoxyCodeLine{00059\ \ \ \{}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_table_record}{TableRecord}}\ *\mbox{\hyperlink{structa}{a}}\ =\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_table_record}{TableRecord}}\ *)\ pa;}
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_table_record}{TableRecord}}\ *b\ =\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_table_record}{TableRecord}}\ *)\ pb;}
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{keywordflow}{return}\ b-\/>cmp\ (\mbox{\hyperlink{structa}{a}}-\/>tag);}
\DoxyCodeLine{00063\ \ \ \}}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00066\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00067\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00068\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this}));}
\DoxyCodeLine{00069\ \ \ \}}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \ \ \mbox{\hyperlink{struct_o_t_1_1_tag}{Tag}}\ \ \ \ \ \ \ \ tag;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ 4-\/byte\ identifier.\ */}}
\DoxyCodeLine{00072\ \ \ \mbox{\hyperlink{struct_o_t_1_1_check_sum}{CheckSum}}\ \ checkSum;\ \ \ \textcolor{comment}{/*\ CheckSum\ for\ this\ table.\ */}}
\DoxyCodeLine{00073\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset}{Offset32}}\ \ offset;\ \ \ \ \ \textcolor{comment}{/*\ Offset\ from\ beginning\ of\ TrueType\ font}}
\DoxyCodeLine{00074\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ file.\ */}}
\DoxyCodeLine{00075\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT32}}\ \ length;\ \ \ \ \ \textcolor{comment}{/*\ Length\ of\ this\ table.\ */}}
\DoxyCodeLine{00076\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00077\ \ \ DEFINE\_SIZE\_STATIC\ (16);}
\DoxyCodeLine{00078\ \}\ \mbox{\hyperlink{struct_o_t_1_1_table_record}{OpenTypeTable}};}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_open_type_offset_table}{OpenTypeOffsetTable}}}
\DoxyCodeLine{00081\ \{}
\DoxyCodeLine{00082\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_open_type_font_file}{OpenTypeFontFile}};}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_table\_count\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ tables.len;\ \}}
\DoxyCodeLine{00085\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_table_record}{TableRecord}}\&\ get\_table\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00086\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ tables[i];\ \}}
\DoxyCodeLine{00087\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_table\_tags\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \ start\_offset,}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *table\_count,\ \textcolor{comment}{/*\ IN/OUT\ */}}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_tag\_t\ \ \ \ \ *table\_tags\ \textcolor{comment}{/*\ OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{00090\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00091\ \ \ \ \ \textcolor{keywordflow}{if}\ (table\_count)}
\DoxyCodeLine{00092\ \ \ \ \ \{}
\DoxyCodeLine{00093\ \ \ \ \ \ \ +\ tables.sub\_array\ (start\_offset,\ table\_count)}
\DoxyCodeLine{00094\ \ \ \ \ \ \ |\ hb\_map\ (\&TableRecord::tag)}
\DoxyCodeLine{00095\ \ \ \ \ \ \ |\ hb\_sink\ (hb\_array\ (table\_tags,\ *table\_count))}
\DoxyCodeLine{00096\ \ \ \ \ \ \ ;}
\DoxyCodeLine{00097\ \ \ \ \ \}}
\DoxyCodeLine{00098\ \ \ \ \ \textcolor{keywordflow}{return}\ tables.len;}
\DoxyCodeLine{00099\ \ \ \}}
\DoxyCodeLine{00100\ \ \ \textcolor{keywordtype}{bool}\ find\_table\_index\ (hb\_tag\_t\ tag,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *table\_index)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00101\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00102\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_tag}{Tag}}\ t;}
\DoxyCodeLine{00103\ \ \ \ \ t\ =\ tag;}
\DoxyCodeLine{00104\ \ \ \ \ \textcolor{comment}{/*\ Use\ lfind\ for\ small\ fonts;\ there\ are\ fonts\ that\ have\ unsorted\ table\ entries;}}
\DoxyCodeLine{00105\ \textcolor{comment}{\ \ \ \ \ *\ those\ tend\ to\ work\ in\ other\ tools,\ so\ tolerate\ them.}}
\DoxyCodeLine{00106\ \textcolor{comment}{\ \ \ \ \ *\ https://github.com/harfbuzz/harfbuzz/issues/3065\ */}}
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{keywordflow}{if}\ (tables.len\ <\ 16)}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ tables.lfind\ (t,\ table\_index,\ HB\_NOT\_FOUND\_STORE,\ Index::NOT\_FOUND\_INDEX);}
\DoxyCodeLine{00109\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ tables.bfind\ (t,\ table\_index,\ HB\_NOT\_FOUND\_STORE,\ Index::NOT\_FOUND\_INDEX);}
\DoxyCodeLine{00111\ \ \ \}}
\DoxyCodeLine{00112\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_table_record}{TableRecord}}\&\ get\_table\_by\_tag\ (hb\_tag\_t\ tag)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00113\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ table\_index;}
\DoxyCodeLine{00115\ \ \ \ \ find\_table\_index\ (tag,\ \&table\_index);}
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{keywordflow}{return}\ get\_table\ (table\_index);}
\DoxyCodeLine{00117\ \ \ \}}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00119\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Iterator,}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ hb\_requires\ ((\mbox{\hyperlink{structhb__is__source__of}{hb\_is\_source\_of}}<Iterator,\ \mbox{\hyperlink{structhb__pair__t}{hb\_pair\_t<hb\_tag\_t,\ hb\_blob\_t\ *>}}>\mbox{\hyperlink{classvalue}{::value}}))>}
\DoxyCodeLine{00123\ \ \ \textcolor{keywordtype}{bool}\ serialize\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ hb\_tag\_t\ sfnt\_tag,}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ Iterator\ it)}
\DoxyCodeLine{00126\ \ \ \{}
\DoxyCodeLine{00127\ \ \ \ \ TRACE\_SERIALIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00128\ \ \ \ \ \textcolor{comment}{/*\ Alloc\ 12\ for\ the\ OTHeader.\ */}}
\DoxyCodeLine{00129\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>extend\_min\ (\textcolor{keyword}{this})))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{00130\ \ \ \ \ \textcolor{comment}{/*\ Write\ sfntVersion\ (bytes\ 0..3).\ */}}
\DoxyCodeLine{00131\ \ \ \ \ sfnt\_version\ =\ sfnt\_tag;}
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{comment}{/*\ Take\ space\ for\ numTables,\ searchRange,\ entrySelector,\ RangeShift}}
\DoxyCodeLine{00133\ \textcolor{comment}{\ \ \ \ \ *\ and\ the\ TableRecords\ themselves.\ \ */}}
\DoxyCodeLine{00134\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ num\_items\ =\ it.len\ ();}
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!tables.serialize\ (c,\ num\_items)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *dir\_end\ =\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *)\ c-\/>head;}
\DoxyCodeLine{00138\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT32}}\ *checksum\_adjustment\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00140\ \ \ \ \ \textcolor{comment}{/*\ Write\ OffsetTables,\ alloc\ for\ and\ write\ actual\ table\ blobs.\ */}}
\DoxyCodeLine{00141\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ i\ =\ 0;}
\DoxyCodeLine{00142\ \ \ \ \ for\ (\mbox{\hyperlink{structhb__pair__t}{hb\_pair\_t<hb\_tag\_t,\ hb\_blob\_t*>}}\ \mbox{\hyperlink{structentry}{entry}}\ :\ it)}
\DoxyCodeLine{00143\ \ \ \ \ \{}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \mbox{\hyperlink{structhb__blob__t}{hb\_blob\_t}}\ *blob\ =\ \mbox{\hyperlink{structentry}{entry}}.second;}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ len\ =\ blob-\/>length;}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00147\ \ \ \ \ \ \ \textcolor{comment}{/*\ Allocate\ room\ for\ the\ table\ and\ copy\ it.\ */}}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ *start\ =\ (\textcolor{keywordtype}{char}\ *)\ c-\/>allocate\_size<\textcolor{keywordtype}{void}>\ (len);}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!start))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00151\ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_table_record}{TableRecord}}\ \&rec\ =\ tables.arrayZ[i];}
\DoxyCodeLine{00152\ \ \ \ \ \ \ rec.tag\ =\ \mbox{\hyperlink{structentry}{entry}}.first;}
\DoxyCodeLine{00153\ \ \ \ \ \ \ rec.length\ =\ len;}
\DoxyCodeLine{00154\ \ \ \ \ \ \ rec.offset\ =\ 0;}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>check\_assign\ (rec.offset,}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned})\ ((\textcolor{keywordtype}{char}\ *)\ start\ -\/\ (\textcolor{keywordtype}{char}\ *)\ \textcolor{keyword}{this}),}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ HB\_SERIALIZE\_ERROR\_OFFSET\_OVERFLOW)))}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00160\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (likely\ (len))}
\DoxyCodeLine{00161\ \ \ \ \ memcpy\ (start,\ blob-\/>data,\ len);}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00163\ \ \ \ \ \ \ \textcolor{comment}{/*\ 4-\/byte\ alignment.\ */}}
\DoxyCodeLine{00164\ \ \ \ \ \ \ c-\/>align\ (4);}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *end\ =\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *)\ c-\/>head;}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00167\ \ \ \ \ \ \ if\ (\mbox{\hyperlink{structentry}{entry}}.first\ ==\ HB\_OT\_TAG\_head\ \&\&}
\DoxyCodeLine{00168\ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned})\ (end\ -\/\ start)\ >=\ head::static\_size)}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00170\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1head}{head}}\ *h\ =\ (\mbox{\hyperlink{struct_o_t_1_1head}{head}}\ *)\ start;}
\DoxyCodeLine{00171\ \ \ \ \ checksum\_adjustment\ =\ \&h-\/>checkSumAdjustment;}
\DoxyCodeLine{00172\ \ \ \ \ *checksum\_adjustment\ =\ 0;}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \ \ \ \ \ \ rec.checkSum.set\_for\_data\ (start,\ end\ -\/\ start);}
\DoxyCodeLine{00176\ \ \ \ \ \ \ i++;}
\DoxyCodeLine{00177\ \ \ \ \ \}}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \ \ \ \ tables.qsort\ ();}
\DoxyCodeLine{00180\ }
\DoxyCodeLine{00181\ \ \ \ \ \textcolor{keywordflow}{if}\ (checksum\_adjustment)}
\DoxyCodeLine{00182\ \ \ \ \ \{}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_check_sum}{CheckSum}}\ checksum;}
\DoxyCodeLine{00184\ }
\DoxyCodeLine{00185\ \ \ \ \ \ \ \textcolor{comment}{/*\ The\ following\ line\ is\ a\ slower\ version\ of\ the\ following\ block.\ */}}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \textcolor{comment}{//checksum.set\_for\_data\ (this,\ (const\ char\ *)\ c-\/>head\ -\/\ (const\ char\ *)\ this);}}
\DoxyCodeLine{00187\ \ \ \ \ \ \ checksum.set\_for\_data\ (\textcolor{keyword}{this},\ dir\_end\ -\/\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *)\ \textcolor{keyword}{this});}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_items;\ i++)}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00190\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_table_record}{TableRecord}}\ \&rec\ =\ tables.arrayZ[i];}
\DoxyCodeLine{00191\ \ \ \ \ checksum\ =\ checksum\ +\ rec.checkSum;}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \ \ \ \ *checksum\_adjustment\ =\ 0xB1B0AFBAu\ -\/\ checksum;}
\DoxyCodeLine{00195\ \ \ \ \ \}}
\DoxyCodeLine{00196\ }
\DoxyCodeLine{00197\ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{00198\ \ \ \}}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00200\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00201\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00202\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00203\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this})\ \&\&\ tables.sanitize\ (c));}
\DoxyCodeLine{00204\ \ \ \}}
\DoxyCodeLine{00205\ }
\DoxyCodeLine{00206\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00207\ \ \ \mbox{\hyperlink{struct_o_t_1_1_tag}{Tag}}\ \ \ \ \ \ \ \ sfnt\_version;\ \ \ \textcolor{comment}{/*\ '\(\backslash\)0\(\backslash\)001\(\backslash\)0\(\backslash\)00'\ if\ TrueType\ /\ 'OTTO'\ if\ CFF\ */}}
\DoxyCodeLine{00208\ \ \ \mbox{\hyperlink{struct_o_t_1_1_sorted_array_of}{BinSearchArrayOf<TableRecord>}}}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ tables;}
\DoxyCodeLine{00210\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00211\ \ \ DEFINE\_SIZE\_ARRAY\ (12,\ tables);}
\DoxyCodeLine{00212\ \}\ \mbox{\hyperlink{struct_o_t_1_1_open_type_offset_table}{OpenTypeFontFace}};}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00214\ }
\DoxyCodeLine{00215\ \textcolor{comment}{/*}}
\DoxyCodeLine{00216\ \textcolor{comment}{\ *\ TrueType\ Collections}}
\DoxyCodeLine{00217\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00218\ }
\DoxyCodeLine{00219\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_t_t_c_header_version1}{TTCHeaderVersion1}}}
\DoxyCodeLine{00220\ \{}
\DoxyCodeLine{00221\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_t_t_c_header}{TTCHeader}};}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00223\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_face\_count\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ table.len;\ \}}
\DoxyCodeLine{00224\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_open_type_offset_table}{OpenTypeFontFace}}\&\ get\_face\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{this}+table[i];\ \}}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00226\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00227\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00228\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00229\ \ \ \ \ return\_trace\ (table.sanitize\ (c,\ \textcolor{keyword}{this}));}
\DoxyCodeLine{00230\ \ \ \}}
\DoxyCodeLine{00231\ }
\DoxyCodeLine{00232\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00233\ \ \ \mbox{\hyperlink{struct_o_t_1_1_tag}{Tag}}\ \ \ \ \ \ \ \ ttcTag;\ \ \ \ \ \textcolor{comment}{/*\ TrueType\ Collection\ ID\ string:\ 'ttcf'\ */}}
\DoxyCodeLine{00234\ \ \ \mbox{\hyperlink{struct_o_t_1_1_fixed_version}{FixedVersion<>}}version;\ \ \textcolor{comment}{/*\ Version\ of\ the\ TTC\ Header\ (1.0),}}
\DoxyCodeLine{00235\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ 0x00010000u\ */}}
\DoxyCodeLine{00236\ \ \ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array32Of<Offset32To<OpenTypeOffsetTable>}}>}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ table;\ \ \ \ \ \ \textcolor{comment}{/*\ Array\ of\ offsets\ to\ the\ OffsetTable\ for\ each\ font}}
\DoxyCodeLine{00238\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ from\ the\ beginning\ of\ the\ file\ */}}
\DoxyCodeLine{00239\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00240\ \ \ DEFINE\_SIZE\_ARRAY\ (12,\ table);}
\DoxyCodeLine{00241\ \};}
\DoxyCodeLine{00242\ }
\DoxyCodeLine{00243\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_t_t_c_header}{TTCHeader}}}
\DoxyCodeLine{00244\ \{}
\DoxyCodeLine{00245\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_open_type_font_file}{OpenTypeFontFile}};}
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00247\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00248\ }
\DoxyCodeLine{00249\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_face\_count\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00250\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00251\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.header.version.major)\ \{}
\DoxyCodeLine{00252\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ \textcolor{comment}{/*\ version\ 2\ is\ compatible\ with\ version\ 1\ */}}
\DoxyCodeLine{00253\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \textcolor{keywordflow}{return}\ u.version1.get\_face\_count\ ();}
\DoxyCodeLine{00254\ \ \ \ \ \textcolor{keywordflow}{default}:\textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00255\ \ \ \ \ \}}
\DoxyCodeLine{00256\ \ \ \}}
\DoxyCodeLine{00257\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_open_type_offset_table}{OpenTypeFontFace}}\&\ get\_face\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00258\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00259\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.header.version.major)\ \{}
\DoxyCodeLine{00260\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ \textcolor{comment}{/*\ version\ 2\ is\ compatible\ with\ version\ 1\ */}}
\DoxyCodeLine{00261\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \textcolor{keywordflow}{return}\ u.version1.get\_face\ (i);}
\DoxyCodeLine{00262\ \ \ \ \ \textcolor{keywordflow}{default}:\textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_null}{Null}}\ (\mbox{\hyperlink{struct_o_t_1_1_open_type_offset_table}{OpenTypeFontFace}});}
\DoxyCodeLine{00263\ \ \ \ \ \}}
\DoxyCodeLine{00264\ \ \ \}}
\DoxyCodeLine{00265\ }
\DoxyCodeLine{00266\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00267\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00268\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00269\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!u.header.version.sanitize\ (c)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{00270\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.header.version.major)\ \{}
\DoxyCodeLine{00271\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ \textcolor{comment}{/*\ version\ 2\ is\ compatible\ with\ version\ 1\ */}}
\DoxyCodeLine{00272\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ return\_trace\ (u.version1.sanitize\ (c));}
\DoxyCodeLine{00273\ \ \ \ \ \textcolor{keywordflow}{default}:return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{00274\ \ \ \ \ \}}
\DoxyCodeLine{00275\ \ \ \}}
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00277\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00278\ \ \ \textcolor{keyword}{union\ }\{}
\DoxyCodeLine{00279\ \ \ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{00280\ \ \ \mbox{\hyperlink{struct_o_t_1_1_tag}{Tag}}\ \ \ \ \ \ \ \ ttcTag;\ \ \ \ \ \textcolor{comment}{/*\ TrueType\ Collection\ ID\ string:\ 'ttcf'\ */}}
\DoxyCodeLine{00281\ \ \ \mbox{\hyperlink{struct_o_t_1_1_fixed_version}{FixedVersion<>}}version;\ \ \textcolor{comment}{/*\ Version\ of\ the\ TTC\ Header\ (1.0\ or\ 2.0),}}
\DoxyCodeLine{00282\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ 0x00010000u\ or\ 0x00020000u\ */}}
\DoxyCodeLine{00283\ \ \ \}\ \ \ \ \ \ \ \ \ header;}
\DoxyCodeLine{00284\ \ \ \mbox{\hyperlink{struct_o_t_1_1_t_t_c_header_version1}{TTCHeaderVersion1}}\ \ \ \ version1;}
\DoxyCodeLine{00285\ \ \ \}\ u;}
\DoxyCodeLine{00286\ \};}
\DoxyCodeLine{00287\ }
\DoxyCodeLine{00288\ \textcolor{comment}{/*}}
\DoxyCodeLine{00289\ \textcolor{comment}{\ *\ Mac\ Resource\ Fork}}
\DoxyCodeLine{00290\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00291\ \textcolor{comment}{\ *\ http://mirror.informatimago.com/next/developer.apple.com/documentation/mac/MoreToolbox/MoreToolbox-\/99.html}}
\DoxyCodeLine{00292\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00293\ }
\DoxyCodeLine{00294\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_resource_record}{ResourceRecord}}}
\DoxyCodeLine{00295\ \{}
\DoxyCodeLine{00296\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_open_type_offset_table}{OpenTypeFontFace}}\ \&\ get\_face\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *data\_base)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00297\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ *\ \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{struct_o_t_1_1_open_type_offset_table}{OpenTypeFontFace}}\ *\textcolor{keyword}{>}\ ((data\_base+offset).arrayZ);\ \}}
\DoxyCodeLine{00298\ }
\DoxyCodeLine{00299\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c,}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *data\_base)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00301\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00302\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00303\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this})\ \&\&}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \ \ offset.sanitize\ (c,\ data\_base)\ \&\&}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \ \ get\_face\ (data\_base).sanitize\ (c));}
\DoxyCodeLine{00306\ \ \ \}}
\DoxyCodeLine{00307\ }
\DoxyCodeLine{00308\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00309\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ id;\ \ \ \ \ \textcolor{comment}{/*\ Resource\ ID.\ */}}
\DoxyCodeLine{00310\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBINT16}}\ \ \ \ nameOffset;\ \textcolor{comment}{/*\ Offset\ from\ beginning\ of\ resource\ name\ list}}
\DoxyCodeLine{00311\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ to\ resource\ name,\ -\/1\ means\ there\ is\ none.\ */}}
\DoxyCodeLine{00312\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT8}}\ \ \ \ attrs;\ \ \ \ \ \ \textcolor{comment}{/*\ Resource\ attributes\ */}}
\DoxyCodeLine{00313\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{NNOffset24To<Array32Of<HBUINT8>}}>}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ offset;\ \ \ \ \ \textcolor{comment}{/*\ Offset\ from\ beginning\ of\ data\ block\ to}}
\DoxyCodeLine{00315\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ data\ for\ this\ resource\ */}}
\DoxyCodeLine{00316\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT32}}\ \ reserved;\ \ \ \textcolor{comment}{/*\ Reserved\ for\ handle\ to\ resource\ */}}
\DoxyCodeLine{00317\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00318\ \ \ DEFINE\_SIZE\_STATIC\ (12);}
\DoxyCodeLine{00319\ \};}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00321\ \textcolor{preprocessor}{\#define\ HB\_TAG\_sfnt\ HB\_TAG\ ('s','f','n','t')}}
\DoxyCodeLine{00322\ }
\DoxyCodeLine{00323\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_resource_type_record}{ResourceTypeRecord}}}
\DoxyCodeLine{00324\ \{}
\DoxyCodeLine{00325\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_resource\_count\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00326\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ tag\ ==\ HB\_TAG\_sfnt\ ?\ resCountM1\ +\ 1\ :\ 0;\ \}}
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00328\ \ \ \textcolor{keywordtype}{bool}\ is\_sfnt\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ tag\ ==\ HB\_TAG\_sfnt;\ \}}
\DoxyCodeLine{00329\ }
\DoxyCodeLine{00330\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_resource_record}{ResourceRecord}}\&\ get\_resource\_record\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i,}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *type\_base)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00332\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ (type\_base+resourcesZ).as\_array\ (get\_resource\_count\ ())[i];\ \}}
\DoxyCodeLine{00333\ }
\DoxyCodeLine{00334\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c,}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *type\_base,}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *data\_base)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00337\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00338\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00339\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this})\ \&\&}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \ \ resourcesZ.sanitize\ (c,\ type\_base,}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_resource\_count\ (),}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ data\_base));}
\DoxyCodeLine{00343\ \ \ \}}
\DoxyCodeLine{00344\ }
\DoxyCodeLine{00345\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00346\ \ \ \mbox{\hyperlink{struct_o_t_1_1_tag}{Tag}}\ \ \ \ \ \ \ \ tag;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Resource\ type.\ */}}
\DoxyCodeLine{00347\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ resCountM1;\ \textcolor{comment}{/*\ Number\ of\ resources\ minus\ 1.\ */}}
\DoxyCodeLine{00348\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{NNOffset16To<UnsizedArrayOf<ResourceRecord>}}>}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ resourcesZ;\ \textcolor{comment}{/*\ Offset\ from\ beginning\ of\ resource\ type\ list}}
\DoxyCodeLine{00350\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ to\ reference\ item\ list\ for\ this\ type.\ */}}
\DoxyCodeLine{00351\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00352\ \ \ DEFINE\_SIZE\_STATIC\ (8);}
\DoxyCodeLine{00353\ \};}
\DoxyCodeLine{00354\ }
\DoxyCodeLine{00355\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_resource_map}{ResourceMap}}}
\DoxyCodeLine{00356\ \{}
\DoxyCodeLine{00357\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_face\_count\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00358\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00359\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ get\_type\_count\ ();}
\DoxyCodeLine{00360\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{00361\ \ \ \ \ \{}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_resource_type_record}{ResourceTypeRecord}}\&\ type\ =\ get\_type\_record\ (i);}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (type.is\_sfnt\ ())}
\DoxyCodeLine{00364\ \ \ \ \ \textcolor{keywordflow}{return}\ type.get\_resource\_count\ ();}
\DoxyCodeLine{00365\ \ \ \ \ \}}
\DoxyCodeLine{00366\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00367\ \ \ \}}
\DoxyCodeLine{00368\ }
\DoxyCodeLine{00369\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_open_type_offset_table}{OpenTypeFontFace}}\&\ get\_face\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ idx,}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *data\_base)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00371\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00372\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ get\_type\_count\ ();}
\DoxyCodeLine{00373\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{00374\ \ \ \ \ \{}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_resource_type_record}{ResourceTypeRecord}}\&\ type\ =\ get\_type\_record\ (i);}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \textcolor{comment}{/*\ The\ check\ for\ idx\ <\ count\ is\ here\ because\ ResourceRecord\ is\ NOT\ null-\/safe.}}
\DoxyCodeLine{00377\ \textcolor{comment}{\ \ \ \ \ \ \ *\ Because\ an\ offset\ of\ 0\ there\ does\ NOT\ mean\ null.\ */}}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (type.is\_sfnt\ ()\ \&\&\ idx\ <\ type.get\_resource\_count\ ())}
\DoxyCodeLine{00379\ \ \ \ \ \textcolor{keywordflow}{return}\ type.get\_resource\_record\ (idx,\ \&(\textcolor{keyword}{this}+typeList)).get\_face\ (data\_base);}
\DoxyCodeLine{00380\ \ \ \ \ \}}
\DoxyCodeLine{00381\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_null}{Null}}\ (\mbox{\hyperlink{struct_o_t_1_1_open_type_offset_table}{OpenTypeFontFace}});}
\DoxyCodeLine{00382\ \ \ \}}
\DoxyCodeLine{00383\ }
\DoxyCodeLine{00384\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *data\_base)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00385\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00386\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00387\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this})\ \&\&}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \ \ typeList.sanitize\ (c,\ \textcolor{keyword}{this},}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&(\textcolor{keyword}{this}+typeList),}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ data\_base));}
\DoxyCodeLine{00391\ \ \ \}}
\DoxyCodeLine{00392\ }
\DoxyCodeLine{00393\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00394\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_type\_count\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{this}+typeList).lenM1\ +\ 1;\ \}}
\DoxyCodeLine{00395\ }
\DoxyCodeLine{00396\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_resource_type_record}{ResourceTypeRecord}}\&\ get\_type\_record\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00397\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{this}+typeList)[i];\ \}}
\DoxyCodeLine{00398\ }
\DoxyCodeLine{00399\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00400\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT8}}\ \ \ \ reserved0[16];\ \ \textcolor{comment}{/*\ Reserved\ for\ copy\ of\ resource\ header\ */}}
\DoxyCodeLine{00401\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT32}}\ \ reserved1;\ \ \textcolor{comment}{/*\ Reserved\ for\ handle\ to\ next\ resource\ map\ */}}
\DoxyCodeLine{00402\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ resreved2;\ \ \textcolor{comment}{/*\ Reserved\ for\ file\ reference\ number\ */}}
\DoxyCodeLine{00403\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ attrs;\ \ \ \ \ \ \textcolor{comment}{/*\ Resource\ fork\ attribute\ */}}
\DoxyCodeLine{00404\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{NNOffset16To<ArrayOfM1<ResourceTypeRecord>}}>}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \ \ typeList;\ \ \ \textcolor{comment}{/*\ Offset\ from\ beginning\ of\ map\ to}}
\DoxyCodeLine{00406\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ resource\ type\ list\ */}}
\DoxyCodeLine{00407\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset}{Offset16}}\ \ nameList;\ \ \ \textcolor{comment}{/*\ Offset\ from\ beginning\ of\ map\ to}}
\DoxyCodeLine{00408\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ resource\ name\ list\ */}}
\DoxyCodeLine{00409\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00410\ \ \ DEFINE\_SIZE\_STATIC\ (28);}
\DoxyCodeLine{00411\ \};}
\DoxyCodeLine{00412\ }
\DoxyCodeLine{00413\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_resource_fork_header}{ResourceForkHeader}}}
\DoxyCodeLine{00414\ \{}
\DoxyCodeLine{00415\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_face\_count\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00416\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{this}+map).get\_face\_count\ ();\ \}}
\DoxyCodeLine{00417\ }
\DoxyCodeLine{00418\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_open_type_offset_table}{OpenTypeFontFace}}\&\ get\_face\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ idx,}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *base\_offset\ =\ \textcolor{keyword}{nullptr})\textcolor{keyword}{\ const}}
\DoxyCodeLine{00420\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00421\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_open_type_offset_table}{OpenTypeFontFace}}\ \&face\ =\ (\textcolor{keyword}{this}+map).get\_face\ (idx,\ \&(\textcolor{keyword}{this}+\mbox{\hyperlink{structdata}{data}}));}
\DoxyCodeLine{00422\ \ \ \ \ \textcolor{keywordflow}{if}\ (base\_offset)}
\DoxyCodeLine{00423\ \ \ \ \ \ \ *base\_offset\ =\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *)\ \&face\ -\/\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *)\ \textcolor{keyword}{this};}
\DoxyCodeLine{00424\ \ \ \ \ \textcolor{keywordflow}{return}\ face;}
\DoxyCodeLine{00425\ \ \ \}}
\DoxyCodeLine{00426\ }
\DoxyCodeLine{00427\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00428\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00429\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00430\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this})\ \&\&}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdata}{data}}.sanitize\ (c,\ \textcolor{keyword}{this},\ dataLen)\ \&\&}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \ \ map.sanitize\ (c,\ \textcolor{keyword}{this},\ \&(\textcolor{keyword}{this}+\mbox{\hyperlink{structdata}{data}})));}
\DoxyCodeLine{00433\ \ \ \}}
\DoxyCodeLine{00434\ }
\DoxyCodeLine{00435\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00436\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{NNOffset32To<UnsizedArrayOf<HBUINT8>}}>}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdata}{data}};\ \ \ \ \ \ \ \textcolor{comment}{/*\ Offset\ from\ beginning\ of\ resource\ fork}}
\DoxyCodeLine{00438\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ to\ resource\ data\ */}}
\DoxyCodeLine{00439\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{NNOffset32To<ResourceMap\ >}}}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ map;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Offset\ from\ beginning\ of\ resource\ fork}}
\DoxyCodeLine{00441\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ to\ resource\ map\ */}}
\DoxyCodeLine{00442\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT32}}\ \ dataLen;\ \ \ \ \textcolor{comment}{/*\ Length\ of\ resource\ data\ */}}
\DoxyCodeLine{00443\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT32}}\ \ mapLen;\ \ \ \ \ \textcolor{comment}{/*\ Length\ of\ resource\ map\ */}}
\DoxyCodeLine{00444\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00445\ \ \ DEFINE\_SIZE\_STATIC\ (16);}
\DoxyCodeLine{00446\ \};}
\DoxyCodeLine{00447\ }
\DoxyCodeLine{00448\ \textcolor{comment}{/*}}
\DoxyCodeLine{00449\ \textcolor{comment}{\ *\ OpenType\ Font\ File}}
\DoxyCodeLine{00450\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00451\ }
\DoxyCodeLine{00452\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_open_type_font_file}{OpenTypeFontFile}}}
\DoxyCodeLine{00453\ \{}
\DoxyCodeLine{00454\ \ \ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{00455\ \ \ \ \ CFFTag\ \ \ \ \ \ =\ HB\_TAG\ (\textcolor{charliteral}{'O'},\textcolor{charliteral}{'T'},\textcolor{charliteral}{'T'},\textcolor{charliteral}{'O'}),\ \textcolor{comment}{/*\ OpenType\ with\ Postscript\ outlines\ */}}
\DoxyCodeLine{00456\ \ \ \ \ TrueTypeTag\ \ \ \ \ =\ HB\_TAG\ (\ 0\ ,\ 1\ ,\ 0\ ,\ 0\ ),\ \textcolor{comment}{/*\ OpenType\ with\ TrueType\ outlines\ */}}
\DoxyCodeLine{00457\ \ \ \ \ TTCTag\ \ \ \ \ \ =\ HB\_TAG\ (\textcolor{charliteral}{'t'},\textcolor{charliteral}{'t'},\textcolor{charliteral}{'c'},\textcolor{charliteral}{'f'}),\ \textcolor{comment}{/*\ TrueType\ Collection\ */}}
\DoxyCodeLine{00458\ \ \ \ \ DFontTag\ \ \ \ \ \ \ \ =\ HB\_TAG\ (\ 0\ ,\ 0\ ,\ 1\ ,\ 0\ ),\ \textcolor{comment}{/*\ DFont\ Mac\ Resource\ Fork\ */}}
\DoxyCodeLine{00459\ \ \ \ \ TrueTag\ \ \ \ \ =\ HB\_TAG\ (\textcolor{charliteral}{'t'},\textcolor{charliteral}{'r'},\textcolor{charliteral}{'u'},\textcolor{charliteral}{'e'}),\ \textcolor{comment}{/*\ Obsolete\ Apple\ TrueType\ */}}
\DoxyCodeLine{00460\ \ \ \ \ Typ1Tag\ \ \ \ \ =\ HB\_TAG\ (\textcolor{charliteral}{'t'},\textcolor{charliteral}{'y'},\textcolor{charliteral}{'p'},\textcolor{charliteral}{'1'})\ \ \textcolor{comment}{/*\ Obsolete\ Apple\ Type1\ font\ in\ SFNT\ container\ */}}
\DoxyCodeLine{00461\ \ \ \};}
\DoxyCodeLine{00462\ }
\DoxyCodeLine{00463\ \ \ hb\_tag\_t\ get\_tag\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ u.tag;\ \}}
\DoxyCodeLine{00464\ }
\DoxyCodeLine{00465\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_face\_count\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00466\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00467\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.tag)\ \{}
\DoxyCodeLine{00468\ \ \ \ \ \textcolor{keywordflow}{case}\ CFFTag:\ \ \ \ \textcolor{comment}{/*\ All\ the\ non-\/collection\ tags\ */}}
\DoxyCodeLine{00469\ \ \ \ \ \textcolor{keywordflow}{case}\ TrueTag:}
\DoxyCodeLine{00470\ \ \ \ \ \textcolor{keywordflow}{case}\ Typ1Tag:}
\DoxyCodeLine{00471\ \ \ \ \ \textcolor{keywordflow}{case}\ TrueTypeTag:\ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{00472\ \ \ \ \ \textcolor{keywordflow}{case}\ TTCTag:\ \ \ \ \textcolor{keywordflow}{return}\ u.ttcHeader.get\_face\_count\ ();}
\DoxyCodeLine{00473\ \ \ \ \ \textcolor{keywordflow}{case}\ DFontTag:\ \ \textcolor{keywordflow}{return}\ u.rfHeader.get\_face\_count\ ();}
\DoxyCodeLine{00474\ \ \ \ \ \textcolor{keywordflow}{default}:\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00475\ \ \ \ \ \}}
\DoxyCodeLine{00476\ \ \ \}}
\DoxyCodeLine{00477\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_open_type_offset_table}{OpenTypeFontFace}}\&\ get\_face\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *base\_offset\ =\ \textcolor{keyword}{nullptr})\textcolor{keyword}{\ const}}
\DoxyCodeLine{00478\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00479\ \ \ \ \ \textcolor{keywordflow}{if}\ (base\_offset)}
\DoxyCodeLine{00480\ \ \ \ \ \ \ *base\_offset\ =\ 0;}
\DoxyCodeLine{00481\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.tag)\ \{}
\DoxyCodeLine{00482\ \ \ \ \ \textcolor{comment}{/*\ Note:\ for\ non-\/collection\ SFNT\ data\ we\ ignore\ index.\ \ This\ is\ because}}
\DoxyCodeLine{00483\ \textcolor{comment}{\ \ \ \ \ *\ Apple\ dfont\ container\ is\ a\ container\ of\ SFNT's.\ \ So\ each\ SFNT\ is\ a}}
\DoxyCodeLine{00484\ \textcolor{comment}{\ \ \ \ \ *\ non-\/TTC,\ but\ the\ index\ is\ more\ than\ zero.\ */}}
\DoxyCodeLine{00485\ \ \ \ \ \textcolor{keywordflow}{case}\ CFFTag:\ \ \ \ \textcolor{comment}{/*\ All\ the\ non-\/collection\ tags\ */}}
\DoxyCodeLine{00486\ \ \ \ \ \textcolor{keywordflow}{case}\ TrueTag:}
\DoxyCodeLine{00487\ \ \ \ \ \textcolor{keywordflow}{case}\ Typ1Tag:}
\DoxyCodeLine{00488\ \ \ \ \ \textcolor{keywordflow}{case}\ TrueTypeTag:\ \ \ \textcolor{keywordflow}{return}\ u.fontFace;}
\DoxyCodeLine{00489\ \ \ \ \ \textcolor{keywordflow}{case}\ TTCTag:\ \ \ \ \textcolor{keywordflow}{return}\ u.ttcHeader.get\_face\ (i);}
\DoxyCodeLine{00490\ \ \ \ \ \textcolor{keywordflow}{case}\ DFontTag:\ \ \textcolor{keywordflow}{return}\ u.rfHeader.get\_face\ (i,\ base\_offset);}
\DoxyCodeLine{00491\ \ \ \ \ \textcolor{keywordflow}{default}:\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_null}{Null}}\ (\mbox{\hyperlink{struct_o_t_1_1_open_type_offset_table}{OpenTypeFontFace}});}
\DoxyCodeLine{00492\ \ \ \ \ \}}
\DoxyCodeLine{00493\ \ \ \}}
\DoxyCodeLine{00494\ }
\DoxyCodeLine{00495\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Iterator,}
\DoxyCodeLine{00496\ \ \ \ \ \ \ \ \ hb\_requires\ ((\mbox{\hyperlink{structhb__is__source__of}{hb\_is\_source\_of}}<Iterator,\ \mbox{\hyperlink{structhb__pair__t}{hb\_pair\_t<hb\_tag\_t,\ hb\_blob\_t\ *>}}>\mbox{\hyperlink{classvalue}{::value}}))>}
\DoxyCodeLine{00497\ \ \ \textcolor{keywordtype}{bool}\ serialize\_single\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{00498\ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_tag\_t\ sfnt\_tag,}
\DoxyCodeLine{00499\ \ \ \ \ \ \ \ \ \ \ \ \ \ Iterator\ items)}
\DoxyCodeLine{00500\ \ \ \{}
\DoxyCodeLine{00501\ \ \ \ \ TRACE\_SERIALIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00502\ \ \ \ \ assert\ (sfnt\_tag\ !=\ TTCTag);}
\DoxyCodeLine{00503\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>extend\_min\ (\textcolor{keyword}{this})))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{00504\ \ \ \ \ return\_trace\ (u.fontFace.serialize\ (c,\ sfnt\_tag,\ items));}
\DoxyCodeLine{00505\ \ \ \}}
\DoxyCodeLine{00506\ }
\DoxyCodeLine{00507\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00508\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00509\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{00510\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!u.tag.sanitize\ (c)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{00511\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.tag)\ \{}
\DoxyCodeLine{00512\ \ \ \ \ \textcolor{keywordflow}{case}\ CFFTag:\ \ \ \ \textcolor{comment}{/*\ All\ the\ non-\/collection\ tags\ */}}
\DoxyCodeLine{00513\ \ \ \ \ \textcolor{keywordflow}{case}\ TrueTag:}
\DoxyCodeLine{00514\ \ \ \ \ \textcolor{keywordflow}{case}\ Typ1Tag:}
\DoxyCodeLine{00515\ \ \ \ \ \textcolor{keywordflow}{case}\ TrueTypeTag:\ \ \ return\_trace\ (u.fontFace.sanitize\ (c));}
\DoxyCodeLine{00516\ \ \ \ \ \textcolor{keywordflow}{case}\ TTCTag:\ \ \ \ return\_trace\ (u.ttcHeader.sanitize\ (c));}
\DoxyCodeLine{00517\ \ \ \ \ \textcolor{keywordflow}{case}\ DFontTag:\ \ return\_trace\ (u.rfHeader.sanitize\ (c));}
\DoxyCodeLine{00518\ \ \ \ \ \textcolor{keywordflow}{default}:\ \ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{00519\ \ \ \ \ \}}
\DoxyCodeLine{00520\ \ \ \}}
\DoxyCodeLine{00521\ }
\DoxyCodeLine{00522\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00523\ \ \ \textcolor{keyword}{union\ }\{}
\DoxyCodeLine{00524\ \ \ \mbox{\hyperlink{struct_o_t_1_1_tag}{Tag}}\ \ \ \ \ \ \ \ \ \ \ \ tag;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ 4-\/byte\ identifier.\ */}}
\DoxyCodeLine{00525\ \ \ \mbox{\hyperlink{struct_o_t_1_1_open_type_offset_table}{OpenTypeFontFace}}\ \ fontFace;}
\DoxyCodeLine{00526\ \ \ \mbox{\hyperlink{struct_o_t_1_1_t_t_c_header}{TTCHeader}}\ \ \ \ \ \ \ \ ttcHeader;}
\DoxyCodeLine{00527\ \ \ \mbox{\hyperlink{struct_o_t_1_1_resource_fork_header}{ResourceForkHeader}}\ \ rfHeader;}
\DoxyCodeLine{00528\ \ \ \}\ u;}
\DoxyCodeLine{00529\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00530\ \ \ DEFINE\_SIZE\_UNION\ (4,\ tag);}
\DoxyCodeLine{00531\ \};}
\DoxyCodeLine{00532\ }
\DoxyCodeLine{00533\ }
\DoxyCodeLine{00534\ \}\ \textcolor{comment}{/*\ namespace\ OT\ */}}
\DoxyCodeLine{00535\ }
\DoxyCodeLine{00536\ }
\DoxyCodeLine{00537\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*\ HB\_OPEN\_FILE\_HH\ */}\textcolor{preprocessor}{}}

\end{DoxyCode}

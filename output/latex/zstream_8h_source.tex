\hypertarget{zstream_8h_source}{}\doxysection{zstream.\+h}
\label{zstream_8h_source}\index{AseSprite/aseprite/third\_party/zlib/contrib/iostream2/zstream.h@{AseSprite/aseprite/third\_party/zlib/contrib/iostream2/zstream.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ *\ Copyright\ (c)\ 1997}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ *\ Christian\ Michelsen\ Research\ AS}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ *\ Advanced\ Computing}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ *\ Fantoftvegen\ 38,\ 5036\ BERGEN,\ Norway}}
\DoxyCodeLine{00007\ \textcolor{comment}{\ *\ http://www.cmr.no}}
\DoxyCodeLine{00008\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00009\ \textcolor{comment}{\ *\ Permission\ to\ use,\ copy,\ modify,\ distribute\ and\ sell\ this\ software}}
\DoxyCodeLine{00010\ \textcolor{comment}{\ *\ and\ its\ documentation\ for\ any\ purpose\ is\ hereby\ granted\ without\ fee,}}
\DoxyCodeLine{00011\ \textcolor{comment}{\ *\ provided\ that\ the\ above\ copyright\ notice\ appear\ in\ all\ copies\ and}}
\DoxyCodeLine{00012\ \textcolor{comment}{\ *\ that\ both\ that\ copyright\ notice\ and\ this\ permission\ notice\ appear}}
\DoxyCodeLine{00013\ \textcolor{comment}{\ *\ in\ supporting\ documentation.\ \ Christian\ Michelsen\ Research\ AS\ makes\ no}}
\DoxyCodeLine{00014\ \textcolor{comment}{\ *\ representations\ about\ the\ suitability\ of\ this\ software\ for\ any}}
\DoxyCodeLine{00015\ \textcolor{comment}{\ *\ purpose.\ \ It\ is\ provided\ "{}as\ is"{}\ without\ express\ or\ implied\ warranty.}}
\DoxyCodeLine{00016\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00017\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#ifndef\ ZSTREAM\_\_H}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#define\ ZSTREAM\_\_H}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \textcolor{comment}{/*}}
\DoxyCodeLine{00023\ \textcolor{comment}{\ *\ zstream.h\ -\/\ C++\ interface\ to\ the\ 'zlib'\ general\ purpose\ compression\ library}}
\DoxyCodeLine{00024\ \textcolor{comment}{\ *\ \$Id:\ zstream.h\ 1.1\ 1997-\/06-\/25\ 12:00:56+02\ tyge\ Exp\ tyge\ \$}}
\DoxyCodeLine{00025\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ <strstream.h>}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#include\ <string.h>}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#include\ <stdio.h>}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#include\ "{}zlib.h"{}}}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#if\ defined(\_WIN32)}}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#\ \ \ include\ <fcntl.h>}}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#\ \ \ include\ <io.h>}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#\ \ \ define\ SET\_BINARY\_MODE(file)\ setmode(fileno(file),\ O\_BINARY)}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\#\ \ \ define\ SET\_BINARY\_MODE(file)}}
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classzstringlen}{zstringlen}}\ \{}
\DoxyCodeLine{00041\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00042\ \ \ \ \ \mbox{\hyperlink{classzstringlen}{zstringlen}}(\textcolor{keyword}{class}\ \mbox{\hyperlink{classizstream}{izstream}}\&);}
\DoxyCodeLine{00043\ \ \ \ \ \mbox{\hyperlink{classzstringlen}{zstringlen}}(\textcolor{keyword}{class}\ \mbox{\hyperlink{classozstream}{ozstream}}\&,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*);}
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classvalue}{value}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ val.word;\ \}}
\DoxyCodeLine{00045\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keyword}{struct\ }Val\ \{\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ byte;\ \textcolor{keywordtype}{size\_t}\ word;\ \}\ val;}
\DoxyCodeLine{00047\ \};}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \textcolor{comment}{//\ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ izstream\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classizstream}{izstream}}}
\DoxyCodeLine{00052\ \{}
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classizstream}{izstream}}()\ :\ m\_fp(0)\ \{\}}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classizstream}{izstream}}(FILE*\ \mbox{\hyperlink{structbasic__fp}{fp}})\ :\ m\_fp(0)\ \{\ open(\mbox{\hyperlink{structbasic__fp}{fp}});\ \}}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classizstream}{izstream}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ name)\ :\ m\_fp(0)\ \{\ open(name);\ \}}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classizstream}{\string~izstream}}()\ \{\ close();\ \}}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Opens\ a\ gzip\ (.gz)\ file\ for\ reading.}}
\DoxyCodeLine{00060\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ open()\ can\ be\ used\ to\ read\ a\ file\ which\ is\ not\ in\ gzip\ format;}}
\DoxyCodeLine{00061\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ in\ this\ case\ read()\ will\ directly\ read\ from\ the\ file\ without}}
\DoxyCodeLine{00062\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ decompression.\ errno\ can\ be\ checked\ to\ distinguish\ two\ error}}
\DoxyCodeLine{00063\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ cases\ (if\ errno\ is\ zero,\ the\ zlib\ error\ is\ Z\_MEM\_ERROR).}}
\DoxyCodeLine{00064\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ open(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ name)\ \{}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_fp)\ close();}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \ \ \ \ m\_fp\ =\ ::gzopen(name,\ \textcolor{stringliteral}{"{}rb"{}});}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ open(FILE*\ \mbox{\hyperlink{structbasic__fp}{fp}})\ \{}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \ \ \ \ SET\_BINARY\_MODE(\mbox{\hyperlink{structbasic__fp}{fp}});}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_fp)\ close();}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \ \ m\_fp\ =\ ::gzdopen(fileno(\mbox{\hyperlink{structbasic__fp}{fp}}),\ \textcolor{stringliteral}{"{}rb"{}});}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Flushes\ all\ pending\ input\ if\ necessary,\ closes\ the\ compressed\ file}}
\DoxyCodeLine{00077\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ and\ deallocates\ all\ the\ (de)compression\ state.\ The\ return\ value\ is}}
\DoxyCodeLine{00078\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ the\ zlib\ error\ number\ (see\ function\ error()\ below).}}
\DoxyCodeLine{00079\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ close()\ \{}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ r\ =\ ::gzclose(m\_fp);}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \ \ \ \ m\_fp\ =\ 0;\ \textcolor{keywordflow}{return}\ r;}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Binary\ read\ the\ given\ number\ of\ bytes\ from\ the\ compressed\ file.}}
\DoxyCodeLine{00086\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ read(\textcolor{keywordtype}{void}*\ \mbox{\hyperlink{structbuf}{buf}},\ \textcolor{keywordtype}{size\_t}\ len)\ \{}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ return\ ::gzread(m\_fp,\ \mbox{\hyperlink{structbuf}{buf}},\ len);}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Returns\ the\ error\ message\ for\ the\ last\ error\ which\ occurred\ on\ the}}
\DoxyCodeLine{00092\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ given\ compressed\ file.\ errnum\ is\ set\ to\ zlib\ error\ number.\ If\ an}}
\DoxyCodeLine{00093\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ error\ occurred\ in\ the\ file\ system\ and\ not\ in\ the\ compression\ library,}}
\DoxyCodeLine{00094\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ errnum\ is\ set\ to\ Z\_ERRNO\ and\ the\ application\ may\ consult\ errno}}
\DoxyCodeLine{00095\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ to\ get\ the\ exact\ error\ code.}}
\DoxyCodeLine{00096\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ error(\textcolor{keywordtype}{int}*\ errnum)\ \{}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \ \ \ \ return\ ::gzerror(m\_fp,\ errnum);}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structgz_file__s}{gzFile}}\ \mbox{\hyperlink{structbasic__fp}{fp}}()\ \{\ \textcolor{keywordflow}{return}\ m\_fp;\ \}}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structgz_file__s}{gzFile}}\ m\_fp;}
\DoxyCodeLine{00105\ \};}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \textcolor{comment}{/*}}
\DoxyCodeLine{00108\ \textcolor{comment}{\ *\ Binary\ read\ the\ given\ (array\ of)\ object(s)\ from\ the\ compressed\ file.}}
\DoxyCodeLine{00109\ \textcolor{comment}{\ *\ If\ the\ input\ file\ was\ not\ in\ gzip\ format,\ read()\ copies\ the\ objects\ number}}
\DoxyCodeLine{00110\ \textcolor{comment}{\ *\ of\ bytes\ into\ the\ buffer.}}
\DoxyCodeLine{00111\ \textcolor{comment}{\ *\ returns\ the\ number\ of\ uncompressed\ bytes\ actually\ read}}
\DoxyCodeLine{00112\ \textcolor{comment}{\ *\ (0\ for\ end\ of\ file,\ -\/1\ for\ error).}}
\DoxyCodeLine{00113\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00114\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T,\ \textcolor{keyword}{class}\ Items>}
\DoxyCodeLine{00115\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{int}\ read(\mbox{\hyperlink{classizstream}{izstream}}\&\ zs,\ T*\ x,\ Items\ items)\ \{}
\DoxyCodeLine{00116\ \ \ \ \ return\ ::gzread(zs.fp(),\ x,\ items*\textcolor{keyword}{sizeof}(T));}
\DoxyCodeLine{00117\ \}}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00119\ \textcolor{comment}{/*}}
\DoxyCodeLine{00120\ \textcolor{comment}{\ *\ Binary\ input\ with\ the\ '>'\ operator.}}
\DoxyCodeLine{00121\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00122\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00123\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{classizstream}{izstream}}\&\ operator>(\mbox{\hyperlink{classizstream}{izstream}}\&\ zs,\ T\&\ x)\ \{}
\DoxyCodeLine{00124\ \ \ \ \ ::gzread(zs.fp(),\ \&x,\ \textcolor{keyword}{sizeof}(T));}
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{keywordflow}{return}\ zs;}
\DoxyCodeLine{00126\ \}}
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00129\ \textcolor{keyword}{inline}\ zstringlen::zstringlen(\mbox{\hyperlink{classizstream}{izstream}}\&\ zs)\ \{}
\DoxyCodeLine{00130\ \ \ \ \ zs\ >\ val.byte;}
\DoxyCodeLine{00131\ \ \ \ \ \textcolor{keywordflow}{if}\ (val.byte\ ==\ 255)\ zs\ >\ val.word;}
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{keywordflow}{else}\ val.word\ =\ val.byte;}
\DoxyCodeLine{00133\ \}}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00135\ \textcolor{comment}{/*}}
\DoxyCodeLine{00136\ \textcolor{comment}{\ *\ Read\ length\ of\ string\ +\ the\ string\ with\ the\ '>'\ operator.}}
\DoxyCodeLine{00137\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00138\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{classizstream}{izstream}}\&\ operator>(\mbox{\hyperlink{classizstream}{izstream}}\&\ zs,\ \textcolor{keywordtype}{char}*\ x)\ \{}
\DoxyCodeLine{00139\ \ \ \ \ \mbox{\hyperlink{classzstringlen}{zstringlen}}\ len(zs);}
\DoxyCodeLine{00140\ \ \ \ \ ::gzread(zs.fp(),\ x,\ len.value());}
\DoxyCodeLine{00141\ \ \ \ \ x[len.value()]\ =\ \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{keywordflow}{return}\ zs;}
\DoxyCodeLine{00143\ \}}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{char}*\ read\_string(\mbox{\hyperlink{classizstream}{izstream}}\&\ zs)\ \{}
\DoxyCodeLine{00146\ \ \ \ \ \mbox{\hyperlink{classzstringlen}{zstringlen}}\ len(zs);}
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{keywordtype}{char}*\ x\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{char}[len.value()+1];}
\DoxyCodeLine{00148\ \ \ \ \ ::gzread(zs.fp(),\ x,\ len.value());}
\DoxyCodeLine{00149\ \ \ \ \ x[len.value()]\ =\ \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{00150\ \ \ \ \ \textcolor{keywordflow}{return}\ x;}
\DoxyCodeLine{00151\ \}}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ ozstream\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classozstream}{ozstream}}}
\DoxyCodeLine{00156\ \{}
\DoxyCodeLine{00157\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classozstream}{ozstream}}()\ :\ m\_fp(0),\ m\_os(0)\ \{}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classozstream}{ozstream}}(FILE*\ \mbox{\hyperlink{structbasic__fp}{fp}},\ \textcolor{keywordtype}{int}\ level\ =\ Z\_DEFAULT\_COMPRESSION)}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \ \ \ \ :\ m\_fp(0),\ m\_os(0)\ \{}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ open(\mbox{\hyperlink{structbasic__fp}{fp}},\ level);}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classozstream}{ozstream}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ name,\ \textcolor{keywordtype}{int}\ level\ =\ Z\_DEFAULT\_COMPRESSION)}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \ \ \ \ :\ m\_fp(0),\ m\_os(0)\ \{}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \ \ open(name,\ level);}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classozstream}{\string~ozstream}}()\ \{}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \ \ \ \ close();}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Opens\ a\ gzip\ (.gz)\ file\ for\ writing.}}
\DoxyCodeLine{00173\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ The\ compression\ level\ parameter\ should\ be\ in\ 0..9}}
\DoxyCodeLine{00174\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ errno\ can\ be\ checked\ to\ distinguish\ two\ error\ cases}}
\DoxyCodeLine{00175\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ (if\ errno\ is\ zero,\ the\ zlib\ error\ is\ Z\_MEM\_ERROR).}}
\DoxyCodeLine{00176\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ open(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ name,\ \textcolor{keywordtype}{int}\ level\ =\ Z\_DEFAULT\_COMPRESSION)\ \{}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ mode[4]\ =\ \textcolor{stringliteral}{"{}wb\(\backslash\)0"{}};}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (level\ !=\ Z\_DEFAULT\_COMPRESSION)\ mode[2]\ =\ \textcolor{charliteral}{'0'}+level;}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_fp)\ close();}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ m\_fp\ =\ ::gzopen(name,\ mode);}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00183\ }
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ open\ from\ a\ FILE\ pointer.}}
\DoxyCodeLine{00185\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ open(FILE*\ \mbox{\hyperlink{structbasic__fp}{fp}},\ \textcolor{keywordtype}{int}\ level\ =\ Z\_DEFAULT\_COMPRESSION)\ \{}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \ \ \ \ SET\_BINARY\_MODE(\mbox{\hyperlink{structbasic__fp}{fp}});}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ mode[4]\ =\ \textcolor{stringliteral}{"{}wb\(\backslash\)0"{}};}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (level\ !=\ Z\_DEFAULT\_COMPRESSION)\ mode[2]\ =\ \textcolor{charliteral}{'0'}+level;}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_fp)\ close();}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \ \ \ \ m\_fp\ =\ ::gzdopen(fileno(\mbox{\hyperlink{structbasic__fp}{fp}}),\ mode);}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Flushes\ all\ pending\ output\ if\ necessary,\ closes\ the\ compressed\ file}}
\DoxyCodeLine{00195\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ and\ deallocates\ all\ the\ (de)compression\ state.\ The\ return\ value\ is}}
\DoxyCodeLine{00196\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ the\ zlib\ error\ number\ (see\ function\ error()\ below).}}
\DoxyCodeLine{00197\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ close()\ \{}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_os)\ \{}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ::gzwrite(m\_fp,\ m\_os-\/>str(),\ m\_os-\/>pcount());}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ m\_os-\/>str();\ \textcolor{keyword}{delete}\ m\_os;\ m\_os\ =\ 0;}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ r\ =\ ::gzclose(m\_fp);\ m\_fp\ =\ 0;\ \textcolor{keywordflow}{return}\ r;}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00205\ }
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Binary\ write\ the\ given\ number\ of\ bytes\ into\ the\ compressed\ file.}}
\DoxyCodeLine{00207\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ write(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ \mbox{\hyperlink{structbuf}{buf}},\ \textcolor{keywordtype}{size\_t}\ len)\ \{}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \ \ \ \ return\ ::gzwrite(m\_fp,\ (voidp)\ \mbox{\hyperlink{structbuf}{buf}},\ len);}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00211\ }
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Flushes\ all\ pending\ output\ into\ the\ compressed\ file.\ The\ parameter}}
\DoxyCodeLine{00213\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ \_flush\ is\ as\ in\ the\ deflate()\ function.\ The\ return\ value\ is\ the\ zlib}}
\DoxyCodeLine{00214\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ error\ number\ (see\ function\ gzerror\ below).\ flush()\ returns\ Z\_OK\ if}}
\DoxyCodeLine{00215\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ the\ flush\_\ parameter\ is\ Z\_FINISH\ and\ all\ output\ could\ be\ flushed.}}
\DoxyCodeLine{00216\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ flush()\ should\ be\ called\ only\ when\ strictly\ necessary\ because\ it\ can}}
\DoxyCodeLine{00217\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ degrade\ compression.}}
\DoxyCodeLine{00218\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ flush(\textcolor{keywordtype}{int}\ \_flush)\ \{}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \ \ \ \ os\_flush();}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \ \ \ \ return\ ::gzflush(m\_fp,\ \_flush);}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00223\ }
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Returns\ the\ error\ message\ for\ the\ last\ error\ which\ occurred\ on\ the}}
\DoxyCodeLine{00225\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ given\ compressed\ file.\ errnum\ is\ set\ to\ zlib\ error\ number.\ If\ an}}
\DoxyCodeLine{00226\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ error\ occurred\ in\ the\ file\ system\ and\ not\ in\ the\ compression\ library,}}
\DoxyCodeLine{00227\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ errnum\ is\ set\ to\ Z\_ERRNO\ and\ the\ application\ may\ consult\ errno}}
\DoxyCodeLine{00228\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ *\ to\ get\ the\ exact\ error\ code.}}
\DoxyCodeLine{00229\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ error(\textcolor{keywordtype}{int}*\ errnum)\ \{}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \ \ \ \ return\ ::gzerror(m\_fp,\ errnum);}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00233\ }
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structgz_file__s}{gzFile}}\ \mbox{\hyperlink{structbasic__fp}{fp}}()\ \{\ \textcolor{keywordflow}{return}\ m\_fp;\ \}}
\DoxyCodeLine{00235\ }
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ ostream\&\ os()\ \{}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_os\ ==\ 0)\ m\_os\ =\ \textcolor{keyword}{new}\ ostrstream;}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *m\_os;}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00240\ }
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ os\_flush()\ \{}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_os\ \&\&\ m\_os-\/>pcount()>0)\ \{}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ostrstream*\ oss\ =\ \textcolor{keyword}{new}\ ostrstream;}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ oss-\/>fill(m\_os-\/>fill());}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ oss-\/>flags(m\_os-\/>flags());}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ oss-\/>precision(m\_os-\/>precision());}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ oss-\/>width(m\_os-\/>width());}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ::gzwrite(m\_fp,\ m\_os-\/>str(),\ m\_os-\/>pcount());}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ m\_os-\/>str();\ \textcolor{keyword}{delete}\ m\_os;\ m\_os\ =\ oss;}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00252\ }
\DoxyCodeLine{00253\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structgz_file__s}{gzFile}}\ m\_fp;}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ ostrstream*\ m\_os;}
\DoxyCodeLine{00256\ \};}
\DoxyCodeLine{00257\ }
\DoxyCodeLine{00258\ \textcolor{comment}{/*}}
\DoxyCodeLine{00259\ \textcolor{comment}{\ *\ Binary\ write\ the\ given\ (array\ of)\ object(s)\ into\ the\ compressed\ file.}}
\DoxyCodeLine{00260\ \textcolor{comment}{\ *\ returns\ the\ number\ of\ uncompressed\ bytes\ actually\ written}}
\DoxyCodeLine{00261\ \textcolor{comment}{\ *\ (0\ in\ case\ of\ error).}}
\DoxyCodeLine{00262\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00263\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T,\ \textcolor{keyword}{class}\ Items>}
\DoxyCodeLine{00264\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{int}\ write(\mbox{\hyperlink{classozstream}{ozstream}}\&\ zs,\ \textcolor{keyword}{const}\ T*\ x,\ Items\ items)\ \{}
\DoxyCodeLine{00265\ \ \ \ \ return\ ::gzwrite(zs.fp(),\ (voidp)\ x,\ items*\textcolor{keyword}{sizeof}(T));}
\DoxyCodeLine{00266\ \}}
\DoxyCodeLine{00267\ }
\DoxyCodeLine{00268\ \textcolor{comment}{/*}}
\DoxyCodeLine{00269\ \textcolor{comment}{\ *\ Binary\ output\ with\ the\ '<'\ operator.}}
\DoxyCodeLine{00270\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00271\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00272\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{classozstream}{ozstream}}\&\ operator<(\mbox{\hyperlink{classozstream}{ozstream}}\&\ zs,\ \textcolor{keyword}{const}\ T\&\ x)\ \{}
\DoxyCodeLine{00273\ \ \ \ \ ::gzwrite(zs.fp(),\ (voidp)\ \&x,\ \textcolor{keyword}{sizeof}(T));}
\DoxyCodeLine{00274\ \ \ \ \ \textcolor{keywordflow}{return}\ zs;}
\DoxyCodeLine{00275\ \}}
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00277\ \textcolor{keyword}{inline}\ zstringlen::zstringlen(\mbox{\hyperlink{classozstream}{ozstream}}\&\ zs,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ x)\ \{}
\DoxyCodeLine{00278\ \ \ \ \ val.byte\ =\ 255;\ \ val.word\ =\ ::strlen(x);}
\DoxyCodeLine{00279\ \ \ \ \ \textcolor{keywordflow}{if}\ (val.word\ <\ 255)\ zs\ <\ (val.byte\ =\ val.word);}
\DoxyCodeLine{00280\ \ \ \ \ \textcolor{keywordflow}{else}\ zs\ <\ val;}
\DoxyCodeLine{00281\ \}}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00283\ \textcolor{comment}{/*}}
\DoxyCodeLine{00284\ \textcolor{comment}{\ *\ Write\ length\ of\ string\ +\ the\ string\ with\ the\ '<'\ operator.}}
\DoxyCodeLine{00285\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00286\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{classozstream}{ozstream}}\&\ operator<(\mbox{\hyperlink{classozstream}{ozstream}}\&\ zs,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ x)\ \{}
\DoxyCodeLine{00287\ \ \ \ \ \mbox{\hyperlink{classzstringlen}{zstringlen}}\ len(zs,\ x);}
\DoxyCodeLine{00288\ \ \ \ \ ::gzwrite(zs.fp(),\ (voidp)\ x,\ len.value());}
\DoxyCodeLine{00289\ \ \ \ \ \textcolor{keywordflow}{return}\ zs;}
\DoxyCodeLine{00290\ \}}
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00292\ \textcolor{preprocessor}{\#ifdef\ \_MSC\_VER}}
\DoxyCodeLine{00293\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{classozstream}{ozstream}}\&\ operator<(\mbox{\hyperlink{classozstream}{ozstream}}\&\ zs,\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\&\ x)\ \{}
\DoxyCodeLine{00294\ \ \ \ \ \textcolor{keywordflow}{return}\ zs\ <\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*)\ x;}
\DoxyCodeLine{00295\ \}}
\DoxyCodeLine{00296\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00297\ }
\DoxyCodeLine{00298\ \textcolor{comment}{/*}}
\DoxyCodeLine{00299\ \textcolor{comment}{\ *\ Ascii\ write\ with\ the\ <<\ operator;}}
\DoxyCodeLine{00300\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00301\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00302\ \textcolor{keyword}{inline}\ ostream\&\ operator<<(\mbox{\hyperlink{classozstream}{ozstream}}\&\ zs,\ \textcolor{keyword}{const}\ T\&\ x)\ \{}
\DoxyCodeLine{00303\ \ \ \ \ zs.os\_flush();}
\DoxyCodeLine{00304\ \ \ \ \ \textcolor{keywordflow}{return}\ zs.os()\ <<\ x;}
\DoxyCodeLine{00305\ \}}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00307\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}

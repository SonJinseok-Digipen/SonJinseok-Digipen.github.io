Every once in a while someone comes up with the idea of adding support for yet another protocol to curl. After all, curl already supports 25 something protocols and it is the Internet transfer machine for the world.

In the curl project we love protocols and we love supporting many protocols and do it well.

So how do you proceed to add a new protocol and what are the requirements?\hypertarget{md__ase_sprite_aseprite_third_party_curl_docs__n_e_w__p_r_o_t_o_c_o_l_autotoc_md1141}{}\doxysection{No fixed set of requirements}\label{md__ase_sprite_aseprite_third_party_curl_docs__n_e_w__p_r_o_t_o_c_o_l_autotoc_md1141}
This document is an attempt to describe things to consider. There is no checklist of the twenty-\/seven things you need to cross off. We view the entire effort as a whole and then judge if it seems to be the right thing -\/ for now. The more things that look right, fit our patterns and are done in ways that align with our thinking, the better are the chances that we will agree that supporting this protocol is a grand idea.\hypertarget{md__ase_sprite_aseprite_third_party_curl_docs__n_e_w__p_r_o_t_o_c_o_l_autotoc_md1142}{}\doxysection{Mutual benefit is preferred}\label{md__ase_sprite_aseprite_third_party_curl_docs__n_e_w__p_r_o_t_o_c_o_l_autotoc_md1142}
curl is not here for your protocol. Your protocol is not here for curl. The best cooperation and end result occur when all involved parties mutually see and agree that supporting this protocol in curl would be good for everyone. Heck, for the world!

Consider \char`\"{}selling us\char`\"{} the idea that we need an implementation merged in curl, to be fairly important. {\itshape Why} do we want curl to support this new protocol?\hypertarget{md__ase_sprite_aseprite_third_party_curl_docs__n_e_w__p_r_o_t_o_c_o_l_autotoc_md1143}{}\doxysection{Protocol requirements}\label{md__ase_sprite_aseprite_third_party_curl_docs__n_e_w__p_r_o_t_o_c_o_l_autotoc_md1143}
\hypertarget{md__ase_sprite_aseprite_third_party_curl_docs__n_e_w__p_r_o_t_o_c_o_l_autotoc_md1144}{}\doxysubsection{Client-\/side}\label{md__ase_sprite_aseprite_third_party_curl_docs__n_e_w__p_r_o_t_o_c_o_l_autotoc_md1144}
The protocol implementation is for a client\textquotesingle{}s side of a \char`\"{}communication session\char`\"{}.\hypertarget{md__ase_sprite_aseprite_third_party_curl_docs__n_e_w__p_r_o_t_o_c_o_l_autotoc_md1145}{}\doxysubsection{Transfer oriented}\label{md__ase_sprite_aseprite_third_party_curl_docs__n_e_w__p_r_o_t_o_c_o_l_autotoc_md1145}
The protocol itself should be focused on {\itshape transfers}. Be it uploads or downloads or both. It should at least be possible to view the transfers as such, like we can view reading emails over \mbox{\hyperlink{struct_p_o_p3}{POP3}} as a download and sending emails over \mbox{\hyperlink{struct_s_m_t_p}{SMTP}} as an upload.

If you cannot even shoehorn the protocol into a transfer focused view, then you are up for a tough argument.\hypertarget{md__ase_sprite_aseprite_third_party_curl_docs__n_e_w__p_r_o_t_o_c_o_l_autotoc_md1146}{}\doxysubsection{URL}\label{md__ase_sprite_aseprite_third_party_curl_docs__n_e_w__p_r_o_t_o_c_o_l_autotoc_md1146}
There should be a documented URL format. If there is an RFC for it there is no question about it but the syntax doesn\textquotesingle{}t have to be a published RFC. It could be enough if it is already in use by other implementations.

If you make up the syntax just in order to be able to propose it to curl, then you are in a bad place. URLs are designed and defined for interoperability. There should at least be a good chance that other clients and servers can be implemented supporting the same URL syntax and work the same or similar way.

URLs work on registered \textquotesingle{}schemes\textquotesingle{}. There is a register of \mbox{[}all officially recognized schemes\mbox{]}(\href{https://www.iana.org/assignments/uri-schemes/uri-schemes.xhtml}{\texttt{ https\+://www.\+iana.\+org/assignments/uri-\/schemes/uri-\/schemes.\+xhtml}}). If your protocol is not in there, is it really a protocol we want?\hypertarget{md__ase_sprite_aseprite_third_party_curl_docs__n_e_w__p_r_o_t_o_c_o_l_autotoc_md1147}{}\doxysubsection{Wide and public use}\label{md__ase_sprite_aseprite_third_party_curl_docs__n_e_w__p_r_o_t_o_c_o_l_autotoc_md1147}
The protocol shall already be used or have an expectation of getting used widely. Experimental protocols are better off worked on in experiments first, to prove themselves before they are adopted by curl.\hypertarget{md__ase_sprite_aseprite_third_party_curl_docs__n_e_w__p_r_o_t_o_c_o_l_autotoc_md1148}{}\doxysection{Code}\label{md__ase_sprite_aseprite_third_party_curl_docs__n_e_w__p_r_o_t_o_c_o_l_autotoc_md1148}
Of course the code needs to be written, provided, licensed agreeably and it should follow our code guidelines and review comments have to be dealt with. If the implementation needs third party code, that third party code should not have noticeably lesser standards than the curl project itself.\hypertarget{md__ase_sprite_aseprite_third_party_curl_docs__n_e_w__p_r_o_t_o_c_o_l_autotoc_md1149}{}\doxysection{Tests}\label{md__ase_sprite_aseprite_third_party_curl_docs__n_e_w__p_r_o_t_o_c_o_l_autotoc_md1149}
As much of the protocol implementation as possible needs to be verified by curl test cases. We must have the implementation get tested by CI jobs, torture tests and more.

We\textquotesingle{}ve experienced many times in the past how new implementations were brought to curl and immediately once the code had been merged, the originator vanished from the face of the earth. That is fine, but we need to take the necessary precautions so when it happens we are still fine.

Our test infrastructure is powerful enough to test just about every possible protocol -\/ but it might require a bit of an effort to make it happen.\hypertarget{md__ase_sprite_aseprite_third_party_curl_docs__n_e_w__p_r_o_t_o_c_o_l_autotoc_md1150}{}\doxysection{Documentation}\label{md__ase_sprite_aseprite_third_party_curl_docs__n_e_w__p_r_o_t_o_c_o_l_autotoc_md1150}
We cannot assume that users are particularly familiar with specific details and peculiarities of the protocol. It needs documentation.

Maybe it even needs some internal documentation so that the developers who will try to debug something five years from now can figure out functionality a little easier!

The protocol specification itself should be freely available without requiring any NDA or similar.\hypertarget{md__ase_sprite_aseprite_third_party_curl_docs__n_e_w__p_r_o_t_o_c_o_l_autotoc_md1151}{}\doxysection{Don\textquotesingle{}t compare}\label{md__ase_sprite_aseprite_third_party_curl_docs__n_e_w__p_r_o_t_o_c_o_l_autotoc_md1151}
We are constantly raising the bar and we are constantly improving the project. \mbox{\hyperlink{class_a}{A}} lot of things we did in the past would not be acceptable if done today. Therefore, you might be tempted to use shortcuts or \char`\"{}hacks\char`\"{} you can spot other -\/ existing -\/ protocol implementations have used, but there is nothing to gain from that. The bar has been raised. Former \char`\"{}cheats\char`\"{} won\textquotesingle{}t be tolerated anymore. 
\hypertarget{laf_2os_2common_2system_8h_source}{}\doxysection{system.\+h}
\label{laf_2os_2common_2system_8h_source}\index{AseSprite/aseprite/laf/os/common/system.h@{AseSprite/aseprite/laf/os/common/system.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ LAF\ OS\ Library}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ Copyright\ (C)\ 2019-\/2022\ \ Igara\ Studio\ S.A.}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ Copyright\ (C)\ 2012-\/2018\ \ David\ Capello}}
\DoxyCodeLine{00004\ \textcolor{comment}{//}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ This\ file\ is\ released\ under\ the\ terms\ of\ the\ MIT\ license.}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ Read\ LICENSE.txt\ for\ more\ information.}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#ifndef\ OS\_COMMON\_SYSTEM\_H}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#define\ OS\_COMMON\_SYSTEM\_H}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#if\ LAF\_WINDOWS}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\ \ \#include\ "{}os/win/native\_dialogs.h"{}}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#elif\ LAF\_MACOS}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\ \ \#include\ "{}os/osx/app.h"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\ \ \#include\ "{}os/osx/menus.h"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\ \ \#include\ "{}os/osx/native\_dialogs.h"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#elif\ LAF\_OS\_WITH\_GTK}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\ \ \#include\ "{}os/gtk/native\_dialogs.h"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\ \ \#include\ "{}os/native\_dialogs.h"{}}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#ifdef\ LAF\_FREETYPE}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}ft/lib.h"{}}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ "{}os/common/freetype\_font.h"{}}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#include\ "{}os/common/sprite\_sheet\_font.h"{}}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#include\ "{}os/event\_queue.h"{}}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#include\ "{}os/menus.h"{}}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#include\ "{}os/system.h"{}}}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#include\ <memory>}}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \textcolor{keyword}{namespace\ }os\ \{}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classos_1_1_common_system}{CommonSystem}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classos_1_1_system}{System}}\ \{}
\DoxyCodeLine{00038\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00039\ \ \ \mbox{\hyperlink{classos_1_1_common_system}{CommonSystem}}()\ \{\ \}}
\DoxyCodeLine{00040\ \ \ \mbox{\hyperlink{classos_1_1_common_system}{\string~CommonSystem}}()\ \{}
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{comment}{//\ We\ have\ to\ clear\ the\ list\ of\ all\ events\ to\ clear\ all\ possible}}
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{comment}{//\ living\ WindowRef\ (so\ all\ window\ destructors\ are\ called\ at\ this}}
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{comment}{//\ point,\ when\ the\ os::System\ instance\ is\ still\ alive).}}
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{comment}{//\ TODO\ Maybe\ the\ event\ queue\ should\ be\ inside\ the\ System\ instance}}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ (so\ when\ the\ system\ is\ deleted,\ the\ queue\ is}}
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ deleted).\ Anyway\ we\ should\ still\ clear\ all\ the\ events}}
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ before\ set\_instance(nullptr),\ and\ we're\ not\ sure\ if\ this}}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ is\ possible\ on\ macOS,\ as\ some\ events\ are\ queued\ before\ the}}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ System\ instance\ is\ even\ created\ (see}}
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ EventQueue::instance()\ comment\ on\ laf/os/event\_queue.h).}}
\DoxyCodeLine{00052\ \ \ \ \ eventQueue()-\/>clearEvents();}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ \ \ set\_instance(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{00055\ \ \ \}}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \ \ \textcolor{keywordtype}{void}\ setAppName(\textcolor{keyword}{const}\ std::string\&\ appName)\textcolor{keyword}{\ override\ }\{\ \}}
\DoxyCodeLine{00058\ \ \ \textcolor{keywordtype}{void}\ setAppMode(AppMode\ appMode)\textcolor{keyword}{\ override\ }\{\ \}}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \ \ \textcolor{keywordtype}{void}\ markCliFileAsProcessed(\textcolor{keyword}{const}\ std::string\&\ fn)\textcolor{keyword}{\ override\ }\{\ \}}
\DoxyCodeLine{00061\ \ \ \textcolor{keywordtype}{void}\ finishLaunching()\textcolor{keyword}{\ override\ }\{\ \}}
\DoxyCodeLine{00062\ \ \ \textcolor{keywordtype}{void}\ activateApp()\textcolor{keyword}{\ override\ }\{\ \}}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \ \ \textcolor{keywordtype}{void}\ setTabletAPI(TabletAPI\ api)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{comment}{//\ Do\ nothing\ by\ default}}
\DoxyCodeLine{00066\ \ \ \}}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \ \ TabletAPI\ tabletAPI()\textcolor{keyword}{\ const\ override\ }\{}
\DoxyCodeLine{00069\ \ \ \ \ \textcolor{keywordflow}{return}\ TabletAPI::Default;}
\DoxyCodeLine{00070\ \ \ \}}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ \ \ \mbox{\hyperlink{classos_1_1_logger}{Logger}}*\ logger()\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00074\ \ \ \}}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \ \ \mbox{\hyperlink{classos_1_1_menus}{Menus}}*\ menus()\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00078\ \ \ \}}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \ \ \mbox{\hyperlink{classos_1_1_native_dialogs}{NativeDialogs}}*\ nativeDialogs()\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{keywordflow}{if}\ (!m\_nativeDialogs)\ \{}
\DoxyCodeLine{00082\ \textcolor{preprocessor}{\#if\ LAF\_WINDOWS}}
\DoxyCodeLine{00083\ \ \ \ \ \ \ m\_nativeDialogs.reset(\textcolor{keyword}{new}\ \mbox{\hyperlink{classos_1_1_native_dialogs_win}{NativeDialogsWin}});}
\DoxyCodeLine{00084\ \textcolor{preprocessor}{\#elif\ LAF\_MACOS}}
\DoxyCodeLine{00085\ \ \ \ \ \ \ m\_nativeDialogs.reset(\textcolor{keyword}{new}\ \mbox{\hyperlink{classos_1_1_native_dialogs_o_s_x}{NativeDialogsOSX}});}
\DoxyCodeLine{00086\ \textcolor{preprocessor}{\#elif\ LAF\_OS\_WITH\_GTK}}
\DoxyCodeLine{00087\ \ \ \ \ \ \ m\_nativeDialogs.reset(\textcolor{keyword}{new}\ \mbox{\hyperlink{classos_1_1_native_dialogs_g_t_k}{NativeDialogsGTK}});}
\DoxyCodeLine{00088\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00089\ \ \ \ \ \}}
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{keywordflow}{return}\ m\_nativeDialogs.get();}
\DoxyCodeLine{00091\ \ \ \}}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ \mbox{\hyperlink{classos_1_1_event_queue}{EventQueue}}*\ eventQueue()\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00094\ \ \ \ \ \textcolor{keywordflow}{return}\ EventQueue::instance();}
\DoxyCodeLine{00095\ \ \ \}}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \mbox{\hyperlink{classbase_1_1_ref}{FontRef}}\ loadSpriteSheetFont(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ filename,\ \textcolor{keywordtype}{int}\ scale)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00098\ \ \ \ \ \mbox{\hyperlink{classbase_1_1_ref}{SurfaceRef}}\ sheet\ =\ loadRgbaSurface(filename);}
\DoxyCodeLine{00099\ \ \ \ \ \mbox{\hyperlink{classbase_1_1_ref}{FontRef}}\ font\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00100\ \ \ \ \ \textcolor{keywordflow}{if}\ (sheet)\ \{}
\DoxyCodeLine{00101\ \ \ \ \ \ \ sheet-\/>applyScale(scale);}
\DoxyCodeLine{00102\ \ \ \ \ \ \ sheet-\/>setImmutable();}
\DoxyCodeLine{00103\ \ \ \ \ \ \ font\ =\ SpriteSheetFont::fromSurface(sheet);}
\DoxyCodeLine{00104\ \ \ \ \ \}}
\DoxyCodeLine{00105\ \ \ \ \ \textcolor{keywordflow}{return}\ font;}
\DoxyCodeLine{00106\ \ \ \}}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00108\ \ \ \mbox{\hyperlink{classbase_1_1_ref}{FontRef}}\ loadTrueTypeFont(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ filename,\ \textcolor{keywordtype}{int}\ height)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00109\ \textcolor{preprocessor}{\#ifdef\ LAF\_FREETYPE}}
\DoxyCodeLine{00110\ \ \ \ \ \textcolor{keywordflow}{if}\ (!m\_ft)}
\DoxyCodeLine{00111\ \ \ \ \ \ \ m\_ft.reset(\textcolor{keyword}{new}\ \mbox{\hyperlink{classft_1_1_lib}{ft::Lib}}());}
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classbase_1_1_ref}{FontRef}}(load\_free\_type\_font(*m\_ft.get(),\ filename,\ height));}
\DoxyCodeLine{00113\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00115\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00116\ \ \ \}}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \ \ KeyModifiers\ keyModifiers()\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00119\ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{00120\ \ \ \ \ \ \ (KeyModifiers)}
\DoxyCodeLine{00121\ \ \ \ \ \ \ ((isKeyPressed(kKeyLShift)\ ||}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ isKeyPressed(kKeyRShift)\ ?\ kKeyShiftModifier:\ 0)\ |}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ (isKeyPressed(kKeyLControl)\ ||}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ isKeyPressed(kKeyRControl)\ ?\ kKeyCtrlModifier:\ 0)\ |}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ (isKeyPressed(kKeyAlt)\ ?\ kKeyAltModifier:\ 0)\ |}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ (isKeyPressed(kKeyAltGr)\ ?\ (kKeyCtrlModifier\ |\ kKeyAltModifier):\ 0)\ |}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ (isKeyPressed(kKeyCommand)\ ?\ kKeyCmdModifier:\ 0)\ |}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ (isKeyPressed(kKeySpace)\ ?\ kKeySpaceModifier:\ 0)\ |}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ (isKeyPressed(kKeyLWin)\ ||}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ isKeyPressed(kKeyRWin)\ ?\ kKeyWinModifier:\ 0));}
\DoxyCodeLine{00131\ \ \ \}}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00134\ \ \ \mbox{\hyperlink{classbase_1_1_ref}{Ref<NativeDialogs>}}\ m\_nativeDialogs;}
\DoxyCodeLine{00135\ \textcolor{preprocessor}{\#ifdef\ LAF\_FREETYPE}}
\DoxyCodeLine{00136\ \ \ std::unique\_ptr<ft::Lib>\ m\_ft;}
\DoxyCodeLine{00137\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00138\ \};}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00140\ \}\ \textcolor{comment}{//\ namespace\ os}}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}

\href{LICENSE.txt}{\texttt{ }}\hypertarget{md__ase_sprite_aseprite_src_desktop__r_e_a_d_m_e_autotoc_md533}{}\doxysection{Windows}\label{md__ase_sprite_aseprite_src_desktop__r_e_a_d_m_e_autotoc_md533}
On Windows we have to create a COM server in a DLL to provide thumbnails. The DLL must provide an \href{https://msdn.microsoft.com/en-us/library/windows/desktop/bb774614.aspx}{\texttt{ IThumbnail\+Provider}} implementation. Our implementation is in \href{win/thumbnail_handler.h}{\texttt{ desktop\+::\+Thumbnail\+Handler}} class, the most interesting member function is \href{win/thumbnail_handler.cpp}{\texttt{ Thumbnail\+Handler\+::\+Get\+Thumbnail()}}, which should return a {\ttfamily HBITMAP} of the thumbnail.\hypertarget{md__ase_sprite_aseprite_src_desktop__r_e_a_d_m_e_autotoc_md534}{}\doxysubsection{Registering the DLL}\label{md__ase_sprite_aseprite_src_desktop__r_e_a_d_m_e_autotoc_md534}
If you distribute your app in an installer remember to use {\ttfamily regsvr32.\+exe} to register your DLL which will call your DLL\textquotesingle{}s \href{win/dllmain.cpp}{\texttt{ Dll\+Register\+Server()}}, a function that must create registry keys to associate your file type extension with your thumbnail handler.

More information \href{https://msdn.microsoft.com/en-us/library/windows/desktop/cc144118.aspx}{\texttt{ in the MSDN}}.\hypertarget{md__ase_sprite_aseprite_src_desktop__r_e_a_d_m_e_autotoc_md535}{}\doxysection{mac\+OS}\label{md__ase_sprite_aseprite_src_desktop__r_e_a_d_m_e_autotoc_md535}
On mac\+OS we have to create a Quick\+Look plugin/extension to display thumbnails and previews. The plugin is a {\ttfamily .qlgenerator} bundle which can be installed in the {\ttfamily $\sim$/\+Library/\+Quick\+Look}, {\ttfamily /\+System/\+Library/\+Quick\+Look}, or {\ttfamily /\+Library/\+Quick\+Look} directories, or included the in the same app bundle.

\href{https://developer.apple.com/documentation/quicklook/previews_or_thumbnail_images_for_macos_10_14_or_earlier?language=objc}{\texttt{ mac\+OS pre-\/10.\+15}}, has a COM-\/like functionality to load Quick\+Look plugins\+: the Quick\+Look daemon will use the information in our bundle \href{osx/Info.plist}{\texttt{ Info.\+plist}} to know which function to load and call from our library to create the plugin object. (The function generally is called {\ttfamily Quick\+Look\+Generator\+Plugin\+Factory} but can has any name, the name is specified in a child element of {\ttfamily CFPlug\+In\+Factories} inside the {\ttfamily Info.\+plist} file.) Then the created object is used abstractly as a {\ttfamily IUnknown}, and the {\ttfamily QLGenerator\+Interface} interface is queried to generate then thumbnails and previews.

We can test our {\ttfamily .qlgenerator} without installing it using the \href{https://developer.apple.com/library/archive/documentation/UserExperience/Conceptual/Quicklook_Programming_Guide/Articles/QLDebugTest.html}{\texttt{ {\ttfamily qlmanage} utility}}.

We target to mac\+OS 10.\+9, but \href{https://developer.apple.com/videos/play/wwdc2019/719?time=944}{\texttt{ we should migrate}} to the new mac\+OS 10.\+15 API in a near future (or provide both). 
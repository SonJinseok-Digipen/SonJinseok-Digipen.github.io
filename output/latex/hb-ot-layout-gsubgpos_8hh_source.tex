\hypertarget{hb-ot-layout-gsubgpos_8hh_source}{}\doxysection{hb-\/ot-\/layout-\/gsubgpos.hh}
\label{hb-ot-layout-gsubgpos_8hh_source}\index{AseSprite/aseprite/third\_party/harfbuzz/src/hb-\/ot-\/layout-\/gsubgpos.hh@{AseSprite/aseprite/third\_party/harfbuzz/src/hb-\/ot-\/layout-\/gsubgpos.hh}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ *\ Copyright\ ©\ 2007,2008,2009,2010\ \ Red\ Hat,\ Inc.}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ *\ Copyright\ ©\ 2010,2012\ \ Google,\ Inc.}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ *\ \ This\ is\ part\ of\ HarfBuzz,\ a\ text\ shaping\ library.}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00007\ \textcolor{comment}{\ *\ Permission\ is\ hereby\ granted,\ without\ written\ agreement\ and\ without}}
\DoxyCodeLine{00008\ \textcolor{comment}{\ *\ license\ or\ royalty\ fees,\ to\ use,\ copy,\ modify,\ and\ distribute\ this}}
\DoxyCodeLine{00009\ \textcolor{comment}{\ *\ software\ and\ its\ documentation\ for\ any\ purpose,\ provided\ that\ the}}
\DoxyCodeLine{00010\ \textcolor{comment}{\ *\ above\ copyright\ notice\ and\ the\ following\ two\ paragraphs\ appear\ in}}
\DoxyCodeLine{00011\ \textcolor{comment}{\ *\ all\ copies\ of\ this\ software.}}
\DoxyCodeLine{00012\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00013\ \textcolor{comment}{\ *\ IN\ NO\ EVENT\ SHALL\ THE\ COPYRIGHT\ HOLDER\ BE\ LIABLE\ TO\ ANY\ PARTY\ FOR}}
\DoxyCodeLine{00014\ \textcolor{comment}{\ *\ DIRECT,\ INDIRECT,\ SPECIAL,\ INCIDENTAL,\ OR\ CONSEQUENTIAL\ DAMAGES}}
\DoxyCodeLine{00015\ \textcolor{comment}{\ *\ ARISING\ OUT\ OF\ THE\ USE\ OF\ THIS\ SOFTWARE\ AND\ ITS\ DOCUMENTATION,\ EVEN}}
\DoxyCodeLine{00016\ \textcolor{comment}{\ *\ IF\ THE\ COPYRIGHT\ HOLDER\ HAS\ BEEN\ ADVISED\ OF\ THE\ POSSIBILITY\ OF\ SUCH}}
\DoxyCodeLine{00017\ \textcolor{comment}{\ *\ DAMAGE.}}
\DoxyCodeLine{00018\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00019\ \textcolor{comment}{\ *\ THE\ COPYRIGHT\ HOLDER\ SPECIFICALLY\ DISCLAIMS\ ANY\ WARRANTIES,\ INCLUDING,}}
\DoxyCodeLine{00020\ \textcolor{comment}{\ *\ BUT\ NOT\ LIMITED\ TO,\ THE\ IMPLIED\ WARRANTIES\ OF\ MERCHANTABILITY\ AND}}
\DoxyCodeLine{00021\ \textcolor{comment}{\ *\ FITNESS\ FOR\ A\ PARTICULAR\ PURPOSE.\ \ THE\ SOFTWARE\ PROVIDED\ HEREUNDER\ IS}}
\DoxyCodeLine{00022\ \textcolor{comment}{\ *\ ON\ AN\ "{}AS\ IS"{}\ BASIS,\ AND\ THE\ COPYRIGHT\ HOLDER\ HAS\ NO\ OBLIGATION\ TO}}
\DoxyCodeLine{00023\ \textcolor{comment}{\ *\ PROVIDE\ MAINTENANCE,\ SUPPORT,\ UPDATES,\ ENHANCEMENTS,\ OR\ MODIFICATIONS.}}
\DoxyCodeLine{00024\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00025\ \textcolor{comment}{\ *\ Red\ Hat\ Author(s):\ Behdad\ Esfahbod}}
\DoxyCodeLine{00026\ \textcolor{comment}{\ *\ Google\ Author(s):\ Behdad\ Esfahbod}}
\DoxyCodeLine{00027\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#ifndef\ HB\_OT\_LAYOUT\_GSUBGPOS\_HH}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#define\ HB\_OT\_LAYOUT\_GSUBGPOS\_HH}}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#include\ "{}hb.hh"{}}}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#include\ "{}hb-\/buffer.hh"{}}}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#include\ "{}hb-\/map.hh"{}}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#include\ "{}hb-\/set.hh"{}}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#include\ "{}hb-\/ot-\/map.hh"{}}}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\#include\ "{}hb-\/ot-\/layout-\/common.hh"{}}}
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#include\ "{}hb-\/ot-\/layout-\/gdef-\/table.hh"{}}}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \textcolor{keyword}{namespace\ }OT\ \{}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1hb__intersects__context__t}{hb\_intersects\_context\_t}}\ :}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__dispatch__context__t}{hb\_dispatch\_context\_t}}<hb\_intersects\_context\_t,\ bool>}
\DoxyCodeLine{00046\ \{}
\DoxyCodeLine{00047\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00048\ \ \ return\_t\ dispatch\ (\textcolor{keyword}{const}\ T\ \&obj)\ \{\ \textcolor{keywordflow}{return}\ obj.intersects\ (this-\/>glyphs);\ \}}
\DoxyCodeLine{00049\ \ \ \textcolor{keyword}{static}\ return\_t\ default\_return\_value\ ()\ \{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};\ \}}
\DoxyCodeLine{00050\ \ \ \textcolor{keywordtype}{bool}\ stop\_sublookup\_iteration\ (return\_t\ r)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ r;\ \}}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs;}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__intersects__context__t}{hb\_intersects\_context\_t}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs\_)\ :}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ glyphs\ (glyphs\_)\ \{\}}
\DoxyCodeLine{00056\ \};}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00058\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1hb__have__non__1to1__context__t}{hb\_have\_non\_1to1\_context\_t}}\ :}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__dispatch__context__t}{hb\_dispatch\_context\_t}}<hb\_have\_non\_1to1\_context\_t,\ bool>}
\DoxyCodeLine{00060\ \{}
\DoxyCodeLine{00061\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00062\ \ \ return\_t\ dispatch\ (\textcolor{keyword}{const}\ T\ \&obj)\ \{\ \textcolor{keywordflow}{return}\ obj.may\_have\_non\_1to1\ ();\ \}}
\DoxyCodeLine{00063\ \ \ \textcolor{keyword}{static}\ return\_t\ default\_return\_value\ ()\ \{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};\ \}}
\DoxyCodeLine{00064\ \ \ \textcolor{keywordtype}{bool}\ stop\_sublookup\_iteration\ (return\_t\ r)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ r;\ \}}
\DoxyCodeLine{00065\ \};}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1hb__closure__context__t}{hb\_closure\_context\_t}}\ :}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__dispatch__context__t}{hb\_dispatch\_context\_t}}<hb\_closure\_context\_t>}
\DoxyCodeLine{00069\ \{}
\DoxyCodeLine{00070\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{structhb__empty__t}{return\_t}}\ (*recurse\_func\_t)\ (\mbox{\hyperlink{struct_o_t_1_1hb__closure__context__t}{hb\_closure\_context\_t}}\ *c,\ \textcolor{keywordtype}{unsigned}\ lookup\_index,\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *covered\_seq\_indicies,\ \textcolor{keywordtype}{unsigned}\ seq\_index,\ \textcolor{keywordtype}{unsigned}\ end\_index);}
\DoxyCodeLine{00071\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00072\ \ \ \mbox{\hyperlink{structhb__empty__t}{return\_t}}\ dispatch\ (\textcolor{keyword}{const}\ T\ \&obj)\ \{\ obj.closure\ (\textcolor{keyword}{this});\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structhb__empty__t}{hb\_empty\_t}}\ ();\ \}}
\DoxyCodeLine{00073\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{structhb__empty__t}{return\_t}}\ default\_return\_value\ ()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structhb__empty__t}{hb\_empty\_t}}\ ();\ \}}
\DoxyCodeLine{00074\ \ \ \textcolor{keywordtype}{void}\ recurse\ (\textcolor{keywordtype}{unsigned}\ lookup\_index,\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *covered\_seq\_indicies,\ \textcolor{keywordtype}{unsigned}\ seq\_index,\ \textcolor{keywordtype}{unsigned}\ end\_index)}
\DoxyCodeLine{00075\ \ \ \{}
\DoxyCodeLine{00076\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (nesting\_level\_left\ ==\ 0\ ||\ !recurse\_func))}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00079\ \ \ \ \ nesting\_level\_left-\/-\/;}
\DoxyCodeLine{00080\ \ \ \ \ recurse\_func\ (\textcolor{keyword}{this},\ lookup\_index,\ covered\_seq\_indicies,\ seq\_index,\ end\_index);}
\DoxyCodeLine{00081\ \ \ \ \ nesting\_level\_left++;}
\DoxyCodeLine{00082\ \ \ \}}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ \textcolor{keywordtype}{void}\ reset\_lookup\_visit\_count\ ()}
\DoxyCodeLine{00085\ \ \ \{\ lookup\_count\ =\ 0;\ \}}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \textcolor{keywordtype}{bool}\ lookup\_limit\_exceeded\ ()}
\DoxyCodeLine{00088\ \ \ \{\ \textcolor{keywordflow}{return}\ lookup\_count\ >\ HB\_MAX\_LOOKUP\_VISIT\_COUNT;\ \}}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \ \ \textcolor{keywordtype}{bool}\ should\_visit\_lookup\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookup\_index)}
\DoxyCodeLine{00091\ \ \ \{}
\DoxyCodeLine{00092\ \ \ \ \ \textcolor{keywordflow}{if}\ (lookup\_count++\ >\ HB\_MAX\_LOOKUP\_VISIT\_COUNT)}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_lookup\_done\ (lookup\_index))}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00099\ \ \ \}}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \ \ \textcolor{keywordtype}{bool}\ is\_lookup\_done\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookup\_index)}
\DoxyCodeLine{00102\ \ \ \{}
\DoxyCodeLine{00103\ \ \ \ \ \textcolor{keywordflow}{if}\ (done\_lookups\_glyph\_count-\/>in\_error\ ()\ ||}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ done\_lookups\_glyph\_set-\/>in\_error\ ())}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{comment}{/*\ Have\ we\ visited\ this\ lookup\ with\ the\ current\ set\ of\ glyphs?\ */}}
\DoxyCodeLine{00108\ \ \ \ \ \textcolor{keywordflow}{if}\ (done\_lookups\_glyph\_count-\/>get\ (lookup\_index)\ !=\ glyphs-\/>get\_population\ ())}
\DoxyCodeLine{00109\ \ \ \ \ \{}
\DoxyCodeLine{00110\ \ \ \ \ \ \ done\_lookups\_glyph\_count-\/>set\ (lookup\_index,\ glyphs-\/>get\_population\ ());}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!done\_lookups\_glyph\_set-\/>get\ (lookup\_index))}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00114\ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}*\ empty\_set\ =\ hb\_set\_create\ ();}
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!done\_lookups\_glyph\_set-\/>set\ (lookup\_index,\ empty\_set)))}
\DoxyCodeLine{00116\ \ \ \ \ \{}
\DoxyCodeLine{00117\ \ \ \ \ \ \ hb\_set\_destroy\ (empty\_set);}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00119\ \ \ \ \ \}}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \ \ \ \ \ \ hb\_set\_clear\ (done\_lookups\_glyph\_set-\/>get\ (lookup\_index));}
\DoxyCodeLine{00123\ \ \ \ \ \}}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *covered\_glyph\_set\ =\ done\_lookups\_glyph\_set-\/>get\ (lookup\_index);}
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (covered\_glyph\_set-\/>in\_error\ ()))}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00128\ \ \ \ \ \textcolor{keywordflow}{if}\ (parent\_active\_glyphs\ ().is\_subset\ (*covered\_glyph\_set))}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ \ \ covered\_glyph\_set-\/>union\_\ (parent\_active\_glyphs\ ());}
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00133\ \ \ \}}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00135\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\&\ previous\_parent\_active\_glyphs\ ()\ \{}
\DoxyCodeLine{00136\ \ \ \ \ \textcolor{keywordflow}{if}\ (active\_glyphs\_stack.length\ <=\ 1)}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *glyphs;}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ \ \ \textcolor{keywordflow}{return}\ active\_glyphs\_stack[active\_glyphs\_stack.length\ -\/\ 2];}
\DoxyCodeLine{00140\ \ \ \}}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\&\ parent\_active\_glyphs\ ()}
\DoxyCodeLine{00143\ \ \ \{}
\DoxyCodeLine{00144\ \ \ \ \ \textcolor{keywordflow}{if}\ (!active\_glyphs\_stack)}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *glyphs;}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{keywordflow}{return}\ active\_glyphs\_stack.tail\ ();}
\DoxyCodeLine{00148\ \ \ \}}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\&\ push\_cur\_active\_glyphs\ ()}
\DoxyCodeLine{00151\ \ \ \{}
\DoxyCodeLine{00152\ \ \ \ \ \textcolor{keywordflow}{return}\ *active\_glyphs\_stack.push\ ();}
\DoxyCodeLine{00153\ \ \ \}}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ \ \ \textcolor{keywordtype}{bool}\ pop\_cur\_done\_glyphs\ ()}
\DoxyCodeLine{00156\ \ \ \{}
\DoxyCodeLine{00157\ \ \ \ \ \textcolor{keywordflow}{if}\ (active\_glyphs\_stack.length\ <\ 1)}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00160\ \ \ \ \ active\_glyphs\_stack.pop\ ();}
\DoxyCodeLine{00161\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00162\ \ \ \}}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00164\ \ \ \mbox{\hyperlink{structhb__face__t}{hb\_face\_t}}\ *face;}
\DoxyCodeLine{00165\ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs;}
\DoxyCodeLine{00166\ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ output[1];}
\DoxyCodeLine{00167\ \ \ \mbox{\hyperlink{structhb__vector__t}{hb\_vector\_t<hb\_set\_t>}}\ active\_glyphs\_stack;}
\DoxyCodeLine{00168\ \ \ recurse\_func\_t\ recurse\_func;}
\DoxyCodeLine{00169\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ nesting\_level\_left;}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00171\ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__closure__context__t}{hb\_closure\_context\_t}}\ (\mbox{\hyperlink{structhb__face__t}{hb\_face\_t}}\ *face\_,}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs\_,}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *done\_lookups\_glyph\_count\_,}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__hashmap__t}{hb\_hashmap\_t<unsigned,\ hb\_set\_t\ *>}}\ *done\_lookups\_glyph\_set\_,}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ nesting\_level\_left\_\ =\ HB\_MAX\_NESTING\_LEVEL)\ :}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ face\ (face\_),}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ glyphs\ (glyphs\_),}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ recurse\_func\ (\textcolor{keyword}{nullptr}),}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nesting\_level\_left\ (nesting\_level\_left\_),}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ done\_lookups\_glyph\_count\ (done\_lookups\_glyph\_count\_),}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ done\_lookups\_glyph\_set\ (done\_lookups\_glyph\_set\_),}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_count\ (0)}
\DoxyCodeLine{00183\ \ \ \{\}}
\DoxyCodeLine{00184\ }
\DoxyCodeLine{00185\ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__closure__context__t}{\string~hb\_closure\_context\_t}}\ ()\ \{\ flush\ ();\ \}}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \ \ \textcolor{keywordtype}{void}\ set\_recurse\_func\ (recurse\_func\_t\ func)\ \{\ recurse\_func\ =\ func;\ \}}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00189\ \ \ \textcolor{keywordtype}{void}\ flush\ ()}
\DoxyCodeLine{00190\ \ \ \{}
\DoxyCodeLine{00191\ \ \ \ \ output-\/>del\_range\ (face-\/>get\_num\_glyphs\ (),\ HB\_SET\_VALUE\_INVALID);\ \ \textcolor{comment}{/*\ Remove\ invalid\ glyphs.\ */}}
\DoxyCodeLine{00192\ \ \ \ \ glyphs-\/>union\_\ (*output);}
\DoxyCodeLine{00193\ \ \ \ \ output-\/>clear\ ();}
\DoxyCodeLine{00194\ \ \ \ \ active\_glyphs\_stack.pop\ ();}
\DoxyCodeLine{00195\ \ \ \ \ active\_glyphs\_stack.reset\ ();}
\DoxyCodeLine{00196\ \ \ \}}
\DoxyCodeLine{00197\ }
\DoxyCodeLine{00198\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00199\ \ \ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *done\_lookups\_glyph\_count;}
\DoxyCodeLine{00200\ \ \ \mbox{\hyperlink{structhb__hashmap__t}{hb\_hashmap\_t<unsigned,\ hb\_set\_t\ *>}}\ *done\_lookups\_glyph\_set;}
\DoxyCodeLine{00201\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookup\_count;}
\DoxyCodeLine{00202\ \};}
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00204\ }
\DoxyCodeLine{00205\ }
\DoxyCodeLine{00206\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1hb__closure__lookups__context__t}{hb\_closure\_lookups\_context\_t}}\ :}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__dispatch__context__t}{hb\_dispatch\_context\_t}}<hb\_closure\_lookups\_context\_t>}
\DoxyCodeLine{00208\ \{}
\DoxyCodeLine{00209\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{structhb__empty__t}{return\_t}}\ (*recurse\_func\_t)\ (\mbox{\hyperlink{struct_o_t_1_1hb__closure__lookups__context__t}{hb\_closure\_lookups\_context\_t}}\ *c,\ \textcolor{keywordtype}{unsigned}\ lookup\_index);}
\DoxyCodeLine{00210\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00211\ \ \ \mbox{\hyperlink{structhb__empty__t}{return\_t}}\ dispatch\ (\textcolor{keyword}{const}\ T\ \&obj)\ \{\ obj.closure\_lookups\ (\textcolor{keyword}{this});\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structhb__empty__t}{hb\_empty\_t}}\ ();\ \}}
\DoxyCodeLine{00212\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{structhb__empty__t}{return\_t}}\ default\_return\_value\ ()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structhb__empty__t}{hb\_empty\_t}}\ ();\ \}}
\DoxyCodeLine{00213\ \ \ \textcolor{keywordtype}{void}\ recurse\ (\textcolor{keywordtype}{unsigned}\ lookup\_index)}
\DoxyCodeLine{00214\ \ \ \{}
\DoxyCodeLine{00215\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (nesting\_level\_left\ ==\ 0\ ||\ !recurse\_func))}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00217\ }
\DoxyCodeLine{00218\ \ \ \ \ \textcolor{comment}{/*\ Return\ if\ new\ lookup\ was\ recursed\ to\ before.\ */}}
\DoxyCodeLine{00219\ \ \ \ \ \textcolor{keywordflow}{if}\ (lookup\_limit\_exceeded\ ()}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ ||\ visited\_lookups-\/>in\_error\ ()}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ ||\ visited\_lookups-\/>has\ (lookup\_index))}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \textcolor{comment}{//\ Don't\ increment\ lookup\ count\ here,\ that\ will\ be\ done\ in\ the\ call\ to\ closure\_lookups()}}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \textcolor{comment}{//\ made\ by\ recurse\_func.}}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00226\ \ \ \ \ nesting\_level\_left-\/-\/;}
\DoxyCodeLine{00227\ \ \ \ \ recurse\_func\ (\textcolor{keyword}{this},\ lookup\_index);}
\DoxyCodeLine{00228\ \ \ \ \ nesting\_level\_left++;}
\DoxyCodeLine{00229\ \ \ \}}
\DoxyCodeLine{00230\ }
\DoxyCodeLine{00231\ \ \ \textcolor{keywordtype}{void}\ set\_lookup\_visited\ (\textcolor{keywordtype}{unsigned}\ lookup\_index)}
\DoxyCodeLine{00232\ \ \ \{\ visited\_lookups-\/>add\ (lookup\_index);\ \}}
\DoxyCodeLine{00233\ }
\DoxyCodeLine{00234\ \ \ \textcolor{keywordtype}{void}\ set\_lookup\_inactive\ (\textcolor{keywordtype}{unsigned}\ lookup\_index)}
\DoxyCodeLine{00235\ \ \ \{\ inactive\_lookups-\/>add\ (lookup\_index);\ \}}
\DoxyCodeLine{00236\ }
\DoxyCodeLine{00237\ \ \ \textcolor{keywordtype}{bool}\ lookup\_limit\_exceeded\ ()}
\DoxyCodeLine{00238\ \ \ \{}
\DoxyCodeLine{00239\ \ \ \ \ \textcolor{keywordtype}{bool}\ ret\ =\ lookup\_count\ >\ HB\_MAX\_LOOKUP\_VISIT\_COUNT;}
\DoxyCodeLine{00240\ \ \ \ \ \textcolor{keywordflow}{if}\ (ret)}
\DoxyCodeLine{00241\ \ \ \ \ \ \ DEBUG\_MSG\ (SUBSET,\ \textcolor{keyword}{nullptr},\ \textcolor{stringliteral}{"{}lookup\ visit\ count\ limit\ exceeded\ in\ lookup\ closure!"{}});}
\DoxyCodeLine{00242\ \ \ \ \ \textcolor{keywordflow}{return}\ ret;\ \}}
\DoxyCodeLine{00243\ }
\DoxyCodeLine{00244\ \ \ \textcolor{keywordtype}{bool}\ is\_lookup\_visited\ (\textcolor{keywordtype}{unsigned}\ lookup\_index)}
\DoxyCodeLine{00245\ \ \ \{}
\DoxyCodeLine{00246\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (lookup\_count++\ >\ HB\_MAX\_LOOKUP\_VISIT\_COUNT))}
\DoxyCodeLine{00247\ \ \ \ \ \{}
\DoxyCodeLine{00248\ \ \ \ \ \ \ DEBUG\_MSG\ (SUBSET,\ \textcolor{keyword}{nullptr},\ \textcolor{stringliteral}{"{}total\ visited\ lookup\ count\ \%u\ exceeds\ max\ limit,\ lookup\ \%u\ is\ dropped."{}},}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_count,\ lookup\_index);}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00251\ \ \ \ \ \}}
\DoxyCodeLine{00252\ }
\DoxyCodeLine{00253\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (visited\_lookups-\/>in\_error\ ()))}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00256\ \ \ \ \ \textcolor{keywordflow}{return}\ visited\_lookups-\/>has\ (lookup\_index);}
\DoxyCodeLine{00257\ \ \ \}}
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00259\ \ \ \mbox{\hyperlink{structhb__face__t}{hb\_face\_t}}\ *face;}
\DoxyCodeLine{00260\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs;}
\DoxyCodeLine{00261\ \ \ recurse\_func\_t\ recurse\_func;}
\DoxyCodeLine{00262\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ nesting\_level\_left;}
\DoxyCodeLine{00263\ }
\DoxyCodeLine{00264\ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__closure__lookups__context__t}{hb\_closure\_lookups\_context\_t}}\ (\mbox{\hyperlink{structhb__face__t}{hb\_face\_t}}\ *face\_,}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs\_,}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *visited\_lookups\_,}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *inactive\_lookups\_,}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ nesting\_level\_left\_\ =\ HB\_MAX\_NESTING\_LEVEL)\ :}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ face\ (face\_),}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ glyphs\ (glyphs\_),}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ recurse\_func\ (\textcolor{keyword}{nullptr}),}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nesting\_level\_left\ (nesting\_level\_left\_),}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ visited\_lookups\ (visited\_lookups\_),}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ inactive\_lookups\ (inactive\_lookups\_),}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_count\ (0)\ \{\}}
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00277\ \ \ \textcolor{keywordtype}{void}\ set\_recurse\_func\ (recurse\_func\_t\ func)\ \{\ recurse\_func\ =\ func;\ \}}
\DoxyCodeLine{00278\ }
\DoxyCodeLine{00279\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00280\ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *visited\_lookups;}
\DoxyCodeLine{00281\ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *inactive\_lookups;}
\DoxyCodeLine{00282\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookup\_count;}
\DoxyCodeLine{00283\ \};}
\DoxyCodeLine{00284\ }
\DoxyCodeLine{00285\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1hb__would__apply__context__t}{hb\_would\_apply\_context\_t}}\ :}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__dispatch__context__t}{hb\_dispatch\_context\_t}}<hb\_would\_apply\_context\_t,\ bool>}
\DoxyCodeLine{00287\ \{}
\DoxyCodeLine{00288\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00289\ \ \ return\_t\ dispatch\ (\textcolor{keyword}{const}\ T\ \&obj)\ \{\ \textcolor{keywordflow}{return}\ obj.would\_apply\ (\textcolor{keyword}{this});\ \}}
\DoxyCodeLine{00290\ \ \ \textcolor{keyword}{static}\ return\_t\ default\_return\_value\ ()\ \{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};\ \}}
\DoxyCodeLine{00291\ \ \ \textcolor{keywordtype}{bool}\ stop\_sublookup\_iteration\ (return\_t\ r)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ r;\ \}}
\DoxyCodeLine{00292\ }
\DoxyCodeLine{00293\ \ \ \mbox{\hyperlink{structhb__face__t}{hb\_face\_t}}\ *face;}
\DoxyCodeLine{00294\ \ \ \textcolor{keyword}{const}\ hb\_codepoint\_t\ *glyphs;}
\DoxyCodeLine{00295\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ len;}
\DoxyCodeLine{00296\ \ \ \textcolor{keywordtype}{bool}\ zero\_context;}
\DoxyCodeLine{00297\ }
\DoxyCodeLine{00298\ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__would__apply__context__t}{hb\_would\_apply\_context\_t}}\ (\mbox{\hyperlink{structhb__face__t}{hb\_face\_t}}\ *face\_,}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ hb\_codepoint\_t\ *glyphs\_,}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ len\_,}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ zero\_context\_)\ :}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ face\ (face\_),}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ glyphs\ (glyphs\_),}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ len\ (len\_),}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ zero\_context\ (zero\_context\_)\ \{\}}
\DoxyCodeLine{00306\ \};}
\DoxyCodeLine{00307\ }
\DoxyCodeLine{00308\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1hb__collect__glyphs__context__t}{hb\_collect\_glyphs\_context\_t}}\ :}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__dispatch__context__t}{hb\_dispatch\_context\_t}}<hb\_collect\_glyphs\_context\_t>}
\DoxyCodeLine{00310\ \{}
\DoxyCodeLine{00311\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{structhb__empty__t}{return\_t}}\ (*recurse\_func\_t)\ (\mbox{\hyperlink{struct_o_t_1_1hb__collect__glyphs__context__t}{hb\_collect\_glyphs\_context\_t}}\ *c,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookup\_index);}
\DoxyCodeLine{00312\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00313\ \ \ \mbox{\hyperlink{structhb__empty__t}{return\_t}}\ dispatch\ (\textcolor{keyword}{const}\ T\ \&obj)\ \{\ obj.collect\_glyphs\ (\textcolor{keyword}{this});\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structhb__empty__t}{hb\_empty\_t}}\ ();\ \}}
\DoxyCodeLine{00314\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{structhb__empty__t}{return\_t}}\ default\_return\_value\ ()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structhb__empty__t}{hb\_empty\_t}}\ ();\ \}}
\DoxyCodeLine{00315\ \ \ \textcolor{keywordtype}{void}\ recurse\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookup\_index)}
\DoxyCodeLine{00316\ \ \ \{}
\DoxyCodeLine{00317\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (nesting\_level\_left\ ==\ 0\ ||\ !recurse\_func))}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00319\ }
\DoxyCodeLine{00320\ \ \ \ \ \textcolor{comment}{/*\ Note\ that\ GPOS\ sets\ recurse\_func\ to\ nullptr\ already,\ so\ it\ doesn't\ get}}
\DoxyCodeLine{00321\ \textcolor{comment}{\ \ \ \ \ *\ past\ the\ previous\ check.\ \ For\ GSUB,\ we\ only\ want\ to\ collect\ the\ output}}
\DoxyCodeLine{00322\ \textcolor{comment}{\ \ \ \ \ *\ glyphs\ in\ the\ recursion.\ \ If\ output\ is\ not\ requested,\ we\ can\ go\ home\ now.}}
\DoxyCodeLine{00323\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{00324\ \textcolor{comment}{\ \ \ \ \ *\ Note\ further,\ that\ the\ above\ is\ not\ exactly\ correct.\ \ A\ recursed\ lookup}}
\DoxyCodeLine{00325\ \textcolor{comment}{\ \ \ \ \ *\ is\ allowed\ to\ match\ input\ that\ is\ not\ matched\ in\ the\ context,\ but\ that's}}
\DoxyCodeLine{00326\ \textcolor{comment}{\ \ \ \ \ *\ not\ how\ most\ fonts\ are\ built.\ \ It's\ possible\ to\ relax\ that\ and\ recurse}}
\DoxyCodeLine{00327\ \textcolor{comment}{\ \ \ \ \ *\ with\ all\ sets\ here\ if\ it\ proves\ to\ be\ an\ issue.}}
\DoxyCodeLine{00328\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00329\ }
\DoxyCodeLine{00330\ \ \ \ \ \textcolor{keywordflow}{if}\ (output\ ==\ hb\_set\_get\_empty\ ())}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00332\ }
\DoxyCodeLine{00333\ \ \ \ \ \textcolor{comment}{/*\ Return\ if\ new\ lookup\ was\ recursed\ to\ before.\ */}}
\DoxyCodeLine{00334\ \ \ \ \ \textcolor{keywordflow}{if}\ (recursed\_lookups-\/>has\ (lookup\_index))}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00336\ }
\DoxyCodeLine{00337\ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *old\_before\ =\ before;}
\DoxyCodeLine{00338\ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *old\_input\ \ =\ \mbox{\hyperlink{structinput}{input}};}
\DoxyCodeLine{00339\ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *old\_after\ \ =\ after;}
\DoxyCodeLine{00340\ \ \ \ \ before\ =\ \mbox{\hyperlink{structinput}{input}}\ =\ after\ =\ hb\_set\_get\_empty\ ();}
\DoxyCodeLine{00341\ }
\DoxyCodeLine{00342\ \ \ \ \ nesting\_level\_left-\/-\/;}
\DoxyCodeLine{00343\ \ \ \ \ recurse\_func\ (\textcolor{keyword}{this},\ lookup\_index);}
\DoxyCodeLine{00344\ \ \ \ \ nesting\_level\_left++;}
\DoxyCodeLine{00345\ }
\DoxyCodeLine{00346\ \ \ \ \ before\ =\ old\_before;}
\DoxyCodeLine{00347\ \ \ \ \ \mbox{\hyperlink{structinput}{input}}\ \ =\ old\_input;}
\DoxyCodeLine{00348\ \ \ \ \ after\ \ =\ old\_after;}
\DoxyCodeLine{00349\ }
\DoxyCodeLine{00350\ \ \ \ \ recursed\_lookups-\/>add\ (lookup\_index);}
\DoxyCodeLine{00351\ \ \ \}}
\DoxyCodeLine{00352\ }
\DoxyCodeLine{00353\ \ \ \mbox{\hyperlink{structhb__face__t}{hb\_face\_t}}\ *face;}
\DoxyCodeLine{00354\ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *before;}
\DoxyCodeLine{00355\ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *\mbox{\hyperlink{structinput}{input}};}
\DoxyCodeLine{00356\ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *after;}
\DoxyCodeLine{00357\ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *output;}
\DoxyCodeLine{00358\ \ \ recurse\_func\_t\ recurse\_func;}
\DoxyCodeLine{00359\ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *recursed\_lookups;}
\DoxyCodeLine{00360\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ nesting\_level\_left;}
\DoxyCodeLine{00361\ }
\DoxyCodeLine{00362\ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__collect__glyphs__context__t}{hb\_collect\_glyphs\_context\_t}}\ (\mbox{\hyperlink{structhb__face__t}{hb\_face\_t}}\ *face\_,}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \ *glyphs\_before,\ \textcolor{comment}{/*\ OUT.\ \ May\ be\ NULL\ */}}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \ *glyphs\_input,\ \ \textcolor{comment}{/*\ OUT.\ \ May\ be\ NULL\ */}}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \ *glyphs\_after,\ \ \textcolor{comment}{/*\ OUT.\ \ May\ be\ NULL\ */}}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \ *glyphs\_output,\ \textcolor{comment}{/*\ OUT.\ \ May\ be\ NULL\ */}}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ nesting\_level\_left\_\ =\ HB\_MAX\_NESTING\_LEVEL)\ :}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ face\ (face\_),}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ before\ (glyphs\_before\ ?\ glyphs\_before\ :\ hb\_set\_get\_empty\ ()),}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structinput}{input}}\ \ (glyphs\_input\ \ ?\ glyphs\_input\ \ :\ hb\_set\_get\_empty\ ()),}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ after\ \ (glyphs\_after\ \ ?\ glyphs\_after\ \ :\ hb\_set\_get\_empty\ ()),}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ output\ (glyphs\_output\ ?\ glyphs\_output\ :\ hb\_set\_get\_empty\ ()),}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ recurse\_func\ (\textcolor{keyword}{nullptr}),}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ recursed\_lookups\ (hb\_set\_create\ ()),}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nesting\_level\_left\ (nesting\_level\_left\_)\ \{\}}
\DoxyCodeLine{00376\ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__collect__glyphs__context__t}{\string~hb\_collect\_glyphs\_context\_t}}\ ()\ \{\ hb\_set\_destroy\ (recursed\_lookups);\ \}}
\DoxyCodeLine{00377\ }
\DoxyCodeLine{00378\ \ \ \textcolor{keywordtype}{void}\ set\_recurse\_func\ (recurse\_func\_t\ func)\ \{\ recurse\_func\ =\ func;\ \}}
\DoxyCodeLine{00379\ \};}
\DoxyCodeLine{00380\ }
\DoxyCodeLine{00381\ }
\DoxyCodeLine{00382\ }
\DoxyCodeLine{00383\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ set\_t>}
\DoxyCodeLine{00384\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1hb__collect__coverage__context__t}{hb\_collect\_coverage\_context\_t}}\ :}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__dispatch__context__t}{hb\_dispatch\_context\_t}}<hb\_collect\_coverage\_context\_t<set\_t>,\ const\ Coverage\ \&>}
\DoxyCodeLine{00386\ \{}
\DoxyCodeLine{00387\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_coverage}{Coverage}}\ \&\mbox{\hyperlink{struct_o_t_1_1_coverage}{return\_t}};\ \textcolor{comment}{//\ Stoopid\ that\ we\ have\ to\ dupe\ this\ here.}}
\DoxyCodeLine{00388\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00389\ \ \ \mbox{\hyperlink{struct_o_t_1_1_coverage}{return\_t}}\ dispatch\ (\textcolor{keyword}{const}\ T\ \&obj)\ \{\ \textcolor{keywordflow}{return}\ obj.get\_coverage\ ();\ \}}
\DoxyCodeLine{00390\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{struct_o_t_1_1_coverage}{return\_t}}\ default\_return\_value\ ()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_null}{Null}}\ (\mbox{\hyperlink{struct_o_t_1_1_coverage}{Coverage}});\ \}}
\DoxyCodeLine{00391\ \ \ \textcolor{keywordtype}{bool}\ stop\_sublookup\_iteration\ (\mbox{\hyperlink{struct_o_t_1_1_coverage}{return\_t}}\ r)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00392\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00393\ \ \ \ \ r.collect\_coverage\ (set);}
\DoxyCodeLine{00394\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00395\ \ \ \}}
\DoxyCodeLine{00396\ }
\DoxyCodeLine{00397\ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__collect__coverage__context__t}{hb\_collect\_coverage\_context\_t}}\ (set\_t\ *set\_)\ :}
\DoxyCodeLine{00398\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ set\ (set\_)\ \{\}}
\DoxyCodeLine{00399\ }
\DoxyCodeLine{00400\ \ \ set\_t\ *set;}
\DoxyCodeLine{00401\ \};}
\DoxyCodeLine{00402\ }
\DoxyCodeLine{00403\ }
\DoxyCodeLine{00404\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1hb__ot__apply__context__t}{hb\_ot\_apply\_context\_t}}\ :}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__dispatch__context__t}{hb\_dispatch\_context\_t}}<hb\_ot\_apply\_context\_t,\ bool,\ HB\_DEBUG\_APPLY>}
\DoxyCodeLine{00406\ \{}
\DoxyCodeLine{00407\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1hb__ot__apply__context__t_1_1matcher__t}{matcher\_t}}}
\DoxyCodeLine{00408\ \ \ \{}
\DoxyCodeLine{00409\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__ot__apply__context__t_1_1matcher__t}{matcher\_t}}\ ()\ :}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \ lookup\_props\ (0),}
\DoxyCodeLine{00411\ \ \ \ \ \ \ \ \ \ ignore\_zwnj\ (\textcolor{keyword}{false}),}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \ \ \ ignore\_zwj\ (\textcolor{keyword}{false}),}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ \ mask\ (-\/1),}
\DoxyCodeLine{00414\ \textcolor{preprocessor}{\#define\ arg1(arg)\ (arg)\ }\textcolor{comment}{/*\ Remove\ the\ macro\ to\ see\ why\ it's\ needed!\ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ \ syllable\ arg1(0),}
\DoxyCodeLine{00416\ \textcolor{preprocessor}{\#undef\ arg1}}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ \ match\_func\ (\textcolor{keyword}{nullptr}),}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ \ match\_data\ (\textcolor{keyword}{nullptr})\ \{\}}
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00420\ \ \ \ \ \textcolor{keyword}{typedef}\ bool\ (*match\_func\_t)\ (hb\_codepoint\_t\ glyph\_id,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \&\mbox{\hyperlink{classvalue}{value}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{structdata}{data}});}
\DoxyCodeLine{00421\ }
\DoxyCodeLine{00422\ \ \ \ \ \textcolor{keywordtype}{void}\ set\_ignore\_zwnj\ (\textcolor{keywordtype}{bool}\ ignore\_zwnj\_)\ \{\ ignore\_zwnj\ =\ ignore\_zwnj\_;\ \}}
\DoxyCodeLine{00423\ \ \ \ \ \textcolor{keywordtype}{void}\ set\_ignore\_zwj\ (\textcolor{keywordtype}{bool}\ ignore\_zwj\_)\ \{\ ignore\_zwj\ =\ ignore\_zwj\_;\ \}}
\DoxyCodeLine{00424\ \ \ \ \ \textcolor{keywordtype}{void}\ set\_lookup\_props\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookup\_props\_)\ \{\ lookup\_props\ =\ lookup\_props\_;\ \}}
\DoxyCodeLine{00425\ \ \ \ \ \textcolor{keywordtype}{void}\ set\_mask\ (hb\_mask\_t\ mask\_)\ \{\ mask\ =\ mask\_;\ \}}
\DoxyCodeLine{00426\ \ \ \ \ \textcolor{keywordtype}{void}\ set\_syllable\ (uint8\_t\ syllable\_)\ \ \{\ syllable\ =\ syllable\_;\ \}}
\DoxyCodeLine{00427\ \ \ \ \ \textcolor{keywordtype}{void}\ set\_match\_func\ (match\_func\_t\ match\_func\_,}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *match\_data\_)}
\DoxyCodeLine{00429\ \ \ \ \ \{\ match\_func\ =\ match\_func\_;\ match\_data\ =\ match\_data\_;\ \}}
\DoxyCodeLine{00430\ }
\DoxyCodeLine{00431\ \ \ \ \ \textcolor{keyword}{enum}\ may\_match\_t\ \{}
\DoxyCodeLine{00432\ \ \ \ \ \ \ MATCH\_NO,}
\DoxyCodeLine{00433\ \ \ \ \ \ \ MATCH\_YES,}
\DoxyCodeLine{00434\ \ \ \ \ \ \ MATCH\_MAYBE}
\DoxyCodeLine{00435\ \ \ \ \ \};}
\DoxyCodeLine{00436\ }
\DoxyCodeLine{00437\ \ \ \ \ may\_match\_t\ may\_match\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__glyph__info__t}{hb\_glyph\_info\_t}}\ \&info,}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ \ \ \ \ \ \ *glyph\_data)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00439\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!(info.mask\ \&\ mask)\ ||}
\DoxyCodeLine{00441\ \ \ \ \ \ \ (syllable\ \&\&\ syllable\ !=\ info.syllable\ ()))}
\DoxyCodeLine{00442\ \ \ \ \ \textcolor{keywordflow}{return}\ MATCH\_NO;}
\DoxyCodeLine{00443\ }
\DoxyCodeLine{00444\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (match\_func)}
\DoxyCodeLine{00445\ \ \ \ \ \textcolor{keywordflow}{return}\ match\_func\ (info.codepoint,\ *glyph\_data,\ match\_data)\ ?\ MATCH\_YES\ :\ MATCH\_NO;}
\DoxyCodeLine{00446\ }
\DoxyCodeLine{00447\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ MATCH\_MAYBE;}
\DoxyCodeLine{00448\ \ \ \ \ \}}
\DoxyCodeLine{00449\ }
\DoxyCodeLine{00450\ \ \ \ \ \textcolor{keyword}{enum}\ may\_skip\_t\ \{}
\DoxyCodeLine{00451\ \ \ \ \ \ \ SKIP\_NO,}
\DoxyCodeLine{00452\ \ \ \ \ \ \ SKIP\_YES,}
\DoxyCodeLine{00453\ \ \ \ \ \ \ SKIP\_MAYBE}
\DoxyCodeLine{00454\ \ \ \ \ \};}
\DoxyCodeLine{00455\ }
\DoxyCodeLine{00456\ \ \ \ \ may\_skip\_t\ may\_skip\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1hb__ot__apply__context__t}{hb\_ot\_apply\_context\_t}}\ *c,}
\DoxyCodeLine{00457\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__glyph__info__t}{hb\_glyph\_info\_t}}\ \ \ \ \ \ \ \&info)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00458\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00459\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!c-\/>check\_glyph\_property\ (\&info,\ lookup\_props))}
\DoxyCodeLine{00460\ \ \ \ \ \textcolor{keywordflow}{return}\ SKIP\_YES;}
\DoxyCodeLine{00461\ }
\DoxyCodeLine{00462\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (\_hb\_glyph\_info\_is\_default\_ignorable\_and\_not\_hidden\ (\&info)\ \&\&}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \ \ \ \ \ \ (ignore\_zwnj\ ||\ !\_hb\_glyph\_info\_is\_zwnj\ (\&info))\ \&\&}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ \ \ \ \ (ignore\_zwj\ ||\ !\_hb\_glyph\_info\_is\_zwj\ (\&info))))}
\DoxyCodeLine{00465\ \ \ \ \ \textcolor{keywordflow}{return}\ SKIP\_MAYBE;}
\DoxyCodeLine{00466\ }
\DoxyCodeLine{00467\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ SKIP\_NO;}
\DoxyCodeLine{00468\ \ \ \ \ \}}
\DoxyCodeLine{00469\ }
\DoxyCodeLine{00470\ \ \ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00471\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookup\_props;}
\DoxyCodeLine{00472\ \ \ \ \ \textcolor{keywordtype}{bool}\ ignore\_zwnj;}
\DoxyCodeLine{00473\ \ \ \ \ \textcolor{keywordtype}{bool}\ ignore\_zwj;}
\DoxyCodeLine{00474\ \ \ \ \ hb\_mask\_t\ mask;}
\DoxyCodeLine{00475\ \ \ \ \ uint8\_t\ syllable;}
\DoxyCodeLine{00476\ \ \ \ \ match\_func\_t\ match\_func;}
\DoxyCodeLine{00477\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *match\_data;}
\DoxyCodeLine{00478\ \ \ \};}
\DoxyCodeLine{00479\ }
\DoxyCodeLine{00480\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1hb__ot__apply__context__t_1_1skipping__iterator__t}{skipping\_iterator\_t}}}
\DoxyCodeLine{00481\ \ \ \{}
\DoxyCodeLine{00482\ \ \ \ \ \textcolor{keywordtype}{void}\ init\ (\mbox{\hyperlink{struct_o_t_1_1hb__ot__apply__context__t}{hb\_ot\_apply\_context\_t}}\ *c\_,\ \textcolor{keywordtype}{bool}\ context\_match\ =\ \textcolor{keyword}{false})}
\DoxyCodeLine{00483\ \ \ \ \ \{}
\DoxyCodeLine{00484\ \ \ \ \ \ \ c\ =\ c\_;}
\DoxyCodeLine{00485\ \ \ \ \ \ \ match\_glyph\_data\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00486\ \ \ \ \ \ \ matcher.set\_match\_func\ (\textcolor{keyword}{nullptr},\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00487\ \ \ \ \ \ \ matcher.set\_lookup\_props\ (c-\/>lookup\_props);}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \textcolor{comment}{/*\ Ignore\ ZWNJ\ if\ we\ are\ matching\ GPOS,\ or\ matching\ GSUB\ context\ and\ asked\ to.\ */}}
\DoxyCodeLine{00489\ \ \ \ \ \ \ matcher.set\_ignore\_zwnj\ (c-\/>table\_index\ ==\ 1\ ||\ (context\_match\ \&\&\ c-\/>auto\_zwnj));}
\DoxyCodeLine{00490\ \ \ \ \ \ \ \textcolor{comment}{/*\ Ignore\ ZWJ\ if\ we\ are\ matching\ context,\ or\ asked\ to.\ */}}
\DoxyCodeLine{00491\ \ \ \ \ \ \ matcher.set\_ignore\_zwj\ \ (context\_match\ ||\ c-\/>auto\_zwj);}
\DoxyCodeLine{00492\ \ \ \ \ \ \ matcher.set\_mask\ (context\_match\ ?\ -\/1\ :\ c-\/>lookup\_mask);}
\DoxyCodeLine{00493\ \ \ \ \ \}}
\DoxyCodeLine{00494\ \ \ \ \ \textcolor{keywordtype}{void}\ set\_lookup\_props\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookup\_props)}
\DoxyCodeLine{00495\ \ \ \ \ \{}
\DoxyCodeLine{00496\ \ \ \ \ \ \ matcher.set\_lookup\_props\ (lookup\_props);}
\DoxyCodeLine{00497\ \ \ \ \ \}}
\DoxyCodeLine{00498\ \ \ \ \ \textcolor{keywordtype}{void}\ set\_match\_func\ (matcher\_t::match\_func\_t\ match\_func\_,}
\DoxyCodeLine{00499\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *match\_data\_,}
\DoxyCodeLine{00500\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ glyph\_data[])}
\DoxyCodeLine{00501\ \ \ \ \ \{}
\DoxyCodeLine{00502\ \ \ \ \ \ \ matcher.set\_match\_func\ (match\_func\_,\ match\_data\_);}
\DoxyCodeLine{00503\ \ \ \ \ \ \ match\_glyph\_data\ =\ glyph\_data;}
\DoxyCodeLine{00504\ \ \ \ \ \}}
\DoxyCodeLine{00505\ }
\DoxyCodeLine{00506\ \ \ \ \ \textcolor{keywordtype}{void}\ reset\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ start\_index\_,}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ num\_items\_)}
\DoxyCodeLine{00508\ \ \ \ \ \{}
\DoxyCodeLine{00509\ \ \ \ \ \ \ idx\ =\ start\_index\_;}
\DoxyCodeLine{00510\ \ \ \ \ \ \ num\_items\ =\ num\_items\_;}
\DoxyCodeLine{00511\ \ \ \ \ \ \ end\ =\ c-\/>buffer-\/>len;}
\DoxyCodeLine{00512\ \ \ \ \ \ \ matcher.set\_syllable\ (start\_index\_\ ==\ c-\/>buffer-\/>idx\ ?\ c-\/>buffer-\/>cur().syllable\ ()\ :\ 0);}
\DoxyCodeLine{00513\ \ \ \ \ \}}
\DoxyCodeLine{00514\ }
\DoxyCodeLine{00515\ \ \ \ \ \textcolor{keywordtype}{void}\ reject\ ()}
\DoxyCodeLine{00516\ \ \ \ \ \{}
\DoxyCodeLine{00517\ \ \ \ \ \ \ num\_items++;}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (match\_glyph\_data)\ match\_glyph\_data-\/-\/;}
\DoxyCodeLine{00519\ \ \ \ \ \}}
\DoxyCodeLine{00520\ }
\DoxyCodeLine{00521\ \ \ \ \ matcher\_t::may\_skip\_t}
\DoxyCodeLine{00522\ \ \ \ \ may\_skip\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__glyph__info__t}{hb\_glyph\_info\_t}}\ \&info)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00523\ \textcolor{keyword}{\ \ \ \ }\{\ \textcolor{keywordflow}{return}\ matcher.may\_skip\ (c,\ info);\ \}}
\DoxyCodeLine{00524\ }
\DoxyCodeLine{00525\ \ \ \ \ \textcolor{keywordtype}{bool}\ next\ (\textcolor{keywordtype}{unsigned}\ *unsafe\_to\ =\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00526\ \ \ \ \ \{}
\DoxyCodeLine{00527\ \ \ \ \ \ \ assert\ (num\_items\ >\ 0);}
\DoxyCodeLine{00528\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (idx\ +\ num\_items\ <\ end)}
\DoxyCodeLine{00529\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00530\ \ \ \ \ idx++;}
\DoxyCodeLine{00531\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__glyph__info__t}{hb\_glyph\_info\_t}}\ \&info\ =\ c-\/>buffer-\/>info[idx];}
\DoxyCodeLine{00532\ }
\DoxyCodeLine{00533\ \ \ \ \ matcher\_t::may\_skip\_t\ skip\ =\ matcher.may\_skip\ (c,\ info);}
\DoxyCodeLine{00534\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (skip\ ==\ matcher\_t::SKIP\_YES))}
\DoxyCodeLine{00535\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00536\ }
\DoxyCodeLine{00537\ \ \ \ \ matcher\_t::may\_match\_t\ \mbox{\hyperlink{structmatch}{match}}\ =\ matcher.may\_match\ (info,\ match\_glyph\_data);}
\DoxyCodeLine{00538\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structmatch}{match}}\ ==\ matcher\_t::MATCH\_YES\ ||}
\DoxyCodeLine{00539\ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{structmatch}{match}}\ ==\ matcher\_t::MATCH\_MAYBE\ \&\&}
\DoxyCodeLine{00540\ \ \ \ \ \ \ \ \ \ skip\ ==\ matcher\_t::SKIP\_NO))}
\DoxyCodeLine{00541\ \ \ \ \ \{}
\DoxyCodeLine{00542\ \ \ \ \ \ \ num\_items-\/-\/;}
\DoxyCodeLine{00543\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (match\_glyph\_data)\ match\_glyph\_data++;}
\DoxyCodeLine{00544\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00545\ \ \ \ \ \}}
\DoxyCodeLine{00546\ }
\DoxyCodeLine{00547\ \ \ \ \ \textcolor{keywordflow}{if}\ (skip\ ==\ matcher\_t::SKIP\_NO)}
\DoxyCodeLine{00548\ \ \ \ \ \{}
\DoxyCodeLine{00549\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unsafe\_to)}
\DoxyCodeLine{00550\ \ \ \ \ \ \ \ \ *unsafe\_to\ =\ idx\ +\ 1;}
\DoxyCodeLine{00551\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00552\ \ \ \ \ \}}
\DoxyCodeLine{00553\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00554\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unsafe\_to)}
\DoxyCodeLine{00555\ \ \ \ \ \ \ \ \ *unsafe\_to\ =\ end;}
\DoxyCodeLine{00556\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00557\ \ \ \ \ \}}
\DoxyCodeLine{00558\ \ \ \ \ \textcolor{keywordtype}{bool}\ prev\ (\textcolor{keywordtype}{unsigned}\ *unsafe\_from\ =\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00559\ \ \ \ \ \{}
\DoxyCodeLine{00560\ \ \ \ \ \ \ assert\ (num\_items\ >\ 0);}
\DoxyCodeLine{00561\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (idx\ >\ num\_items\ -\/\ 1)}
\DoxyCodeLine{00562\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00563\ \ \ \ \ idx-\/-\/;}
\DoxyCodeLine{00564\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__glyph__info__t}{hb\_glyph\_info\_t}}\ \&info\ =\ c-\/>buffer-\/>out\_info[idx];}
\DoxyCodeLine{00565\ }
\DoxyCodeLine{00566\ \ \ \ \ matcher\_t::may\_skip\_t\ skip\ =\ matcher.may\_skip\ (c,\ info);}
\DoxyCodeLine{00567\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (skip\ ==\ matcher\_t::SKIP\_YES))}
\DoxyCodeLine{00568\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00569\ }
\DoxyCodeLine{00570\ \ \ \ \ matcher\_t::may\_match\_t\ \mbox{\hyperlink{structmatch}{match}}\ =\ matcher.may\_match\ (info,\ match\_glyph\_data);}
\DoxyCodeLine{00571\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structmatch}{match}}\ ==\ matcher\_t::MATCH\_YES\ ||}
\DoxyCodeLine{00572\ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{structmatch}{match}}\ ==\ matcher\_t::MATCH\_MAYBE\ \&\&}
\DoxyCodeLine{00573\ \ \ \ \ \ \ \ \ \ skip\ ==\ matcher\_t::SKIP\_NO))}
\DoxyCodeLine{00574\ \ \ \ \ \{}
\DoxyCodeLine{00575\ \ \ \ \ \ \ num\_items-\/-\/;}
\DoxyCodeLine{00576\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (match\_glyph\_data)\ match\_glyph\_data++;}
\DoxyCodeLine{00577\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00578\ \ \ \ \ \}}
\DoxyCodeLine{00579\ }
\DoxyCodeLine{00580\ \ \ \ \ \textcolor{keywordflow}{if}\ (skip\ ==\ matcher\_t::SKIP\_NO)}
\DoxyCodeLine{00581\ \ \ \ \ \{}
\DoxyCodeLine{00582\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unsafe\_from)}
\DoxyCodeLine{00583\ \ \ \ \ \ \ \ \ *unsafe\_from\ =\ hb\_max\ (1u,\ idx)\ -\/\ 1u;}
\DoxyCodeLine{00584\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00585\ \ \ \ \ \}}
\DoxyCodeLine{00586\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00587\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unsafe\_from)}
\DoxyCodeLine{00588\ \ \ \ \ \ \ \ \ *unsafe\_from\ =\ 0;}
\DoxyCodeLine{00589\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00590\ \ \ \ \ \}}
\DoxyCodeLine{00591\ }
\DoxyCodeLine{00592\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ idx;}
\DoxyCodeLine{00593\ \ \ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00594\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__ot__apply__context__t}{hb\_ot\_apply\_context\_t}}\ *c;}
\DoxyCodeLine{00595\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__ot__apply__context__t_1_1matcher__t}{matcher\_t}}\ matcher;}
\DoxyCodeLine{00596\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *match\_glyph\_data;}
\DoxyCodeLine{00597\ }
\DoxyCodeLine{00598\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ num\_items;}
\DoxyCodeLine{00599\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ end;}
\DoxyCodeLine{00600\ \ \ \};}
\DoxyCodeLine{00601\ }
\DoxyCodeLine{00602\ }
\DoxyCodeLine{00603\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *get\_name\ ()\ \{\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}APPLY"{}};\ \}}
\DoxyCodeLine{00604\ \ \ \textcolor{keyword}{typedef}\ return\_t\ (*recurse\_func\_t)\ (\mbox{\hyperlink{struct_o_t_1_1hb__ot__apply__context__t}{hb\_ot\_apply\_context\_t}}\ *c,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookup\_index);}
\DoxyCodeLine{00605\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00606\ \ \ return\_t\ dispatch\ (\textcolor{keyword}{const}\ T\ \&obj)\ \{\ \textcolor{keywordflow}{return}\ obj.apply\ (\textcolor{keyword}{this});\ \}}
\DoxyCodeLine{00607\ \ \ \textcolor{keyword}{static}\ return\_t\ default\_return\_value\ ()\ \{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};\ \}}
\DoxyCodeLine{00608\ \ \ \textcolor{keywordtype}{bool}\ stop\_sublookup\_iteration\ (return\_t\ r)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ r;\ \}}
\DoxyCodeLine{00609\ \ \ return\_t\ recurse\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ sub\_lookup\_index)}
\DoxyCodeLine{00610\ \ \ \{}
\DoxyCodeLine{00611\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (nesting\_level\_left\ ==\ 0\ ||\ !recurse\_func\ ||\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>max\_ops-\/-\/\ <=\ 0))}
\DoxyCodeLine{00612\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ default\_return\_value\ ();}
\DoxyCodeLine{00613\ }
\DoxyCodeLine{00614\ \ \ \ \ nesting\_level\_left-\/-\/;}
\DoxyCodeLine{00615\ \ \ \ \ \textcolor{keywordtype}{bool}\ ret\ =\ recurse\_func\ (\textcolor{keyword}{this},\ sub\_lookup\_index);}
\DoxyCodeLine{00616\ \ \ \ \ nesting\_level\_left++;}
\DoxyCodeLine{00617\ \ \ \ \ \textcolor{keywordflow}{return}\ ret;}
\DoxyCodeLine{00618\ \ \ \}}
\DoxyCodeLine{00619\ }
\DoxyCodeLine{00620\ \ \ skipping\_iterator\_t\ iter\_input,\ iter\_context;}
\DoxyCodeLine{00621\ }
\DoxyCodeLine{00622\ \ \ \mbox{\hyperlink{structhb__font__t}{hb\_font\_t}}\ *font;}
\DoxyCodeLine{00623\ \ \ \mbox{\hyperlink{structhb__face__t}{hb\_face\_t}}\ *face;}
\DoxyCodeLine{00624\ \ \ \mbox{\hyperlink{structhb__buffer__t}{hb\_buffer\_t}}\ *\mbox{\hyperlink{classbuffer}{buffer}};}
\DoxyCodeLine{00625\ \ \ recurse\_func\_t\ recurse\_func;}
\DoxyCodeLine{00626\ \ \ \textcolor{keyword}{const}\ GDEF\ \&gdef;}
\DoxyCodeLine{00627\ \ \ \textcolor{keyword}{const}\ VariationStore\ \&var\_store;}
\DoxyCodeLine{00628\ }
\DoxyCodeLine{00629\ \ \ hb\_direction\_t\ direction;}
\DoxyCodeLine{00630\ \ \ hb\_mask\_t\ lookup\_mask;}
\DoxyCodeLine{00631\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ table\_index;\ \textcolor{comment}{/*\ GSUB/GPOS\ */}}
\DoxyCodeLine{00632\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookup\_index;}
\DoxyCodeLine{00633\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookup\_props;}
\DoxyCodeLine{00634\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ nesting\_level\_left;}
\DoxyCodeLine{00635\ }
\DoxyCodeLine{00636\ \ \ \textcolor{keywordtype}{bool}\ has\_glyph\_classes;}
\DoxyCodeLine{00637\ \ \ \textcolor{keywordtype}{bool}\ auto\_zwnj;}
\DoxyCodeLine{00638\ \ \ \textcolor{keywordtype}{bool}\ auto\_zwj;}
\DoxyCodeLine{00639\ \ \ \textcolor{keywordtype}{bool}\ random;}
\DoxyCodeLine{00640\ }
\DoxyCodeLine{00641\ \ \ uint32\_t\ random\_state;}
\DoxyCodeLine{00642\ }
\DoxyCodeLine{00643\ }
\DoxyCodeLine{00644\ \ \ hb\_ot\_apply\_context\_t\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ table\_index\_,}
\DoxyCodeLine{00645\ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__font__t}{hb\_font\_t}}\ *font\_,}
\DoxyCodeLine{00646\ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__buffer__t}{hb\_buffer\_t}}\ *buffer\_)\ :}
\DoxyCodeLine{00647\ \ \ \ \ \ \ \ \ \ \ \ \ iter\_input\ (),\ iter\_context\ (),}
\DoxyCodeLine{00648\ \ \ \ \ \ \ \ \ \ \ \ \ font\ (font\_),\ face\ (font-\/>face),\ \mbox{\hyperlink{classbuffer}{buffer}}\ (buffer\_),}
\DoxyCodeLine{00649\ \ \ \ \ \ \ \ \ \ \ \ \ recurse\_func\ (nullptr),}
\DoxyCodeLine{00650\ \ \ \ \ \ \ \ \ \ \ \ \ gdef\ (}
\DoxyCodeLine{00651\ \#ifndef\ HB\_NO\_OT\_LAYOUT}
\DoxyCodeLine{00652\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *face-\/>table.GDEF-\/>table}
\DoxyCodeLine{00653\ \#else}
\DoxyCodeLine{00654\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_null}{Null}}\ (GDEF)}
\DoxyCodeLine{00655\ \#endif}
\DoxyCodeLine{00656\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ),}
\DoxyCodeLine{00657\ \ \ \ \ \ \ \ \ \ \ \ \ var\_store\ (gdef.get\_var\_store\ ()),}
\DoxyCodeLine{00658\ \ \ \ \ \ \ \ \ \ \ \ \ direction\ (buffer\_-\/>props.direction),}
\DoxyCodeLine{00659\ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_mask\ (1),}
\DoxyCodeLine{00660\ \ \ \ \ \ \ \ \ \ \ \ \ table\_index\ (table\_index\_),}
\DoxyCodeLine{00661\ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_index\ ((unsigned\ int)\ -\/1),}
\DoxyCodeLine{00662\ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_props\ (0),}
\DoxyCodeLine{00663\ \ \ \ \ \ \ \ \ \ \ \ \ nesting\_level\_left\ (HB\_MAX\_NESTING\_LEVEL),}
\DoxyCodeLine{00664\ \ \ \ \ \ \ \ \ \ \ \ \ has\_glyph\_classes\ (gdef.has\_glyph\_classes\ ()),}
\DoxyCodeLine{00665\ \ \ \ \ \ \ \ \ \ \ \ \ auto\_zwnj\ (true),}
\DoxyCodeLine{00666\ \ \ \ \ \ \ \ \ \ \ \ \ auto\_zwj\ (true),}
\DoxyCodeLine{00667\ \ \ \ \ \ \ \ \ \ \ \ \ random\ (false),}
\DoxyCodeLine{00668\ \ \ \ \ \ \ \ \ \ \ \ \ random\_state\ (1)\ \{\ init\_iters\ ();\ \}}
\DoxyCodeLine{00669\ }
\DoxyCodeLine{00670\ \ \ \textcolor{keywordtype}{void}\ init\_iters\ ()}
\DoxyCodeLine{00671\ \ \ \{}
\DoxyCodeLine{00672\ \ \ \ \ iter\_input.init\ (\textcolor{keyword}{this},\ \textcolor{keyword}{false});}
\DoxyCodeLine{00673\ \ \ \ \ iter\_context.init\ (\textcolor{keyword}{this},\ \textcolor{keyword}{true});}
\DoxyCodeLine{00674\ \ \ \}}
\DoxyCodeLine{00675\ }
\DoxyCodeLine{00676\ \ \ \textcolor{keywordtype}{void}\ set\_lookup\_mask\ (hb\_mask\_t\ mask)\ \{\ lookup\_mask\ =\ mask;\ init\_iters\ ();\ \}}
\DoxyCodeLine{00677\ \ \ \textcolor{keywordtype}{void}\ set\_auto\_zwj\ (\textcolor{keywordtype}{bool}\ auto\_zwj\_)\ \{\ auto\_zwj\ =\ auto\_zwj\_;\ init\_iters\ ();\ \}}
\DoxyCodeLine{00678\ \ \ \textcolor{keywordtype}{void}\ set\_auto\_zwnj\ (\textcolor{keywordtype}{bool}\ auto\_zwnj\_)\ \{\ auto\_zwnj\ =\ auto\_zwnj\_;\ init\_iters\ ();\ \}}
\DoxyCodeLine{00679\ \ \ \textcolor{keywordtype}{void}\ set\_random\ (\textcolor{keywordtype}{bool}\ random\_)\ \{\ random\ =\ random\_;\ \}}
\DoxyCodeLine{00680\ \ \ \textcolor{keywordtype}{void}\ set\_recurse\_func\ (recurse\_func\_t\ func)\ \{\ recurse\_func\ =\ func;\ \}}
\DoxyCodeLine{00681\ \ \ \textcolor{keywordtype}{void}\ set\_lookup\_index\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookup\_index\_)\ \{\ lookup\_index\ =\ lookup\_index\_;\ \}}
\DoxyCodeLine{00682\ \ \ \textcolor{keywordtype}{void}\ set\_lookup\_props\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookup\_props\_)\ \{\ lookup\_props\ =\ lookup\_props\_;\ init\_iters\ ();\ \}}
\DoxyCodeLine{00683\ }
\DoxyCodeLine{00684\ \ \ uint32\_t\ random\_number\ ()}
\DoxyCodeLine{00685\ \ \ \{}
\DoxyCodeLine{00686\ \ \ \ \ \textcolor{comment}{/*\ http://www.cplusplus.com/reference/random/minstd\_rand/\ */}}
\DoxyCodeLine{00687\ \ \ \ \ random\_state\ =\ random\_state\ *\ 48271\ \%\ 2147483647;}
\DoxyCodeLine{00688\ \ \ \ \ \textcolor{keywordflow}{return}\ random\_state;}
\DoxyCodeLine{00689\ \ \ \}}
\DoxyCodeLine{00690\ }
\DoxyCodeLine{00691\ \ \ \textcolor{keywordtype}{bool}\ match\_properties\_mark\ (hb\_codepoint\_t\ \ glyph,}
\DoxyCodeLine{00692\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \ \ \ glyph\_props,}
\DoxyCodeLine{00693\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \ \ \ match\_props)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00694\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00695\ \ \ \ \ \textcolor{comment}{/*\ If\ using\ mark\ filtering\ sets,\ the\ high\ short\ of}}
\DoxyCodeLine{00696\ \textcolor{comment}{\ \ \ \ \ *\ match\_props\ has\ the\ set\ index.}}
\DoxyCodeLine{00697\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00698\ \ \ \ \ \textcolor{keywordflow}{if}\ (match\_props\ \&\ LookupFlag::UseMarkFilteringSet)}
\DoxyCodeLine{00699\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ gdef.mark\_set\_covers\ (match\_props\ >>\ 16,\ glyph);}
\DoxyCodeLine{00700\ }
\DoxyCodeLine{00701\ \ \ \ \ \textcolor{comment}{/*\ The\ second\ byte\ of\ match\_props\ has\ the\ meaning}}
\DoxyCodeLine{00702\ \textcolor{comment}{\ \ \ \ \ *\ "{}ignore\ marks\ of\ attachment\ type\ different\ than}}
\DoxyCodeLine{00703\ \textcolor{comment}{\ \ \ \ \ *\ the\ attachment\ type\ specified."{}}}
\DoxyCodeLine{00704\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00705\ \ \ \ \ \textcolor{keywordflow}{if}\ (match\_props\ \&\ LookupFlag::MarkAttachmentType)}
\DoxyCodeLine{00706\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (match\_props\ \&\ LookupFlag::MarkAttachmentType)\ ==\ (glyph\_props\ \&\ LookupFlag::MarkAttachmentType);}
\DoxyCodeLine{00707\ }
\DoxyCodeLine{00708\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00709\ \ \ \}}
\DoxyCodeLine{00710\ }
\DoxyCodeLine{00711\ \ \ \textcolor{keywordtype}{bool}\ check\_glyph\_property\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__glyph__info__t}{hb\_glyph\_info\_t}}\ *info,}
\DoxyCodeLine{00712\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \ match\_props)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00713\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00714\ \ \ \ \ hb\_codepoint\_t\ glyph\ =\ info-\/>codepoint;}
\DoxyCodeLine{00715\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ glyph\_props\ =\ \_hb\_glyph\_info\_get\_glyph\_props\ (info);}
\DoxyCodeLine{00716\ }
\DoxyCodeLine{00717\ \ \ \ \ \textcolor{comment}{/*\ Not\ covered,\ if,\ for\ example,\ glyph\ class\ is\ ligature\ and}}
\DoxyCodeLine{00718\ \textcolor{comment}{\ \ \ \ \ *\ match\_props\ includes\ LookupFlags::IgnoreLigatures}}
\DoxyCodeLine{00719\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00720\ \ \ \ \ \textcolor{keywordflow}{if}\ (glyph\_props\ \&\ match\_props\ \&\ LookupFlag::IgnoreFlags)}
\DoxyCodeLine{00721\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00722\ }
\DoxyCodeLine{00723\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (glyph\_props\ \&\ HB\_OT\_LAYOUT\_GLYPH\_PROPS\_MARK))}
\DoxyCodeLine{00724\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ match\_properties\_mark\ (glyph,\ glyph\_props,\ match\_props);}
\DoxyCodeLine{00725\ }
\DoxyCodeLine{00726\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00727\ \ \ \}}
\DoxyCodeLine{00728\ }
\DoxyCodeLine{00729\ \ \ \textcolor{keywordtype}{void}\ \_set\_glyph\_class\ (hb\_codepoint\_t\ glyph\_index,}
\DoxyCodeLine{00730\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ class\_guess\ =\ 0,}
\DoxyCodeLine{00731\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ ligature\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00732\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ component\ =\ \textcolor{keyword}{false})\textcolor{keyword}{\ const}}
\DoxyCodeLine{00733\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00734\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ props\ =\ \_hb\_glyph\_info\_get\_glyph\_props\ (\&\mbox{\hyperlink{classbuffer}{buffer}}-\/>cur());}
\DoxyCodeLine{00735\ \ \ \ \ props\ |=\ HB\_OT\_LAYOUT\_GLYPH\_PROPS\_SUBSTITUTED;}
\DoxyCodeLine{00736\ \ \ \ \ \textcolor{keywordflow}{if}\ (ligature)}
\DoxyCodeLine{00737\ \ \ \ \ \{}
\DoxyCodeLine{00738\ \ \ \ \ \ \ props\ |=\ HB\_OT\_LAYOUT\_GLYPH\_PROPS\_LIGATED;}
\DoxyCodeLine{00739\ \ \ \ \ \ \ \textcolor{comment}{/*\ In\ the\ only\ place\ that\ the\ MULTIPLIED\ bit\ is\ used,\ Uniscribe}}
\DoxyCodeLine{00740\ \textcolor{comment}{\ \ \ \ \ \ \ *\ seems\ to\ only\ care\ about\ the\ "{}last"{}\ transformation\ between}}
\DoxyCodeLine{00741\ \textcolor{comment}{\ \ \ \ \ \ \ *\ Ligature\ and\ Multiple\ substitutions.\ \ Ie.\ if\ you\ ligate,\ expand,}}
\DoxyCodeLine{00742\ \textcolor{comment}{\ \ \ \ \ \ \ *\ and\ ligate\ again,\ it\ forgives\ the\ multiplication\ and\ acts\ as}}
\DoxyCodeLine{00743\ \textcolor{comment}{\ \ \ \ \ \ \ *\ if\ only\ ligation\ happened.\ \ As\ such,\ clear\ MULTIPLIED\ bit.}}
\DoxyCodeLine{00744\ \textcolor{comment}{\ \ \ \ \ \ \ */}}
\DoxyCodeLine{00745\ \ \ \ \ \ \ props\ \&=\ \string~HB\_OT\_LAYOUT\_GLYPH\_PROPS\_MULTIPLIED;}
\DoxyCodeLine{00746\ \ \ \ \ \}}
\DoxyCodeLine{00747\ \ \ \ \ \textcolor{keywordflow}{if}\ (component)}
\DoxyCodeLine{00748\ \ \ \ \ \ \ props\ |=\ HB\_OT\_LAYOUT\_GLYPH\_PROPS\_MULTIPLIED;}
\DoxyCodeLine{00749\ \ \ \ \ \textcolor{keywordflow}{if}\ (likely\ (has\_glyph\_classes))}
\DoxyCodeLine{00750\ \ \ \ \ \{}
\DoxyCodeLine{00751\ \ \ \ \ \ \ props\ \&=\ HB\_OT\_LAYOUT\_GLYPH\_PROPS\_PRESERVE;}
\DoxyCodeLine{00752\ \ \ \ \ \ \ \_hb\_glyph\_info\_set\_glyph\_props\ (\&\mbox{\hyperlink{classbuffer}{buffer}}-\/>cur(),\ props\ |\ gdef.get\_glyph\_props\ (glyph\_index));}
\DoxyCodeLine{00753\ \ \ \ \ \}}
\DoxyCodeLine{00754\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (class\_guess)}
\DoxyCodeLine{00755\ \ \ \ \ \{}
\DoxyCodeLine{00756\ \ \ \ \ \ \ props\ \&=\ HB\_OT\_LAYOUT\_GLYPH\_PROPS\_PRESERVE;}
\DoxyCodeLine{00757\ \ \ \ \ \ \ \_hb\_glyph\_info\_set\_glyph\_props\ (\&\mbox{\hyperlink{classbuffer}{buffer}}-\/>cur(),\ props\ |\ class\_guess);}
\DoxyCodeLine{00758\ \ \ \ \ \}}
\DoxyCodeLine{00759\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00760\ \ \ \ \ \ \ \_hb\_glyph\_info\_set\_glyph\_props\ (\&\mbox{\hyperlink{classbuffer}{buffer}}-\/>cur(),\ props);}
\DoxyCodeLine{00761\ \ \ \}}
\DoxyCodeLine{00762\ }
\DoxyCodeLine{00763\ \ \ \textcolor{keywordtype}{void}\ replace\_glyph\ (hb\_codepoint\_t\ glyph\_index)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00764\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00765\ \ \ \ \ \_set\_glyph\_class\ (glyph\_index);}
\DoxyCodeLine{00766\ \ \ \ \ (void)\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>replace\_glyph\ (glyph\_index);}
\DoxyCodeLine{00767\ \ \ \}}
\DoxyCodeLine{00768\ \ \ \textcolor{keywordtype}{void}\ replace\_glyph\_inplace\ (hb\_codepoint\_t\ glyph\_index)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00769\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00770\ \ \ \ \ \_set\_glyph\_class\ (glyph\_index);}
\DoxyCodeLine{00771\ \ \ \ \ \mbox{\hyperlink{classbuffer}{buffer}}-\/>cur().codepoint\ =\ glyph\_index;}
\DoxyCodeLine{00772\ \ \ \}}
\DoxyCodeLine{00773\ \ \ \textcolor{keywordtype}{void}\ replace\_glyph\_with\_ligature\ (hb\_codepoint\_t\ glyph\_index,}
\DoxyCodeLine{00774\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ class\_guess)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00775\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00776\ \ \ \ \ \_set\_glyph\_class\ (glyph\_index,\ class\_guess,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00777\ \ \ \ \ (void)\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>replace\_glyph\ (glyph\_index);}
\DoxyCodeLine{00778\ \ \ \}}
\DoxyCodeLine{00779\ \ \ \textcolor{keywordtype}{void}\ output\_glyph\_for\_component\ (hb\_codepoint\_t\ glyph\_index,}
\DoxyCodeLine{00780\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ class\_guess)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00781\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00782\ \ \ \ \ \_set\_glyph\_class\ (glyph\_index,\ class\_guess,\ \textcolor{keyword}{false},\ \textcolor{keyword}{true});}
\DoxyCodeLine{00783\ \ \ \ \ (void)\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>output\_glyph\ (glyph\_index);}
\DoxyCodeLine{00784\ \ \ \}}
\DoxyCodeLine{00785\ \};}
\DoxyCodeLine{00786\ }
\DoxyCodeLine{00787\ }
\DoxyCodeLine{00788\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1hb__get__subtables__context__t}{hb\_get\_subtables\_context\_t}}\ :}
\DoxyCodeLine{00789\ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__dispatch__context__t}{hb\_dispatch\_context\_t}}<hb\_get\_subtables\_context\_t>}
\DoxyCodeLine{00790\ \{}
\DoxyCodeLine{00791\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Type>}
\DoxyCodeLine{00792\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ apply\_to\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *obj,\ \mbox{\hyperlink{struct_o_t_1_1hb__ot__apply__context__t}{OT::hb\_ot\_apply\_context\_t}}\ *c)}
\DoxyCodeLine{00793\ \ \ \{}
\DoxyCodeLine{00794\ \ \ \ \ \textcolor{keyword}{const}\ Type\ *typed\_obj\ =\ (\textcolor{keyword}{const}\ Type\ *)\ obj;}
\DoxyCodeLine{00795\ \ \ \ \ \textcolor{keywordflow}{return}\ typed\_obj-\/>apply\ (c);}
\DoxyCodeLine{00796\ \ \ \}}
\DoxyCodeLine{00797\ }
\DoxyCodeLine{00798\ \ \ \textcolor{keyword}{typedef}\ bool\ (*hb\_apply\_func\_t)\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *obj,\ \mbox{\hyperlink{struct_o_t_1_1hb__ot__apply__context__t}{OT::hb\_ot\_apply\_context\_t}}\ *c);}
\DoxyCodeLine{00799\ }
\DoxyCodeLine{00800\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1hb__get__subtables__context__t_1_1hb__applicable__t}{hb\_applicable\_t}}}
\DoxyCodeLine{00801\ \ \ \{}
\DoxyCodeLine{00802\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00803\ \ \ \ \ \textcolor{keywordtype}{void}\ init\ (\textcolor{keyword}{const}\ T\ \&obj\_,\ hb\_apply\_func\_t\ apply\_func\_)}
\DoxyCodeLine{00804\ \ \ \ \ \{}
\DoxyCodeLine{00805\ \ \ \ \ \ \ obj\ =\ \&obj\_;}
\DoxyCodeLine{00806\ \ \ \ \ \ \ apply\_func\ =\ apply\_func\_;}
\DoxyCodeLine{00807\ \ \ \ \ \ \ digest.init\ ();}
\DoxyCodeLine{00808\ \ \ \ \ \ \ obj\_.get\_coverage\ ().collect\_coverage\ (\&digest);}
\DoxyCodeLine{00809\ \ \ \ \ \}}
\DoxyCodeLine{00810\ }
\DoxyCodeLine{00811\ \ \ \ \ \textcolor{keywordtype}{bool}\ apply\ (\mbox{\hyperlink{struct_o_t_1_1hb__ot__apply__context__t}{OT::hb\_ot\_apply\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00812\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00813\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ digest.may\_have\ (c-\/>buffer-\/>cur().codepoint)\ \&\&\ apply\_func\ (obj,\ c);}
\DoxyCodeLine{00814\ \ \ \ \ \}}
\DoxyCodeLine{00815\ }
\DoxyCodeLine{00816\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00817\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *obj;}
\DoxyCodeLine{00818\ \ \ \ \ hb\_apply\_func\_t\ apply\_func;}
\DoxyCodeLine{00819\ \ \ \ \ \mbox{\hyperlink{structhb__set__digest__combiner__t}{hb\_set\_digest\_t}}\ digest;}
\DoxyCodeLine{00820\ \ \ \};}
\DoxyCodeLine{00821\ }
\DoxyCodeLine{00822\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{structhb__vector__t}{hb\_vector\_t<hb\_applicable\_t>}}\ \mbox{\hyperlink{structhb__vector__t}{array\_t}};}
\DoxyCodeLine{00823\ }
\DoxyCodeLine{00824\ \ \ \textcolor{comment}{/*\ Dispatch\ interface.\ */}}
\DoxyCodeLine{00825\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00826\ \ \ \mbox{\hyperlink{structhb__empty__t}{return\_t}}\ dispatch\ (\textcolor{keyword}{const}\ T\ \&obj)}
\DoxyCodeLine{00827\ \ \ \{}
\DoxyCodeLine{00828\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__get__subtables__context__t_1_1hb__applicable__t}{hb\_applicable\_t}}\ *\mbox{\hyperlink{structentry}{entry}}\ =\ array.push();}
\DoxyCodeLine{00829\ \ \ \ \ \mbox{\hyperlink{structentry}{entry}}-\/>init\ (obj,\ apply\_to<T>);}
\DoxyCodeLine{00830\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structhb__empty__t}{hb\_empty\_t}}\ ();}
\DoxyCodeLine{00831\ \ \ \}}
\DoxyCodeLine{00832\ \ \ \textcolor{keyword}{static}\ return\_t\ default\_return\_value\ ()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structhb__empty__t}{hb\_empty\_t}}\ ();\ \}}
\DoxyCodeLine{00833\ }
\DoxyCodeLine{00834\ \ \ hb\_get\_subtables\_context\_t\ (\mbox{\hyperlink{structarray__t}{array\_t}}\ \&array\_)\ :}
\DoxyCodeLine{00835\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ array\ (array\_)\ \{\}}
\DoxyCodeLine{00836\ }
\DoxyCodeLine{00837\ \ \ \mbox{\hyperlink{structarray__t}{array\_t}}\ \&array;}
\DoxyCodeLine{00838\ \};}
\DoxyCodeLine{00839\ }
\DoxyCodeLine{00840\ }
\DoxyCodeLine{00841\ }
\DoxyCodeLine{00842\ }
\DoxyCodeLine{00843\ \textcolor{keyword}{typedef}\ bool\ (*intersects\_func\_t)\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ \textcolor{keyword}{const}\ HBUINT16\ \&\mbox{\hyperlink{classvalue}{value}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{structdata}{data}});}
\DoxyCodeLine{00844\ \textcolor{keyword}{typedef}\ void\ (*intersected\_glyphs\_func\_t)\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{structdata}{data}},\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classvalue}{value}},\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *intersected\_glyphs);}
\DoxyCodeLine{00845\ \textcolor{keyword}{typedef}\ void\ (*collect\_glyphs\_func\_t)\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ \textcolor{keyword}{const}\ HBUINT16\ \&\mbox{\hyperlink{classvalue}{value}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{structdata}{data}});}
\DoxyCodeLine{00846\ \textcolor{keyword}{typedef}\ bool\ (*match\_func\_t)\ (hb\_codepoint\_t\ glyph\_id,\ \textcolor{keyword}{const}\ HBUINT16\ \&\mbox{\hyperlink{classvalue}{value}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{structdata}{data}});}
\DoxyCodeLine{00847\ }
\DoxyCodeLine{00848\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_context_closure_funcs}{ContextClosureFuncs}}}
\DoxyCodeLine{00849\ \{}
\DoxyCodeLine{00850\ \ \ intersects\_func\_t\ intersects;}
\DoxyCodeLine{00851\ \ \ intersected\_glyphs\_func\_t\ intersected\_glyphs;}
\DoxyCodeLine{00852\ \};}
\DoxyCodeLine{00853\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_context_collect_glyphs_funcs}{ContextCollectGlyphsFuncs}}}
\DoxyCodeLine{00854\ \{}
\DoxyCodeLine{00855\ \ \ collect\_glyphs\_func\_t\ collect;}
\DoxyCodeLine{00856\ \};}
\DoxyCodeLine{00857\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_context_apply_funcs}{ContextApplyFuncs}}}
\DoxyCodeLine{00858\ \{}
\DoxyCodeLine{00859\ \ \ match\_func\_t\ \mbox{\hyperlink{structmatch}{match}};}
\DoxyCodeLine{00860\ \};}
\DoxyCodeLine{00861\ }
\DoxyCodeLine{00862\ }
\DoxyCodeLine{00863\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ intersects\_glyph\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \&\mbox{\hyperlink{classvalue}{value}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{structdata}{data}}\ HB\_UNUSED)}
\DoxyCodeLine{00864\ \{}
\DoxyCodeLine{00865\ \ \ \textcolor{keywordflow}{return}\ glyphs-\/>has\ (\mbox{\hyperlink{classvalue}{value}});}
\DoxyCodeLine{00866\ \}}
\DoxyCodeLine{00867\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ intersects\_class\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ \textcolor{keyword}{const}\ HBUINT16\ \&\mbox{\hyperlink{classvalue}{value}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{structdata}{data}})}
\DoxyCodeLine{00868\ \{}
\DoxyCodeLine{00869\ \ \ \textcolor{keyword}{const}\ ClassDef\ \&class\_def\ =\ *\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }ClassDef\ *\textcolor{keyword}{>}(\mbox{\hyperlink{structdata}{data}});}
\DoxyCodeLine{00870\ \ \ \textcolor{keywordflow}{return}\ class\_def.intersects\_class\ (glyphs,\ \mbox{\hyperlink{classvalue}{value}});}
\DoxyCodeLine{00871\ \}}
\DoxyCodeLine{00872\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ intersects\_coverage\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ \textcolor{keyword}{const}\ HBUINT16\ \&\mbox{\hyperlink{classvalue}{value}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{structdata}{data}})}
\DoxyCodeLine{00873\ \{}
\DoxyCodeLine{00874\ \ \ \textcolor{keyword}{const}\ Offset16To<Coverage>\ \&coverage\ =\ (\textcolor{keyword}{const}\ Offset16To<Coverage>\&)\mbox{\hyperlink{classvalue}{value}};}
\DoxyCodeLine{00875\ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{structdata}{data}}+coverage).intersects\ (glyphs);}
\DoxyCodeLine{00876\ \}}
\DoxyCodeLine{00877\ }
\DoxyCodeLine{00878\ }
\DoxyCodeLine{00879\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ intersected\_glyph\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs\ HB\_UNUSED,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{structdata}{data}},\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classvalue}{value}},\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *intersected\_glyphs)}
\DoxyCodeLine{00880\ \{}
\DoxyCodeLine{00881\ \ \ \textcolor{keywordtype}{unsigned}\ g\ =\ \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }HBUINT16\ *\textcolor{keyword}{>}(\mbox{\hyperlink{structdata}{data}})[\mbox{\hyperlink{classvalue}{value}}];}
\DoxyCodeLine{00882\ \ \ intersected\_glyphs-\/>add\ (g);}
\DoxyCodeLine{00883\ \}}
\DoxyCodeLine{00884\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ intersected\_class\_glyphs\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{structdata}{data}},\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classvalue}{value}},\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *intersected\_glyphs)}
\DoxyCodeLine{00885\ \{}
\DoxyCodeLine{00886\ \ \ \textcolor{keyword}{const}\ ClassDef\ \&class\_def\ =\ *\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }ClassDef\ *\textcolor{keyword}{>}(\mbox{\hyperlink{structdata}{data}});}
\DoxyCodeLine{00887\ \ \ class\_def.intersected\_class\_glyphs\ (glyphs,\ \mbox{\hyperlink{classvalue}{value}},\ intersected\_glyphs);}
\DoxyCodeLine{00888\ \}}
\DoxyCodeLine{00889\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ intersected\_coverage\_glyphs\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{structdata}{data}},\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classvalue}{value}},\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *intersected\_glyphs)}
\DoxyCodeLine{00890\ \{}
\DoxyCodeLine{00891\ \ \ Offset16To<Coverage>\ coverage;}
\DoxyCodeLine{00892\ \ \ coverage\ =\ \mbox{\hyperlink{classvalue}{value}};}
\DoxyCodeLine{00893\ \ \ (\mbox{\hyperlink{structdata}{data}}+coverage).intersected\_coverage\_glyphs\ (glyphs,\ intersected\_glyphs);}
\DoxyCodeLine{00894\ \}}
\DoxyCodeLine{00895\ }
\DoxyCodeLine{00896\ }
\DoxyCodeLine{00897\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ array\_is\_subset\_of\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,}
\DoxyCodeLine{00898\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count,}
\DoxyCodeLine{00899\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ HBUINT16\ values[],}
\DoxyCodeLine{00900\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ intersects\_func\_t\ intersects\_func,}
\DoxyCodeLine{00901\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *intersects\_data)}
\DoxyCodeLine{00902\ \{}
\DoxyCodeLine{00903\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ HBUINT16\ \&\_\ :\ +\ hb\_iter\ (values,\ count))}
\DoxyCodeLine{00904\ \ \ \ \ \textcolor{keywordflow}{if}\ (!intersects\_func\ (glyphs,\ \_,\ intersects\_data))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00905\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00906\ \}}
\DoxyCodeLine{00907\ }
\DoxyCodeLine{00908\ }
\DoxyCodeLine{00909\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ collect\_glyph\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ \textcolor{keyword}{const}\ HBUINT16\ \&\mbox{\hyperlink{classvalue}{value}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{structdata}{data}}\ HB\_UNUSED)}
\DoxyCodeLine{00910\ \{}
\DoxyCodeLine{00911\ \ \ glyphs-\/>add\ (\mbox{\hyperlink{classvalue}{value}});}
\DoxyCodeLine{00912\ \}}
\DoxyCodeLine{00913\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ collect\_class\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ \textcolor{keyword}{const}\ HBUINT16\ \&\mbox{\hyperlink{classvalue}{value}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{structdata}{data}})}
\DoxyCodeLine{00914\ \{}
\DoxyCodeLine{00915\ \ \ \textcolor{keyword}{const}\ ClassDef\ \&class\_def\ =\ *\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }ClassDef\ *\textcolor{keyword}{>}(\mbox{\hyperlink{structdata}{data}});}
\DoxyCodeLine{00916\ \ \ class\_def.collect\_class\ (glyphs,\ \mbox{\hyperlink{classvalue}{value}});}
\DoxyCodeLine{00917\ \}}
\DoxyCodeLine{00918\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ collect\_coverage\ (\mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ \textcolor{keyword}{const}\ HBUINT16\ \&\mbox{\hyperlink{classvalue}{value}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{structdata}{data}})}
\DoxyCodeLine{00919\ \{}
\DoxyCodeLine{00920\ \ \ \textcolor{keyword}{const}\ Offset16To<Coverage>\ \&coverage\ =\ (\textcolor{keyword}{const}\ Offset16To<Coverage>\&)\mbox{\hyperlink{classvalue}{value}};}
\DoxyCodeLine{00921\ \ \ (\mbox{\hyperlink{structdata}{data}}+coverage).collect\_coverage\ (glyphs);}
\DoxyCodeLine{00922\ \}}
\DoxyCodeLine{00923\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ collect\_array\ (hb\_collect\_glyphs\_context\_t\ *c\ HB\_UNUSED,}
\DoxyCodeLine{00924\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,}
\DoxyCodeLine{00925\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count,}
\DoxyCodeLine{00926\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ HBUINT16\ values[],}
\DoxyCodeLine{00927\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ collect\_glyphs\_func\_t\ collect\_func,}
\DoxyCodeLine{00928\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *collect\_data)}
\DoxyCodeLine{00929\ \{}
\DoxyCodeLine{00930\ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{00931\ \ \ +\ hb\_iter\ (values,\ count)}
\DoxyCodeLine{00932\ \ \ |\ hb\_apply\ ([\&]\ (\textcolor{keyword}{const}\ HBUINT16\ \&\_)\ \{\ collect\_func\ (glyphs,\ \_,\ collect\_data);\ \})}
\DoxyCodeLine{00933\ \ \ ;}
\DoxyCodeLine{00934\ \}}
\DoxyCodeLine{00935\ }
\DoxyCodeLine{00936\ }
\DoxyCodeLine{00937\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ match\_glyph\ (hb\_codepoint\_t\ glyph\_id,\ \textcolor{keyword}{const}\ HBUINT16\ \&\mbox{\hyperlink{classvalue}{value}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{structdata}{data}}\ HB\_UNUSED)}
\DoxyCodeLine{00938\ \{}
\DoxyCodeLine{00939\ \ \ \textcolor{keywordflow}{return}\ glyph\_id\ ==\ \mbox{\hyperlink{classvalue}{value}};}
\DoxyCodeLine{00940\ \}}
\DoxyCodeLine{00941\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ match\_class\ (hb\_codepoint\_t\ glyph\_id,\ \textcolor{keyword}{const}\ HBUINT16\ \&\mbox{\hyperlink{classvalue}{value}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{structdata}{data}})}
\DoxyCodeLine{00942\ \{}
\DoxyCodeLine{00943\ \ \ \textcolor{keyword}{const}\ ClassDef\ \&class\_def\ =\ *\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }ClassDef\ *\textcolor{keyword}{>}(\mbox{\hyperlink{structdata}{data}});}
\DoxyCodeLine{00944\ \ \ \textcolor{keywordflow}{return}\ class\_def.get\_class\ (glyph\_id)\ ==\ \mbox{\hyperlink{classvalue}{value}};}
\DoxyCodeLine{00945\ \}}
\DoxyCodeLine{00946\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ match\_coverage\ (hb\_codepoint\_t\ glyph\_id,\ \textcolor{keyword}{const}\ HBUINT16\ \&\mbox{\hyperlink{classvalue}{value}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{structdata}{data}})}
\DoxyCodeLine{00947\ \{}
\DoxyCodeLine{00948\ \ \ \textcolor{keyword}{const}\ Offset16To<Coverage>\ \&coverage\ =\ (\textcolor{keyword}{const}\ Offset16To<Coverage>\&)\mbox{\hyperlink{classvalue}{value}};}
\DoxyCodeLine{00949\ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{structdata}{data}}+coverage).get\_coverage\ (glyph\_id)\ !=\ NOT\_COVERED;}
\DoxyCodeLine{00950\ \}}
\DoxyCodeLine{00951\ }
\DoxyCodeLine{00952\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ would\_match\_input\ (hb\_would\_apply\_context\_t\ *c,}
\DoxyCodeLine{00953\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count,\ \textcolor{comment}{/*\ Including\ the\ first\ glyph\ (not\ matched)\ */}}
\DoxyCodeLine{00954\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ HBUINT16\ \mbox{\hyperlink{structinput}{input}}[],\ \textcolor{comment}{/*\ Array\ of\ input\ values-\/-\/start\ with\ second\ glyph\ */}}
\DoxyCodeLine{00955\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ match\_func\_t\ match\_func,}
\DoxyCodeLine{00956\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *match\_data)}
\DoxyCodeLine{00957\ \{}
\DoxyCodeLine{00958\ \ \ \textcolor{keywordflow}{if}\ (count\ !=\ c-\/>len)}
\DoxyCodeLine{00959\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00960\ }
\DoxyCodeLine{00961\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ count;\ i++)}
\DoxyCodeLine{00962\ \ \ \ \ \textcolor{keywordflow}{if}\ (likely\ (!match\_func\ (c-\/>glyphs[i],\ \mbox{\hyperlink{structinput}{input}}[i\ -\/\ 1],\ match\_data)))}
\DoxyCodeLine{00963\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00964\ }
\DoxyCodeLine{00965\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00966\ \}}
\DoxyCodeLine{00967\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ match\_input\ (hb\_ot\_apply\_context\_t\ *c,}
\DoxyCodeLine{00968\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count,\ \textcolor{comment}{/*\ Including\ the\ first\ glyph\ (not\ matched)\ */}}
\DoxyCodeLine{00969\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ HBUINT16\ \mbox{\hyperlink{structinput}{input}}[],\ \textcolor{comment}{/*\ Array\ of\ input\ values-\/-\/start\ with\ second\ glyph\ */}}
\DoxyCodeLine{00970\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ match\_func\_t\ match\_func,}
\DoxyCodeLine{00971\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *match\_data,}
\DoxyCodeLine{00972\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *end\_position,}
\DoxyCodeLine{00973\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ match\_positions[HB\_MAX\_CONTEXT\_LENGTH],}
\DoxyCodeLine{00974\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *p\_total\_component\_count\ =\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00975\ \{}
\DoxyCodeLine{00976\ \ \ TRACE\_APPLY\ (\textcolor{keyword}{nullptr});}
\DoxyCodeLine{00977\ }
\DoxyCodeLine{00978\ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (count\ >\ HB\_MAX\_CONTEXT\_LENGTH))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{00979\ }
\DoxyCodeLine{00980\ \ \ \mbox{\hyperlink{structhb__buffer__t}{hb\_buffer\_t}}\ *\mbox{\hyperlink{classbuffer}{buffer}}\ =\ c-\/>buffer;}
\DoxyCodeLine{00981\ }
\DoxyCodeLine{00982\ \ \ hb\_ot\_apply\_context\_t::skipping\_iterator\_t\ \&skippy\_iter\ =\ c-\/>iter\_input;}
\DoxyCodeLine{00983\ \ \ skippy\_iter.reset\ (\mbox{\hyperlink{classbuffer}{buffer}}-\/>idx,\ count\ -\/\ 1);}
\DoxyCodeLine{00984\ \ \ skippy\_iter.set\_match\_func\ (match\_func,\ match\_data,\ \mbox{\hyperlink{structinput}{input}});}
\DoxyCodeLine{00985\ }
\DoxyCodeLine{00986\ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00987\ \textcolor{comment}{\ \ \ *\ This\ is\ perhaps\ the\ trickiest\ part\ of\ OpenType...\ \ Remarks:}}
\DoxyCodeLine{00988\ \textcolor{comment}{\ \ \ *}}
\DoxyCodeLine{00989\ \textcolor{comment}{\ \ \ *\ -\/\ If\ all\ components\ of\ the\ ligature\ were\ marks,\ we\ call\ this\ a\ mark\ ligature.}}
\DoxyCodeLine{00990\ \textcolor{comment}{\ \ \ *}}
\DoxyCodeLine{00991\ \textcolor{comment}{\ \ \ *\ -\/\ If\ there\ is\ no\ GDEF,\ and\ the\ ligature\ is\ NOT\ a\ mark\ ligature,\ we\ categorize}}
\DoxyCodeLine{00992\ \textcolor{comment}{\ \ \ *\ \ \ it\ as\ a\ ligature\ glyph.}}
\DoxyCodeLine{00993\ \textcolor{comment}{\ \ \ *}}
\DoxyCodeLine{00994\ \textcolor{comment}{\ \ \ *\ -\/\ Ligatures\ cannot\ be\ formed\ across\ glyphs\ attached\ to\ different\ components}}
\DoxyCodeLine{00995\ \textcolor{comment}{\ \ \ *\ \ \ of\ previous\ ligatures.\ \ Eg.\ the\ sequence\ is\ LAM,SHADDA,LAM,FATHA,HEH,\ and}}
\DoxyCodeLine{00996\ \textcolor{comment}{\ \ \ *\ \ \ LAM,LAM,HEH\ form\ a\ ligature,\ leaving\ SHADDA,FATHA\ next\ to\ eachother.}}
\DoxyCodeLine{00997\ \textcolor{comment}{\ \ \ *\ \ \ However,\ it\ would\ be\ wrong\ to\ ligate\ that\ SHADDA,FATHA\ sequence.}}
\DoxyCodeLine{00998\ \textcolor{comment}{\ \ \ *\ \ \ There\ are\ a\ couple\ of\ exceptions\ to\ this:}}
\DoxyCodeLine{00999\ \textcolor{comment}{\ \ \ *}}
\DoxyCodeLine{01000\ \textcolor{comment}{\ \ \ *\ \ \ o\ If\ a\ ligature\ tries\ ligating\ with\ marks\ that\ belong\ to\ it\ itself,\ go\ ahead,}}
\DoxyCodeLine{01001\ \textcolor{comment}{\ \ \ *\ \ \ \ \ assuming\ that\ the\ font\ designer\ knows\ what\ they\ are\ doing\ (otherwise\ it\ can}}
\DoxyCodeLine{01002\ \textcolor{comment}{\ \ \ *\ \ \ \ \ break\ Indic\ stuff\ when\ a\ matra\ wants\ to\ ligate\ with\ a\ conjunct,}}
\DoxyCodeLine{01003\ \textcolor{comment}{\ \ \ *}}
\DoxyCodeLine{01004\ \textcolor{comment}{\ \ \ *\ \ \ o\ If\ two\ marks\ want\ to\ ligate\ and\ they\ belong\ to\ different\ components\ of\ the}}
\DoxyCodeLine{01005\ \textcolor{comment}{\ \ \ *\ \ \ \ \ same\ ligature\ glyph,\ and\ said\ ligature\ glyph\ is\ to\ be\ ignored\ according\ to}}
\DoxyCodeLine{01006\ \textcolor{comment}{\ \ \ *\ \ \ \ \ mark-\/filtering\ rules,\ then\ allow.}}
\DoxyCodeLine{01007\ \textcolor{comment}{\ \ \ *\ \ \ \ \ https://github.com/harfbuzz/harfbuzz/issues/545}}
\DoxyCodeLine{01008\ \textcolor{comment}{\ \ \ */}}
\DoxyCodeLine{01009\ }
\DoxyCodeLine{01010\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ total\_component\_count\ =\ 0;}
\DoxyCodeLine{01011\ \ \ total\_component\_count\ +=\ \_hb\_glyph\_info\_get\_lig\_num\_comps\ (\&\mbox{\hyperlink{classbuffer}{buffer}}-\/>cur());}
\DoxyCodeLine{01012\ }
\DoxyCodeLine{01013\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ first\_lig\_id\ =\ \_hb\_glyph\_info\_get\_lig\_id\ (\&\mbox{\hyperlink{classbuffer}{buffer}}-\/>cur());}
\DoxyCodeLine{01014\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ first\_lig\_comp\ =\ \_hb\_glyph\_info\_get\_lig\_comp\ (\&\mbox{\hyperlink{classbuffer}{buffer}}-\/>cur());}
\DoxyCodeLine{01015\ }
\DoxyCodeLine{01016\ \ \ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{01017\ \ \ \ \ LIGBASE\_NOT\_CHECKED,}
\DoxyCodeLine{01018\ \ \ \ \ LIGBASE\_MAY\_NOT\_SKIP,}
\DoxyCodeLine{01019\ \ \ \ \ LIGBASE\_MAY\_SKIP}
\DoxyCodeLine{01020\ \ \ \}\ ligbase\ =\ LIGBASE\_NOT\_CHECKED;}
\DoxyCodeLine{01021\ }
\DoxyCodeLine{01022\ \ \ match\_positions[0]\ =\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>idx;}
\DoxyCodeLine{01023\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ count;\ i++)}
\DoxyCodeLine{01024\ \ \ \{}
\DoxyCodeLine{01025\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ unsafe\_to;}
\DoxyCodeLine{01026\ \ \ \ \ \textcolor{keywordflow}{if}\ (!skippy\_iter.next\ (\&unsafe\_to))}
\DoxyCodeLine{01027\ \ \ \ \ \{}
\DoxyCodeLine{01028\ \ \ \ \ \ \ *end\_position\ =\ unsafe\_to;}
\DoxyCodeLine{01029\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01030\ \ \ \ \ \}}
\DoxyCodeLine{01031\ }
\DoxyCodeLine{01032\ \ \ \ \ match\_positions[i]\ =\ skippy\_iter.idx;}
\DoxyCodeLine{01033\ }
\DoxyCodeLine{01034\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ this\_lig\_id\ =\ \_hb\_glyph\_info\_get\_lig\_id\ (\&\mbox{\hyperlink{classbuffer}{buffer}}-\/>info[skippy\_iter.idx]);}
\DoxyCodeLine{01035\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ this\_lig\_comp\ =\ \_hb\_glyph\_info\_get\_lig\_comp\ (\&\mbox{\hyperlink{classbuffer}{buffer}}-\/>info[skippy\_iter.idx]);}
\DoxyCodeLine{01036\ }
\DoxyCodeLine{01037\ \ \ \ \ \textcolor{keywordflow}{if}\ (first\_lig\_id\ \&\&\ first\_lig\_comp)}
\DoxyCodeLine{01038\ \ \ \ \ \{}
\DoxyCodeLine{01039\ \ \ \ \ \ \ \textcolor{comment}{/*\ If\ first\ component\ was\ attached\ to\ a\ previous\ ligature\ component,}}
\DoxyCodeLine{01040\ \textcolor{comment}{\ \ \ \ \ \ \ *\ all\ subsequent\ components\ should\ be\ attached\ to\ the\ same\ ligature}}
\DoxyCodeLine{01041\ \textcolor{comment}{\ \ \ \ \ \ \ *\ component,\ otherwise\ we\ shouldn't\ ligate\ them...\ */}}
\DoxyCodeLine{01042\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (first\_lig\_id\ !=\ this\_lig\_id\ ||\ first\_lig\_comp\ !=\ this\_lig\_comp)}
\DoxyCodeLine{01043\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01044\ \ \ \ \ \textcolor{comment}{/*\ ...unless,\ we\ are\ attached\ to\ a\ base\ ligature\ and\ that\ base}}
\DoxyCodeLine{01045\ \textcolor{comment}{\ \ \ \ \ *\ ligature\ is\ ignorable.\ */}}
\DoxyCodeLine{01046\ \ \ \ \ \textcolor{keywordflow}{if}\ (ligbase\ ==\ LIGBASE\_NOT\_CHECKED)}
\DoxyCodeLine{01047\ \ \ \ \ \{}
\DoxyCodeLine{01048\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ found\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01049\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ *out\ =\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>out\_info;}
\DoxyCodeLine{01050\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j\ =\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>out\_len;}
\DoxyCodeLine{01051\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (j\ \&\&\ \_hb\_glyph\_info\_get\_lig\_id\ (\&out[j\ -\/\ 1])\ ==\ first\_lig\_id)}
\DoxyCodeLine{01052\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01053\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_hb\_glyph\_info\_get\_lig\_comp\ (\&out[j\ -\/\ 1])\ ==\ 0)}
\DoxyCodeLine{01054\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01055\ \ \ \ \ \ \ \ \ \ \ j-\/-\/;}
\DoxyCodeLine{01056\ \ \ \ \ \ \ \ \ \ \ found\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01057\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01058\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01059\ \ \ \ \ \ \ \ \ j-\/-\/;}
\DoxyCodeLine{01060\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01061\ }
\DoxyCodeLine{01062\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (found\ \&\&\ skippy\_iter.may\_skip\ (out[j])\ ==\ hb\_ot\_apply\_context\_t::matcher\_t::SKIP\_YES)}
\DoxyCodeLine{01063\ \ \ \ \ \ \ \ \ ligbase\ =\ LIGBASE\_MAY\_SKIP;}
\DoxyCodeLine{01064\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01065\ \ \ \ \ \ \ \ \ ligbase\ =\ LIGBASE\_MAY\_NOT\_SKIP;}
\DoxyCodeLine{01066\ \ \ \ \ \}}
\DoxyCodeLine{01067\ }
\DoxyCodeLine{01068\ \ \ \ \ \textcolor{keywordflow}{if}\ (ligbase\ ==\ LIGBASE\_MAY\_NOT\_SKIP)}
\DoxyCodeLine{01069\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01070\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01071\ \ \ \ \ \}}
\DoxyCodeLine{01072\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01073\ \ \ \ \ \{}
\DoxyCodeLine{01074\ \ \ \ \ \ \ \textcolor{comment}{/*\ If\ first\ component\ was\ NOT\ attached\ to\ a\ previous\ ligature\ component,}}
\DoxyCodeLine{01075\ \textcolor{comment}{\ \ \ \ \ \ \ *\ all\ subsequent\ components\ should\ also\ NOT\ be\ attached\ to\ any\ ligature}}
\DoxyCodeLine{01076\ \textcolor{comment}{\ \ \ \ \ \ \ *\ component,\ unless\ they\ are\ attached\ to\ the\ first\ component\ itself!\ */}}
\DoxyCodeLine{01077\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this\_lig\_id\ \&\&\ this\_lig\_comp\ \&\&\ (this\_lig\_id\ !=\ first\_lig\_id))}
\DoxyCodeLine{01078\ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01079\ \ \ \ \ \}}
\DoxyCodeLine{01080\ }
\DoxyCodeLine{01081\ \ \ \ \ total\_component\_count\ +=\ \_hb\_glyph\_info\_get\_lig\_num\_comps\ (\&\mbox{\hyperlink{classbuffer}{buffer}}-\/>info[skippy\_iter.idx]);}
\DoxyCodeLine{01082\ \ \ \}}
\DoxyCodeLine{01083\ }
\DoxyCodeLine{01084\ \ \ *end\_position\ =\ skippy\_iter.idx\ +\ 1;}
\DoxyCodeLine{01085\ }
\DoxyCodeLine{01086\ \ \ \textcolor{keywordflow}{if}\ (p\_total\_component\_count)}
\DoxyCodeLine{01087\ \ \ \ \ *p\_total\_component\_count\ =\ total\_component\_count;}
\DoxyCodeLine{01088\ }
\DoxyCodeLine{01089\ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{01090\ \}}
\DoxyCodeLine{01091\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ ligate\_input\ (hb\_ot\_apply\_context\_t\ *c,}
\DoxyCodeLine{01092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count,\ \textcolor{comment}{/*\ Including\ the\ first\ glyph\ */}}
\DoxyCodeLine{01093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ match\_positions[HB\_MAX\_CONTEXT\_LENGTH],\ \textcolor{comment}{/*\ Including\ the\ first\ glyph\ */}}
\DoxyCodeLine{01094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ match\_end,}
\DoxyCodeLine{01095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_codepoint\_t\ lig\_glyph,}
\DoxyCodeLine{01096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ total\_component\_count)}
\DoxyCodeLine{01097\ \{}
\DoxyCodeLine{01098\ \ \ TRACE\_APPLY\ (\textcolor{keyword}{nullptr});}
\DoxyCodeLine{01099\ }
\DoxyCodeLine{01100\ \ \ \mbox{\hyperlink{structhb__buffer__t}{hb\_buffer\_t}}\ *\mbox{\hyperlink{classbuffer}{buffer}}\ =\ c-\/>buffer;}
\DoxyCodeLine{01101\ }
\DoxyCodeLine{01102\ \ \ \mbox{\hyperlink{classbuffer}{buffer}}-\/>merge\_clusters\ (\mbox{\hyperlink{classbuffer}{buffer}}-\/>idx,\ match\_end);}
\DoxyCodeLine{01103\ }
\DoxyCodeLine{01104\ \ \ \textcolor{comment}{/*\ -\/\ If\ a\ base\ and\ one\ or\ more\ marks\ ligate,\ consider\ that\ as\ a\ base,\ NOT}}
\DoxyCodeLine{01105\ \textcolor{comment}{\ \ \ *\ \ \ ligature,\ such\ that\ all\ following\ marks\ can\ still\ attach\ to\ it.}}
\DoxyCodeLine{01106\ \textcolor{comment}{\ \ \ *\ \ \ https://github.com/harfbuzz/harfbuzz/issues/1109}}
\DoxyCodeLine{01107\ \textcolor{comment}{\ \ \ *}}
\DoxyCodeLine{01108\ \textcolor{comment}{\ \ \ *\ -\/\ If\ all\ components\ of\ the\ ligature\ were\ marks,\ we\ call\ this\ a\ mark\ ligature.}}
\DoxyCodeLine{01109\ \textcolor{comment}{\ \ \ *\ \ \ If\ it\ *is*\ a\ mark\ ligature,\ we\ don't\ allocate\ a\ new\ ligature\ id,\ and\ leave}}
\DoxyCodeLine{01110\ \textcolor{comment}{\ \ \ *\ \ \ the\ ligature\ to\ keep\ its\ old\ ligature\ id.\ \ This\ will\ allow\ it\ to\ attach\ to}}
\DoxyCodeLine{01111\ \textcolor{comment}{\ \ \ *\ \ \ a\ base\ ligature\ in\ GPOS.\ \ Eg.\ if\ the\ sequence\ is:\ LAM,LAM,SHADDA,FATHA,HEH,}}
\DoxyCodeLine{01112\ \textcolor{comment}{\ \ \ *\ \ \ and\ LAM,LAM,HEH\ for\ a\ ligature,\ they\ will\ leave\ SHADDA\ and\ FATHA\ with\ a}}
\DoxyCodeLine{01113\ \textcolor{comment}{\ \ \ *\ \ \ ligature\ id\ and\ component\ value\ of\ 2.\ \ Then\ if\ SHADDA,FATHA\ form\ a\ ligature}}
\DoxyCodeLine{01114\ \textcolor{comment}{\ \ \ *\ \ \ later,\ we\ don't\ want\ them\ to\ lose\ their\ ligature\ id/component,\ otherwise}}
\DoxyCodeLine{01115\ \textcolor{comment}{\ \ \ *\ \ \ GPOS\ will\ fail\ to\ correctly\ position\ the\ mark\ ligature\ on\ top\ of\ the}}
\DoxyCodeLine{01116\ \textcolor{comment}{\ \ \ *\ \ \ LAM,LAM,HEH\ ligature.\ \ See:}}
\DoxyCodeLine{01117\ \textcolor{comment}{\ \ \ *\ \ \ \ \ https://bugzilla.gnome.org/show\_bug.cgi?id=676343}}
\DoxyCodeLine{01118\ \textcolor{comment}{\ \ \ *}}
\DoxyCodeLine{01119\ \textcolor{comment}{\ \ \ *\ -\/\ If\ a\ ligature\ is\ formed\ of\ components\ that\ some\ of\ which\ are\ also\ ligatures}}
\DoxyCodeLine{01120\ \textcolor{comment}{\ \ \ *\ \ \ themselves,\ and\ those\ ligature\ components\ had\ marks\ attached\ to\ *their*}}
\DoxyCodeLine{01121\ \textcolor{comment}{\ \ \ *\ \ \ components,\ we\ have\ to\ attach\ the\ marks\ to\ the\ new\ ligature\ component}}
\DoxyCodeLine{01122\ \textcolor{comment}{\ \ \ *\ \ \ positions!\ \ Now\ *that*'s\ tricky!\ \ And\ these\ marks\ may\ be\ following\ the}}
\DoxyCodeLine{01123\ \textcolor{comment}{\ \ \ *\ \ \ last\ component\ of\ the\ whole\ sequence,\ so\ we\ should\ loop\ forward\ looking}}
\DoxyCodeLine{01124\ \textcolor{comment}{\ \ \ *\ \ \ for\ them\ and\ update\ them.}}
\DoxyCodeLine{01125\ \textcolor{comment}{\ \ \ *}}
\DoxyCodeLine{01126\ \textcolor{comment}{\ \ \ *\ \ \ Eg.\ the\ sequence\ is\ LAM,LAM,SHADDA,FATHA,HEH,\ and\ the\ font\ first\ forms\ a}}
\DoxyCodeLine{01127\ \textcolor{comment}{\ \ \ *\ \ \ 'calt'\ ligature\ of\ LAM,HEH,\ leaving\ the\ SHADDA\ and\ FATHA\ with\ a\ ligature}}
\DoxyCodeLine{01128\ \textcolor{comment}{\ \ \ *\ \ \ id\ and\ component\ ==\ 1.\ \ Now,\ during\ 'liga',\ the\ LAM\ and\ the\ LAM-\/HEH\ ligature}}
\DoxyCodeLine{01129\ \textcolor{comment}{\ \ \ *\ \ \ form\ a\ LAM-\/LAM-\/HEH\ ligature.\ \ We\ need\ to\ reassign\ the\ SHADDA\ and\ FATHA\ to}}
\DoxyCodeLine{01130\ \textcolor{comment}{\ \ \ *\ \ \ the\ new\ ligature\ with\ a\ component\ value\ of\ 2.}}
\DoxyCodeLine{01131\ \textcolor{comment}{\ \ \ *}}
\DoxyCodeLine{01132\ \textcolor{comment}{\ \ \ *\ \ \ This\ in\ fact\ happened\ to\ a\ font...\ \ See:}}
\DoxyCodeLine{01133\ \textcolor{comment}{\ \ \ *\ \ \ https://bugzilla.gnome.org/show\_bug.cgi?id=437633}}
\DoxyCodeLine{01134\ \textcolor{comment}{\ \ \ */}}
\DoxyCodeLine{01135\ }
\DoxyCodeLine{01136\ \ \ \textcolor{keywordtype}{bool}\ is\_base\_ligature\ =\ \_hb\_glyph\_info\_is\_base\_glyph\ (\&\mbox{\hyperlink{classbuffer}{buffer}}-\/>info[match\_positions[0]]);}
\DoxyCodeLine{01137\ \ \ \textcolor{keywordtype}{bool}\ is\_mark\_ligature\ =\ \_hb\_glyph\_info\_is\_mark\ (\&\mbox{\hyperlink{classbuffer}{buffer}}-\/>info[match\_positions[0]]);}
\DoxyCodeLine{01138\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ count;\ i++)}
\DoxyCodeLine{01139\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_hb\_glyph\_info\_is\_mark\ (\&\mbox{\hyperlink{classbuffer}{buffer}}-\/>info[match\_positions[i]]))}
\DoxyCodeLine{01140\ \ \ \ \ \{}
\DoxyCodeLine{01141\ \ \ \ \ \ \ is\_base\_ligature\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01142\ \ \ \ \ \ \ is\_mark\_ligature\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01143\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01144\ \ \ \ \ \}}
\DoxyCodeLine{01145\ \ \ \textcolor{keywordtype}{bool}\ is\_ligature\ =\ !is\_base\_ligature\ \&\&\ !is\_mark\_ligature;}
\DoxyCodeLine{01146\ }
\DoxyCodeLine{01147\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ klass\ =\ is\_ligature\ ?\ HB\_OT\_LAYOUT\_GLYPH\_PROPS\_LIGATURE\ :\ 0;}
\DoxyCodeLine{01148\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lig\_id\ =\ is\_ligature\ ?\ \_hb\_allocate\_lig\_id\ (\mbox{\hyperlink{classbuffer}{buffer}})\ :\ 0;}
\DoxyCodeLine{01149\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ last\_lig\_id\ =\ \_hb\_glyph\_info\_get\_lig\_id\ (\&\mbox{\hyperlink{classbuffer}{buffer}}-\/>cur());}
\DoxyCodeLine{01150\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ last\_num\_components\ =\ \_hb\_glyph\_info\_get\_lig\_num\_comps\ (\&\mbox{\hyperlink{classbuffer}{buffer}}-\/>cur());}
\DoxyCodeLine{01151\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ components\_so\_far\ =\ last\_num\_components;}
\DoxyCodeLine{01152\ }
\DoxyCodeLine{01153\ \ \ \textcolor{keywordflow}{if}\ (is\_ligature)}
\DoxyCodeLine{01154\ \ \ \{}
\DoxyCodeLine{01155\ \ \ \ \ \_hb\_glyph\_info\_set\_lig\_props\_for\_ligature\ (\&\mbox{\hyperlink{classbuffer}{buffer}}-\/>cur(),\ lig\_id,\ total\_component\_count);}
\DoxyCodeLine{01156\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_hb\_glyph\_info\_get\_general\_category\ (\&\mbox{\hyperlink{classbuffer}{buffer}}-\/>cur())\ ==\ HB\_UNICODE\_GENERAL\_CATEGORY\_NON\_SPACING\_MARK)}
\DoxyCodeLine{01157\ \ \ \ \ \{}
\DoxyCodeLine{01158\ \ \ \ \ \ \ \_hb\_glyph\_info\_set\_general\_category\ (\&\mbox{\hyperlink{classbuffer}{buffer}}-\/>cur(),\ HB\_UNICODE\_GENERAL\_CATEGORY\_OTHER\_LETTER);}
\DoxyCodeLine{01159\ \ \ \ \ \}}
\DoxyCodeLine{01160\ \ \ \}}
\DoxyCodeLine{01161\ \ \ c-\/>replace\_glyph\_with\_ligature\ (lig\_glyph,\ klass);}
\DoxyCodeLine{01162\ }
\DoxyCodeLine{01163\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ count;\ i++)}
\DoxyCodeLine{01164\ \ \ \{}
\DoxyCodeLine{01165\ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{classbuffer}{buffer}}-\/>idx\ <\ match\_positions[i]\ \&\&\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>successful)}
\DoxyCodeLine{01166\ \ \ \ \ \{}
\DoxyCodeLine{01167\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_ligature)}
\DoxyCodeLine{01168\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01169\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ this\_comp\ =\ \_hb\_glyph\_info\_get\_lig\_comp\ (\&\mbox{\hyperlink{classbuffer}{buffer}}-\/>cur());}
\DoxyCodeLine{01170\ \ \ \ \ \textcolor{keywordflow}{if}\ (this\_comp\ ==\ 0)}
\DoxyCodeLine{01171\ \ \ \ \ \ \ this\_comp\ =\ last\_num\_components;}
\DoxyCodeLine{01172\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ new\_lig\_comp\ =\ components\_so\_far\ -\/\ last\_num\_components\ +}
\DoxyCodeLine{01173\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_min\ (this\_comp,\ last\_num\_components);}
\DoxyCodeLine{01174\ \ \ \ \ \ \ \_hb\_glyph\_info\_set\_lig\_props\_for\_mark\ (\&\mbox{\hyperlink{classbuffer}{buffer}}-\/>cur(),\ lig\_id,\ new\_lig\_comp);}
\DoxyCodeLine{01175\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01176\ \ \ \ \ \ \ (void)\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>next\_glyph\ ();}
\DoxyCodeLine{01177\ \ \ \ \ \}}
\DoxyCodeLine{01178\ }
\DoxyCodeLine{01179\ \ \ \ \ last\_lig\_id\ =\ \_hb\_glyph\_info\_get\_lig\_id\ (\&\mbox{\hyperlink{classbuffer}{buffer}}-\/>cur());}
\DoxyCodeLine{01180\ \ \ \ \ last\_num\_components\ =\ \_hb\_glyph\_info\_get\_lig\_num\_comps\ (\&\mbox{\hyperlink{classbuffer}{buffer}}-\/>cur());}
\DoxyCodeLine{01181\ \ \ \ \ components\_so\_far\ +=\ last\_num\_components;}
\DoxyCodeLine{01182\ }
\DoxyCodeLine{01183\ \ \ \ \ \textcolor{comment}{/*\ Skip\ the\ base\ glyph\ */}}
\DoxyCodeLine{01184\ \ \ \ \ \mbox{\hyperlink{classbuffer}{buffer}}-\/>idx++;}
\DoxyCodeLine{01185\ \ \ \}}
\DoxyCodeLine{01186\ }
\DoxyCodeLine{01187\ \ \ \textcolor{keywordflow}{if}\ (!is\_mark\_ligature\ \&\&\ last\_lig\_id)}
\DoxyCodeLine{01188\ \ \ \{}
\DoxyCodeLine{01189\ \ \ \ \ \textcolor{comment}{/*\ Re-\/adjust\ components\ for\ any\ marks\ following.\ */}}
\DoxyCodeLine{01190\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>idx;\ i\ <\ buffer-\/>len;\ ++i)}
\DoxyCodeLine{01191\ \ \ \ \ \{}
\DoxyCodeLine{01192\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (last\_lig\_id\ !=\ \_hb\_glyph\_info\_get\_lig\_id\ (\&\mbox{\hyperlink{classbuffer}{buffer}}-\/>info[i]))\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01193\ }
\DoxyCodeLine{01194\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ this\_comp\ =\ \_hb\_glyph\_info\_get\_lig\_comp\ (\&\mbox{\hyperlink{classbuffer}{buffer}}-\/>info[i]);}
\DoxyCodeLine{01195\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!this\_comp)\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01196\ }
\DoxyCodeLine{01197\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ new\_lig\_comp\ =\ components\_so\_far\ -\/\ last\_num\_components\ +}
\DoxyCodeLine{01198\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_min\ (this\_comp,\ last\_num\_components);}
\DoxyCodeLine{01199\ \ \ \ \ \ \ \_hb\_glyph\_info\_set\_lig\_props\_for\_mark\ (\&\mbox{\hyperlink{classbuffer}{buffer}}-\/>info[i],\ lig\_id,\ new\_lig\_comp);}
\DoxyCodeLine{01200\ \ \ \ \ \}}
\DoxyCodeLine{01201\ \ \ \}}
\DoxyCodeLine{01202\ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{01203\ \}}
\DoxyCodeLine{01204\ }
\DoxyCodeLine{01205\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ match\_backtrack\ (hb\_ot\_apply\_context\_t\ *c,}
\DoxyCodeLine{01206\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count,}
\DoxyCodeLine{01207\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ HBUINT16\ backtrack[],}
\DoxyCodeLine{01208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ match\_func\_t\ match\_func,}
\DoxyCodeLine{01209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *match\_data,}
\DoxyCodeLine{01210\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *match\_start)}
\DoxyCodeLine{01211\ \{}
\DoxyCodeLine{01212\ \ \ TRACE\_APPLY\ (\textcolor{keyword}{nullptr});}
\DoxyCodeLine{01213\ }
\DoxyCodeLine{01214\ \ \ hb\_ot\_apply\_context\_t::skipping\_iterator\_t\ \&skippy\_iter\ =\ c-\/>iter\_context;}
\DoxyCodeLine{01215\ \ \ skippy\_iter.reset\ (c-\/>buffer-\/>backtrack\_len\ (),\ count);}
\DoxyCodeLine{01216\ \ \ skippy\_iter.set\_match\_func\ (match\_func,\ match\_data,\ backtrack);}
\DoxyCodeLine{01217\ }
\DoxyCodeLine{01218\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{01219\ \ \ \{}
\DoxyCodeLine{01220\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ unsafe\_from;}
\DoxyCodeLine{01221\ \ \ \ \ \textcolor{keywordflow}{if}\ (!skippy\_iter.prev\ (\&unsafe\_from))}
\DoxyCodeLine{01222\ \ \ \ \ \{}
\DoxyCodeLine{01223\ \ \ \ \ \ \ *match\_start\ =\ unsafe\_from;}
\DoxyCodeLine{01224\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01225\ \ \ \ \ \}}
\DoxyCodeLine{01226\ \ \ \}}
\DoxyCodeLine{01227\ }
\DoxyCodeLine{01228\ \ \ *match\_start\ =\ skippy\_iter.idx;}
\DoxyCodeLine{01229\ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{01230\ \}}
\DoxyCodeLine{01231\ }
\DoxyCodeLine{01232\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ match\_lookahead\ (hb\_ot\_apply\_context\_t\ *c,}
\DoxyCodeLine{01233\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count,}
\DoxyCodeLine{01234\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ HBUINT16\ lookahead[],}
\DoxyCodeLine{01235\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ match\_func\_t\ match\_func,}
\DoxyCodeLine{01236\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *match\_data,}
\DoxyCodeLine{01237\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ start\_index,}
\DoxyCodeLine{01238\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *end\_index)}
\DoxyCodeLine{01239\ \{}
\DoxyCodeLine{01240\ \ \ TRACE\_APPLY\ (\textcolor{keyword}{nullptr});}
\DoxyCodeLine{01241\ }
\DoxyCodeLine{01242\ \ \ hb\_ot\_apply\_context\_t::skipping\_iterator\_t\ \&skippy\_iter\ =\ c-\/>iter\_context;}
\DoxyCodeLine{01243\ \ \ skippy\_iter.reset\ (start\_index\ -\/\ 1,\ count);}
\DoxyCodeLine{01244\ \ \ skippy\_iter.set\_match\_func\ (match\_func,\ match\_data,\ lookahead);}
\DoxyCodeLine{01245\ }
\DoxyCodeLine{01246\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{01247\ \ \ \{}
\DoxyCodeLine{01248\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ unsafe\_to;}
\DoxyCodeLine{01249\ \ \ \ \ \textcolor{keywordflow}{if}\ (!skippy\_iter.next\ (\&unsafe\_to))}
\DoxyCodeLine{01250\ \ \ \ \ \{}
\DoxyCodeLine{01251\ \ \ \ \ \ \ *end\_index\ =\ unsafe\_to;}
\DoxyCodeLine{01252\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01253\ \ \ \ \ \}}
\DoxyCodeLine{01254\ \ \ \}}
\DoxyCodeLine{01255\ }
\DoxyCodeLine{01256\ \ \ *end\_index\ =\ skippy\_iter.idx\ +\ 1;}
\DoxyCodeLine{01257\ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{01258\ \}}
\DoxyCodeLine{01259\ }
\DoxyCodeLine{01260\ }
\DoxyCodeLine{01261\ }
\DoxyCodeLine{01262\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_lookup_record}{LookupRecord}}}
\DoxyCodeLine{01263\ \{}
\DoxyCodeLine{01264\ \ \ \textcolor{keywordtype}{bool}\ serialize\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{01265\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ \ \ \ \ \ \ \ \ *lookup\_map)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01266\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01267\ \ \ \ \ TRACE\_SERIALIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01268\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>embed\ (*\textcolor{keyword}{this});}
\DoxyCodeLine{01269\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!out))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01270\ }
\DoxyCodeLine{01271\ \ \ \ \ return\_trace\ (c-\/>check\_assign\ (out-\/>lookupListIndex,\ lookup\_map-\/>get\ (lookupListIndex),\ HB\_SERIALIZE\_ERROR\_INT\_OVERFLOW));}
\DoxyCodeLine{01272\ \ \ \}}
\DoxyCodeLine{01273\ }
\DoxyCodeLine{01274\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01275\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01276\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01277\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this}));}
\DoxyCodeLine{01278\ \ \ \}}
\DoxyCodeLine{01279\ }
\DoxyCodeLine{01280\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ sequenceIndex;\ \ \ \ \ \ \textcolor{comment}{/*\ Index\ into\ current\ glyph}}
\DoxyCodeLine{01281\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ sequence-\/-\/first\ glyph\ =\ 0\ */}}
\DoxyCodeLine{01282\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ lookupListIndex;\ \ \ \ \textcolor{comment}{/*\ Lookup\ to\ apply\ to\ that}}
\DoxyCodeLine{01283\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ position-\/-\/zero-\/-\/based\ */}}
\DoxyCodeLine{01284\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01285\ \ \ DEFINE\_SIZE\_STATIC\ (4);}
\DoxyCodeLine{01286\ \};}
\DoxyCodeLine{01287\ }
\DoxyCodeLine{01288\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{unsigned}\ serialize\_lookuprecord\_array\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{01289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__array__t}{hb\_array\_t<const\ LookupRecord>}}\ lookupRecords,}
\DoxyCodeLine{01290\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *lookup\_map)}
\DoxyCodeLine{01291\ \{}
\DoxyCodeLine{01292\ \ \ \textcolor{keywordtype}{unsigned}\ count\ =\ 0;}
\DoxyCodeLine{01293\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_lookup_record}{LookupRecord}}\&\ r\ :\ lookupRecords)}
\DoxyCodeLine{01294\ \ \ \{}
\DoxyCodeLine{01295\ \ \ \ \ \textcolor{keywordflow}{if}\ (!lookup\_map-\/>has\ (r.lookupListIndex))}
\DoxyCodeLine{01296\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01297\ }
\DoxyCodeLine{01298\ \ \ \ \ \textcolor{keywordflow}{if}\ (!r.serialize\ (c,\ lookup\_map))}
\DoxyCodeLine{01299\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01300\ }
\DoxyCodeLine{01301\ \ \ \ \ count++;}
\DoxyCodeLine{01302\ \ \ \}}
\DoxyCodeLine{01303\ \ \ \textcolor{keywordflow}{return}\ count;}
\DoxyCodeLine{01304\ \}}
\DoxyCodeLine{01305\ }
\DoxyCodeLine{01306\ \textcolor{keyword}{enum}\ ContextFormat\ \{\ SimpleContext\ =\ 1,\ ClassBasedContext\ =\ 2,\ CoverageBasedContext\ =\ 3\ \};}
\DoxyCodeLine{01307\ }
\DoxyCodeLine{01308\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ context\_closure\_recurse\_lookups\ (hb\_closure\_context\_t\ *c,}
\DoxyCodeLine{01309\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ inputCount,\ \textcolor{keyword}{const}\ HBUINT16\ \mbox{\hyperlink{structinput}{input}}[],}
\DoxyCodeLine{01310\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ lookupCount,}
\DoxyCodeLine{01311\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LookupRecord\ lookupRecord[]\ \textcolor{comment}{/*\ Array\ of\ LookupRecords-\/-\/in\ design\ order\ */},}
\DoxyCodeLine{01312\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classvalue}{value}},}
\DoxyCodeLine{01313\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ContextFormat\ context\_format,}
\DoxyCodeLine{01314\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{structdata}{data}},}
\DoxyCodeLine{01315\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ intersected\_glyphs\_func\_t\ intersected\_glyphs\_func)}
\DoxyCodeLine{01316\ \{}
\DoxyCodeLine{01317\ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *covered\_seq\_indicies\ =\ hb\_set\_create\ ();}
\DoxyCodeLine{01318\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ lookupCount;\ i++)}
\DoxyCodeLine{01319\ \ \ \{}
\DoxyCodeLine{01320\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ seqIndex\ =\ lookupRecord[i].sequenceIndex;}
\DoxyCodeLine{01321\ \ \ \ \ \textcolor{keywordflow}{if}\ (seqIndex\ >=\ inputCount)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01322\ }
\DoxyCodeLine{01323\ \ \ \ \ \textcolor{keywordtype}{bool}\ has\_pos\_glyphs\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01324\ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ pos\_glyphs;}
\DoxyCodeLine{01325\ }
\DoxyCodeLine{01326\ \ \ \ \ \textcolor{keywordflow}{if}\ (hb\_set\_is\_empty\ (covered\_seq\_indicies)\ ||\ !hb\_set\_has\ (covered\_seq\_indicies,\ seqIndex))}
\DoxyCodeLine{01327\ \ \ \ \ \{}
\DoxyCodeLine{01328\ \ \ \ \ \ \ has\_pos\_glyphs\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01329\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (seqIndex\ ==\ 0)}
\DoxyCodeLine{01330\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01331\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (context\_format)\ \{}
\DoxyCodeLine{01332\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ContextFormat::SimpleContext:}
\DoxyCodeLine{01333\ \ \ \ \ \ \ \ \ \ \ pos\_glyphs.add\ (\mbox{\hyperlink{classvalue}{value}});}
\DoxyCodeLine{01334\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01335\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ContextFormat::ClassBasedContext:}
\DoxyCodeLine{01336\ \ \ \ \ \ \ \ \ \ \ intersected\_glyphs\_func\ (\&c-\/>parent\_active\_glyphs\ (),\ \mbox{\hyperlink{structdata}{data}},\ \mbox{\hyperlink{classvalue}{value}},\ \&pos\_glyphs);}
\DoxyCodeLine{01337\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01338\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ContextFormat::CoverageBasedContext:}
\DoxyCodeLine{01339\ \ \ \ \ \ \ \ \ \ \ pos\_glyphs.set\ (c-\/>parent\_active\_glyphs\ ());}
\DoxyCodeLine{01340\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01341\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01342\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01343\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01344\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01345\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *input\_data\ =\ \mbox{\hyperlink{structinput}{input}};}
\DoxyCodeLine{01346\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ input\_value\ =\ seqIndex\ -\/\ 1;}
\DoxyCodeLine{01347\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (context\_format\ !=\ ContextFormat::SimpleContext)}
\DoxyCodeLine{01348\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01349\ \ \ \ \ \ \ \ \ \ \ input\_data\ =\ \mbox{\hyperlink{structdata}{data}};}
\DoxyCodeLine{01350\ \ \ \ \ \ \ \ \ \ \ input\_value\ =\ \mbox{\hyperlink{structinput}{input}}[seqIndex\ -\/\ 1];}
\DoxyCodeLine{01351\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01352\ }
\DoxyCodeLine{01353\ \ \ \ \ \ \ \ \ intersected\_glyphs\_func\ (c-\/>glyphs,\ input\_data,\ input\_value,\ \&pos\_glyphs);}
\DoxyCodeLine{01354\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01355\ \ \ \ \ \}}
\DoxyCodeLine{01356\ }
\DoxyCodeLine{01357\ \ \ \ \ covered\_seq\_indicies-\/>add\ (seqIndex);}
\DoxyCodeLine{01358\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_pos\_glyphs)\ \{}
\DoxyCodeLine{01359\ \ \ \ \ \ \ c-\/>push\_cur\_active\_glyphs\ ()\ =\ pos\_glyphs;}
\DoxyCodeLine{01360\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01361\ \ \ \ \ \ \ c-\/>push\_cur\_active\_glyphs\ ().set\ (*c-\/>glyphs);}
\DoxyCodeLine{01362\ \ \ \ \ \}}
\DoxyCodeLine{01363\ }
\DoxyCodeLine{01364\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ endIndex\ =\ inputCount;}
\DoxyCodeLine{01365\ \ \ \ \ \textcolor{keywordflow}{if}\ (context\_format\ ==\ ContextFormat::CoverageBasedContext)}
\DoxyCodeLine{01366\ \ \ \ \ \ \ endIndex\ +=\ 1;}
\DoxyCodeLine{01367\ }
\DoxyCodeLine{01368\ \ \ \ \ c-\/>recurse\ (lookupRecord[i].lookupListIndex,\ covered\_seq\_indicies,\ seqIndex,\ endIndex);}
\DoxyCodeLine{01369\ }
\DoxyCodeLine{01370\ \ \ \ \ c-\/>pop\_cur\_done\_glyphs\ ();}
\DoxyCodeLine{01371\ \ \ \}}
\DoxyCodeLine{01372\ }
\DoxyCodeLine{01373\ \ \ hb\_set\_destroy\ (covered\_seq\_indicies);}
\DoxyCodeLine{01374\ \}}
\DoxyCodeLine{01375\ }
\DoxyCodeLine{01376\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ context\_t>}
\DoxyCodeLine{01377\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ recurse\_lookups\ (context\_t\ *c,}
\DoxyCodeLine{01378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookupCount,}
\DoxyCodeLine{01379\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LookupRecord\ lookupRecord[]\ \textcolor{comment}{/*\ Array\ of\ LookupRecords-\/-\/in\ design\ order\ */})}
\DoxyCodeLine{01380\ \{}
\DoxyCodeLine{01381\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ lookupCount;\ i++)}
\DoxyCodeLine{01382\ \ \ \ \ c-\/>recurse\ (lookupRecord[i].lookupListIndex);}
\DoxyCodeLine{01383\ \}}
\DoxyCodeLine{01384\ }
\DoxyCodeLine{01385\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ apply\_lookup\ (hb\_ot\_apply\_context\_t\ *c,}
\DoxyCodeLine{01386\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count,\ \textcolor{comment}{/*\ Including\ the\ first\ glyph\ */}}
\DoxyCodeLine{01387\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ match\_positions[HB\_MAX\_CONTEXT\_LENGTH],\ \textcolor{comment}{/*\ Including\ the\ first\ glyph\ */}}
\DoxyCodeLine{01388\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookupCount,}
\DoxyCodeLine{01389\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LookupRecord\ lookupRecord[],\ \textcolor{comment}{/*\ Array\ of\ LookupRecords-\/-\/in\ design\ order\ */}}
\DoxyCodeLine{01390\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ match\_end)}
\DoxyCodeLine{01391\ \{}
\DoxyCodeLine{01392\ \ \ \mbox{\hyperlink{structhb__buffer__t}{hb\_buffer\_t}}\ *\mbox{\hyperlink{classbuffer}{buffer}}\ =\ c-\/>buffer;}
\DoxyCodeLine{01393\ \ \ \textcolor{keywordtype}{int}\ end;}
\DoxyCodeLine{01394\ }
\DoxyCodeLine{01395\ \ \ \textcolor{comment}{/*\ All\ positions\ are\ distance\ from\ beginning\ of\ *output*\ buffer.}}
\DoxyCodeLine{01396\ \textcolor{comment}{\ \ \ *\ Adjust.\ */}}
\DoxyCodeLine{01397\ \ \ \{}
\DoxyCodeLine{01398\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ bl\ =\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>backtrack\_len\ ();}
\DoxyCodeLine{01399\ \ \ \ \ end\ =\ bl\ +\ match\_end\ -\/\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>idx;}
\DoxyCodeLine{01400\ }
\DoxyCodeLine{01401\ \ \ \ \ \textcolor{keywordtype}{int}\ delta\ =\ bl\ -\/\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>idx;}
\DoxyCodeLine{01402\ \ \ \ \ \textcolor{comment}{/*\ Convert\ positions\ to\ new\ indexing.\ */}}
\DoxyCodeLine{01403\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ count;\ j++)}
\DoxyCodeLine{01404\ \ \ \ \ \ \ match\_positions[j]\ +=\ delta;}
\DoxyCodeLine{01405\ \ \ \}}
\DoxyCodeLine{01406\ }
\DoxyCodeLine{01407\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ lookupCount\ \&\&\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>successful;\ i++)}
\DoxyCodeLine{01408\ \ \ \{}
\DoxyCodeLine{01409\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ idx\ =\ lookupRecord[i].sequenceIndex;}
\DoxyCodeLine{01410\ \ \ \ \ \textcolor{keywordflow}{if}\ (idx\ >=\ count)}
\DoxyCodeLine{01411\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01412\ }
\DoxyCodeLine{01413\ \ \ \ \ \textcolor{comment}{/*\ Don't\ recurse\ to\ ourself\ at\ same\ position.}}
\DoxyCodeLine{01414\ \textcolor{comment}{\ \ \ \ \ *\ Note\ that\ this\ test\ is\ too\ naive,\ it\ doesn't\ catch\ longer\ loops.\ */}}
\DoxyCodeLine{01415\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (idx\ ==\ 0\ \&\&\ lookupRecord[i].lookupListIndex\ ==\ c-\/>lookup\_index))}
\DoxyCodeLine{01416\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01417\ }
\DoxyCodeLine{01418\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!\mbox{\hyperlink{classbuffer}{buffer}}-\/>move\_to\ (match\_positions[idx])))}
\DoxyCodeLine{01419\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01420\ }
\DoxyCodeLine{01421\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (\mbox{\hyperlink{classbuffer}{buffer}}-\/>max\_ops\ <=\ 0))}
\DoxyCodeLine{01422\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01423\ }
\DoxyCodeLine{01424\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ orig\_len\ =\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>backtrack\_len\ ()\ +\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>lookahead\_len\ ();}
\DoxyCodeLine{01425\ \ \ \ \ \textcolor{keywordflow}{if}\ (!c-\/>recurse\ (lookupRecord[i].lookupListIndex))}
\DoxyCodeLine{01426\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01427\ }
\DoxyCodeLine{01428\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ new\_len\ =\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>backtrack\_len\ ()\ +\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>lookahead\_len\ ();}
\DoxyCodeLine{01429\ \ \ \ \ \textcolor{keywordtype}{int}\ delta\ =\ new\_len\ -\/\ orig\_len;}
\DoxyCodeLine{01430\ }
\DoxyCodeLine{01431\ \ \ \ \ \textcolor{keywordflow}{if}\ (!delta)}
\DoxyCodeLine{01432\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01433\ }
\DoxyCodeLine{01434\ \ \ \ \ \textcolor{comment}{/*\ Recursed\ lookup\ changed\ buffer\ len.\ \ Adjust.}}
\DoxyCodeLine{01435\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{01436\ \textcolor{comment}{\ \ \ \ \ *\ TODO:}}
\DoxyCodeLine{01437\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{01438\ \textcolor{comment}{\ \ \ \ \ *\ Right\ now,\ if\ buffer\ length\ increased\ by\ n,\ we\ assume\ n\ new\ glyphs}}
\DoxyCodeLine{01439\ \textcolor{comment}{\ \ \ \ \ *\ were\ added\ right\ after\ the\ current\ position,\ and\ if\ buffer\ length}}
\DoxyCodeLine{01440\ \textcolor{comment}{\ \ \ \ \ *\ was\ decreased\ by\ n,\ we\ assume\ n\ match\ positions\ after\ the\ current}}
\DoxyCodeLine{01441\ \textcolor{comment}{\ \ \ \ \ *\ one\ where\ removed.\ \ The\ former\ (buffer\ length\ increased)\ case\ is}}
\DoxyCodeLine{01442\ \textcolor{comment}{\ \ \ \ \ *\ fine,\ but\ the\ decrease\ case\ can\ be\ improved\ in\ at\ least\ two\ ways,}}
\DoxyCodeLine{01443\ \textcolor{comment}{\ \ \ \ \ *\ both\ of\ which\ are\ significant:}}
\DoxyCodeLine{01444\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{01445\ \textcolor{comment}{\ \ \ \ \ *\ \ \ -\/\ If\ recursed-\/to\ lookup\ is\ MultipleSubst\ and\ buffer\ length}}
\DoxyCodeLine{01446\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ decreased,\ then\ it's\ current\ match\ position\ that\ was\ deleted,}}
\DoxyCodeLine{01447\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ NOT\ the\ one\ after\ it.}}
\DoxyCodeLine{01448\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{01449\ \textcolor{comment}{\ \ \ \ \ *\ \ \ -\/\ If\ buffer\ length\ was\ decreased\ by\ n,\ it\ does\ not\ necessarily}}
\DoxyCodeLine{01450\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ mean\ that\ n\ match\ positions\ where\ removed,\ as\ there\ might}}
\DoxyCodeLine{01451\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ have\ been\ marks\ and\ default-\/ignorables\ in\ the\ sequence.\ \ We}}
\DoxyCodeLine{01452\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ should\ instead\ drop\ match\ positions\ between\ current-\/position}}
\DoxyCodeLine{01453\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ and\ current-\/position\ +\ n\ instead.\ Though,\ am\ not\ sure\ which}}
\DoxyCodeLine{01454\ \textcolor{comment}{\ \ \ \ \ *\ \ \ \ \ one\ is\ better.\ Both\ cases\ have\ valid\ uses.\ Sigh.}}
\DoxyCodeLine{01455\ \textcolor{comment}{\ \ \ \ \ *}}
\DoxyCodeLine{01456\ \textcolor{comment}{\ \ \ \ \ *\ It\ should\ be\ possible\ to\ construct\ tests\ for\ both\ of\ these\ cases.}}
\DoxyCodeLine{01457\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{01458\ }
\DoxyCodeLine{01459\ \ \ \ \ end\ +=\ delta;}
\DoxyCodeLine{01460\ \ \ \ \ \textcolor{keywordflow}{if}\ (end\ <=\ \textcolor{keywordtype}{int}\ (match\_positions[idx]))}
\DoxyCodeLine{01461\ \ \ \ \ \{}
\DoxyCodeLine{01462\ \ \ \ \ \ \ \textcolor{comment}{/*\ End\ might\ end\ up\ being\ smaller\ than\ match\_positions[idx]\ if\ the\ recursed}}
\DoxyCodeLine{01463\ \textcolor{comment}{\ \ \ \ \ \ \ *\ lookup\ ended\ up\ removing\ many\ items,\ more\ than\ we\ have\ had\ matched.}}
\DoxyCodeLine{01464\ \textcolor{comment}{\ \ \ \ \ \ \ *\ Just\ never\ rewind\ end\ back\ and\ get\ out\ of\ here.}}
\DoxyCodeLine{01465\ \textcolor{comment}{\ \ \ \ \ \ \ *\ https://bugs.chromium.org/p/chromium/issues/detail?id=659496\ */}}
\DoxyCodeLine{01466\ \ \ \ \ \ \ end\ =\ match\_positions[idx];}
\DoxyCodeLine{01467\ \ \ \ \ \ \ \textcolor{comment}{/*\ There\ can't\ be\ any\ further\ changes.\ */}}
\DoxyCodeLine{01468\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01469\ \ \ \ \ \}}
\DoxyCodeLine{01470\ }
\DoxyCodeLine{01471\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ next\ =\ idx\ +\ 1;\ \textcolor{comment}{/*\ next\ now\ is\ the\ position\ after\ the\ recursed\ lookup.\ */}}
\DoxyCodeLine{01472\ }
\DoxyCodeLine{01473\ \ \ \ \ \textcolor{keywordflow}{if}\ (delta\ >\ 0)}
\DoxyCodeLine{01474\ \ \ \ \ \{}
\DoxyCodeLine{01475\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (delta\ +\ count\ >\ HB\_MAX\_CONTEXT\_LENGTH))}
\DoxyCodeLine{01476\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01477\ \ \ \ \ \}}
\DoxyCodeLine{01478\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01479\ \ \ \ \ \{}
\DoxyCodeLine{01480\ \ \ \ \ \ \ \textcolor{comment}{/*\ NOTE:\ delta\ is\ negative.\ */}}
\DoxyCodeLine{01481\ \ \ \ \ \ \ delta\ =\ hb\_max\ (delta,\ (\textcolor{keywordtype}{int})\ next\ -\/\ (\textcolor{keywordtype}{int})\ count);}
\DoxyCodeLine{01482\ \ \ \ \ \ \ next\ -\/=\ delta;}
\DoxyCodeLine{01483\ \ \ \ \ \}}
\DoxyCodeLine{01484\ }
\DoxyCodeLine{01485\ \ \ \ \ \textcolor{comment}{/*\ Shift!\ */}}
\DoxyCodeLine{01486\ \ \ \ \ memmove\ (match\_positions\ +\ next\ +\ delta,\ match\_positions\ +\ next,}
\DoxyCodeLine{01487\ \ \ \ \ \ \ \ \ \ (count\ -\/\ next)\ *\ \textcolor{keyword}{sizeof}\ (match\_positions[0]));}
\DoxyCodeLine{01488\ \ \ \ \ next\ +=\ delta;}
\DoxyCodeLine{01489\ \ \ \ \ count\ +=\ delta;}
\DoxyCodeLine{01490\ }
\DoxyCodeLine{01491\ \ \ \ \ \textcolor{comment}{/*\ Fill\ in\ new\ entries.\ */}}
\DoxyCodeLine{01492\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j\ =\ idx\ +\ 1;\ j\ <\ next;\ j++)}
\DoxyCodeLine{01493\ \ \ \ \ \ \ match\_positions[j]\ =\ match\_positions[j\ -\/\ 1]\ +\ 1;}
\DoxyCodeLine{01494\ }
\DoxyCodeLine{01495\ \ \ \ \ \textcolor{comment}{/*\ And\ fixup\ the\ rest.\ */}}
\DoxyCodeLine{01496\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ next\ <\ count;\ next++)}
\DoxyCodeLine{01497\ \ \ \ \ \ \ match\_positions[next]\ +=\ delta;}
\DoxyCodeLine{01498\ \ \ \}}
\DoxyCodeLine{01499\ }
\DoxyCodeLine{01500\ \ \ (void)\ \mbox{\hyperlink{classbuffer}{buffer}}-\/>move\_to\ (end);}
\DoxyCodeLine{01501\ \}}
\DoxyCodeLine{01502\ }
\DoxyCodeLine{01503\ }
\DoxyCodeLine{01504\ }
\DoxyCodeLine{01505\ \textcolor{comment}{/*\ Contextual\ lookups\ */}}
\DoxyCodeLine{01506\ }
\DoxyCodeLine{01507\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_context_closure_lookup_context}{ContextClosureLookupContext}}}
\DoxyCodeLine{01508\ \{}
\DoxyCodeLine{01509\ \ \ \mbox{\hyperlink{struct_o_t_1_1_context_closure_funcs}{ContextClosureFuncs}}\ funcs;}
\DoxyCodeLine{01510\ \ \ ContextFormat\ context\_format;}
\DoxyCodeLine{01511\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *intersects\_data;}
\DoxyCodeLine{01512\ \};}
\DoxyCodeLine{01513\ }
\DoxyCodeLine{01514\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_context_collect_glyphs_lookup_context}{ContextCollectGlyphsLookupContext}}}
\DoxyCodeLine{01515\ \{}
\DoxyCodeLine{01516\ \ \ \mbox{\hyperlink{struct_o_t_1_1_context_collect_glyphs_funcs}{ContextCollectGlyphsFuncs}}\ funcs;}
\DoxyCodeLine{01517\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *collect\_data;}
\DoxyCodeLine{01518\ \};}
\DoxyCodeLine{01519\ }
\DoxyCodeLine{01520\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_context_apply_lookup_context}{ContextApplyLookupContext}}}
\DoxyCodeLine{01521\ \{}
\DoxyCodeLine{01522\ \ \ \mbox{\hyperlink{struct_o_t_1_1_context_apply_funcs}{ContextApplyFuncs}}\ funcs;}
\DoxyCodeLine{01523\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *match\_data;}
\DoxyCodeLine{01524\ \};}
\DoxyCodeLine{01525\ }
\DoxyCodeLine{01526\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ context\_intersects\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,}
\DoxyCodeLine{01527\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ inputCount,\ \textcolor{comment}{/*\ Including\ the\ first\ glyph\ (not\ matched)\ */}}
\DoxyCodeLine{01528\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \mbox{\hyperlink{structinput}{input}}[],\ \textcolor{comment}{/*\ Array\ of\ input\ values-\/-\/start\ with\ second\ glyph\ */}}
\DoxyCodeLine{01529\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_context_closure_lookup_context}{ContextClosureLookupContext}}\ \&lookup\_context)}
\DoxyCodeLine{01530\ \{}
\DoxyCodeLine{01531\ \ \ \textcolor{keywordflow}{return}\ array\_is\_subset\_of\ (glyphs,}
\DoxyCodeLine{01532\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ inputCount\ ?\ inputCount\ -\/\ 1\ :\ 0,\ \mbox{\hyperlink{structinput}{input}},}
\DoxyCodeLine{01533\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_context.funcs.intersects,\ lookup\_context.intersects\_data);}
\DoxyCodeLine{01534\ \}}
\DoxyCodeLine{01535\ }
\DoxyCodeLine{01536\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ context\_closure\_lookup\ (hb\_closure\_context\_t\ *c,}
\DoxyCodeLine{01537\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ inputCount,\ \textcolor{comment}{/*\ Including\ the\ first\ glyph\ (not\ matched)\ */}}
\DoxyCodeLine{01538\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ HBUINT16\ \mbox{\hyperlink{structinput}{input}}[],\ \textcolor{comment}{/*\ Array\ of\ input\ values-\/-\/start\ with\ second\ glyph\ */}}
\DoxyCodeLine{01539\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookupCount,}
\DoxyCodeLine{01540\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LookupRecord\ lookupRecord[],}
\DoxyCodeLine{01541\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classvalue}{value}},\ \textcolor{comment}{/*\ Index\ of\ first\ glyph\ in\ Coverage\ or\ Class\ value\ in\ ClassDef\ table\ */}}
\DoxyCodeLine{01542\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ContextClosureLookupContext\ \&lookup\_context)}
\DoxyCodeLine{01543\ \{}
\DoxyCodeLine{01544\ \ \ \textcolor{keywordflow}{if}\ (context\_intersects\ (c-\/>glyphs,}
\DoxyCodeLine{01545\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ inputCount,\ \mbox{\hyperlink{structinput}{input}},}
\DoxyCodeLine{01546\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_context))}
\DoxyCodeLine{01547\ \ \ \ \ context\_closure\_recurse\_lookups\ (c,}
\DoxyCodeLine{01548\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ inputCount,\ \mbox{\hyperlink{structinput}{input}},}
\DoxyCodeLine{01549\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookupCount,\ lookupRecord,}
\DoxyCodeLine{01550\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classvalue}{value}},}
\DoxyCodeLine{01551\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_context.context\_format,}
\DoxyCodeLine{01552\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_context.intersects\_data,}
\DoxyCodeLine{01553\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_context.funcs.intersected\_glyphs);}
\DoxyCodeLine{01554\ \}}
\DoxyCodeLine{01555\ }
\DoxyCodeLine{01556\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ context\_collect\_glyphs\_lookup\ (hb\_collect\_glyphs\_context\_t\ *c,}
\DoxyCodeLine{01557\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ inputCount,\ \textcolor{comment}{/*\ Including\ the\ first\ glyph\ (not\ matched)\ */}}
\DoxyCodeLine{01558\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ HBUINT16\ \mbox{\hyperlink{structinput}{input}}[],\ \textcolor{comment}{/*\ Array\ of\ input\ values-\/-\/start\ with\ second\ glyph\ */}}
\DoxyCodeLine{01559\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookupCount,}
\DoxyCodeLine{01560\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LookupRecord\ lookupRecord[],}
\DoxyCodeLine{01561\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ContextCollectGlyphsLookupContext\ \&lookup\_context)}
\DoxyCodeLine{01562\ \{}
\DoxyCodeLine{01563\ \ \ collect\_array\ (c,\ c-\/>input,}
\DoxyCodeLine{01564\ \ \ \ \ \ \ \ \ \ inputCount\ ?\ inputCount\ -\/\ 1\ :\ 0,\ \mbox{\hyperlink{structinput}{input}},}
\DoxyCodeLine{01565\ \ \ \ \ \ \ \ \ \ lookup\_context.funcs.collect,\ lookup\_context.collect\_data);}
\DoxyCodeLine{01566\ \ \ recurse\_lookups\ (c,}
\DoxyCodeLine{01567\ \ \ \ \ \ \ \ \ \ \ \ lookupCount,\ lookupRecord);}
\DoxyCodeLine{01568\ \}}
\DoxyCodeLine{01569\ }
\DoxyCodeLine{01570\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ context\_would\_apply\_lookup\ (hb\_would\_apply\_context\_t\ *c,}
\DoxyCodeLine{01571\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ inputCount,\ \textcolor{comment}{/*\ Including\ the\ first\ glyph\ (not\ matched)\ */}}
\DoxyCodeLine{01572\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ HBUINT16\ \mbox{\hyperlink{structinput}{input}}[],\ \textcolor{comment}{/*\ Array\ of\ input\ values-\/-\/start\ with\ second\ glyph\ */}}
\DoxyCodeLine{01573\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookupCount\ HB\_UNUSED,}
\DoxyCodeLine{01574\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LookupRecord\ lookupRecord[]\ HB\_UNUSED,}
\DoxyCodeLine{01575\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ContextApplyLookupContext\ \&lookup\_context)}
\DoxyCodeLine{01576\ \{}
\DoxyCodeLine{01577\ \ \ \textcolor{keywordflow}{return}\ would\_match\_input\ (c,}
\DoxyCodeLine{01578\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ inputCount,\ \mbox{\hyperlink{structinput}{input}},}
\DoxyCodeLine{01579\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_context.funcs.match,\ lookup\_context.match\_data);}
\DoxyCodeLine{01580\ \}}
\DoxyCodeLine{01581\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ context\_apply\_lookup\ (hb\_ot\_apply\_context\_t\ *c,}
\DoxyCodeLine{01582\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ inputCount,\ \textcolor{comment}{/*\ Including\ the\ first\ glyph\ (not\ matched)\ */}}
\DoxyCodeLine{01583\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ HBUINT16\ \mbox{\hyperlink{structinput}{input}}[],\ \textcolor{comment}{/*\ Array\ of\ input\ values-\/-\/start\ with\ second\ glyph\ */}}
\DoxyCodeLine{01584\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookupCount,}
\DoxyCodeLine{01585\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LookupRecord\ lookupRecord[],}
\DoxyCodeLine{01586\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ContextApplyLookupContext\ \&lookup\_context)}
\DoxyCodeLine{01587\ \{}
\DoxyCodeLine{01588\ \ \ \textcolor{keywordtype}{unsigned}\ match\_end\ =\ 0;}
\DoxyCodeLine{01589\ \ \ \textcolor{keywordtype}{unsigned}\ match\_positions[HB\_MAX\_CONTEXT\_LENGTH];}
\DoxyCodeLine{01590\ \ \ \textcolor{keywordflow}{if}\ (match\_input\ (c,}
\DoxyCodeLine{01591\ \ \ \ \ \ \ \ \ \ \ \ inputCount,\ \mbox{\hyperlink{structinput}{input}},}
\DoxyCodeLine{01592\ \ \ \ \ \ \ \ \ \ \ \ lookup\_context.funcs.match,\ lookup\_context.match\_data,}
\DoxyCodeLine{01593\ \ \ \ \ \ \ \ \ \ \ \ \&match\_end,\ match\_positions))}
\DoxyCodeLine{01594\ \ \ \{}
\DoxyCodeLine{01595\ \ \ \ \ c-\/>buffer-\/>unsafe\_to\_break\ (c-\/>buffer-\/>idx,\ match\_end);}
\DoxyCodeLine{01596\ \ \ \ \ apply\_lookup\ (c,}
\DoxyCodeLine{01597\ \ \ \ \ \ \ \ \ \ \ inputCount,\ match\_positions,}
\DoxyCodeLine{01598\ \ \ \ \ \ \ \ \ \ \ lookupCount,\ lookupRecord,}
\DoxyCodeLine{01599\ \ \ \ \ \ \ \ \ \ \ match\_end);}
\DoxyCodeLine{01600\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01601\ \ \ \}}
\DoxyCodeLine{01602\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01603\ \ \ \{}
\DoxyCodeLine{01604\ \ \ \ \ c-\/>buffer-\/>unsafe\_to\_concat\ (c-\/>buffer-\/>idx,\ match\_end);}
\DoxyCodeLine{01605\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01606\ \ \ \}}
\DoxyCodeLine{01607\ \}}
\DoxyCodeLine{01608\ }
\DoxyCodeLine{01609\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_rule}{Rule}}}
\DoxyCodeLine{01610\ \{}
\DoxyCodeLine{01611\ \ \ \textcolor{keywordtype}{bool}\ intersects\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ \mbox{\hyperlink{struct_o_t_1_1_context_closure_lookup_context}{ContextClosureLookupContext}}\ \&lookup\_context)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01612\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01613\ \ \ \ \ \textcolor{keywordflow}{return}\ context\_intersects\ (glyphs,}
\DoxyCodeLine{01614\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ inputCount,\ inputZ.arrayZ,}
\DoxyCodeLine{01615\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_context);}
\DoxyCodeLine{01616\ \ \ \}}
\DoxyCodeLine{01617\ }
\DoxyCodeLine{01618\ \ \ \textcolor{keywordtype}{void}\ closure\ (\mbox{\hyperlink{struct_o_t_1_1hb__closure__context__t}{hb\_closure\_context\_t}}\ *c,\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classvalue}{value}},\ \mbox{\hyperlink{struct_o_t_1_1_context_closure_lookup_context}{ContextClosureLookupContext}}\ \&lookup\_context)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01619\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01620\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (c-\/>lookup\_limit\_exceeded\ ()))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01621\ }
\DoxyCodeLine{01622\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_unsized_array_of}{UnsizedArrayOf<LookupRecord>}}\ \&lookupRecord\ =\ StructAfter<UnsizedArrayOf<LookupRecord>>}
\DoxyCodeLine{01623\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (inputZ.as\_array\ ((inputCount\ ?\ inputCount\ -\/\ 1\ :\ 0)));}
\DoxyCodeLine{01624\ \ \ \ \ context\_closure\_lookup\ (c,}
\DoxyCodeLine{01625\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ inputCount,\ inputZ.arrayZ,}
\DoxyCodeLine{01626\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookupCount,\ lookupRecord.arrayZ,}
\DoxyCodeLine{01627\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classvalue}{value}},\ lookup\_context);}
\DoxyCodeLine{01628\ \ \ \}}
\DoxyCodeLine{01629\ }
\DoxyCodeLine{01630\ \ \ \textcolor{keywordtype}{void}\ closure\_lookups\ (\mbox{\hyperlink{struct_o_t_1_1hb__closure__lookups__context__t}{hb\_closure\_lookups\_context\_t}}\ *c,}
\DoxyCodeLine{01631\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_context_closure_lookup_context}{ContextClosureLookupContext}}\ \&lookup\_context)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01632\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01633\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (c-\/>lookup\_limit\_exceeded\ ()))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01634\ \ \ \ \ \textcolor{keywordflow}{if}\ (!intersects\ (c-\/>glyphs,\ lookup\_context))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01635\ }
\DoxyCodeLine{01636\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_unsized_array_of}{UnsizedArrayOf<LookupRecord>}}\ \&lookupRecord\ =\ StructAfter<UnsizedArrayOf<LookupRecord>>}
\DoxyCodeLine{01637\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (inputZ.as\_array\ (inputCount\ ?\ inputCount\ -\/\ 1\ :\ 0));}
\DoxyCodeLine{01638\ \ \ \ \ recurse\_lookups\ (c,\ lookupCount,\ lookupRecord.arrayZ);}
\DoxyCodeLine{01639\ \ \ \}}
\DoxyCodeLine{01640\ }
\DoxyCodeLine{01641\ \ \ \textcolor{keywordtype}{void}\ collect\_glyphs\ (\mbox{\hyperlink{struct_o_t_1_1hb__collect__glyphs__context__t}{hb\_collect\_glyphs\_context\_t}}\ *c,}
\DoxyCodeLine{01642\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_context_collect_glyphs_lookup_context}{ContextCollectGlyphsLookupContext}}\ \&lookup\_context)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01643\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01644\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_unsized_array_of}{UnsizedArrayOf<LookupRecord>}}\ \&lookupRecord\ =\ StructAfter<UnsizedArrayOf<LookupRecord>>}
\DoxyCodeLine{01645\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (inputZ.as\_array\ (inputCount\ ?\ inputCount\ -\/\ 1\ :\ 0));}
\DoxyCodeLine{01646\ \ \ \ \ context\_collect\_glyphs\_lookup\ (c,}
\DoxyCodeLine{01647\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ inputCount,\ inputZ.arrayZ,}
\DoxyCodeLine{01648\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookupCount,\ lookupRecord.arrayZ,}
\DoxyCodeLine{01649\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_context);}
\DoxyCodeLine{01650\ \ \ \}}
\DoxyCodeLine{01651\ }
\DoxyCodeLine{01652\ \ \ \textcolor{keywordtype}{bool}\ would\_apply\ (\mbox{\hyperlink{struct_o_t_1_1hb__would__apply__context__t}{hb\_would\_apply\_context\_t}}\ *c,}
\DoxyCodeLine{01653\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_context_apply_lookup_context}{ContextApplyLookupContext}}\ \&lookup\_context)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01654\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01655\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_unsized_array_of}{UnsizedArrayOf<LookupRecord>}}\ \&lookupRecord\ =\ StructAfter<UnsizedArrayOf<LookupRecord>>}
\DoxyCodeLine{01656\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (inputZ.as\_array\ (inputCount\ ?\ inputCount\ -\/\ 1\ :\ 0));}
\DoxyCodeLine{01657\ \ \ \ \ \textcolor{keywordflow}{return}\ context\_would\_apply\_lookup\ (c,}
\DoxyCodeLine{01658\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ inputCount,\ inputZ.arrayZ,}
\DoxyCodeLine{01659\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookupCount,\ lookupRecord.arrayZ,}
\DoxyCodeLine{01660\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_context);}
\DoxyCodeLine{01661\ \ \ \}}
\DoxyCodeLine{01662\ }
\DoxyCodeLine{01663\ \ \ \textcolor{keywordtype}{bool}\ apply\ (\mbox{\hyperlink{struct_o_t_1_1hb__ot__apply__context__t}{hb\_ot\_apply\_context\_t}}\ *c,}
\DoxyCodeLine{01664\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_context_apply_lookup_context}{ContextApplyLookupContext}}\ \&lookup\_context)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01665\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01666\ \ \ \ \ TRACE\_APPLY\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01667\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_unsized_array_of}{UnsizedArrayOf<LookupRecord>}}\ \&lookupRecord\ =\ StructAfter<UnsizedArrayOf<LookupRecord>>}
\DoxyCodeLine{01668\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (inputZ.as\_array\ (inputCount\ ?\ inputCount\ -\/\ 1\ :\ 0));}
\DoxyCodeLine{01669\ \ \ \ \ return\_trace\ (context\_apply\_lookup\ (c,\ inputCount,\ inputZ.arrayZ,\ lookupCount,\ lookupRecord.arrayZ,\ lookup\_context));}
\DoxyCodeLine{01670\ \ \ \}}
\DoxyCodeLine{01671\ }
\DoxyCodeLine{01672\ \ \ \textcolor{keywordtype}{bool}\ serialize\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{01673\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *input\_mapping,\ \textcolor{comment}{/*\ old-\/>new\ glyphid\ or\ class\ mapping\ */}}
\DoxyCodeLine{01674\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *lookup\_map)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01675\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01676\ \ \ \ \ TRACE\_SERIALIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01677\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>start\_embed\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01678\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>extend\_min\ (out)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01679\ }
\DoxyCodeLine{01680\ \ \ \ \ out-\/>inputCount\ =\ inputCount;}
\DoxyCodeLine{01681\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__array__t}{hb\_array\_t<const\ HBUINT16>}}\ \mbox{\hyperlink{structinput}{input}}\ =\ inputZ.as\_array\ (inputCount\ -\/\ 1);}
\DoxyCodeLine{01682\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ org\ :\ \mbox{\hyperlink{structinput}{input}})}
\DoxyCodeLine{01683\ \ \ \ \ \{}
\DoxyCodeLine{01684\ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ d;}
\DoxyCodeLine{01685\ \ \ \ \ \ \ d\ =\ input\_mapping-\/>get\ (org);}
\DoxyCodeLine{01686\ \ \ \ \ \ \ c-\/>copy\ (d);}
\DoxyCodeLine{01687\ \ \ \ \ \}}
\DoxyCodeLine{01688\ }
\DoxyCodeLine{01689\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_unsized_array_of}{UnsizedArrayOf<LookupRecord>}}\ \&lookupRecord\ =\ StructAfter<UnsizedArrayOf<LookupRecord>>}
\DoxyCodeLine{01690\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (inputZ.as\_array\ ((inputCount\ ?\ inputCount\ -\/\ 1\ :\ 0)));}
\DoxyCodeLine{01691\ }
\DoxyCodeLine{01692\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ count\ =\ serialize\_lookuprecord\_array\ (c,\ lookupRecord.as\_array\ (lookupCount),\ lookup\_map);}
\DoxyCodeLine{01693\ \ \ \ \ return\_trace\ (c-\/>check\_assign\ (out-\/>lookupCount,\ count,\ HB\_SERIALIZE\_ERROR\_INT\_OVERFLOW));}
\DoxyCodeLine{01694\ \ \ \}}
\DoxyCodeLine{01695\ }
\DoxyCodeLine{01696\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c,}
\DoxyCodeLine{01697\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *lookup\_map,}
\DoxyCodeLine{01698\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *klass\_map\ =\ \textcolor{keyword}{nullptr})\textcolor{keyword}{\ const}}
\DoxyCodeLine{01699\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01700\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01701\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!inputCount))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01702\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__array__t}{hb\_array\_t<const\ HBUINT16>}}\ \mbox{\hyperlink{structinput}{input}}\ =\ inputZ.as\_array\ (inputCount\ -\/\ 1);}
\DoxyCodeLine{01703\ }
\DoxyCodeLine{01704\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *mapping\ =\ klass\_map\ ==\ \textcolor{keyword}{nullptr}\ ?\ c-\/>plan-\/>glyph\_map\ :\ klass\_map;}
\DoxyCodeLine{01705\ \ \ \ \ \textcolor{keywordflow}{if}\ (!hb\_all\ (\mbox{\hyperlink{structinput}{input}},\ mapping))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01706\ \ \ \ \ return\_trace\ (serialize\ (c-\/>serializer,\ mapping,\ lookup\_map));}
\DoxyCodeLine{01707\ \ \ \}}
\DoxyCodeLine{01708\ }
\DoxyCodeLine{01709\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01710\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01711\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01712\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01713\ \ \ \ \ return\_trace\ (inputCount.sanitize\ (c)\ \&\&}
\DoxyCodeLine{01714\ \ \ \ \ \ \ \ \ \ \ lookupCount.sanitize\ (c)\ \&\&}
\DoxyCodeLine{01715\ \ \ \ \ \ \ \ \ \ \ c-\/>check\_range\ (inputZ.arrayZ,}
\DoxyCodeLine{01716\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ inputZ.item\_size\ *\ (inputCount\ ?\ inputCount\ -\/\ 1\ :\ 0)\ +}
\DoxyCodeLine{01717\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ LookupRecord::static\_size\ *\ lookupCount));}
\DoxyCodeLine{01718\ \ \ \}}
\DoxyCodeLine{01719\ }
\DoxyCodeLine{01720\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{01721\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ inputCount;\ \ \ \ \ \textcolor{comment}{/*\ Total\ number\ of\ glyphs\ in\ input}}
\DoxyCodeLine{01722\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ glyph\ sequence-\/-\/includes\ the\ first}}
\DoxyCodeLine{01723\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ glyph\ */}}
\DoxyCodeLine{01724\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ lookupCount;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Number\ of\ LookupRecords\ */}}
\DoxyCodeLine{01725\ \ \ \mbox{\hyperlink{struct_o_t_1_1_unsized_array_of}{UnsizedArrayOf<HBUINT16>}}}
\DoxyCodeLine{01726\ \ \ \ \ \ \ \ \ inputZ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Array\ of\ match\ inputs-\/-\/start\ with}}
\DoxyCodeLine{01727\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ second\ glyph\ */}}
\DoxyCodeLine{01728\ \textcolor{comment}{/*UnsizedArrayOf<LookupRecord>}}
\DoxyCodeLine{01729\ \textcolor{comment}{\ \ \ \ \ \ \ \ lookupRecordX;*/}\ \ \ \ \textcolor{comment}{/*\ Array\ of\ LookupRecords-\/-\/in}}
\DoxyCodeLine{01730\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ design\ order\ */}}
\DoxyCodeLine{01731\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01732\ \ \ DEFINE\_SIZE\_ARRAY\ (4,\ inputZ);}
\DoxyCodeLine{01733\ \};}
\DoxyCodeLine{01734\ }
\DoxyCodeLine{01735\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_rule_set}{RuleSet}}}
\DoxyCodeLine{01736\ \{}
\DoxyCodeLine{01737\ \ \ \textcolor{keywordtype}{bool}\ intersects\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,}
\DoxyCodeLine{01738\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_context_closure_lookup_context}{ContextClosureLookupContext}}\ \&lookup\_context)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01739\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01740\ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{01741\ \ \ \ \ +\ hb\_iter\ (rule)}
\DoxyCodeLine{01742\ \ \ \ \ |\ hb\_map\ (hb\_add\ (\textcolor{keyword}{this}))}
\DoxyCodeLine{01743\ \ \ \ \ |\ hb\_map\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_rule}{Rule}}\ \&\_)\ \{\ \textcolor{keywordflow}{return}\ \_.intersects\ (glyphs,\ lookup\_context);\ \})}
\DoxyCodeLine{01744\ \ \ \ \ |\ hb\_any}
\DoxyCodeLine{01745\ \ \ \ \ ;}
\DoxyCodeLine{01746\ \ \ \}}
\DoxyCodeLine{01747\ }
\DoxyCodeLine{01748\ \ \ \textcolor{keywordtype}{void}\ closure\ (\mbox{\hyperlink{struct_o_t_1_1hb__closure__context__t}{hb\_closure\_context\_t}}\ *c,\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classvalue}{value}},}
\DoxyCodeLine{01749\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_context_closure_lookup_context}{ContextClosureLookupContext}}\ \&lookup\_context)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01750\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01751\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (c-\/>lookup\_limit\_exceeded\ ()))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01752\ }
\DoxyCodeLine{01753\ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{01754\ \ \ \ \ +\ hb\_iter\ (rule)}
\DoxyCodeLine{01755\ \ \ \ \ |\ hb\_map\ (hb\_add\ (\textcolor{keyword}{this}))}
\DoxyCodeLine{01756\ \ \ \ \ |\ hb\_apply\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_rule}{Rule}}\ \&\_)\ \{\ \_.closure\ (c,\ \mbox{\hyperlink{classvalue}{value}},\ lookup\_context);\ \})}
\DoxyCodeLine{01757\ \ \ \ \ ;}
\DoxyCodeLine{01758\ \ \ \}}
\DoxyCodeLine{01759\ }
\DoxyCodeLine{01760\ \ \ \textcolor{keywordtype}{void}\ closure\_lookups\ (\mbox{\hyperlink{struct_o_t_1_1hb__closure__lookups__context__t}{hb\_closure\_lookups\_context\_t}}\ *c,}
\DoxyCodeLine{01761\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_context_closure_lookup_context}{ContextClosureLookupContext}}\ \&lookup\_context)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01762\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01763\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (c-\/>lookup\_limit\_exceeded\ ()))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01764\ \ \ \ \ +\ hb\_iter\ (rule)}
\DoxyCodeLine{01765\ \ \ \ \ |\ hb\_map\ (hb\_add\ (\textcolor{keyword}{this}))}
\DoxyCodeLine{01766\ \ \ \ \ |\ hb\_apply\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_rule}{Rule}}\ \&\_)\ \{\ \_.closure\_lookups\ (c,\ lookup\_context);\ \})}
\DoxyCodeLine{01767\ \ \ \ \ ;}
\DoxyCodeLine{01768\ \ \ \}}
\DoxyCodeLine{01769\ }
\DoxyCodeLine{01770\ \ \ \textcolor{keywordtype}{void}\ collect\_glyphs\ (\mbox{\hyperlink{struct_o_t_1_1hb__collect__glyphs__context__t}{hb\_collect\_glyphs\_context\_t}}\ *c,}
\DoxyCodeLine{01771\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_context_collect_glyphs_lookup_context}{ContextCollectGlyphsLookupContext}}\ \&lookup\_context)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01772\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01773\ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{01774\ \ \ \ \ +\ hb\_iter\ (rule)}
\DoxyCodeLine{01775\ \ \ \ \ |\ hb\_map\ (hb\_add\ (\textcolor{keyword}{this}))}
\DoxyCodeLine{01776\ \ \ \ \ |\ hb\_apply\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_rule}{Rule}}\ \&\_)\ \{\ \_.collect\_glyphs\ (c,\ lookup\_context);\ \})}
\DoxyCodeLine{01777\ \ \ \ \ ;}
\DoxyCodeLine{01778\ \ \ \}}
\DoxyCodeLine{01779\ }
\DoxyCodeLine{01780\ \ \ \textcolor{keywordtype}{bool}\ would\_apply\ (\mbox{\hyperlink{struct_o_t_1_1hb__would__apply__context__t}{hb\_would\_apply\_context\_t}}\ *c,}
\DoxyCodeLine{01781\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_context_apply_lookup_context}{ContextApplyLookupContext}}\ \&lookup\_context)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01782\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01783\ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{01784\ \ \ \ \ +\ hb\_iter\ (rule)}
\DoxyCodeLine{01785\ \ \ \ \ |\ hb\_map\ (hb\_add\ (\textcolor{keyword}{this}))}
\DoxyCodeLine{01786\ \ \ \ \ |\ hb\_map\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_rule}{Rule}}\ \&\_)\ \{\ \textcolor{keywordflow}{return}\ \_.would\_apply\ (c,\ lookup\_context);\ \})}
\DoxyCodeLine{01787\ \ \ \ \ |\ hb\_any}
\DoxyCodeLine{01788\ \ \ \ \ ;}
\DoxyCodeLine{01789\ \ \ \}}
\DoxyCodeLine{01790\ }
\DoxyCodeLine{01791\ \ \ \textcolor{keywordtype}{bool}\ apply\ (\mbox{\hyperlink{struct_o_t_1_1hb__ot__apply__context__t}{hb\_ot\_apply\_context\_t}}\ *c,}
\DoxyCodeLine{01792\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_context_apply_lookup_context}{ContextApplyLookupContext}}\ \&lookup\_context)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01793\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01794\ \ \ \ \ TRACE\_APPLY\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01795\ \ \ \ \ return\_trace\ (}
\DoxyCodeLine{01796\ \ \ \ \ +\ hb\_iter\ (rule)}
\DoxyCodeLine{01797\ \ \ \ \ |\ hb\_map\ (hb\_add\ (\textcolor{keyword}{this}))}
\DoxyCodeLine{01798\ \ \ \ \ |\ hb\_map\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_rule}{Rule}}\ \&\_)\ \{\ \textcolor{keywordflow}{return}\ \_.apply\ (c,\ lookup\_context);\ \})}
\DoxyCodeLine{01799\ \ \ \ \ |\ hb\_any}
\DoxyCodeLine{01800\ \ \ \ \ )}
\DoxyCodeLine{01801\ \ \ \ \ ;}
\DoxyCodeLine{01802\ \ \ \}}
\DoxyCodeLine{01803\ }
\DoxyCodeLine{01804\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c,}
\DoxyCodeLine{01805\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *lookup\_map,}
\DoxyCodeLine{01806\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *klass\_map\ =\ \textcolor{keyword}{nullptr})\textcolor{keyword}{\ const}}
\DoxyCodeLine{01807\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01808\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01809\ }
\DoxyCodeLine{01810\ \ \ \ \ \textcolor{keyword}{auto}\ snap\ =\ c-\/>serializer-\/>snapshot\ ();}
\DoxyCodeLine{01811\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>serializer-\/>start\_embed\ (*\textcolor{keyword}{this});}
\DoxyCodeLine{01812\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>serializer-\/>extend\_min\ (out)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01813\ }
\DoxyCodeLine{01814\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<Rule>}}\&\ \_\ :\ rule)}
\DoxyCodeLine{01815\ \ \ \ \ \{}
\DoxyCodeLine{01816\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01817\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ o\_snap\ =\ c-\/>serializer-\/>snapshot\ ();}
\DoxyCodeLine{01818\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ *o\ =\ out-\/>rule.serialize\_append\ (c-\/>serializer);}
\DoxyCodeLine{01819\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!o))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01820\ }
\DoxyCodeLine{01821\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!o-\/>serialize\_subset\ (c,\ \_,\ \textcolor{keyword}{this},\ lookup\_map,\ klass\_map))}
\DoxyCodeLine{01822\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01823\ \ \ \ \ out-\/>rule.pop\ ();}
\DoxyCodeLine{01824\ \ \ \ \ c-\/>serializer-\/>revert\ (o\_snap);}
\DoxyCodeLine{01825\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01826\ \ \ \ \ \}}
\DoxyCodeLine{01827\ }
\DoxyCodeLine{01828\ \ \ \ \ \textcolor{keywordtype}{bool}\ ret\ =\ bool\ (out-\/>rule);}
\DoxyCodeLine{01829\ \ \ \ \ \textcolor{keywordflow}{if}\ (!ret)\ c-\/>serializer-\/>revert\ (snap);}
\DoxyCodeLine{01830\ }
\DoxyCodeLine{01831\ \ \ \ \ return\_trace\ (ret);}
\DoxyCodeLine{01832\ \ \ \}}
\DoxyCodeLine{01833\ }
\DoxyCodeLine{01834\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01835\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01836\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01837\ \ \ \ \ return\_trace\ (rule.sanitize\ (c,\ \textcolor{keyword}{this}));}
\DoxyCodeLine{01838\ \ \ \}}
\DoxyCodeLine{01839\ }
\DoxyCodeLine{01840\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{01841\ \ \ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<Rule>}}}
\DoxyCodeLine{01842\ \ \ \ \ \ \ \ \ rule;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Array\ of\ Rule\ tables}}
\DoxyCodeLine{01843\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ ordered\ by\ preference\ */}}
\DoxyCodeLine{01844\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01845\ \ \ DEFINE\_SIZE\_ARRAY\ (2,\ rule);}
\DoxyCodeLine{01846\ \};}
\DoxyCodeLine{01847\ }
\DoxyCodeLine{01848\ }
\DoxyCodeLine{01849\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_context_format1}{ContextFormat1}}}
\DoxyCodeLine{01850\ \{}
\DoxyCodeLine{01851\ \ \ \textcolor{keywordtype}{bool}\ intersects\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01852\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01853\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_context_closure_lookup_context}{ContextClosureLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{01854\ \ \ \ \ \ \ \{intersects\_glyph,\ intersected\_glyph\},}
\DoxyCodeLine{01855\ \ \ \ \ \ \ ContextFormat::SimpleContext,}
\DoxyCodeLine{01856\ \ \ \ \ \ \ \textcolor{keyword}{nullptr}}
\DoxyCodeLine{01857\ \ \ \ \ \};}
\DoxyCodeLine{01858\ }
\DoxyCodeLine{01859\ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{01860\ \ \ \ \ +\ hb\_zip\ (\textcolor{keyword}{this}+coverage,\ ruleSet)}
\DoxyCodeLine{01861\ \ \ \ \ |\ hb\_filter\ (*glyphs,\ hb\_first)}
\DoxyCodeLine{01862\ \ \ \ \ |\ hb\_map\ (hb\_second)}
\DoxyCodeLine{01863\ \ \ \ \ |\ hb\_map\ (hb\_add\ (\textcolor{keyword}{this}))}
\DoxyCodeLine{01864\ \ \ \ \ |\ hb\_map\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_rule_set}{RuleSet}}\ \&\_)\ \{\ \textcolor{keywordflow}{return}\ \_.intersects\ (glyphs,\ lookup\_context);\ \})}
\DoxyCodeLine{01865\ \ \ \ \ |\ hb\_any}
\DoxyCodeLine{01866\ \ \ \ \ ;}
\DoxyCodeLine{01867\ \ \ \}}
\DoxyCodeLine{01868\ }
\DoxyCodeLine{01869\ \ \ \textcolor{keywordtype}{bool}\ may\_have\_non\_1to1\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{01870\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};\ \}}
\DoxyCodeLine{01871\ }
\DoxyCodeLine{01872\ \ \ \textcolor{keywordtype}{void}\ closure\ (\mbox{\hyperlink{struct_o_t_1_1hb__closure__context__t}{hb\_closure\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01873\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01874\ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}*\ cur\_active\_glyphs\ =\ \&c-\/>push\_cur\_active\_glyphs\ ();}
\DoxyCodeLine{01875\ \ \ \ \ get\_coverage\ ().intersected\_coverage\_glyphs\ (\&c-\/>previous\_parent\_active\_glyphs\ (),}
\DoxyCodeLine{01876\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cur\_active\_glyphs);}
\DoxyCodeLine{01877\ }
\DoxyCodeLine{01878\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_context_closure_lookup_context}{ContextClosureLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{01879\ \ \ \ \ \ \ \{intersects\_glyph,\ intersected\_glyph\},}
\DoxyCodeLine{01880\ \ \ \ \ \ \ ContextFormat::SimpleContext,}
\DoxyCodeLine{01881\ \ \ \ \ \ \ \textcolor{keyword}{nullptr}}
\DoxyCodeLine{01882\ \ \ \ \ \};}
\DoxyCodeLine{01883\ }
\DoxyCodeLine{01884\ \ \ \ \ +\ hb\_zip\ (\textcolor{keyword}{this}+coverage,\ hb\_range\ ((\textcolor{keywordtype}{unsigned})\ ruleSet.len))}
\DoxyCodeLine{01885\ \ \ \ \ |\ hb\_filter\ ([\&]\ (hb\_codepoint\_t\ \_)\ \{}
\DoxyCodeLine{01886\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ c-\/>previous\_parent\_active\_glyphs\ ().has\ (\_);}
\DoxyCodeLine{01887\ \ \ \ \ \},\ hb\_first)}
\DoxyCodeLine{01888\ \ \ \ \ |\ hb\_map\ ([\&](\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__pair__t}{hb\_pair\_t<hb\_codepoint\_t,\ unsigned>}}\ \_)\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structhb__pair__t}{hb\_pair\_t<unsigned,\ const\ RuleSet\&>}}\ (\_.first,\ \textcolor{keyword}{this}+ruleSet[\_.second]);\ \})}
\DoxyCodeLine{01889\ \ \ \ \ |\ hb\_apply\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__pair__t}{hb\_pair\_t<unsigned,\ const\ RuleSet\&>}}\&\ \_)\ \{\ \_.second.closure\ (c,\ \_.first,\ lookup\_context);\ \})}
\DoxyCodeLine{01890\ \ \ \ \ ;}
\DoxyCodeLine{01891\ }
\DoxyCodeLine{01892\ \ \ \ \ c-\/>pop\_cur\_done\_glyphs\ ();}
\DoxyCodeLine{01893\ \ \ \}}
\DoxyCodeLine{01894\ }
\DoxyCodeLine{01895\ \ \ \textcolor{keywordtype}{void}\ closure\_lookups\ (\mbox{\hyperlink{struct_o_t_1_1hb__closure__lookups__context__t}{hb\_closure\_lookups\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01896\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01897\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_context_closure_lookup_context}{ContextClosureLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{01898\ \ \ \ \ \ \ \{intersects\_glyph,\ intersected\_glyph\},}
\DoxyCodeLine{01899\ \ \ \ \ \ \ ContextFormat::SimpleContext,}
\DoxyCodeLine{01900\ \ \ \ \ \ \ \textcolor{keyword}{nullptr}}
\DoxyCodeLine{01901\ \ \ \ \ \};}
\DoxyCodeLine{01902\ }
\DoxyCodeLine{01903\ \ \ \ \ +\ hb\_zip\ (\textcolor{keyword}{this}+coverage,\ ruleSet)}
\DoxyCodeLine{01904\ \ \ \ \ |\ hb\_filter\ (*c-\/>glyphs,\ hb\_first)}
\DoxyCodeLine{01905\ \ \ \ \ |\ hb\_map\ (hb\_second)}
\DoxyCodeLine{01906\ \ \ \ \ |\ hb\_map\ (hb\_add\ (\textcolor{keyword}{this}))}
\DoxyCodeLine{01907\ \ \ \ \ |\ hb\_apply\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_rule_set}{RuleSet}}\ \&\_)\ \{\ \_.closure\_lookups\ (c,\ lookup\_context);\ \})}
\DoxyCodeLine{01908\ \ \ \ \ ;}
\DoxyCodeLine{01909\ \ \ \}}
\DoxyCodeLine{01910\ }
\DoxyCodeLine{01911\ \ \ \textcolor{keywordtype}{void}\ collect\_variation\_indices\ (\mbox{\hyperlink{struct_o_t_1_1hb__collect__variation__indices__context__t}{hb\_collect\_variation\_indices\_context\_t}}\ *c)\textcolor{keyword}{\ const\ }\{\}}
\DoxyCodeLine{01912\ }
\DoxyCodeLine{01913\ \ \ \textcolor{keywordtype}{void}\ collect\_glyphs\ (\mbox{\hyperlink{struct_o_t_1_1hb__collect__glyphs__context__t}{hb\_collect\_glyphs\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01914\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01915\ \ \ \ \ (\textcolor{keyword}{this}+coverage).collect\_coverage\ (c-\/>input);}
\DoxyCodeLine{01916\ }
\DoxyCodeLine{01917\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_context_collect_glyphs_lookup_context}{ContextCollectGlyphsLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{01918\ \ \ \ \ \ \ \{collect\_glyph\},}
\DoxyCodeLine{01919\ \ \ \ \ \ \ \textcolor{keyword}{nullptr}}
\DoxyCodeLine{01920\ \ \ \ \ \};}
\DoxyCodeLine{01921\ }
\DoxyCodeLine{01922\ \ \ \ \ +\ hb\_iter\ (ruleSet)}
\DoxyCodeLine{01923\ \ \ \ \ |\ hb\_map\ (hb\_add\ (\textcolor{keyword}{this}))}
\DoxyCodeLine{01924\ \ \ \ \ |\ hb\_apply\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_rule_set}{RuleSet}}\ \&\_)\ \{\ \_.collect\_glyphs\ (c,\ lookup\_context);\ \})}
\DoxyCodeLine{01925\ \ \ \ \ ;}
\DoxyCodeLine{01926\ \ \ \}}
\DoxyCodeLine{01927\ }
\DoxyCodeLine{01928\ \ \ \textcolor{keywordtype}{bool}\ would\_apply\ (\mbox{\hyperlink{struct_o_t_1_1hb__would__apply__context__t}{hb\_would\_apply\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01929\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01930\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_rule_set}{RuleSet}}\ \&rule\_set\ =\ \textcolor{keyword}{this}+ruleSet[(\textcolor{keyword}{this}+coverage).get\_coverage\ (c-\/>glyphs[0])];}
\DoxyCodeLine{01931\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_context_apply_lookup_context}{ContextApplyLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{01932\ \ \ \ \ \ \ \{match\_glyph\},}
\DoxyCodeLine{01933\ \ \ \ \ \ \ \textcolor{keyword}{nullptr}}
\DoxyCodeLine{01934\ \ \ \ \ \};}
\DoxyCodeLine{01935\ \ \ \ \ \textcolor{keywordflow}{return}\ rule\_set.would\_apply\ (c,\ lookup\_context);}
\DoxyCodeLine{01936\ \ \ \}}
\DoxyCodeLine{01937\ }
\DoxyCodeLine{01938\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_coverage}{Coverage}}\ \&get\_coverage\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{this}+coverage;\ \}}
\DoxyCodeLine{01939\ }
\DoxyCodeLine{01940\ \ \ \textcolor{keywordtype}{bool}\ apply\ (\mbox{\hyperlink{struct_o_t_1_1hb__ot__apply__context__t}{hb\_ot\_apply\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01941\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01942\ \ \ \ \ TRACE\_APPLY\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01943\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ index\ =\ (\textcolor{keyword}{this}+coverage).get\_coverage\ (c-\/>buffer-\/>cur().codepoint);}
\DoxyCodeLine{01944\ \ \ \ \ \textcolor{keywordflow}{if}\ (likely\ (index\ ==\ NOT\_COVERED))}
\DoxyCodeLine{01945\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01946\ }
\DoxyCodeLine{01947\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_rule_set}{RuleSet}}\ \&rule\_set\ =\ \textcolor{keyword}{this}+ruleSet[index];}
\DoxyCodeLine{01948\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_context_apply_lookup_context}{ContextApplyLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{01949\ \ \ \ \ \ \ \{match\_glyph\},}
\DoxyCodeLine{01950\ \ \ \ \ \ \ \textcolor{keyword}{nullptr}}
\DoxyCodeLine{01951\ \ \ \ \ \};}
\DoxyCodeLine{01952\ \ \ \ \ return\_trace\ (rule\_set.apply\ (c,\ lookup\_context));}
\DoxyCodeLine{01953\ \ \ \}}
\DoxyCodeLine{01954\ }
\DoxyCodeLine{01955\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01956\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01957\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01958\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \&glyphset\ =\ *c-\/>plan-\/>glyphset\_gsub\ ();}
\DoxyCodeLine{01959\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ \&glyph\_map\ =\ *c-\/>plan-\/>glyph\_map;}
\DoxyCodeLine{01960\ }
\DoxyCodeLine{01961\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>serializer-\/>start\_embed\ (*\textcolor{keyword}{this});}
\DoxyCodeLine{01962\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>serializer-\/>extend\_min\ (out)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{01963\ \ \ \ \ out-\/>format\ =\ format;}
\DoxyCodeLine{01964\ }
\DoxyCodeLine{01965\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *lookup\_map\ =\ c-\/>table\_tag\ ==\ HB\_OT\_TAG\_GSUB\ ?\ c-\/>plan-\/>gsub\_lookups\ :\ c-\/>plan-\/>gpos\_lookups;}
\DoxyCodeLine{01966\ \ \ \ \ \mbox{\hyperlink{structhb__vector__t}{hb\_sorted\_vector\_t<hb\_codepoint\_t>}}\ new\_coverage;}
\DoxyCodeLine{01967\ \ \ \ \ +\ hb\_zip\ (\textcolor{keyword}{this}+coverage,\ ruleSet)}
\DoxyCodeLine{01968\ \ \ \ \ |\ hb\_filter\ (glyphset,\ hb\_first)}
\DoxyCodeLine{01969\ \ \ \ \ |\ hb\_filter\ (subset\_offset\_array\ (c,\ out-\/>ruleSet,\ \textcolor{keyword}{this},\ lookup\_map),\ hb\_second)}
\DoxyCodeLine{01970\ \ \ \ \ |\ hb\_map\ (hb\_first)}
\DoxyCodeLine{01971\ \ \ \ \ |\ hb\_map\ (glyph\_map)}
\DoxyCodeLine{01972\ \ \ \ \ |\ hb\_sink\ (new\_coverage)}
\DoxyCodeLine{01973\ \ \ \ \ ;}
\DoxyCodeLine{01974\ }
\DoxyCodeLine{01975\ \ \ \ \ out-\/>coverage.serialize\_serialize\ (c-\/>serializer,\ new\_coverage.iter\ ());}
\DoxyCodeLine{01976\ \ \ \ \ return\_trace\ (\textcolor{keywordtype}{bool}\ (new\_coverage));}
\DoxyCodeLine{01977\ \ \ \}}
\DoxyCodeLine{01978\ }
\DoxyCodeLine{01979\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{01980\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{01981\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{01982\ \ \ \ \ return\_trace\ (coverage.sanitize\ (c,\ \textcolor{keyword}{this})\ \&\&\ ruleSet.sanitize\ (c,\ \textcolor{keyword}{this}));}
\DoxyCodeLine{01983\ \ \ \}}
\DoxyCodeLine{01984\ }
\DoxyCodeLine{01985\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{01986\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ format;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Format\ identifier-\/-\/format\ =\ 1\ */}}
\DoxyCodeLine{01987\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<Coverage>}}}
\DoxyCodeLine{01988\ \ \ \ \ \ \ \ \ coverage;\ \ \ \ \ \ \ \textcolor{comment}{/*\ Offset\ to\ Coverage\ table-\/-\/from}}
\DoxyCodeLine{01989\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ beginning\ of\ table\ */}}
\DoxyCodeLine{01990\ \ \ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<RuleSet>}}}
\DoxyCodeLine{01991\ \ \ \ \ \ \ \ \ ruleSet;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Array\ of\ RuleSet\ tables}}
\DoxyCodeLine{01992\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ ordered\ by\ Coverage\ Index\ */}}
\DoxyCodeLine{01993\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01994\ \ \ DEFINE\_SIZE\_ARRAY\ (6,\ ruleSet);}
\DoxyCodeLine{01995\ \};}
\DoxyCodeLine{01996\ }
\DoxyCodeLine{01997\ }
\DoxyCodeLine{01998\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_context_format2}{ContextFormat2}}}
\DoxyCodeLine{01999\ \{}
\DoxyCodeLine{02000\ \ \ \textcolor{keywordtype}{bool}\ intersects\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02001\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02002\ \ \ \ \ \textcolor{keywordflow}{if}\ (!(\textcolor{keyword}{this}+coverage).intersects\ (glyphs))}
\DoxyCodeLine{02003\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02004\ }
\DoxyCodeLine{02005\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_class_def}{ClassDef}}\ \&class\_def\ =\ \textcolor{keyword}{this}+classDef;}
\DoxyCodeLine{02006\ }
\DoxyCodeLine{02007\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_context_closure_lookup_context}{ContextClosureLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{02008\ \ \ \ \ \ \ \{intersects\_class,\ intersected\_class\_glyphs\},}
\DoxyCodeLine{02009\ \ \ \ \ \ \ ContextFormat::ClassBasedContext,}
\DoxyCodeLine{02010\ \ \ \ \ \ \ \&class\_def}
\DoxyCodeLine{02011\ \ \ \ \ \};}
\DoxyCodeLine{02012\ }
\DoxyCodeLine{02013\ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ retained\_coverage\_glyphs;}
\DoxyCodeLine{02014\ \ \ \ \ (\textcolor{keyword}{this}+coverage).intersected\_coverage\_glyphs\ (glyphs,\ \&retained\_coverage\_glyphs);}
\DoxyCodeLine{02015\ }
\DoxyCodeLine{02016\ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ coverage\_glyph\_classes;}
\DoxyCodeLine{02017\ \ \ \ \ class\_def.intersected\_classes\ (\&retained\_coverage\_glyphs,\ \&coverage\_glyph\_classes);}
\DoxyCodeLine{02018\ }
\DoxyCodeLine{02019\ }
\DoxyCodeLine{02020\ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{02021\ \ \ \ \ +\ hb\_iter\ (ruleSet)}
\DoxyCodeLine{02022\ \ \ \ \ |\ hb\_map\ (hb\_add\ (\textcolor{keyword}{this}))}
\DoxyCodeLine{02023\ \ \ \ \ |\ hb\_enumerate}
\DoxyCodeLine{02024\ \ \ \ \ |\ hb\_map\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__pair__t}{hb\_pair\_t<unsigned,\ const\ RuleSet\ \&>}}\ p)}
\DoxyCodeLine{02025\ \ \ \ \ \ \ \ \ \ \ \{\ \textcolor{keywordflow}{return}\ class\_def.intersects\_class\ (glyphs,\ p.first)\ \&\&}
\DoxyCodeLine{02026\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coverage\_glyph\_classes.has\ (p.first)\ \&\&}
\DoxyCodeLine{02027\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p.second.intersects\ (glyphs,\ lookup\_context);\ \})}
\DoxyCodeLine{02028\ \ \ \ \ |\ hb\_any}
\DoxyCodeLine{02029\ \ \ \ \ ;}
\DoxyCodeLine{02030\ \ \ \}}
\DoxyCodeLine{02031\ }
\DoxyCodeLine{02032\ \ \ \textcolor{keywordtype}{bool}\ may\_have\_non\_1to1\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{02033\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};\ \}}
\DoxyCodeLine{02034\ }
\DoxyCodeLine{02035\ \ \ \textcolor{keywordtype}{void}\ closure\ (\mbox{\hyperlink{struct_o_t_1_1hb__closure__context__t}{hb\_closure\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02036\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02037\ \ \ \ \ \textcolor{keywordflow}{if}\ (!(\textcolor{keyword}{this}+coverage).intersects\ (c-\/>glyphs))}
\DoxyCodeLine{02038\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02039\ }
\DoxyCodeLine{02040\ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}*\ cur\_active\_glyphs\ =\ \&c-\/>push\_cur\_active\_glyphs\ ();}
\DoxyCodeLine{02041\ \ \ \ \ get\_coverage\ ().intersected\_coverage\_glyphs\ (\&c-\/>previous\_parent\_active\_glyphs\ (),}
\DoxyCodeLine{02042\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cur\_active\_glyphs);}
\DoxyCodeLine{02043\ }
\DoxyCodeLine{02044\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_class_def}{ClassDef}}\ \&class\_def\ =\ \textcolor{keyword}{this}+classDef;}
\DoxyCodeLine{02045\ }
\DoxyCodeLine{02046\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_context_closure_lookup_context}{ContextClosureLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{02047\ \ \ \ \ \ \ \{intersects\_class,\ intersected\_class\_glyphs\},}
\DoxyCodeLine{02048\ \ \ \ \ \ \ ContextFormat::ClassBasedContext,}
\DoxyCodeLine{02049\ \ \ \ \ \ \ \&class\_def}
\DoxyCodeLine{02050\ \ \ \ \ \};}
\DoxyCodeLine{02051\ }
\DoxyCodeLine{02052\ \ \ \ \ +\ hb\_enumerate\ (ruleSet)}
\DoxyCodeLine{02053\ \ \ \ \ |\ hb\_filter\ ([\&]\ (\textcolor{keywordtype}{unsigned}\ \_)}
\DoxyCodeLine{02054\ \ \ \ \ \{\ \textcolor{keywordflow}{return}\ class\_def.intersects\_class\ (\&c-\/>parent\_active\_glyphs\ (),\ \_);\ \},}
\DoxyCodeLine{02055\ \ \ \ \ \ \ \ \ \ hb\_first)}
\DoxyCodeLine{02056\ \ \ \ \ |\ hb\_apply\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__pair__t}{hb\_pair\_t}}<\textcolor{keywordtype}{unsigned},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<RuleSet>}}\&>\ \_)}
\DoxyCodeLine{02057\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_rule_set}{RuleSet}}\&\ rule\_set\ =\ \textcolor{keyword}{this}+\_.second;}
\DoxyCodeLine{02059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rule\_set.closure\ (c,\ \_.first,\ lookup\_context);}
\DoxyCodeLine{02060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \})}
\DoxyCodeLine{02061\ \ \ \ \ ;}
\DoxyCodeLine{02062\ }
\DoxyCodeLine{02063\ \ \ \ \ c-\/>pop\_cur\_done\_glyphs\ ();}
\DoxyCodeLine{02064\ \ \ \}}
\DoxyCodeLine{02065\ }
\DoxyCodeLine{02066\ \ \ \textcolor{keywordtype}{void}\ closure\_lookups\ (\mbox{\hyperlink{struct_o_t_1_1hb__closure__lookups__context__t}{hb\_closure\_lookups\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02067\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02068\ \ \ \ \ \textcolor{keywordflow}{if}\ (!(\textcolor{keyword}{this}+coverage).intersects\ (c-\/>glyphs))}
\DoxyCodeLine{02069\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02070\ }
\DoxyCodeLine{02071\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_class_def}{ClassDef}}\ \&class\_def\ =\ \textcolor{keyword}{this}+classDef;}
\DoxyCodeLine{02072\ }
\DoxyCodeLine{02073\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_context_closure_lookup_context}{ContextClosureLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{02074\ \ \ \ \ \ \ \{intersects\_class,\ intersected\_class\_glyphs\},}
\DoxyCodeLine{02075\ \ \ \ \ \ \ ContextFormat::ClassBasedContext,}
\DoxyCodeLine{02076\ \ \ \ \ \ \ \&class\_def}
\DoxyCodeLine{02077\ \ \ \ \ \};}
\DoxyCodeLine{02078\ }
\DoxyCodeLine{02079\ \ \ \ \ +\ hb\_iter\ (ruleSet)}
\DoxyCodeLine{02080\ \ \ \ \ |\ hb\_map\ (hb\_add\ (\textcolor{keyword}{this}))}
\DoxyCodeLine{02081\ \ \ \ \ |\ hb\_enumerate}
\DoxyCodeLine{02082\ \ \ \ \ |\ hb\_filter\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__pair__t}{hb\_pair\_t<unsigned,\ const\ RuleSet\ \&>}}\ p)}
\DoxyCodeLine{02083\ \ \ \ \ \{\ \textcolor{keywordflow}{return}\ class\_def.intersects\_class\ (c-\/>glyphs,\ p.first);\ \})}
\DoxyCodeLine{02084\ \ \ \ \ |\ hb\_map\ (hb\_second)}
\DoxyCodeLine{02085\ \ \ \ \ |\ hb\_apply\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_rule_set}{RuleSet}}\ \&\ \_)}
\DoxyCodeLine{02086\ \ \ \ \ \{\ \_.closure\_lookups\ (c,\ lookup\_context);\ \});}
\DoxyCodeLine{02087\ \ \ \}}
\DoxyCodeLine{02088\ }
\DoxyCodeLine{02089\ \ \ \textcolor{keywordtype}{void}\ collect\_variation\_indices\ (\mbox{\hyperlink{struct_o_t_1_1hb__collect__variation__indices__context__t}{hb\_collect\_variation\_indices\_context\_t}}\ *c)\textcolor{keyword}{\ const\ }\{\}}
\DoxyCodeLine{02090\ }
\DoxyCodeLine{02091\ \ \ \textcolor{keywordtype}{void}\ collect\_glyphs\ (\mbox{\hyperlink{struct_o_t_1_1hb__collect__glyphs__context__t}{hb\_collect\_glyphs\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02092\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02093\ \ \ \ \ (\textcolor{keyword}{this}+coverage).collect\_coverage\ (c-\/>input);}
\DoxyCodeLine{02094\ }
\DoxyCodeLine{02095\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_class_def}{ClassDef}}\ \&class\_def\ =\ \textcolor{keyword}{this}+classDef;}
\DoxyCodeLine{02096\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_context_collect_glyphs_lookup_context}{ContextCollectGlyphsLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{02097\ \ \ \ \ \ \ \{collect\_class\},}
\DoxyCodeLine{02098\ \ \ \ \ \ \ \&class\_def}
\DoxyCodeLine{02099\ \ \ \ \ \};}
\DoxyCodeLine{02100\ }
\DoxyCodeLine{02101\ \ \ \ \ +\ hb\_iter\ (ruleSet)}
\DoxyCodeLine{02102\ \ \ \ \ |\ hb\_map\ (hb\_add\ (\textcolor{keyword}{this}))}
\DoxyCodeLine{02103\ \ \ \ \ |\ hb\_apply\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_rule_set}{RuleSet}}\ \&\_)\ \{\ \_.collect\_glyphs\ (c,\ lookup\_context);\ \})}
\DoxyCodeLine{02104\ \ \ \ \ ;}
\DoxyCodeLine{02105\ \ \ \}}
\DoxyCodeLine{02106\ }
\DoxyCodeLine{02107\ \ \ \textcolor{keywordtype}{bool}\ would\_apply\ (\mbox{\hyperlink{struct_o_t_1_1hb__would__apply__context__t}{hb\_would\_apply\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02108\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02109\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_class_def}{ClassDef}}\ \&class\_def\ =\ \textcolor{keyword}{this}+classDef;}
\DoxyCodeLine{02110\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ index\ =\ class\_def.get\_class\ (c-\/>glyphs[0]);}
\DoxyCodeLine{02111\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_rule_set}{RuleSet}}\ \&rule\_set\ =\ \textcolor{keyword}{this}+ruleSet[index];}
\DoxyCodeLine{02112\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_context_apply_lookup_context}{ContextApplyLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{02113\ \ \ \ \ \ \ \{match\_class\},}
\DoxyCodeLine{02114\ \ \ \ \ \ \ \&class\_def}
\DoxyCodeLine{02115\ \ \ \ \ \};}
\DoxyCodeLine{02116\ \ \ \ \ \textcolor{keywordflow}{return}\ rule\_set.would\_apply\ (c,\ lookup\_context);}
\DoxyCodeLine{02117\ \ \ \}}
\DoxyCodeLine{02118\ }
\DoxyCodeLine{02119\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_coverage}{Coverage}}\ \&get\_coverage\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{this}+coverage;\ \}}
\DoxyCodeLine{02120\ }
\DoxyCodeLine{02121\ \ \ \textcolor{keywordtype}{bool}\ apply\ (\mbox{\hyperlink{struct_o_t_1_1hb__ot__apply__context__t}{hb\_ot\_apply\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02122\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02123\ \ \ \ \ TRACE\_APPLY\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02124\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ index\ =\ (\textcolor{keyword}{this}+coverage).get\_coverage\ (c-\/>buffer-\/>cur().codepoint);}
\DoxyCodeLine{02125\ \ \ \ \ \textcolor{keywordflow}{if}\ (likely\ (index\ ==\ NOT\_COVERED))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02126\ }
\DoxyCodeLine{02127\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_class_def}{ClassDef}}\ \&class\_def\ =\ \textcolor{keyword}{this}+classDef;}
\DoxyCodeLine{02128\ \ \ \ \ index\ =\ class\_def.get\_class\ (c-\/>buffer-\/>cur().codepoint);}
\DoxyCodeLine{02129\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_rule_set}{RuleSet}}\ \&rule\_set\ =\ \textcolor{keyword}{this}+ruleSet[index];}
\DoxyCodeLine{02130\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_context_apply_lookup_context}{ContextApplyLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{02131\ \ \ \ \ \ \ \{match\_class\},}
\DoxyCodeLine{02132\ \ \ \ \ \ \ \&class\_def}
\DoxyCodeLine{02133\ \ \ \ \ \};}
\DoxyCodeLine{02134\ \ \ \ \ return\_trace\ (rule\_set.apply\ (c,\ lookup\_context));}
\DoxyCodeLine{02135\ \ \ \}}
\DoxyCodeLine{02136\ }
\DoxyCodeLine{02137\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02138\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02139\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02140\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>serializer-\/>start\_embed\ (*\textcolor{keyword}{this});}
\DoxyCodeLine{02141\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>serializer-\/>extend\_min\ (out)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02142\ \ \ \ \ out-\/>format\ =\ format;}
\DoxyCodeLine{02143\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!out-\/>coverage.serialize\_subset\ (c,\ coverage,\ \textcolor{keyword}{this})))}
\DoxyCodeLine{02144\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02145\ }
\DoxyCodeLine{02146\ \ \ \ \ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ klass\_map;}
\DoxyCodeLine{02147\ \ \ \ \ out-\/>classDef.serialize\_subset\ (c,\ classDef,\ \textcolor{keyword}{this},\ \&klass\_map);}
\DoxyCodeLine{02148\ }
\DoxyCodeLine{02149\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}*\ glyphset\ =\ c-\/>plan-\/>glyphset\_gsub\ ();}
\DoxyCodeLine{02150\ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ retained\_coverage\_glyphs;}
\DoxyCodeLine{02151\ \ \ \ \ (\textcolor{keyword}{this}+coverage).intersected\_coverage\_glyphs\ (glyphset,\ \&retained\_coverage\_glyphs);}
\DoxyCodeLine{02152\ }
\DoxyCodeLine{02153\ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ coverage\_glyph\_classes;}
\DoxyCodeLine{02154\ \ \ \ \ (\textcolor{keyword}{this}+classDef).intersected\_classes\ (\&retained\_coverage\_glyphs,\ \&coverage\_glyph\_classes);}
\DoxyCodeLine{02155\ }
\DoxyCodeLine{02156\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *lookup\_map\ =\ c-\/>table\_tag\ ==\ HB\_OT\_TAG\_GSUB\ ?\ c-\/>plan-\/>gsub\_lookups\ :\ c-\/>plan-\/>gpos\_lookups;}
\DoxyCodeLine{02157\ \ \ \ \ \textcolor{keywordtype}{bool}\ ret\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02158\ \ \ \ \ \textcolor{keywordtype}{int}\ non\_zero\_index\ =\ -\/1,\ index\ =\ 0;}
\DoxyCodeLine{02159\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \_\ :\ +\ hb\_enumerate\ (ruleSet)}
\DoxyCodeLine{02160\ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ hb\_filter\ (klass\_map,\ hb\_first))}
\DoxyCodeLine{02161\ \ \ \ \ \{}
\DoxyCodeLine{02162\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ *o\ =\ out-\/>ruleSet.serialize\_append\ (c-\/>serializer);}
\DoxyCodeLine{02163\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!o))}
\DoxyCodeLine{02164\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02165\ \ \ \ \ ret\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02166\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02167\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02168\ }
\DoxyCodeLine{02169\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (coverage\_glyph\_classes.has\ (\_.first)\ \&\&}
\DoxyCodeLine{02170\ \ \ \ \ \ \ o-\/>serialize\_subset\ (c,\ \_.second,\ \textcolor{keyword}{this},\ lookup\_map,\ \&klass\_map))}
\DoxyCodeLine{02171\ \ \ \ \ non\_zero\_index\ =\ index;}
\DoxyCodeLine{02172\ }
\DoxyCodeLine{02173\ \ \ \ \ \ \ index++;}
\DoxyCodeLine{02174\ \ \ \ \ \}}
\DoxyCodeLine{02175\ }
\DoxyCodeLine{02176\ \ \ \ \ \textcolor{keywordflow}{if}\ (!ret\ ||\ non\_zero\_index\ ==\ -\/1)\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02177\ }
\DoxyCodeLine{02178\ \ \ \ \ \textcolor{comment}{//prune\ empty\ trailing\ ruleSets}}
\DoxyCodeLine{02179\ \ \ \ \ -\/-\/index;}
\DoxyCodeLine{02180\ \ \ \ \ \textcolor{keywordflow}{while}\ (index\ >\ non\_zero\_index)}
\DoxyCodeLine{02181\ \ \ \ \ \{}
\DoxyCodeLine{02182\ \ \ \ \ \ \ out-\/>ruleSet.pop\ ();}
\DoxyCodeLine{02183\ \ \ \ \ \ \ index-\/-\/;}
\DoxyCodeLine{02184\ \ \ \ \ \}}
\DoxyCodeLine{02185\ }
\DoxyCodeLine{02186\ \ \ \ \ return\_trace\ (\textcolor{keywordtype}{bool}\ (out-\/>ruleSet));}
\DoxyCodeLine{02187\ \ \ \}}
\DoxyCodeLine{02188\ }
\DoxyCodeLine{02189\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02190\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02191\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02192\ \ \ \ \ return\_trace\ (coverage.sanitize\ (c,\ \textcolor{keyword}{this})\ \&\&\ classDef.sanitize\ (c,\ \textcolor{keyword}{this})\ \&\&\ ruleSet.sanitize\ (c,\ \textcolor{keyword}{this}));}
\DoxyCodeLine{02193\ \ \ \}}
\DoxyCodeLine{02194\ }
\DoxyCodeLine{02195\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{02196\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ format;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Format\ identifier-\/-\/format\ =\ 2\ */}}
\DoxyCodeLine{02197\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<Coverage>}}}
\DoxyCodeLine{02198\ \ \ \ \ \ \ \ \ coverage;\ \ \ \ \ \ \ \textcolor{comment}{/*\ Offset\ to\ Coverage\ table-\/-\/from}}
\DoxyCodeLine{02199\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ beginning\ of\ table\ */}}
\DoxyCodeLine{02200\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<ClassDef>}}}
\DoxyCodeLine{02201\ \ \ \ \ \ \ \ \ classDef;\ \ \ \ \ \ \ \textcolor{comment}{/*\ Offset\ to\ glyph\ ClassDef\ table-\/-\/from}}
\DoxyCodeLine{02202\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ beginning\ of\ table\ */}}
\DoxyCodeLine{02203\ \ \ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<RuleSet>}}}
\DoxyCodeLine{02204\ \ \ \ \ \ \ \ \ ruleSet;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Array\ of\ RuleSet\ tables}}
\DoxyCodeLine{02205\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ ordered\ by\ class\ */}}
\DoxyCodeLine{02206\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{02207\ \ \ DEFINE\_SIZE\_ARRAY\ (8,\ ruleSet);}
\DoxyCodeLine{02208\ \};}
\DoxyCodeLine{02209\ }
\DoxyCodeLine{02210\ }
\DoxyCodeLine{02211\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_context_format3}{ContextFormat3}}}
\DoxyCodeLine{02212\ \{}
\DoxyCodeLine{02213\ \ \ \textcolor{keywordtype}{bool}\ intersects\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02214\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02215\ \ \ \ \ \textcolor{keywordflow}{if}\ (!(\textcolor{keyword}{this}+coverageZ[0]).intersects\ (glyphs))}
\DoxyCodeLine{02216\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02217\ }
\DoxyCodeLine{02218\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_context_closure_lookup_context}{ContextClosureLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{02219\ \ \ \ \ \ \ \{intersects\_coverage,\ intersected\_coverage\_glyphs\},}
\DoxyCodeLine{02220\ \ \ \ \ \ \ ContextFormat::CoverageBasedContext,}
\DoxyCodeLine{02221\ \ \ \ \ \ \ \textcolor{keyword}{this}}
\DoxyCodeLine{02222\ \ \ \ \ \};}
\DoxyCodeLine{02223\ \ \ \ \ \textcolor{keywordflow}{return}\ context\_intersects\ (glyphs,}
\DoxyCodeLine{02224\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ glyphCount,\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *)\ (coverageZ.arrayZ\ +\ 1),}
\DoxyCodeLine{02225\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_context);}
\DoxyCodeLine{02226\ \ \ \}}
\DoxyCodeLine{02227\ }
\DoxyCodeLine{02228\ \ \ \textcolor{keywordtype}{bool}\ may\_have\_non\_1to1\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{02229\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};\ \}}
\DoxyCodeLine{02230\ }
\DoxyCodeLine{02231\ \ \ \textcolor{keywordtype}{void}\ closure\ (\mbox{\hyperlink{struct_o_t_1_1hb__closure__context__t}{hb\_closure\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02232\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02233\ \ \ \ \ \textcolor{keywordflow}{if}\ (!(\textcolor{keyword}{this}+coverageZ[0]).intersects\ (c-\/>glyphs))}
\DoxyCodeLine{02234\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02235\ }
\DoxyCodeLine{02236\ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}*\ cur\_active\_glyphs\ =\ \&c-\/>push\_cur\_active\_glyphs\ ();}
\DoxyCodeLine{02237\ \ \ \ \ get\_coverage\ ().intersected\_coverage\_glyphs\ (\&c-\/>previous\_parent\_active\_glyphs\ (),}
\DoxyCodeLine{02238\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cur\_active\_glyphs);}
\DoxyCodeLine{02239\ }
\DoxyCodeLine{02240\ }
\DoxyCodeLine{02241\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_lookup_record}{LookupRecord}}\ *lookupRecord\ =\ \&StructAfter<LookupRecord>\ (coverageZ.as\_array\ (glyphCount));}
\DoxyCodeLine{02242\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_context_closure_lookup_context}{ContextClosureLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{02243\ \ \ \ \ \ \ \{intersects\_coverage,\ intersected\_coverage\_glyphs\},}
\DoxyCodeLine{02244\ \ \ \ \ \ \ ContextFormat::CoverageBasedContext,}
\DoxyCodeLine{02245\ \ \ \ \ \ \ \textcolor{keyword}{this}}
\DoxyCodeLine{02246\ \ \ \ \ \};}
\DoxyCodeLine{02247\ \ \ \ \ context\_closure\_lookup\ (c,}
\DoxyCodeLine{02248\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ glyphCount,\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *)\ (coverageZ.arrayZ\ +\ 1),}
\DoxyCodeLine{02249\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookupCount,\ lookupRecord,}
\DoxyCodeLine{02250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0,\ lookup\_context);}
\DoxyCodeLine{02251\ }
\DoxyCodeLine{02252\ \ \ \ \ c-\/>pop\_cur\_done\_glyphs\ ();}
\DoxyCodeLine{02253\ \ \ \}}
\DoxyCodeLine{02254\ }
\DoxyCodeLine{02255\ \ \ \textcolor{keywordtype}{void}\ closure\_lookups\ (\mbox{\hyperlink{struct_o_t_1_1hb__closure__lookups__context__t}{hb\_closure\_lookups\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02256\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02257\ \ \ \ \ \textcolor{keywordflow}{if}\ (!intersects\ (c-\/>glyphs))}
\DoxyCodeLine{02258\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02259\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_lookup_record}{LookupRecord}}\ *lookupRecord\ =\ \&StructAfter<LookupRecord>\ (coverageZ.as\_array\ (glyphCount));}
\DoxyCodeLine{02260\ \ \ \ \ recurse\_lookups\ (c,\ lookupCount,\ lookupRecord);}
\DoxyCodeLine{02261\ \ \ \}}
\DoxyCodeLine{02262\ }
\DoxyCodeLine{02263\ \ \ \textcolor{keywordtype}{void}\ collect\_variation\_indices\ (\mbox{\hyperlink{struct_o_t_1_1hb__collect__variation__indices__context__t}{hb\_collect\_variation\_indices\_context\_t}}\ *c)\textcolor{keyword}{\ const\ }\{\}}
\DoxyCodeLine{02264\ }
\DoxyCodeLine{02265\ \ \ \textcolor{keywordtype}{void}\ collect\_glyphs\ (\mbox{\hyperlink{struct_o_t_1_1hb__collect__glyphs__context__t}{hb\_collect\_glyphs\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02266\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02267\ \ \ \ \ (\textcolor{keyword}{this}+coverageZ[0]).collect\_coverage\ (c-\/>input);}
\DoxyCodeLine{02268\ }
\DoxyCodeLine{02269\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_lookup_record}{LookupRecord}}\ *lookupRecord\ =\ \&StructAfter<LookupRecord>\ (coverageZ.as\_array\ (glyphCount));}
\DoxyCodeLine{02270\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_context_collect_glyphs_lookup_context}{ContextCollectGlyphsLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{02271\ \ \ \ \ \ \ \{collect\_coverage\},}
\DoxyCodeLine{02272\ \ \ \ \ \ \ \textcolor{keyword}{this}}
\DoxyCodeLine{02273\ \ \ \ \ \};}
\DoxyCodeLine{02274\ }
\DoxyCodeLine{02275\ \ \ \ \ context\_collect\_glyphs\_lookup\ (c,}
\DoxyCodeLine{02276\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ glyphCount,\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *)\ (coverageZ.arrayZ\ +\ 1),}
\DoxyCodeLine{02277\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookupCount,\ lookupRecord,}
\DoxyCodeLine{02278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_context);}
\DoxyCodeLine{02279\ \ \ \}}
\DoxyCodeLine{02280\ }
\DoxyCodeLine{02281\ \ \ \textcolor{keywordtype}{bool}\ would\_apply\ (\mbox{\hyperlink{struct_o_t_1_1hb__would__apply__context__t}{hb\_would\_apply\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02282\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02283\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_lookup_record}{LookupRecord}}\ *lookupRecord\ =\ \&StructAfter<LookupRecord>\ (coverageZ.as\_array\ (glyphCount));}
\DoxyCodeLine{02284\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_context_apply_lookup_context}{ContextApplyLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{02285\ \ \ \ \ \ \ \{match\_coverage\},}
\DoxyCodeLine{02286\ \ \ \ \ \ \ \textcolor{keyword}{this}}
\DoxyCodeLine{02287\ \ \ \ \ \};}
\DoxyCodeLine{02288\ \ \ \ \ \textcolor{keywordflow}{return}\ context\_would\_apply\_lookup\ (c,}
\DoxyCodeLine{02289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ glyphCount,\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *)\ (coverageZ.arrayZ\ +\ 1),}
\DoxyCodeLine{02290\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookupCount,\ lookupRecord,}
\DoxyCodeLine{02291\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_context);}
\DoxyCodeLine{02292\ \ \ \}}
\DoxyCodeLine{02293\ }
\DoxyCodeLine{02294\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_coverage}{Coverage}}\ \&get\_coverage\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{this}+coverageZ[0];\ \}}
\DoxyCodeLine{02295\ }
\DoxyCodeLine{02296\ \ \ \textcolor{keywordtype}{bool}\ apply\ (\mbox{\hyperlink{struct_o_t_1_1hb__ot__apply__context__t}{hb\_ot\_apply\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02297\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02298\ \ \ \ \ TRACE\_APPLY\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02299\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ index\ =\ (\textcolor{keyword}{this}+coverageZ[0]).get\_coverage\ (c-\/>buffer-\/>cur().codepoint);}
\DoxyCodeLine{02300\ \ \ \ \ \textcolor{keywordflow}{if}\ (likely\ (index\ ==\ NOT\_COVERED))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02301\ }
\DoxyCodeLine{02302\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_lookup_record}{LookupRecord}}\ *lookupRecord\ =\ \&StructAfter<LookupRecord>\ (coverageZ.as\_array\ (glyphCount));}
\DoxyCodeLine{02303\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_context_apply_lookup_context}{ContextApplyLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{02304\ \ \ \ \ \ \ \{match\_coverage\},}
\DoxyCodeLine{02305\ \ \ \ \ \ \ \textcolor{keyword}{this}}
\DoxyCodeLine{02306\ \ \ \ \ \};}
\DoxyCodeLine{02307\ \ \ \ \ return\_trace\ (context\_apply\_lookup\ (c,\ glyphCount,\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *)\ (coverageZ.arrayZ\ +\ 1),\ lookupCount,\ lookupRecord,\ lookup\_context));}
\DoxyCodeLine{02308\ \ \ \}}
\DoxyCodeLine{02309\ }
\DoxyCodeLine{02310\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02311\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02312\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02313\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>serializer-\/>start\_embed\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02314\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>serializer-\/>extend\_min\ (out)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02315\ }
\DoxyCodeLine{02316\ \ \ \ \ out-\/>format\ =\ format;}
\DoxyCodeLine{02317\ \ \ \ \ out-\/>glyphCount\ =\ glyphCount;}
\DoxyCodeLine{02318\ }
\DoxyCodeLine{02319\ \ \ \ \ \textcolor{keyword}{auto}\ coverages\ =\ coverageZ.as\_array\ (glyphCount);}
\DoxyCodeLine{02320\ }
\DoxyCodeLine{02321\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<Coverage>}}\&\ offset\ :\ coverages)}
\DoxyCodeLine{02322\ \ \ \ \ \{}
\DoxyCodeLine{02323\ \ \ \ \ \ \ \textcolor{comment}{/*\ TODO(subset)\ This\ looks\ like\ should\ not\ be\ necessary\ to\ write\ this\ way.\ */}}
\DoxyCodeLine{02324\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ *o\ =\ c-\/>serializer-\/>allocate\_size<\mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<Coverage>}}>\ (\mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<Coverage>::static\_size}});}
\DoxyCodeLine{02325\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!o))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02326\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!o-\/>serialize\_subset\ (c,\ offset,\ \textcolor{keyword}{this}))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02327\ \ \ \ \ \}}
\DoxyCodeLine{02328\ }
\DoxyCodeLine{02329\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_unsized_array_of}{UnsizedArrayOf<LookupRecord>}}\&\ lookupRecord\ =\ StructAfter<UnsizedArrayOf<LookupRecord>>\ (coverageZ.as\_array\ (glyphCount));}
\DoxyCodeLine{02330\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *lookup\_map\ =\ c-\/>table\_tag\ ==\ HB\_OT\_TAG\_GSUB\ ?\ c-\/>plan-\/>gsub\_lookups\ :\ c-\/>plan-\/>gpos\_lookups;}
\DoxyCodeLine{02331\ }
\DoxyCodeLine{02332\ }
\DoxyCodeLine{02333\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ count\ =\ serialize\_lookuprecord\_array\ (c-\/>serializer,\ lookupRecord.as\_array\ (lookupCount),\ lookup\_map);}
\DoxyCodeLine{02334\ \ \ \ \ return\_trace\ (c-\/>serializer-\/>check\_assign\ (out-\/>lookupCount,\ count,\ HB\_SERIALIZE\_ERROR\_INT\_OVERFLOW));}
\DoxyCodeLine{02335\ \ \ \}}
\DoxyCodeLine{02336\ }
\DoxyCodeLine{02337\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02338\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02339\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02340\ \ \ \ \ \textcolor{keywordflow}{if}\ (!c-\/>check\_struct\ (\textcolor{keyword}{this}))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02341\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count\ =\ glyphCount;}
\DoxyCodeLine{02342\ \ \ \ \ \textcolor{keywordflow}{if}\ (!count)\ return\_trace\ (\textcolor{keyword}{false});\ \textcolor{comment}{/*\ We\ want\ to\ access\ coverageZ[0]\ freely.\ */}}
\DoxyCodeLine{02343\ \ \ \ \ \textcolor{keywordflow}{if}\ (!c-\/>check\_array\ (coverageZ.arrayZ,\ count))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02344\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ i++)}
\DoxyCodeLine{02345\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!coverageZ[i].sanitize\ (c,\ \textcolor{keyword}{this}))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02346\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_lookup_record}{LookupRecord}}\ *lookupRecord\ =\ \&StructAfter<LookupRecord>\ (coverageZ.as\_array\ (glyphCount));}
\DoxyCodeLine{02347\ \ \ \ \ return\_trace\ (c-\/>check\_array\ (lookupRecord,\ lookupCount));}
\DoxyCodeLine{02348\ \ \ \}}
\DoxyCodeLine{02349\ }
\DoxyCodeLine{02350\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{02351\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ format;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Format\ identifier-\/-\/format\ =\ 3\ */}}
\DoxyCodeLine{02352\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ glyphCount;\ \ \ \ \ \textcolor{comment}{/*\ Number\ of\ glyphs\ in\ the\ input\ glyph}}
\DoxyCodeLine{02353\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ sequence\ */}}
\DoxyCodeLine{02354\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ lookupCount;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Number\ of\ LookupRecords\ */}}
\DoxyCodeLine{02355\ \ \ \mbox{\hyperlink{struct_o_t_1_1_unsized_array_of}{UnsizedArrayOf<Offset16To<Coverage>}}>}
\DoxyCodeLine{02356\ \ \ \ \ \ \ \ \ coverageZ;\ \ \ \ \ \ \textcolor{comment}{/*\ Array\ of\ offsets\ to\ Coverage}}
\DoxyCodeLine{02357\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ table\ in\ glyph\ sequence\ order\ */}}
\DoxyCodeLine{02358\ \textcolor{comment}{/*UnsizedArrayOf<LookupRecord>}}
\DoxyCodeLine{02359\ \textcolor{comment}{\ \ \ \ \ \ \ \ lookupRecordX;*/}\ \ \ \ \textcolor{comment}{/*\ Array\ of\ LookupRecords-\/-\/in}}
\DoxyCodeLine{02360\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ design\ order\ */}}
\DoxyCodeLine{02361\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{02362\ \ \ DEFINE\_SIZE\_ARRAY\ (6,\ coverageZ);}
\DoxyCodeLine{02363\ \};}
\DoxyCodeLine{02364\ }
\DoxyCodeLine{02365\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_context}{Context}}}
\DoxyCodeLine{02366\ \{}
\DoxyCodeLine{02367\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ context\_t,\ \textcolor{keyword}{typename}\ ...Ts>}
\DoxyCodeLine{02368\ \ \ \textcolor{keyword}{typename}\ context\_t::return\_t\ dispatch\ (context\_t\ *c,\ Ts\&\&...\ ds)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02369\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02370\ \ \ \ \ TRACE\_DISPATCH\ (\textcolor{keyword}{this},\ u.format);}
\DoxyCodeLine{02371\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>may\_dispatch\ (\textcolor{keyword}{this},\ \&u.format)))\ return\_trace\ (c-\/>no\_dispatch\_return\_value\ ());}
\DoxyCodeLine{02372\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)\ \{}
\DoxyCodeLine{02373\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ return\_trace\ (c-\/>dispatch\ (u.format1,\ std::forward<Ts>\ (ds)...));}
\DoxyCodeLine{02374\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ return\_trace\ (c-\/>dispatch\ (u.format2,\ std::forward<Ts>\ (ds)...));}
\DoxyCodeLine{02375\ \ \ \ \ \textcolor{keywordflow}{case}\ 3:\ return\_trace\ (c-\/>dispatch\ (u.format3,\ std::forward<Ts>\ (ds)...));}
\DoxyCodeLine{02376\ \ \ \ \ \textcolor{keywordflow}{default}:return\_trace\ (c-\/>default\_return\_value\ ());}
\DoxyCodeLine{02377\ \ \ \ \ \}}
\DoxyCodeLine{02378\ \ \ \}}
\DoxyCodeLine{02379\ }
\DoxyCodeLine{02380\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{02381\ \ \ \textcolor{keyword}{union\ }\{}
\DoxyCodeLine{02382\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ \ \ \ \ format;\ \ \ \ \ \textcolor{comment}{/*\ Format\ identifier\ */}}
\DoxyCodeLine{02383\ \ \ \mbox{\hyperlink{struct_o_t_1_1_context_format1}{ContextFormat1}}\ \ format1;}
\DoxyCodeLine{02384\ \ \ \mbox{\hyperlink{struct_o_t_1_1_context_format2}{ContextFormat2}}\ \ format2;}
\DoxyCodeLine{02385\ \ \ \mbox{\hyperlink{struct_o_t_1_1_context_format3}{ContextFormat3}}\ \ format3;}
\DoxyCodeLine{02386\ \ \ \}\ u;}
\DoxyCodeLine{02387\ \};}
\DoxyCodeLine{02388\ }
\DoxyCodeLine{02389\ }
\DoxyCodeLine{02390\ \textcolor{comment}{/*\ Chaining\ Contextual\ lookups\ */}}
\DoxyCodeLine{02391\ }
\DoxyCodeLine{02392\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_chain_context_closure_lookup_context}{ChainContextClosureLookupContext}}}
\DoxyCodeLine{02393\ \{}
\DoxyCodeLine{02394\ \ \ \mbox{\hyperlink{struct_o_t_1_1_context_closure_funcs}{ContextClosureFuncs}}\ funcs;}
\DoxyCodeLine{02395\ \ \ ContextFormat\ context\_format;}
\DoxyCodeLine{02396\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *intersects\_data[3];}
\DoxyCodeLine{02397\ \};}
\DoxyCodeLine{02398\ }
\DoxyCodeLine{02399\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_chain_context_collect_glyphs_lookup_context}{ChainContextCollectGlyphsLookupContext}}}
\DoxyCodeLine{02400\ \{}
\DoxyCodeLine{02401\ \ \ \mbox{\hyperlink{struct_o_t_1_1_context_collect_glyphs_funcs}{ContextCollectGlyphsFuncs}}\ funcs;}
\DoxyCodeLine{02402\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *collect\_data[3];}
\DoxyCodeLine{02403\ \};}
\DoxyCodeLine{02404\ }
\DoxyCodeLine{02405\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_chain_context_apply_lookup_context}{ChainContextApplyLookupContext}}}
\DoxyCodeLine{02406\ \{}
\DoxyCodeLine{02407\ \ \ \mbox{\hyperlink{struct_o_t_1_1_context_apply_funcs}{ContextApplyFuncs}}\ funcs;}
\DoxyCodeLine{02408\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *match\_data[3];}
\DoxyCodeLine{02409\ \};}
\DoxyCodeLine{02410\ }
\DoxyCodeLine{02411\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ chain\_context\_intersects\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,}
\DoxyCodeLine{02412\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ backtrackCount,}
\DoxyCodeLine{02413\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ backtrack[],}
\DoxyCodeLine{02414\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ inputCount,\ \textcolor{comment}{/*\ Including\ the\ first\ glyph\ (not\ matched)\ */}}
\DoxyCodeLine{02415\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \mbox{\hyperlink{structinput}{input}}[],\ \textcolor{comment}{/*\ Array\ of\ input\ values-\/-\/start\ with\ second\ glyph\ */}}
\DoxyCodeLine{02416\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookaheadCount,}
\DoxyCodeLine{02417\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ lookahead[],}
\DoxyCodeLine{02418\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_chain_context_closure_lookup_context}{ChainContextClosureLookupContext}}\ \&lookup\_context)}
\DoxyCodeLine{02419\ \{}
\DoxyCodeLine{02420\ \ \ \textcolor{keywordflow}{return}\ array\_is\_subset\_of\ (glyphs,}
\DoxyCodeLine{02421\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ backtrackCount,\ backtrack,}
\DoxyCodeLine{02422\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_context.funcs.intersects,\ lookup\_context.intersects\_data[0])}
\DoxyCodeLine{02423\ \ \ \ \ \ \ \&\&\ array\_is\_subset\_of\ (glyphs,}
\DoxyCodeLine{02424\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ inputCount\ ?\ inputCount\ -\/\ 1\ :\ 0,\ \mbox{\hyperlink{structinput}{input}},}
\DoxyCodeLine{02425\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_context.funcs.intersects,\ lookup\_context.intersects\_data[1])}
\DoxyCodeLine{02426\ \ \ \ \ \ \ \&\&\ array\_is\_subset\_of\ (glyphs,}
\DoxyCodeLine{02427\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookaheadCount,\ lookahead,}
\DoxyCodeLine{02428\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_context.funcs.intersects,\ lookup\_context.intersects\_data[2]);}
\DoxyCodeLine{02429\ \}}
\DoxyCodeLine{02430\ }
\DoxyCodeLine{02431\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ chain\_context\_closure\_lookup\ (hb\_closure\_context\_t\ *c,}
\DoxyCodeLine{02432\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ backtrackCount,}
\DoxyCodeLine{02433\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ HBUINT16\ backtrack[],}
\DoxyCodeLine{02434\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ inputCount,\ \textcolor{comment}{/*\ Including\ the\ first\ glyph\ (not\ matched)\ */}}
\DoxyCodeLine{02435\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ HBUINT16\ \mbox{\hyperlink{structinput}{input}}[],\ \textcolor{comment}{/*\ Array\ of\ input\ values-\/-\/start\ with\ second\ glyph\ */}}
\DoxyCodeLine{02436\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookaheadCount,}
\DoxyCodeLine{02437\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ HBUINT16\ lookahead[],}
\DoxyCodeLine{02438\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookupCount,}
\DoxyCodeLine{02439\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LookupRecord\ lookupRecord[],}
\DoxyCodeLine{02440\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classvalue}{value}},}
\DoxyCodeLine{02441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ChainContextClosureLookupContext\ \&lookup\_context)}
\DoxyCodeLine{02442\ \{}
\DoxyCodeLine{02443\ \ \ \textcolor{keywordflow}{if}\ (chain\_context\_intersects\ (c-\/>glyphs,}
\DoxyCodeLine{02444\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ backtrackCount,\ backtrack,}
\DoxyCodeLine{02445\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ inputCount,\ \mbox{\hyperlink{structinput}{input}},}
\DoxyCodeLine{02446\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookaheadCount,\ lookahead,}
\DoxyCodeLine{02447\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_context))}
\DoxyCodeLine{02448\ \ \ \ \ context\_closure\_recurse\_lookups\ (c,}
\DoxyCodeLine{02449\ \ \ \ \ \ \ \ \ \ \ \ \ \ inputCount,\ \mbox{\hyperlink{structinput}{input}},}
\DoxyCodeLine{02450\ \ \ \ \ \ \ \ \ \ \ \ \ \ lookupCount,\ lookupRecord,}
\DoxyCodeLine{02451\ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classvalue}{value}},}
\DoxyCodeLine{02452\ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_context.context\_format,}
\DoxyCodeLine{02453\ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_context.intersects\_data[1],}
\DoxyCodeLine{02454\ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_context.funcs.intersected\_glyphs);}
\DoxyCodeLine{02455\ \}}
\DoxyCodeLine{02456\ }
\DoxyCodeLine{02457\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ chain\_context\_collect\_glyphs\_lookup\ (hb\_collect\_glyphs\_context\_t\ *c,}
\DoxyCodeLine{02458\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ backtrackCount,}
\DoxyCodeLine{02459\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ HBUINT16\ backtrack[],}
\DoxyCodeLine{02460\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ inputCount,\ \textcolor{comment}{/*\ Including\ the\ first\ glyph\ (not\ matched)\ */}}
\DoxyCodeLine{02461\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ HBUINT16\ \mbox{\hyperlink{structinput}{input}}[],\ \textcolor{comment}{/*\ Array\ of\ input\ values-\/-\/start\ with\ second\ glyph\ */}}
\DoxyCodeLine{02462\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookaheadCount,}
\DoxyCodeLine{02463\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ HBUINT16\ lookahead[],}
\DoxyCodeLine{02464\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookupCount,}
\DoxyCodeLine{02465\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LookupRecord\ lookupRecord[],}
\DoxyCodeLine{02466\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ChainContextCollectGlyphsLookupContext\ \&lookup\_context)}
\DoxyCodeLine{02467\ \{}
\DoxyCodeLine{02468\ \ \ collect\_array\ (c,\ c-\/>before,}
\DoxyCodeLine{02469\ \ \ \ \ \ \ \ \ \ backtrackCount,\ backtrack,}
\DoxyCodeLine{02470\ \ \ \ \ \ \ \ \ \ lookup\_context.funcs.collect,\ lookup\_context.collect\_data[0]);}
\DoxyCodeLine{02471\ \ \ collect\_array\ (c,\ c-\/>input,}
\DoxyCodeLine{02472\ \ \ \ \ \ \ \ \ \ inputCount\ ?\ inputCount\ -\/\ 1\ :\ 0,\ \mbox{\hyperlink{structinput}{input}},}
\DoxyCodeLine{02473\ \ \ \ \ \ \ \ \ \ lookup\_context.funcs.collect,\ lookup\_context.collect\_data[1]);}
\DoxyCodeLine{02474\ \ \ collect\_array\ (c,\ c-\/>after,}
\DoxyCodeLine{02475\ \ \ \ \ \ \ \ \ \ lookaheadCount,\ lookahead,}
\DoxyCodeLine{02476\ \ \ \ \ \ \ \ \ \ lookup\_context.funcs.collect,\ lookup\_context.collect\_data[2]);}
\DoxyCodeLine{02477\ \ \ recurse\_lookups\ (c,}
\DoxyCodeLine{02478\ \ \ \ \ \ \ \ \ \ \ \ lookupCount,\ lookupRecord);}
\DoxyCodeLine{02479\ \}}
\DoxyCodeLine{02480\ }
\DoxyCodeLine{02481\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ chain\_context\_would\_apply\_lookup\ (hb\_would\_apply\_context\_t\ *c,}
\DoxyCodeLine{02482\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ backtrackCount,}
\DoxyCodeLine{02483\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ HBUINT16\ backtrack[]\ HB\_UNUSED,}
\DoxyCodeLine{02484\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ inputCount,\ \textcolor{comment}{/*\ Including\ the\ first\ glyph\ (not\ matched)\ */}}
\DoxyCodeLine{02485\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ HBUINT16\ \mbox{\hyperlink{structinput}{input}}[],\ \textcolor{comment}{/*\ Array\ of\ input\ values-\/-\/start\ with\ second\ glyph\ */}}
\DoxyCodeLine{02486\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookaheadCount,}
\DoxyCodeLine{02487\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ HBUINT16\ lookahead[]\ HB\_UNUSED,}
\DoxyCodeLine{02488\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookupCount\ HB\_UNUSED,}
\DoxyCodeLine{02489\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LookupRecord\ lookupRecord[]\ HB\_UNUSED,}
\DoxyCodeLine{02490\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ChainContextApplyLookupContext\ \&lookup\_context)}
\DoxyCodeLine{02491\ \{}
\DoxyCodeLine{02492\ \ \ \textcolor{keywordflow}{return}\ (c-\/>zero\_context\ ?\ !backtrackCount\ \&\&\ !lookaheadCount\ :\ \textcolor{keyword}{true})}
\DoxyCodeLine{02493\ \ \ \ \ \ \ \&\&\ would\_match\_input\ (c,}
\DoxyCodeLine{02494\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ inputCount,\ \mbox{\hyperlink{structinput}{input}},}
\DoxyCodeLine{02495\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_context.funcs.match,\ lookup\_context.match\_data[1]);}
\DoxyCodeLine{02496\ \}}
\DoxyCodeLine{02497\ }
\DoxyCodeLine{02498\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ chain\_context\_apply\_lookup\ (hb\_ot\_apply\_context\_t\ *c,}
\DoxyCodeLine{02499\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ backtrackCount,}
\DoxyCodeLine{02500\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ HBUINT16\ backtrack[],}
\DoxyCodeLine{02501\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ inputCount,\ \textcolor{comment}{/*\ Including\ the\ first\ glyph\ (not\ matched)\ */}}
\DoxyCodeLine{02502\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ HBUINT16\ \mbox{\hyperlink{structinput}{input}}[],\ \textcolor{comment}{/*\ Array\ of\ input\ values-\/-\/start\ with\ second\ glyph\ */}}
\DoxyCodeLine{02503\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookaheadCount,}
\DoxyCodeLine{02504\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ HBUINT16\ lookahead[],}
\DoxyCodeLine{02505\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookupCount,}
\DoxyCodeLine{02506\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LookupRecord\ lookupRecord[],}
\DoxyCodeLine{02507\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ChainContextApplyLookupContext\ \&lookup\_context)}
\DoxyCodeLine{02508\ \{}
\DoxyCodeLine{02509\ \ \ \textcolor{keywordtype}{unsigned}\ end\_index\ =\ c-\/>buffer-\/>idx;}
\DoxyCodeLine{02510\ \ \ \textcolor{keywordtype}{unsigned}\ match\_end\ =\ 0;}
\DoxyCodeLine{02511\ \ \ \textcolor{keywordtype}{unsigned}\ match\_positions[HB\_MAX\_CONTEXT\_LENGTH];}
\DoxyCodeLine{02512\ \ \ \textcolor{keywordflow}{if}\ (!(match\_input\ (c,}
\DoxyCodeLine{02513\ \ \ \ \ \ \ \ \ \ \ \ \ \ inputCount,\ \mbox{\hyperlink{structinput}{input}},}
\DoxyCodeLine{02514\ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_context.funcs.match,\ lookup\_context.match\_data[1],}
\DoxyCodeLine{02515\ \ \ \ \ \ \ \ \ \ \ \ \ \ \&match\_end,\ match\_positions)\ \&\&\ (end\_index\ =\ match\_end)}
\DoxyCodeLine{02516\ \ \ \ \ \ \ \ \&\&\ match\_lookahead\ (c,}
\DoxyCodeLine{02517\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookaheadCount,\ lookahead,}
\DoxyCodeLine{02518\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_context.funcs.match,\ lookup\_context.match\_data[2],}
\DoxyCodeLine{02519\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ match\_end,\ \&end\_index)))}
\DoxyCodeLine{02520\ \ \ \{}
\DoxyCodeLine{02521\ \ \ \ \ c-\/>buffer-\/>unsafe\_to\_concat\ (c-\/>buffer-\/>idx,\ end\_index);}
\DoxyCodeLine{02522\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02523\ \ \ \}}
\DoxyCodeLine{02524\ }
\DoxyCodeLine{02525\ \ \ \textcolor{keywordtype}{unsigned}\ start\_index\ =\ c-\/>buffer-\/>out\_len;}
\DoxyCodeLine{02526\ \ \ \textcolor{keywordflow}{if}\ (!match\_backtrack\ (c,}
\DoxyCodeLine{02527\ \ \ \ \ \ \ \ \ \ \ \ \ backtrackCount,\ backtrack,}
\DoxyCodeLine{02528\ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_context.funcs.match,\ lookup\_context.match\_data[0],}
\DoxyCodeLine{02529\ \ \ \ \ \ \ \ \ \ \ \ \ \&start\_index))}
\DoxyCodeLine{02530\ \ \ \{}
\DoxyCodeLine{02531\ \ \ \ \ c-\/>buffer-\/>unsafe\_to\_concat\_from\_outbuffer\ (start\_index,\ end\_index);}
\DoxyCodeLine{02532\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02533\ \ \ \}}
\DoxyCodeLine{02534\ }
\DoxyCodeLine{02535\ \ \ c-\/>buffer-\/>unsafe\_to\_break\_from\_outbuffer\ (start\_index,\ end\_index);}
\DoxyCodeLine{02536\ \ \ apply\_lookup\ (c,}
\DoxyCodeLine{02537\ \ \ \ \ \ \ \ \ inputCount,\ match\_positions,}
\DoxyCodeLine{02538\ \ \ \ \ \ \ \ \ lookupCount,\ lookupRecord,}
\DoxyCodeLine{02539\ \ \ \ \ \ \ \ \ match\_end);}
\DoxyCodeLine{02540\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02541\ \}}
\DoxyCodeLine{02542\ }
\DoxyCodeLine{02543\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_chain_rule}{ChainRule}}}
\DoxyCodeLine{02544\ \{}
\DoxyCodeLine{02545\ \ \ \textcolor{keywordtype}{bool}\ intersects\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ \mbox{\hyperlink{struct_o_t_1_1_chain_context_closure_lookup_context}{ChainContextClosureLookupContext}}\ \&lookup\_context)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02546\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02547\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_headless_array_of}{HeadlessArrayOf<HBUINT16>}}\ \&\mbox{\hyperlink{structinput}{input}}\ =\ StructAfter<HeadlessArrayOf<HBUINT16>>\ (backtrack);}
\DoxyCodeLine{02548\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<HBUINT16>}}\ \&lookahead\ =\ StructAfter<Array16Of<HBUINT16>>\ (\mbox{\hyperlink{structinput}{input}});}
\DoxyCodeLine{02549\ \ \ \ \ \textcolor{keywordflow}{return}\ chain\_context\_intersects\ (glyphs,}
\DoxyCodeLine{02550\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ backtrack.len,\ backtrack.arrayZ,}
\DoxyCodeLine{02551\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structinput}{input}}.lenP1,\ \mbox{\hyperlink{structinput}{input}}.arrayZ,}
\DoxyCodeLine{02552\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookahead.len,\ lookahead.arrayZ,}
\DoxyCodeLine{02553\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_context);}
\DoxyCodeLine{02554\ \ \ \}}
\DoxyCodeLine{02555\ }
\DoxyCodeLine{02556\ \ \ \textcolor{keywordtype}{void}\ closure\ (\mbox{\hyperlink{struct_o_t_1_1hb__closure__context__t}{hb\_closure\_context\_t}}\ *c,\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classvalue}{value}},}
\DoxyCodeLine{02557\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_chain_context_closure_lookup_context}{ChainContextClosureLookupContext}}\ \&lookup\_context)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02558\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02559\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (c-\/>lookup\_limit\_exceeded\ ()))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02560\ }
\DoxyCodeLine{02561\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_headless_array_of}{HeadlessArrayOf<HBUINT16>}}\ \&\mbox{\hyperlink{structinput}{input}}\ =\ StructAfter<HeadlessArrayOf<HBUINT16>>\ (backtrack);}
\DoxyCodeLine{02562\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<HBUINT16>}}\ \&lookahead\ =\ StructAfter<Array16Of<HBUINT16>>\ (\mbox{\hyperlink{structinput}{input}});}
\DoxyCodeLine{02563\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<LookupRecord>}}\ \&lookup\ =\ StructAfter<Array16Of<LookupRecord>>\ (lookahead);}
\DoxyCodeLine{02564\ \ \ \ \ chain\_context\_closure\_lookup\ (c,}
\DoxyCodeLine{02565\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ backtrack.len,\ backtrack.arrayZ,}
\DoxyCodeLine{02566\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structinput}{input}}.lenP1,\ \mbox{\hyperlink{structinput}{input}}.arrayZ,}
\DoxyCodeLine{02567\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookahead.len,\ lookahead.arrayZ,}
\DoxyCodeLine{02568\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup.len,\ lookup.arrayZ,}
\DoxyCodeLine{02569\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classvalue}{value}},}
\DoxyCodeLine{02570\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_context);}
\DoxyCodeLine{02571\ \ \ \}}
\DoxyCodeLine{02572\ }
\DoxyCodeLine{02573\ \ \ \textcolor{keywordtype}{void}\ closure\_lookups\ (\mbox{\hyperlink{struct_o_t_1_1hb__closure__lookups__context__t}{hb\_closure\_lookups\_context\_t}}\ *c,}
\DoxyCodeLine{02574\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_chain_context_closure_lookup_context}{ChainContextClosureLookupContext}}\ \&lookup\_context)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02575\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02576\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (c-\/>lookup\_limit\_exceeded\ ()))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02577\ \ \ \ \ \textcolor{keywordflow}{if}\ (!intersects\ (c-\/>glyphs,\ lookup\_context))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02578\ }
\DoxyCodeLine{02579\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_headless_array_of}{HeadlessArrayOf<HBUINT16>}}\ \&\mbox{\hyperlink{structinput}{input}}\ =\ StructAfter<HeadlessArrayOf<HBUINT16>>\ (backtrack);}
\DoxyCodeLine{02580\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<HBUINT16>}}\ \&lookahead\ =\ StructAfter<Array16Of<HBUINT16>>\ (\mbox{\hyperlink{structinput}{input}});}
\DoxyCodeLine{02581\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<LookupRecord>}}\ \&lookup\ =\ StructAfter<Array16Of<LookupRecord>>\ (lookahead);}
\DoxyCodeLine{02582\ \ \ \ \ recurse\_lookups\ (c,\ lookup.len,\ lookup.arrayZ);}
\DoxyCodeLine{02583\ \ \ \}}
\DoxyCodeLine{02584\ }
\DoxyCodeLine{02585\ \ \ \textcolor{keywordtype}{void}\ collect\_glyphs\ (\mbox{\hyperlink{struct_o_t_1_1hb__collect__glyphs__context__t}{hb\_collect\_glyphs\_context\_t}}\ *c,}
\DoxyCodeLine{02586\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_chain_context_collect_glyphs_lookup_context}{ChainContextCollectGlyphsLookupContext}}\ \&lookup\_context)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02587\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02588\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_headless_array_of}{HeadlessArrayOf<HBUINT16>}}\ \&\mbox{\hyperlink{structinput}{input}}\ =\ StructAfter<HeadlessArrayOf<HBUINT16>>\ (backtrack);}
\DoxyCodeLine{02589\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<HBUINT16>}}\ \&lookahead\ =\ StructAfter<Array16Of<HBUINT16>>\ (\mbox{\hyperlink{structinput}{input}});}
\DoxyCodeLine{02590\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<LookupRecord>}}\ \&lookup\ =\ StructAfter<Array16Of<LookupRecord>>\ (lookahead);}
\DoxyCodeLine{02591\ \ \ \ \ chain\_context\_collect\_glyphs\_lookup\ (c,}
\DoxyCodeLine{02592\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ backtrack.len,\ backtrack.arrayZ,}
\DoxyCodeLine{02593\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structinput}{input}}.lenP1,\ \mbox{\hyperlink{structinput}{input}}.arrayZ,}
\DoxyCodeLine{02594\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookahead.len,\ lookahead.arrayZ,}
\DoxyCodeLine{02595\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup.len,\ lookup.arrayZ,}
\DoxyCodeLine{02596\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_context);}
\DoxyCodeLine{02597\ \ \ \}}
\DoxyCodeLine{02598\ }
\DoxyCodeLine{02599\ \ \ \textcolor{keywordtype}{bool}\ would\_apply\ (\mbox{\hyperlink{struct_o_t_1_1hb__would__apply__context__t}{hb\_would\_apply\_context\_t}}\ *c,}
\DoxyCodeLine{02600\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_chain_context_apply_lookup_context}{ChainContextApplyLookupContext}}\ \&lookup\_context)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02601\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02602\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_headless_array_of}{HeadlessArrayOf<HBUINT16>}}\ \&\mbox{\hyperlink{structinput}{input}}\ =\ StructAfter<HeadlessArrayOf<HBUINT16>>\ (backtrack);}
\DoxyCodeLine{02603\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<HBUINT16>}}\ \&lookahead\ =\ StructAfter<Array16Of<HBUINT16>>\ (\mbox{\hyperlink{structinput}{input}});}
\DoxyCodeLine{02604\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<LookupRecord>}}\ \&lookup\ =\ StructAfter<Array16Of<LookupRecord>>\ (lookahead);}
\DoxyCodeLine{02605\ \ \ \ \ \textcolor{keywordflow}{return}\ chain\_context\_would\_apply\_lookup\ (c,}
\DoxyCodeLine{02606\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ backtrack.len,\ backtrack.arrayZ,}
\DoxyCodeLine{02607\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structinput}{input}}.lenP1,\ \mbox{\hyperlink{structinput}{input}}.arrayZ,}
\DoxyCodeLine{02608\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookahead.len,\ lookahead.arrayZ,\ lookup.len,}
\DoxyCodeLine{02609\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup.arrayZ,\ lookup\_context);}
\DoxyCodeLine{02610\ \ \ \}}
\DoxyCodeLine{02611\ }
\DoxyCodeLine{02612\ \ \ \textcolor{keywordtype}{bool}\ apply\ (\mbox{\hyperlink{struct_o_t_1_1hb__ot__apply__context__t}{hb\_ot\_apply\_context\_t}}\ *c,\ \mbox{\hyperlink{struct_o_t_1_1_chain_context_apply_lookup_context}{ChainContextApplyLookupContext}}\ \&lookup\_context)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02613\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02614\ \ \ \ \ TRACE\_APPLY\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02615\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_headless_array_of}{HeadlessArrayOf<HBUINT16>}}\ \&\mbox{\hyperlink{structinput}{input}}\ =\ StructAfter<HeadlessArrayOf<HBUINT16>>\ (backtrack);}
\DoxyCodeLine{02616\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<HBUINT16>}}\ \&lookahead\ =\ StructAfter<Array16Of<HBUINT16>>\ (\mbox{\hyperlink{structinput}{input}});}
\DoxyCodeLine{02617\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<LookupRecord>}}\ \&lookup\ =\ StructAfter<Array16Of<LookupRecord>>\ (lookahead);}
\DoxyCodeLine{02618\ \ \ \ \ return\_trace\ (chain\_context\_apply\_lookup\ (c,}
\DoxyCodeLine{02619\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ backtrack.len,\ backtrack.arrayZ,}
\DoxyCodeLine{02620\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structinput}{input}}.lenP1,\ \mbox{\hyperlink{structinput}{input}}.arrayZ,}
\DoxyCodeLine{02621\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookahead.len,\ lookahead.arrayZ,\ lookup.len,}
\DoxyCodeLine{02622\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup.arrayZ,\ lookup\_context));}
\DoxyCodeLine{02623\ \ \ \}}
\DoxyCodeLine{02624\ }
\DoxyCodeLine{02625\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Iterator,}
\DoxyCodeLine{02626\ \ \ \ \ \ \ \ hb\_requires\ (hb\_is\_iterator\ (Iterator))>}
\DoxyCodeLine{02627\ \ \ \textcolor{keywordtype}{void}\ serialize\_array\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{02628\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ len,}
\DoxyCodeLine{02629\ \ \ \ \ \ \ \ \ \ \ \ \ Iterator\ it)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02630\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02631\ \ \ \ \ c-\/>copy\ (len);}
\DoxyCodeLine{02632\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ g\ :\ it)}
\DoxyCodeLine{02633\ \ \ \ \ \ \ c-\/>copy\ ((\mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}})\ g);}
\DoxyCodeLine{02634\ \ \ \}}
\DoxyCodeLine{02635\ }
\DoxyCodeLine{02636\ \ \ \textcolor{keywordtype}{bool}\ serialize\ (\mbox{\hyperlink{structhb__serialize__context__t}{hb\_serialize\_context\_t}}\ *c,}
\DoxyCodeLine{02637\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *lookup\_map,}
\DoxyCodeLine{02638\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *backtrack\_map,}
\DoxyCodeLine{02639\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *input\_map\ =\ \textcolor{keyword}{nullptr},}
\DoxyCodeLine{02640\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *lookahead\_map\ =\ \textcolor{keyword}{nullptr})\textcolor{keyword}{\ const}}
\DoxyCodeLine{02641\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02642\ \ \ \ \ TRACE\_SERIALIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02643\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>start\_embed\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02644\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!out))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02645\ }
\DoxyCodeLine{02646\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *mapping\ =\ backtrack\_map;}
\DoxyCodeLine{02647\ \ \ \ \ serialize\_array\ (c,\ backtrack.len,\ +\ backtrack.iter\ ()}
\DoxyCodeLine{02648\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ hb\_map\ (mapping));}
\DoxyCodeLine{02649\ }
\DoxyCodeLine{02650\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_headless_array_of}{HeadlessArrayOf<HBUINT16>}}\ \&\mbox{\hyperlink{structinput}{input}}\ =\ StructAfter<HeadlessArrayOf<HBUINT16>>\ (backtrack);}
\DoxyCodeLine{02651\ \ \ \ \ \textcolor{keywordflow}{if}\ (input\_map)\ mapping\ =\ input\_map;}
\DoxyCodeLine{02652\ \ \ \ \ serialize\_array\ (c,\ \mbox{\hyperlink{structinput}{input}}.lenP1,\ +\ \mbox{\hyperlink{structinput}{input}}.iter\ ()}
\DoxyCodeLine{02653\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ hb\_map\ (mapping));}
\DoxyCodeLine{02654\ }
\DoxyCodeLine{02655\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<HBUINT16>}}\ \&lookahead\ =\ StructAfter<Array16Of<HBUINT16>>\ (\mbox{\hyperlink{structinput}{input}});}
\DoxyCodeLine{02656\ \ \ \ \ \textcolor{keywordflow}{if}\ (lookahead\_map)\ mapping\ =\ lookahead\_map;}
\DoxyCodeLine{02657\ \ \ \ \ serialize\_array\ (c,\ lookahead.len,\ +\ lookahead.iter\ ()}
\DoxyCodeLine{02658\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ hb\_map\ (mapping));}
\DoxyCodeLine{02659\ }
\DoxyCodeLine{02660\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<LookupRecord>}}\ \&lookupRecord\ =\ StructAfter<Array16Of<LookupRecord>>\ (lookahead);}
\DoxyCodeLine{02661\ }
\DoxyCodeLine{02662\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}*\ lookupCount\ =\ c-\/>embed\ (\&(lookupRecord.len));}
\DoxyCodeLine{02663\ \ \ \ \ \textcolor{keywordflow}{if}\ (!lookupCount)\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02664\ }
\DoxyCodeLine{02665\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ count\ =\ serialize\_lookuprecord\_array\ (c,\ lookupRecord.as\_array\ (),\ lookup\_map);}
\DoxyCodeLine{02666\ \ \ \ \ return\_trace\ (c-\/>check\_assign\ (*lookupCount,\ count,\ HB\_SERIALIZE\_ERROR\_INT\_OVERFLOW));}
\DoxyCodeLine{02667\ \ \ \}}
\DoxyCodeLine{02668\ }
\DoxyCodeLine{02669\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c,}
\DoxyCodeLine{02670\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *lookup\_map,}
\DoxyCodeLine{02671\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *backtrack\_map\ =\ \textcolor{keyword}{nullptr},}
\DoxyCodeLine{02672\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *input\_map\ =\ \textcolor{keyword}{nullptr},}
\DoxyCodeLine{02673\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *lookahead\_map\ =\ \textcolor{keyword}{nullptr})\textcolor{keyword}{\ const}}
\DoxyCodeLine{02674\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02675\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02676\ }
\DoxyCodeLine{02677\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_headless_array_of}{HeadlessArrayOf<HBUINT16>}}\ \&\mbox{\hyperlink{structinput}{input}}\ =\ StructAfter<HeadlessArrayOf<HBUINT16>>\ (backtrack);}
\DoxyCodeLine{02678\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<HBUINT16>}}\ \&lookahead\ =\ StructAfter<Array16Of<HBUINT16>>\ (\mbox{\hyperlink{structinput}{input}});}
\DoxyCodeLine{02679\ }
\DoxyCodeLine{02680\ \ \ \ \ \textcolor{keywordflow}{if}\ (!backtrack\_map)}
\DoxyCodeLine{02681\ \ \ \ \ \{}
\DoxyCodeLine{02682\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \&glyphset\ =\ *c-\/>plan-\/>glyphset\_gsub\ ();}
\DoxyCodeLine{02683\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!hb\_all\ (backtrack,\ glyphset)\ ||}
\DoxyCodeLine{02684\ \ \ \ \ \ \ !hb\_all\ (\mbox{\hyperlink{structinput}{input}},\ glyphset)\ ||}
\DoxyCodeLine{02685\ \ \ \ \ \ \ !hb\_all\ (lookahead,\ glyphset))}
\DoxyCodeLine{02686\ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02687\ }
\DoxyCodeLine{02688\ \ \ \ \ \ \ serialize\ (c-\/>serializer,\ lookup\_map,\ c-\/>plan-\/>glyph\_map);}
\DoxyCodeLine{02689\ \ \ \ \ \}}
\DoxyCodeLine{02690\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02691\ \ \ \ \ \{}
\DoxyCodeLine{02692\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!hb\_all\ (backtrack,\ backtrack\_map)\ ||}
\DoxyCodeLine{02693\ \ \ \ \ \ \ !hb\_all\ (\mbox{\hyperlink{structinput}{input}},\ input\_map)\ ||}
\DoxyCodeLine{02694\ \ \ \ \ \ \ !hb\_all\ (lookahead,\ lookahead\_map))}
\DoxyCodeLine{02695\ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02696\ }
\DoxyCodeLine{02697\ \ \ \ \ \ \ serialize\ (c-\/>serializer,\ lookup\_map,\ backtrack\_map,\ input\_map,\ lookahead\_map);}
\DoxyCodeLine{02698\ \ \ \ \ \}}
\DoxyCodeLine{02699\ }
\DoxyCodeLine{02700\ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{02701\ \ \ \}}
\DoxyCodeLine{02702\ }
\DoxyCodeLine{02703\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02704\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02705\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02706\ \ \ \ \ \textcolor{keywordflow}{if}\ (!backtrack.sanitize\ (c))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02707\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_headless_array_of}{HeadlessArrayOf<HBUINT16>}}\ \&\mbox{\hyperlink{structinput}{input}}\ =\ StructAfter<HeadlessArrayOf<HBUINT16>>\ (backtrack);}
\DoxyCodeLine{02708\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{structinput}{input}}.sanitize\ (c))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02709\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<HBUINT16>}}\ \&lookahead\ =\ StructAfter<Array16Of<HBUINT16>>\ (\mbox{\hyperlink{structinput}{input}});}
\DoxyCodeLine{02710\ \ \ \ \ \textcolor{keywordflow}{if}\ (!lookahead.sanitize\ (c))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02711\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<LookupRecord>}}\ \&lookup\ =\ StructAfter<Array16Of<LookupRecord>>\ (lookahead);}
\DoxyCodeLine{02712\ \ \ \ \ return\_trace\ (lookup.sanitize\ (c));}
\DoxyCodeLine{02713\ \ \ \}}
\DoxyCodeLine{02714\ }
\DoxyCodeLine{02715\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{02716\ \ \ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<HBUINT16>}}}
\DoxyCodeLine{02717\ \ \ \ \ \ \ \ \ backtrack;\ \ \ \ \ \ \textcolor{comment}{/*\ Array\ of\ backtracking\ values}}
\DoxyCodeLine{02718\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ (to\ be\ matched\ before\ the\ input}}
\DoxyCodeLine{02719\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ sequence)\ */}}
\DoxyCodeLine{02720\ \ \ \mbox{\hyperlink{struct_o_t_1_1_headless_array_of}{HeadlessArrayOf<HBUINT16>}}}
\DoxyCodeLine{02721\ \ \ \ \ \ \ \ \ inputX;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Array\ of\ input\ values\ (start\ with}}
\DoxyCodeLine{02722\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ second\ glyph)\ */}}
\DoxyCodeLine{02723\ \ \ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<HBUINT16>}}}
\DoxyCodeLine{02724\ \ \ \ \ \ \ \ \ lookaheadX;\ \ \ \ \ \textcolor{comment}{/*\ Array\ of\ lookahead\ values's\ (to\ be}}
\DoxyCodeLine{02725\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ matched\ after\ the\ input\ sequence)\ */}}
\DoxyCodeLine{02726\ \ \ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<LookupRecord>}}}
\DoxyCodeLine{02727\ \ \ \ \ \ \ \ \ lookupX;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Array\ of\ LookupRecords-\/-\/in}}
\DoxyCodeLine{02728\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ design\ order)\ */}}
\DoxyCodeLine{02729\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{02730\ \ \ DEFINE\_SIZE\_MIN\ (8);}
\DoxyCodeLine{02731\ \};}
\DoxyCodeLine{02732\ }
\DoxyCodeLine{02733\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_chain_rule_set}{ChainRuleSet}}}
\DoxyCodeLine{02734\ \{}
\DoxyCodeLine{02735\ \ \ \textcolor{keywordtype}{bool}\ intersects\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,\ \mbox{\hyperlink{struct_o_t_1_1_chain_context_closure_lookup_context}{ChainContextClosureLookupContext}}\ \&lookup\_context)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02736\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02737\ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{02738\ \ \ \ \ +\ hb\_iter\ (rule)}
\DoxyCodeLine{02739\ \ \ \ \ |\ hb\_map\ (hb\_add\ (\textcolor{keyword}{this}))}
\DoxyCodeLine{02740\ \ \ \ \ |\ hb\_map\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_chain_rule}{ChainRule}}\ \&\_)\ \{\ \textcolor{keywordflow}{return}\ \_.intersects\ (glyphs,\ lookup\_context);\ \})}
\DoxyCodeLine{02741\ \ \ \ \ |\ hb\_any}
\DoxyCodeLine{02742\ \ \ \ \ ;}
\DoxyCodeLine{02743\ \ \ \}}
\DoxyCodeLine{02744\ \ \ \textcolor{keywordtype}{void}\ closure\ (\mbox{\hyperlink{struct_o_t_1_1hb__closure__context__t}{hb\_closure\_context\_t}}\ *c,\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{classvalue}{value}},\ \mbox{\hyperlink{struct_o_t_1_1_chain_context_closure_lookup_context}{ChainContextClosureLookupContext}}\ \&lookup\_context)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02745\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02746\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (c-\/>lookup\_limit\_exceeded\ ()))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02747\ }
\DoxyCodeLine{02748\ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{02749\ \ \ \ \ +\ hb\_iter\ (rule)}
\DoxyCodeLine{02750\ \ \ \ \ |\ hb\_map\ (hb\_add\ (\textcolor{keyword}{this}))}
\DoxyCodeLine{02751\ \ \ \ \ |\ hb\_apply\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_chain_rule}{ChainRule}}\ \&\_)\ \{\ \_.closure\ (c,\ \mbox{\hyperlink{classvalue}{value}},\ lookup\_context);\ \})}
\DoxyCodeLine{02752\ \ \ \ \ ;}
\DoxyCodeLine{02753\ \ \ \}}
\DoxyCodeLine{02754\ }
\DoxyCodeLine{02755\ \ \ \textcolor{keywordtype}{void}\ closure\_lookups\ (\mbox{\hyperlink{struct_o_t_1_1hb__closure__lookups__context__t}{hb\_closure\_lookups\_context\_t}}\ *c,}
\DoxyCodeLine{02756\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_chain_context_closure_lookup_context}{ChainContextClosureLookupContext}}\ \&lookup\_context)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02757\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02758\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (c-\/>lookup\_limit\_exceeded\ ()))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02759\ }
\DoxyCodeLine{02760\ \ \ \ \ +\ hb\_iter\ (rule)}
\DoxyCodeLine{02761\ \ \ \ \ |\ hb\_map\ (hb\_add\ (\textcolor{keyword}{this}))}
\DoxyCodeLine{02762\ \ \ \ \ |\ hb\_apply\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_chain_rule}{ChainRule}}\ \&\_)\ \{\ \_.closure\_lookups\ (c,\ lookup\_context);\ \})}
\DoxyCodeLine{02763\ \ \ \ \ ;}
\DoxyCodeLine{02764\ \ \ \}}
\DoxyCodeLine{02765\ }
\DoxyCodeLine{02766\ \ \ \textcolor{keywordtype}{void}\ collect\_glyphs\ (\mbox{\hyperlink{struct_o_t_1_1hb__collect__glyphs__context__t}{hb\_collect\_glyphs\_context\_t}}\ *c,\ \mbox{\hyperlink{struct_o_t_1_1_chain_context_collect_glyphs_lookup_context}{ChainContextCollectGlyphsLookupContext}}\ \&lookup\_context)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02767\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02768\ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{02769\ \ \ \ \ +\ hb\_iter\ (rule)}
\DoxyCodeLine{02770\ \ \ \ \ |\ hb\_map\ (hb\_add\ (\textcolor{keyword}{this}))}
\DoxyCodeLine{02771\ \ \ \ \ |\ hb\_apply\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_chain_rule}{ChainRule}}\ \&\_)\ \{\ \_.collect\_glyphs\ (c,\ lookup\_context);\ \})}
\DoxyCodeLine{02772\ \ \ \ \ ;}
\DoxyCodeLine{02773\ \ \ \}}
\DoxyCodeLine{02774\ }
\DoxyCodeLine{02775\ \ \ \textcolor{keywordtype}{bool}\ would\_apply\ (\mbox{\hyperlink{struct_o_t_1_1hb__would__apply__context__t}{hb\_would\_apply\_context\_t}}\ *c,\ \mbox{\hyperlink{struct_o_t_1_1_chain_context_apply_lookup_context}{ChainContextApplyLookupContext}}\ \&lookup\_context)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02776\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02777\ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{02778\ \ \ \ \ +\ hb\_iter\ (rule)}
\DoxyCodeLine{02779\ \ \ \ \ |\ hb\_map\ (hb\_add\ (\textcolor{keyword}{this}))}
\DoxyCodeLine{02780\ \ \ \ \ |\ hb\_map\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_chain_rule}{ChainRule}}\ \&\_)\ \{\ \textcolor{keywordflow}{return}\ \_.would\_apply\ (c,\ lookup\_context);\ \})}
\DoxyCodeLine{02781\ \ \ \ \ |\ hb\_any}
\DoxyCodeLine{02782\ \ \ \ \ ;}
\DoxyCodeLine{02783\ \ \ \}}
\DoxyCodeLine{02784\ }
\DoxyCodeLine{02785\ \ \ \textcolor{keywordtype}{bool}\ apply\ (\mbox{\hyperlink{struct_o_t_1_1hb__ot__apply__context__t}{hb\_ot\_apply\_context\_t}}\ *c,\ \mbox{\hyperlink{struct_o_t_1_1_chain_context_apply_lookup_context}{ChainContextApplyLookupContext}}\ \&lookup\_context)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02786\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02787\ \ \ \ \ TRACE\_APPLY\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02788\ \ \ \ \ return\_trace\ (}
\DoxyCodeLine{02789\ \ \ \ \ +\ hb\_iter\ (rule)}
\DoxyCodeLine{02790\ \ \ \ \ |\ hb\_map\ (hb\_add\ (\textcolor{keyword}{this}))}
\DoxyCodeLine{02791\ \ \ \ \ |\ hb\_map\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_chain_rule}{ChainRule}}\ \&\_)\ \{\ \textcolor{keywordflow}{return}\ \_.apply\ (c,\ lookup\_context);\ \})}
\DoxyCodeLine{02792\ \ \ \ \ |\ hb\_any}
\DoxyCodeLine{02793\ \ \ \ \ )}
\DoxyCodeLine{02794\ \ \ \ \ ;}
\DoxyCodeLine{02795\ \ \ \}}
\DoxyCodeLine{02796\ }
\DoxyCodeLine{02797\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c,}
\DoxyCodeLine{02798\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *lookup\_map,}
\DoxyCodeLine{02799\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *backtrack\_klass\_map\ =\ \textcolor{keyword}{nullptr},}
\DoxyCodeLine{02800\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *input\_klass\_map\ =\ \textcolor{keyword}{nullptr},}
\DoxyCodeLine{02801\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *lookahead\_klass\_map\ =\ \textcolor{keyword}{nullptr})\textcolor{keyword}{\ const}}
\DoxyCodeLine{02802\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02803\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02804\ }
\DoxyCodeLine{02805\ \ \ \ \ \textcolor{keyword}{auto}\ snap\ =\ c-\/>serializer-\/>snapshot\ ();}
\DoxyCodeLine{02806\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>serializer-\/>start\_embed\ (*\textcolor{keyword}{this});}
\DoxyCodeLine{02807\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>serializer-\/>extend\_min\ (out)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02808\ }
\DoxyCodeLine{02809\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<ChainRule>}}\&\ \_\ :\ rule)}
\DoxyCodeLine{02810\ \ \ \ \ \{}
\DoxyCodeLine{02811\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{02812\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ o\_snap\ =\ c-\/>serializer-\/>snapshot\ ();}
\DoxyCodeLine{02813\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ *o\ =\ out-\/>rule.serialize\_append\ (c-\/>serializer);}
\DoxyCodeLine{02814\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!o))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{02815\ }
\DoxyCodeLine{02816\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!o-\/>serialize\_subset\ (c,\ \_,\ \textcolor{keyword}{this},}
\DoxyCodeLine{02817\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_map,}
\DoxyCodeLine{02818\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ backtrack\_klass\_map,}
\DoxyCodeLine{02819\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ input\_klass\_map,}
\DoxyCodeLine{02820\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookahead\_klass\_map))}
\DoxyCodeLine{02821\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02822\ \ \ \ \ out-\/>rule.pop\ ();}
\DoxyCodeLine{02823\ \ \ \ \ c-\/>serializer-\/>revert\ (o\_snap);}
\DoxyCodeLine{02824\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02825\ \ \ \ \ \}}
\DoxyCodeLine{02826\ }
\DoxyCodeLine{02827\ \ \ \ \ \textcolor{keywordtype}{bool}\ ret\ =\ bool\ (out-\/>rule);}
\DoxyCodeLine{02828\ \ \ \ \ \textcolor{keywordflow}{if}\ (!ret)\ c-\/>serializer-\/>revert\ (snap);}
\DoxyCodeLine{02829\ }
\DoxyCodeLine{02830\ \ \ \ \ return\_trace\ (ret);}
\DoxyCodeLine{02831\ \ \ \}}
\DoxyCodeLine{02832\ }
\DoxyCodeLine{02833\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02834\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02835\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02836\ \ \ \ \ return\_trace\ (rule.sanitize\ (c,\ \textcolor{keyword}{this}));}
\DoxyCodeLine{02837\ \ \ \}}
\DoxyCodeLine{02838\ }
\DoxyCodeLine{02839\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{02840\ \ \ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<ChainRule>}}}
\DoxyCodeLine{02841\ \ \ \ \ \ \ \ \ rule;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Array\ of\ ChainRule\ tables}}
\DoxyCodeLine{02842\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ ordered\ by\ preference\ */}}
\DoxyCodeLine{02843\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{02844\ \ \ DEFINE\_SIZE\_ARRAY\ (2,\ rule);}
\DoxyCodeLine{02845\ \};}
\DoxyCodeLine{02846\ }
\DoxyCodeLine{02847\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_chain_context_format1}{ChainContextFormat1}}}
\DoxyCodeLine{02848\ \{}
\DoxyCodeLine{02849\ \ \ \textcolor{keywordtype}{bool}\ intersects\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02850\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02851\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_chain_context_closure_lookup_context}{ChainContextClosureLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{02852\ \ \ \ \ \ \ \{intersects\_glyph,\ intersected\_glyph\},}
\DoxyCodeLine{02853\ \ \ \ \ \ \ ContextFormat::SimpleContext,}
\DoxyCodeLine{02854\ \ \ \ \ \ \ \{\textcolor{keyword}{nullptr},\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{nullptr}\}}
\DoxyCodeLine{02855\ \ \ \ \ \};}
\DoxyCodeLine{02856\ }
\DoxyCodeLine{02857\ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{02858\ \ \ \ \ +\ hb\_zip\ (\textcolor{keyword}{this}+coverage,\ ruleSet)}
\DoxyCodeLine{02859\ \ \ \ \ |\ hb\_filter\ (*glyphs,\ hb\_first)}
\DoxyCodeLine{02860\ \ \ \ \ |\ hb\_map\ (hb\_second)}
\DoxyCodeLine{02861\ \ \ \ \ |\ hb\_map\ (hb\_add\ (\textcolor{keyword}{this}))}
\DoxyCodeLine{02862\ \ \ \ \ |\ hb\_map\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_chain_rule_set}{ChainRuleSet}}\ \&\_)\ \{\ \textcolor{keywordflow}{return}\ \_.intersects\ (glyphs,\ lookup\_context);\ \})}
\DoxyCodeLine{02863\ \ \ \ \ |\ hb\_any}
\DoxyCodeLine{02864\ \ \ \ \ ;}
\DoxyCodeLine{02865\ \ \ \}}
\DoxyCodeLine{02866\ }
\DoxyCodeLine{02867\ \ \ \textcolor{keywordtype}{bool}\ may\_have\_non\_1to1\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{02868\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};\ \}}
\DoxyCodeLine{02869\ }
\DoxyCodeLine{02870\ \ \ \textcolor{keywordtype}{void}\ closure\ (\mbox{\hyperlink{struct_o_t_1_1hb__closure__context__t}{hb\_closure\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02871\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02872\ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}*\ cur\_active\_glyphs\ =\ \&c-\/>push\_cur\_active\_glyphs\ ();}
\DoxyCodeLine{02873\ \ \ \ \ get\_coverage\ ().intersected\_coverage\_glyphs\ (\&c-\/>previous\_parent\_active\_glyphs\ (),}
\DoxyCodeLine{02874\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cur\_active\_glyphs);}
\DoxyCodeLine{02875\ }
\DoxyCodeLine{02876\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_chain_context_closure_lookup_context}{ChainContextClosureLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{02877\ \ \ \ \ \ \ \{intersects\_glyph,\ intersected\_glyph\},}
\DoxyCodeLine{02878\ \ \ \ \ \ \ ContextFormat::SimpleContext,}
\DoxyCodeLine{02879\ \ \ \ \ \ \ \{\textcolor{keyword}{nullptr},\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{nullptr}\}}
\DoxyCodeLine{02880\ \ \ \ \ \};}
\DoxyCodeLine{02881\ }
\DoxyCodeLine{02882\ \ \ \ \ +\ hb\_zip\ (\textcolor{keyword}{this}+coverage,\ hb\_range\ ((\textcolor{keywordtype}{unsigned})\ ruleSet.len))}
\DoxyCodeLine{02883\ \ \ \ \ |\ hb\_filter\ ([\&]\ (hb\_codepoint\_t\ \_)\ \{}
\DoxyCodeLine{02884\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ c-\/>previous\_parent\_active\_glyphs\ ().has\ (\_);}
\DoxyCodeLine{02885\ \ \ \ \ \},\ hb\_first)}
\DoxyCodeLine{02886\ \ \ \ \ |\ hb\_map\ ([\&](\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__pair__t}{hb\_pair\_t<hb\_codepoint\_t,\ unsigned>}}\ \_)\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structhb__pair__t}{hb\_pair\_t<unsigned,\ const\ ChainRuleSet\&>}}\ (\_.first,\ \textcolor{keyword}{this}+ruleSet[\_.second]);\ \})}
\DoxyCodeLine{02887\ \ \ \ \ |\ hb\_apply\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__pair__t}{hb\_pair\_t<unsigned,\ const\ ChainRuleSet\&>}}\&\ \_)\ \{\ \_.second.closure\ (c,\ \_.first,\ lookup\_context);\ \})}
\DoxyCodeLine{02888\ \ \ \ \ ;}
\DoxyCodeLine{02889\ }
\DoxyCodeLine{02890\ \ \ \ \ c-\/>pop\_cur\_done\_glyphs\ ();}
\DoxyCodeLine{02891\ \ \ \}}
\DoxyCodeLine{02892\ }
\DoxyCodeLine{02893\ \ \ \textcolor{keywordtype}{void}\ closure\_lookups\ (\mbox{\hyperlink{struct_o_t_1_1hb__closure__lookups__context__t}{hb\_closure\_lookups\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02894\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02895\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_chain_context_closure_lookup_context}{ChainContextClosureLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{02896\ \ \ \ \ \ \ \{intersects\_glyph,\ intersected\_glyph\},}
\DoxyCodeLine{02897\ \ \ \ \ \ \ ContextFormat::SimpleContext,}
\DoxyCodeLine{02898\ \ \ \ \ \ \ \{\textcolor{keyword}{nullptr},\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{nullptr}\}}
\DoxyCodeLine{02899\ \ \ \ \ \};}
\DoxyCodeLine{02900\ }
\DoxyCodeLine{02901\ \ \ \ \ +\ hb\_zip\ (\textcolor{keyword}{this}+coverage,\ ruleSet)}
\DoxyCodeLine{02902\ \ \ \ \ |\ hb\_filter\ (*c-\/>glyphs,\ hb\_first)}
\DoxyCodeLine{02903\ \ \ \ \ |\ hb\_map\ (hb\_second)}
\DoxyCodeLine{02904\ \ \ \ \ |\ hb\_map\ (hb\_add\ (\textcolor{keyword}{this}))}
\DoxyCodeLine{02905\ \ \ \ \ |\ hb\_apply\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_chain_rule_set}{ChainRuleSet}}\ \&\_)\ \{\ \_.closure\_lookups\ (c,\ lookup\_context);\ \})}
\DoxyCodeLine{02906\ \ \ \ \ ;}
\DoxyCodeLine{02907\ \ \ \}}
\DoxyCodeLine{02908\ }
\DoxyCodeLine{02909\ \ \ \textcolor{keywordtype}{void}\ collect\_variation\_indices\ (\mbox{\hyperlink{struct_o_t_1_1hb__collect__variation__indices__context__t}{hb\_collect\_variation\_indices\_context\_t}}\ *c)\textcolor{keyword}{\ const\ }\{\}}
\DoxyCodeLine{02910\ }
\DoxyCodeLine{02911\ \ \ \textcolor{keywordtype}{void}\ collect\_glyphs\ (\mbox{\hyperlink{struct_o_t_1_1hb__collect__glyphs__context__t}{hb\_collect\_glyphs\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02912\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02913\ \ \ \ \ (\textcolor{keyword}{this}+coverage).collect\_coverage\ (c-\/>input);}
\DoxyCodeLine{02914\ }
\DoxyCodeLine{02915\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_chain_context_collect_glyphs_lookup_context}{ChainContextCollectGlyphsLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{02916\ \ \ \ \ \ \ \{collect\_glyph\},}
\DoxyCodeLine{02917\ \ \ \ \ \ \ \{\textcolor{keyword}{nullptr},\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{nullptr}\}}
\DoxyCodeLine{02918\ \ \ \ \ \};}
\DoxyCodeLine{02919\ }
\DoxyCodeLine{02920\ \ \ \ \ +\ hb\_iter\ (ruleSet)}
\DoxyCodeLine{02921\ \ \ \ \ |\ hb\_map\ (hb\_add\ (\textcolor{keyword}{this}))}
\DoxyCodeLine{02922\ \ \ \ \ |\ hb\_apply\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_chain_rule_set}{ChainRuleSet}}\ \&\_)\ \{\ \_.collect\_glyphs\ (c,\ lookup\_context);\ \})}
\DoxyCodeLine{02923\ \ \ \ \ ;}
\DoxyCodeLine{02924\ \ \ \}}
\DoxyCodeLine{02925\ }
\DoxyCodeLine{02926\ \ \ \textcolor{keywordtype}{bool}\ would\_apply\ (\mbox{\hyperlink{struct_o_t_1_1hb__would__apply__context__t}{hb\_would\_apply\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02927\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02928\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_chain_rule_set}{ChainRuleSet}}\ \&rule\_set\ =\ \textcolor{keyword}{this}+ruleSet[(\textcolor{keyword}{this}+coverage).get\_coverage\ (c-\/>glyphs[0])];}
\DoxyCodeLine{02929\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_chain_context_apply_lookup_context}{ChainContextApplyLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{02930\ \ \ \ \ \ \ \{match\_glyph\},}
\DoxyCodeLine{02931\ \ \ \ \ \ \ \{\textcolor{keyword}{nullptr},\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{nullptr}\}}
\DoxyCodeLine{02932\ \ \ \ \ \};}
\DoxyCodeLine{02933\ \ \ \ \ \textcolor{keywordflow}{return}\ rule\_set.would\_apply\ (c,\ lookup\_context);}
\DoxyCodeLine{02934\ \ \ \}}
\DoxyCodeLine{02935\ }
\DoxyCodeLine{02936\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_coverage}{Coverage}}\ \&get\_coverage\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{this}+coverage;\ \}}
\DoxyCodeLine{02937\ }
\DoxyCodeLine{02938\ \ \ \textcolor{keywordtype}{bool}\ apply\ (\mbox{\hyperlink{struct_o_t_1_1hb__ot__apply__context__t}{hb\_ot\_apply\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02939\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02940\ \ \ \ \ TRACE\_APPLY\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02941\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ index\ =\ (\textcolor{keyword}{this}+coverage).get\_coverage\ (c-\/>buffer-\/>cur().codepoint);}
\DoxyCodeLine{02942\ \ \ \ \ \textcolor{keywordflow}{if}\ (likely\ (index\ ==\ NOT\_COVERED))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02943\ }
\DoxyCodeLine{02944\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_chain_rule_set}{ChainRuleSet}}\ \&rule\_set\ =\ \textcolor{keyword}{this}+ruleSet[index];}
\DoxyCodeLine{02945\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_chain_context_apply_lookup_context}{ChainContextApplyLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{02946\ \ \ \ \ \ \ \{match\_glyph\},}
\DoxyCodeLine{02947\ \ \ \ \ \ \ \{\textcolor{keyword}{nullptr},\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{nullptr}\}}
\DoxyCodeLine{02948\ \ \ \ \ \};}
\DoxyCodeLine{02949\ \ \ \ \ return\_trace\ (rule\_set.apply\ (c,\ lookup\_context));}
\DoxyCodeLine{02950\ \ \ \}}
\DoxyCodeLine{02951\ }
\DoxyCodeLine{02952\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02953\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02954\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02955\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \&glyphset\ =\ *c-\/>plan-\/>glyphset\_gsub\ ();}
\DoxyCodeLine{02956\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ \&glyph\_map\ =\ *c-\/>plan-\/>glyph\_map;}
\DoxyCodeLine{02957\ }
\DoxyCodeLine{02958\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>serializer-\/>start\_embed\ (*\textcolor{keyword}{this});}
\DoxyCodeLine{02959\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>serializer-\/>extend\_min\ (out)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{02960\ \ \ \ \ out-\/>format\ =\ format;}
\DoxyCodeLine{02961\ }
\DoxyCodeLine{02962\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *lookup\_map\ =\ c-\/>table\_tag\ ==\ HB\_OT\_TAG\_GSUB\ ?\ c-\/>plan-\/>gsub\_lookups\ :\ c-\/>plan-\/>gpos\_lookups;}
\DoxyCodeLine{02963\ \ \ \ \ \mbox{\hyperlink{structhb__vector__t}{hb\_sorted\_vector\_t<hb\_codepoint\_t>}}\ new\_coverage;}
\DoxyCodeLine{02964\ \ \ \ \ +\ hb\_zip\ (\textcolor{keyword}{this}+coverage,\ ruleSet)}
\DoxyCodeLine{02965\ \ \ \ \ |\ hb\_filter\ (glyphset,\ hb\_first)}
\DoxyCodeLine{02966\ \ \ \ \ |\ hb\_filter\ (subset\_offset\_array\ (c,\ out-\/>ruleSet,\ \textcolor{keyword}{this},\ lookup\_map),\ hb\_second)}
\DoxyCodeLine{02967\ \ \ \ \ |\ hb\_map\ (hb\_first)}
\DoxyCodeLine{02968\ \ \ \ \ |\ hb\_map\ (glyph\_map)}
\DoxyCodeLine{02969\ \ \ \ \ |\ hb\_sink\ (new\_coverage)}
\DoxyCodeLine{02970\ \ \ \ \ ;}
\DoxyCodeLine{02971\ }
\DoxyCodeLine{02972\ \ \ \ \ out-\/>coverage.serialize\_serialize\ (c-\/>serializer,\ new\_coverage.iter\ ());}
\DoxyCodeLine{02973\ \ \ \ \ return\_trace\ (\textcolor{keywordtype}{bool}\ (new\_coverage));}
\DoxyCodeLine{02974\ \ \ \}}
\DoxyCodeLine{02975\ }
\DoxyCodeLine{02976\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02977\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02978\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{02979\ \ \ \ \ return\_trace\ (coverage.sanitize\ (c,\ \textcolor{keyword}{this})\ \&\&\ ruleSet.sanitize\ (c,\ \textcolor{keyword}{this}));}
\DoxyCodeLine{02980\ \ \ \}}
\DoxyCodeLine{02981\ }
\DoxyCodeLine{02982\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{02983\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ format;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Format\ identifier-\/-\/format\ =\ 1\ */}}
\DoxyCodeLine{02984\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<Coverage>}}}
\DoxyCodeLine{02985\ \ \ \ \ \ \ \ \ coverage;\ \ \ \ \ \ \ \textcolor{comment}{/*\ Offset\ to\ Coverage\ table-\/-\/from}}
\DoxyCodeLine{02986\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ beginning\ of\ table\ */}}
\DoxyCodeLine{02987\ \ \ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<ChainRuleSet>}}}
\DoxyCodeLine{02988\ \ \ \ \ \ \ \ \ ruleSet;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Array\ of\ ChainRuleSet\ tables}}
\DoxyCodeLine{02989\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ ordered\ by\ Coverage\ Index\ */}}
\DoxyCodeLine{02990\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{02991\ \ \ DEFINE\_SIZE\_ARRAY\ (6,\ ruleSet);}
\DoxyCodeLine{02992\ \};}
\DoxyCodeLine{02993\ }
\DoxyCodeLine{02994\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_chain_context_format2}{ChainContextFormat2}}}
\DoxyCodeLine{02995\ \{}
\DoxyCodeLine{02996\ \ \ \textcolor{keywordtype}{bool}\ intersects\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{02997\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{02998\ \ \ \ \ \textcolor{keywordflow}{if}\ (!(\textcolor{keyword}{this}+coverage).intersects\ (glyphs))}
\DoxyCodeLine{02999\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03000\ }
\DoxyCodeLine{03001\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_class_def}{ClassDef}}\ \&backtrack\_class\_def\ =\ \textcolor{keyword}{this}+backtrackClassDef;}
\DoxyCodeLine{03002\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_class_def}{ClassDef}}\ \&input\_class\_def\ =\ \textcolor{keyword}{this}+inputClassDef;}
\DoxyCodeLine{03003\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_class_def}{ClassDef}}\ \&lookahead\_class\_def\ =\ \textcolor{keyword}{this}+lookaheadClassDef;}
\DoxyCodeLine{03004\ }
\DoxyCodeLine{03005\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_chain_context_closure_lookup_context}{ChainContextClosureLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{03006\ \ \ \ \ \ \ \{intersects\_class,\ intersected\_class\_glyphs\},}
\DoxyCodeLine{03007\ \ \ \ \ \ \ ContextFormat::ClassBasedContext,}
\DoxyCodeLine{03008\ \ \ \ \ \ \ \{\&backtrack\_class\_def,}
\DoxyCodeLine{03009\ \ \ \ \ \ \ \ \&input\_class\_def,}
\DoxyCodeLine{03010\ \ \ \ \ \ \ \ \&lookahead\_class\_def\}}
\DoxyCodeLine{03011\ \ \ \ \ \};}
\DoxyCodeLine{03012\ }
\DoxyCodeLine{03013\ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ retained\_coverage\_glyphs;}
\DoxyCodeLine{03014\ \ \ \ \ (\textcolor{keyword}{this}+coverage).intersected\_coverage\_glyphs\ (glyphs,\ \&retained\_coverage\_glyphs);}
\DoxyCodeLine{03015\ }
\DoxyCodeLine{03016\ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ coverage\_glyph\_classes;}
\DoxyCodeLine{03017\ \ \ \ \ input\_class\_def.intersected\_classes\ (\&retained\_coverage\_glyphs,\ \&coverage\_glyph\_classes);}
\DoxyCodeLine{03018\ }
\DoxyCodeLine{03019\ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{03020\ \ \ \ \ +\ hb\_iter\ (ruleSet)}
\DoxyCodeLine{03021\ \ \ \ \ |\ hb\_map\ (hb\_add\ (\textcolor{keyword}{this}))}
\DoxyCodeLine{03022\ \ \ \ \ |\ hb\_enumerate}
\DoxyCodeLine{03023\ \ \ \ \ |\ hb\_map\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__pair__t}{hb\_pair\_t<unsigned,\ const\ ChainRuleSet\ \&>}}\ p)}
\DoxyCodeLine{03024\ \ \ \ \ \ \ \ \ \ \ \{\ \textcolor{keywordflow}{return}\ input\_class\_def.intersects\_class\ (glyphs,\ p.first)\ \&\&}
\DoxyCodeLine{03025\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coverage\_glyph\_classes.has\ (p.first)\ \&\&}
\DoxyCodeLine{03026\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p.second.intersects\ (glyphs,\ lookup\_context);\ \})}
\DoxyCodeLine{03027\ \ \ \ \ |\ hb\_any}
\DoxyCodeLine{03028\ \ \ \ \ ;}
\DoxyCodeLine{03029\ \ \ \}}
\DoxyCodeLine{03030\ }
\DoxyCodeLine{03031\ \ \ \textcolor{keywordtype}{bool}\ may\_have\_non\_1to1\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{03032\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};\ \}}
\DoxyCodeLine{03033\ }
\DoxyCodeLine{03034\ \ \ \textcolor{keywordtype}{void}\ closure\ (\mbox{\hyperlink{struct_o_t_1_1hb__closure__context__t}{hb\_closure\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03035\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03036\ \ \ \ \ \textcolor{keywordflow}{if}\ (!(\textcolor{keyword}{this}+coverage).intersects\ (c-\/>glyphs))}
\DoxyCodeLine{03037\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{03038\ }
\DoxyCodeLine{03039\ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}*\ cur\_active\_glyphs\ =\ \&c-\/>push\_cur\_active\_glyphs\ ();}
\DoxyCodeLine{03040\ \ \ \ \ get\_coverage\ ().intersected\_coverage\_glyphs\ (\&c-\/>previous\_parent\_active\_glyphs\ (),}
\DoxyCodeLine{03041\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cur\_active\_glyphs);}
\DoxyCodeLine{03042\ }
\DoxyCodeLine{03043\ }
\DoxyCodeLine{03044\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_class_def}{ClassDef}}\ \&backtrack\_class\_def\ =\ \textcolor{keyword}{this}+backtrackClassDef;}
\DoxyCodeLine{03045\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_class_def}{ClassDef}}\ \&input\_class\_def\ =\ \textcolor{keyword}{this}+inputClassDef;}
\DoxyCodeLine{03046\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_class_def}{ClassDef}}\ \&lookahead\_class\_def\ =\ \textcolor{keyword}{this}+lookaheadClassDef;}
\DoxyCodeLine{03047\ }
\DoxyCodeLine{03048\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_chain_context_closure_lookup_context}{ChainContextClosureLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{03049\ \ \ \ \ \ \ \{intersects\_class,\ intersected\_class\_glyphs\},}
\DoxyCodeLine{03050\ \ \ \ \ \ \ ContextFormat::ClassBasedContext,}
\DoxyCodeLine{03051\ \ \ \ \ \ \ \{\&backtrack\_class\_def,}
\DoxyCodeLine{03052\ \ \ \ \ \ \ \ \&input\_class\_def,}
\DoxyCodeLine{03053\ \ \ \ \ \ \ \ \&lookahead\_class\_def\}}
\DoxyCodeLine{03054\ \ \ \ \ \};}
\DoxyCodeLine{03055\ }
\DoxyCodeLine{03056\ \ \ \ \ +\ hb\_enumerate\ (ruleSet)}
\DoxyCodeLine{03057\ \ \ \ \ |\ hb\_filter\ ([\&]\ (\textcolor{keywordtype}{unsigned}\ \_)}
\DoxyCodeLine{03058\ \ \ \ \ \{\ \textcolor{keywordflow}{return}\ input\_class\_def.intersects\_class\ (\&c-\/>parent\_active\_glyphs\ (),\ \_);\ \},}
\DoxyCodeLine{03059\ \ \ \ \ \ \ \ \ \ hb\_first)}
\DoxyCodeLine{03060\ \ \ \ \ |\ hb\_apply\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__pair__t}{hb\_pair\_t}}<\textcolor{keywordtype}{unsigned},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<ChainRuleSet>}}\&>\ \_)}
\DoxyCodeLine{03061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_chain_rule_set}{ChainRuleSet}}\&\ chainrule\_set\ =\ \textcolor{keyword}{this}+\_.second;}
\DoxyCodeLine{03063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ chainrule\_set.closure\ (c,\ \_.first,\ lookup\_context);}
\DoxyCodeLine{03064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \})}
\DoxyCodeLine{03065\ \ \ \ \ ;}
\DoxyCodeLine{03066\ }
\DoxyCodeLine{03067\ \ \ \ \ c-\/>pop\_cur\_done\_glyphs\ ();}
\DoxyCodeLine{03068\ \ \ \}}
\DoxyCodeLine{03069\ }
\DoxyCodeLine{03070\ \ \ \textcolor{keywordtype}{void}\ closure\_lookups\ (\mbox{\hyperlink{struct_o_t_1_1hb__closure__lookups__context__t}{hb\_closure\_lookups\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03071\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03072\ \ \ \ \ \textcolor{keywordflow}{if}\ (!(\textcolor{keyword}{this}+coverage).intersects\ (c-\/>glyphs))}
\DoxyCodeLine{03073\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{03074\ }
\DoxyCodeLine{03075\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_class_def}{ClassDef}}\ \&backtrack\_class\_def\ =\ \textcolor{keyword}{this}+backtrackClassDef;}
\DoxyCodeLine{03076\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_class_def}{ClassDef}}\ \&input\_class\_def\ =\ \textcolor{keyword}{this}+inputClassDef;}
\DoxyCodeLine{03077\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_class_def}{ClassDef}}\ \&lookahead\_class\_def\ =\ \textcolor{keyword}{this}+lookaheadClassDef;}
\DoxyCodeLine{03078\ }
\DoxyCodeLine{03079\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_chain_context_closure_lookup_context}{ChainContextClosureLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{03080\ \ \ \ \ \ \ \{intersects\_class,\ intersected\_class\_glyphs\},}
\DoxyCodeLine{03081\ \ \ \ \ \ \ ContextFormat::ClassBasedContext,}
\DoxyCodeLine{03082\ \ \ \ \ \ \ \{\&backtrack\_class\_def,}
\DoxyCodeLine{03083\ \ \ \ \ \ \ \ \&input\_class\_def,}
\DoxyCodeLine{03084\ \ \ \ \ \ \ \ \&lookahead\_class\_def\}}
\DoxyCodeLine{03085\ \ \ \ \ \};}
\DoxyCodeLine{03086\ }
\DoxyCodeLine{03087\ \ \ \ \ +\ hb\_iter\ (ruleSet)}
\DoxyCodeLine{03088\ \ \ \ \ |\ hb\_map\ (hb\_add\ (\textcolor{keyword}{this}))}
\DoxyCodeLine{03089\ \ \ \ \ |\ hb\_enumerate}
\DoxyCodeLine{03090\ \ \ \ \ |\ hb\_filter([\&]\ (\textcolor{keywordtype}{unsigned}\ klass)}
\DoxyCodeLine{03091\ \ \ \ \ \{\ \textcolor{keywordflow}{return}\ input\_class\_def.intersects\_class\ (c-\/>glyphs,\ klass);\ \},\ hb\_first)}
\DoxyCodeLine{03092\ \ \ \ \ |\ hb\_map\ (hb\_second)}
\DoxyCodeLine{03093\ \ \ \ \ |\ hb\_apply\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_chain_rule_set}{ChainRuleSet}}\ \&\_)}
\DoxyCodeLine{03094\ \ \ \ \ \{\ \_.closure\_lookups\ (c,\ lookup\_context);\ \})}
\DoxyCodeLine{03095\ \ \ \ \ ;}
\DoxyCodeLine{03096\ \ \ \}}
\DoxyCodeLine{03097\ }
\DoxyCodeLine{03098\ \ \ \textcolor{keywordtype}{void}\ collect\_variation\_indices\ (\mbox{\hyperlink{struct_o_t_1_1hb__collect__variation__indices__context__t}{hb\_collect\_variation\_indices\_context\_t}}\ *c)\textcolor{keyword}{\ const\ }\{\}}
\DoxyCodeLine{03099\ }
\DoxyCodeLine{03100\ \ \ \textcolor{keywordtype}{void}\ collect\_glyphs\ (\mbox{\hyperlink{struct_o_t_1_1hb__collect__glyphs__context__t}{hb\_collect\_glyphs\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03101\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03102\ \ \ \ \ (\textcolor{keyword}{this}+coverage).collect\_coverage\ (c-\/>input);}
\DoxyCodeLine{03103\ }
\DoxyCodeLine{03104\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_class_def}{ClassDef}}\ \&backtrack\_class\_def\ =\ \textcolor{keyword}{this}+backtrackClassDef;}
\DoxyCodeLine{03105\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_class_def}{ClassDef}}\ \&input\_class\_def\ =\ \textcolor{keyword}{this}+inputClassDef;}
\DoxyCodeLine{03106\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_class_def}{ClassDef}}\ \&lookahead\_class\_def\ =\ \textcolor{keyword}{this}+lookaheadClassDef;}
\DoxyCodeLine{03107\ }
\DoxyCodeLine{03108\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_chain_context_collect_glyphs_lookup_context}{ChainContextCollectGlyphsLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{03109\ \ \ \ \ \ \ \{collect\_class\},}
\DoxyCodeLine{03110\ \ \ \ \ \ \ \{\&backtrack\_class\_def,}
\DoxyCodeLine{03111\ \ \ \ \ \ \ \ \&input\_class\_def,}
\DoxyCodeLine{03112\ \ \ \ \ \ \ \ \&lookahead\_class\_def\}}
\DoxyCodeLine{03113\ \ \ \ \ \};}
\DoxyCodeLine{03114\ }
\DoxyCodeLine{03115\ \ \ \ \ +\ hb\_iter\ (ruleSet)}
\DoxyCodeLine{03116\ \ \ \ \ |\ hb\_map\ (hb\_add\ (\textcolor{keyword}{this}))}
\DoxyCodeLine{03117\ \ \ \ \ |\ hb\_apply\ ([\&]\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_chain_rule_set}{ChainRuleSet}}\ \&\_)\ \{\ \_.collect\_glyphs\ (c,\ lookup\_context);\ \})}
\DoxyCodeLine{03118\ \ \ \ \ ;}
\DoxyCodeLine{03119\ \ \ \}}
\DoxyCodeLine{03120\ }
\DoxyCodeLine{03121\ \ \ \textcolor{keywordtype}{bool}\ would\_apply\ (\mbox{\hyperlink{struct_o_t_1_1hb__would__apply__context__t}{hb\_would\_apply\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03122\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03123\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_class_def}{ClassDef}}\ \&backtrack\_class\_def\ =\ \textcolor{keyword}{this}+backtrackClassDef;}
\DoxyCodeLine{03124\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_class_def}{ClassDef}}\ \&input\_class\_def\ =\ \textcolor{keyword}{this}+inputClassDef;}
\DoxyCodeLine{03125\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_class_def}{ClassDef}}\ \&lookahead\_class\_def\ =\ \textcolor{keyword}{this}+lookaheadClassDef;}
\DoxyCodeLine{03126\ }
\DoxyCodeLine{03127\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ index\ =\ input\_class\_def.get\_class\ (c-\/>glyphs[0]);}
\DoxyCodeLine{03128\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_chain_rule_set}{ChainRuleSet}}\ \&rule\_set\ =\ \textcolor{keyword}{this}+ruleSet[index];}
\DoxyCodeLine{03129\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_chain_context_apply_lookup_context}{ChainContextApplyLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{03130\ \ \ \ \ \ \ \{match\_class\},}
\DoxyCodeLine{03131\ \ \ \ \ \ \ \{\&backtrack\_class\_def,}
\DoxyCodeLine{03132\ \ \ \ \ \ \ \ \&input\_class\_def,}
\DoxyCodeLine{03133\ \ \ \ \ \ \ \ \&lookahead\_class\_def\}}
\DoxyCodeLine{03134\ \ \ \ \ \};}
\DoxyCodeLine{03135\ \ \ \ \ \textcolor{keywordflow}{return}\ rule\_set.would\_apply\ (c,\ lookup\_context);}
\DoxyCodeLine{03136\ \ \ \}}
\DoxyCodeLine{03137\ }
\DoxyCodeLine{03138\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_coverage}{Coverage}}\ \&get\_coverage\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{this}+coverage;\ \}}
\DoxyCodeLine{03139\ }
\DoxyCodeLine{03140\ \ \ \textcolor{keywordtype}{bool}\ apply\ (\mbox{\hyperlink{struct_o_t_1_1hb__ot__apply__context__t}{hb\_ot\_apply\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03141\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03142\ \ \ \ \ TRACE\_APPLY\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03143\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ index\ =\ (\textcolor{keyword}{this}+coverage).get\_coverage\ (c-\/>buffer-\/>cur().codepoint);}
\DoxyCodeLine{03144\ \ \ \ \ \textcolor{keywordflow}{if}\ (likely\ (index\ ==\ NOT\_COVERED))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{03145\ }
\DoxyCodeLine{03146\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_class_def}{ClassDef}}\ \&backtrack\_class\_def\ =\ \textcolor{keyword}{this}+backtrackClassDef;}
\DoxyCodeLine{03147\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_class_def}{ClassDef}}\ \&input\_class\_def\ =\ \textcolor{keyword}{this}+inputClassDef;}
\DoxyCodeLine{03148\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_class_def}{ClassDef}}\ \&lookahead\_class\_def\ =\ \textcolor{keyword}{this}+lookaheadClassDef;}
\DoxyCodeLine{03149\ }
\DoxyCodeLine{03150\ \ \ \ \ index\ =\ input\_class\_def.get\_class\ (c-\/>buffer-\/>cur().codepoint);}
\DoxyCodeLine{03151\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_chain_rule_set}{ChainRuleSet}}\ \&rule\_set\ =\ \textcolor{keyword}{this}+ruleSet[index];}
\DoxyCodeLine{03152\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_chain_context_apply_lookup_context}{ChainContextApplyLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{03153\ \ \ \ \ \ \ \{match\_class\},}
\DoxyCodeLine{03154\ \ \ \ \ \ \ \{\&backtrack\_class\_def,}
\DoxyCodeLine{03155\ \ \ \ \ \ \ \ \&input\_class\_def,}
\DoxyCodeLine{03156\ \ \ \ \ \ \ \ \&lookahead\_class\_def\}}
\DoxyCodeLine{03157\ \ \ \ \ \};}
\DoxyCodeLine{03158\ \ \ \ \ return\_trace\ (rule\_set.apply\ (c,\ lookup\_context));}
\DoxyCodeLine{03159\ \ \ \}}
\DoxyCodeLine{03160\ }
\DoxyCodeLine{03161\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03162\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03163\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03164\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>serializer-\/>start\_embed\ (*\textcolor{keyword}{this});}
\DoxyCodeLine{03165\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>serializer-\/>extend\_min\ (out)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{03166\ \ \ \ \ out-\/>format\ =\ format;}
\DoxyCodeLine{03167\ \ \ \ \ out-\/>coverage.serialize\_subset\ (c,\ coverage,\ \textcolor{keyword}{this});}
\DoxyCodeLine{03168\ }
\DoxyCodeLine{03169\ \ \ \ \ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ backtrack\_klass\_map;}
\DoxyCodeLine{03170\ \ \ \ \ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ input\_klass\_map;}
\DoxyCodeLine{03171\ \ \ \ \ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ lookahead\_klass\_map;}
\DoxyCodeLine{03172\ }
\DoxyCodeLine{03173\ \ \ \ \ out-\/>backtrackClassDef.serialize\_subset\ (c,\ backtrackClassDef,\ \textcolor{keyword}{this},\ \&backtrack\_klass\_map);}
\DoxyCodeLine{03174\ \ \ \ \ \textcolor{comment}{//\ TODO:\ subset\ inputClassDef\ based\ on\ glyphs\ survived\ in\ Coverage\ subsetting}}
\DoxyCodeLine{03175\ \ \ \ \ out-\/>inputClassDef.serialize\_subset\ (c,\ inputClassDef,\ \textcolor{keyword}{this},\ \&input\_klass\_map);}
\DoxyCodeLine{03176\ \ \ \ \ out-\/>lookaheadClassDef.serialize\_subset\ (c,\ lookaheadClassDef,\ \textcolor{keyword}{this},\ \&lookahead\_klass\_map);}
\DoxyCodeLine{03177\ }
\DoxyCodeLine{03178\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>serializer-\/>propagate\_error\ (backtrack\_klass\_map,}
\DoxyCodeLine{03179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ input\_klass\_map,}
\DoxyCodeLine{03180\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookahead\_klass\_map)))}
\DoxyCodeLine{03181\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{03182\ }
\DoxyCodeLine{03183\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}*\ glyphset\ =\ c-\/>plan-\/>glyphset\_gsub\ ();}
\DoxyCodeLine{03184\ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ retained\_coverage\_glyphs;}
\DoxyCodeLine{03185\ \ \ \ \ (\textcolor{keyword}{this}+coverage).intersected\_coverage\_glyphs\ (glyphset,\ \&retained\_coverage\_glyphs);}
\DoxyCodeLine{03186\ }
\DoxyCodeLine{03187\ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ coverage\_glyph\_classes;}
\DoxyCodeLine{03188\ \ \ \ \ (\textcolor{keyword}{this}+inputClassDef).intersected\_classes\ (\&retained\_coverage\_glyphs,\ \&coverage\_glyph\_classes);}
\DoxyCodeLine{03189\ }
\DoxyCodeLine{03190\ \ \ \ \ \textcolor{keywordtype}{int}\ non\_zero\_index\ =\ -\/1,\ index\ =\ 0;}
\DoxyCodeLine{03191\ \ \ \ \ \textcolor{keywordtype}{bool}\ ret\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03192\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *lookup\_map\ =\ c-\/>table\_tag\ ==\ HB\_OT\_TAG\_GSUB\ ?\ c-\/>plan-\/>gsub\_lookups\ :\ c-\/>plan-\/>gpos\_lookups;}
\DoxyCodeLine{03193\ \ \ \ \ \textcolor{keyword}{auto}\ last\_non\_zero\ =\ c-\/>serializer-\/>snapshot\ ();}
\DoxyCodeLine{03194\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \_\ :\ +\ hb\_enumerate\ (ruleSet)}
\DoxyCodeLine{03195\ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ hb\_filter\ (input\_klass\_map,\ hb\_first))}
\DoxyCodeLine{03196\ \ \ \ \ \{}
\DoxyCodeLine{03197\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ *o\ =\ out-\/>ruleSet.serialize\_append\ (c-\/>serializer);}
\DoxyCodeLine{03198\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!o))}
\DoxyCodeLine{03199\ \ \ \ \ \ \ \{}
\DoxyCodeLine{03200\ \ \ \ \ ret\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03201\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03202\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03203\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (coverage\_glyph\_classes.has\ (\_.first)\ \&\&}
\DoxyCodeLine{03204\ \ \ \ \ \ \ \ \ \ \ o-\/>serialize\_subset\ (c,\ \_.second,\ \textcolor{keyword}{this},}
\DoxyCodeLine{03205\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_map,}
\DoxyCodeLine{03206\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&backtrack\_klass\_map,}
\DoxyCodeLine{03207\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&input\_klass\_map,}
\DoxyCodeLine{03208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&lookahead\_klass\_map))}
\DoxyCodeLine{03209\ \ \ \ \ \ \ \{}
\DoxyCodeLine{03210\ \ \ \ \ \ \ \ \ last\_non\_zero\ =\ c-\/>serializer-\/>snapshot\ ();}
\DoxyCodeLine{03211\ \ \ \ \ non\_zero\_index\ =\ index;}
\DoxyCodeLine{03212\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03213\ }
\DoxyCodeLine{03214\ \ \ \ \ \ \ index++;}
\DoxyCodeLine{03215\ \ \ \ \ \}}
\DoxyCodeLine{03216\ }
\DoxyCodeLine{03217\ \ \ \ \ \textcolor{keywordflow}{if}\ (!ret\ ||\ non\_zero\_index\ ==\ -\/1)\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{03218\ }
\DoxyCodeLine{03219\ \ \ \ \ \textcolor{comment}{//\ prune\ empty\ trailing\ ruleSets}}
\DoxyCodeLine{03220\ \ \ \ \ \textcolor{keywordflow}{if}\ (index\ >\ non\_zero\_index)\ \{}
\DoxyCodeLine{03221\ \ \ \ \ \ \ c-\/>serializer-\/>revert\ (last\_non\_zero);}
\DoxyCodeLine{03222\ \ \ \ \ \ \ out-\/>ruleSet.len\ =\ non\_zero\_index\ +\ 1;}
\DoxyCodeLine{03223\ \ \ \ \ \}}
\DoxyCodeLine{03224\ }
\DoxyCodeLine{03225\ \ \ \ \ return\_trace\ (\textcolor{keywordtype}{bool}\ (out-\/>ruleSet));}
\DoxyCodeLine{03226\ \ \ \}}
\DoxyCodeLine{03227\ }
\DoxyCodeLine{03228\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03229\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03230\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03231\ \ \ \ \ return\_trace\ (coverage.sanitize\ (c,\ \textcolor{keyword}{this})\ \&\&}
\DoxyCodeLine{03232\ \ \ \ \ \ \ \ \ \ \ backtrackClassDef.sanitize\ (c,\ \textcolor{keyword}{this})\ \&\&}
\DoxyCodeLine{03233\ \ \ \ \ \ \ \ \ \ \ inputClassDef.sanitize\ (c,\ \textcolor{keyword}{this})\ \&\&}
\DoxyCodeLine{03234\ \ \ \ \ \ \ \ \ \ \ lookaheadClassDef.sanitize\ (c,\ \textcolor{keyword}{this})\ \&\&}
\DoxyCodeLine{03235\ \ \ \ \ \ \ \ \ \ \ ruleSet.sanitize\ (c,\ \textcolor{keyword}{this}));}
\DoxyCodeLine{03236\ \ \ \}}
\DoxyCodeLine{03237\ }
\DoxyCodeLine{03238\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{03239\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ format;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Format\ identifier-\/-\/format\ =\ 2\ */}}
\DoxyCodeLine{03240\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<Coverage>}}}
\DoxyCodeLine{03241\ \ \ \ \ \ \ \ \ coverage;\ \ \ \ \ \ \ \textcolor{comment}{/*\ Offset\ to\ Coverage\ table-\/-\/from}}
\DoxyCodeLine{03242\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ beginning\ of\ table\ */}}
\DoxyCodeLine{03243\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<ClassDef>}}}
\DoxyCodeLine{03244\ \ \ \ \ \ \ \ \ backtrackClassDef;\ \ \textcolor{comment}{/*\ Offset\ to\ glyph\ ClassDef\ table}}
\DoxyCodeLine{03245\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ containing\ backtrack\ sequence}}
\DoxyCodeLine{03246\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ data-\/-\/from\ beginning\ of\ table\ */}}
\DoxyCodeLine{03247\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<ClassDef>}}}
\DoxyCodeLine{03248\ \ \ \ \ \ \ \ \ inputClassDef;\ \ \ \ \ \ \textcolor{comment}{/*\ Offset\ to\ glyph\ ClassDef}}
\DoxyCodeLine{03249\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ table\ containing\ input\ sequence}}
\DoxyCodeLine{03250\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ data-\/-\/from\ beginning\ of\ table\ */}}
\DoxyCodeLine{03251\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<ClassDef>}}}
\DoxyCodeLine{03252\ \ \ \ \ \ \ \ \ lookaheadClassDef;\ \ \textcolor{comment}{/*\ Offset\ to\ glyph\ ClassDef\ table}}
\DoxyCodeLine{03253\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ containing\ lookahead\ sequence}}
\DoxyCodeLine{03254\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ data-\/-\/from\ beginning\ of\ table\ */}}
\DoxyCodeLine{03255\ \ \ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<ChainRuleSet>}}}
\DoxyCodeLine{03256\ \ \ \ \ \ \ \ \ ruleSet;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Array\ of\ ChainRuleSet\ tables}}
\DoxyCodeLine{03257\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ ordered\ by\ class\ */}}
\DoxyCodeLine{03258\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{03259\ \ \ DEFINE\_SIZE\_ARRAY\ (12,\ ruleSet);}
\DoxyCodeLine{03260\ \};}
\DoxyCodeLine{03261\ }
\DoxyCodeLine{03262\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_chain_context_format3}{ChainContextFormat3}}}
\DoxyCodeLine{03263\ \{}
\DoxyCodeLine{03264\ \ \ \textcolor{keywordtype}{bool}\ intersects\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03265\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03266\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<Coverage>}}\ \&\mbox{\hyperlink{structinput}{input}}\ =\ StructAfter<Array16OfOffset16To<Coverage>>\ (backtrack);}
\DoxyCodeLine{03267\ }
\DoxyCodeLine{03268\ \ \ \ \ \textcolor{keywordflow}{if}\ (!(\textcolor{keyword}{this}+\mbox{\hyperlink{structinput}{input}}[0]).intersects\ (glyphs))}
\DoxyCodeLine{03269\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03270\ }
\DoxyCodeLine{03271\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<Coverage>}}\ \&lookahead\ =\ StructAfter<Array16OfOffset16To<Coverage>>\ (\mbox{\hyperlink{structinput}{input}});}
\DoxyCodeLine{03272\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_chain_context_closure_lookup_context}{ChainContextClosureLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{03273\ \ \ \ \ \ \ \{intersects\_coverage,\ intersected\_coverage\_glyphs\},}
\DoxyCodeLine{03274\ \ \ \ \ \ \ ContextFormat::CoverageBasedContext,}
\DoxyCodeLine{03275\ \ \ \ \ \ \ \{\textcolor{keyword}{this},\ \textcolor{keyword}{this},\ \textcolor{keyword}{this}\}}
\DoxyCodeLine{03276\ \ \ \ \ \};}
\DoxyCodeLine{03277\ \ \ \ \ \textcolor{keywordflow}{return}\ chain\_context\_intersects\ (glyphs,}
\DoxyCodeLine{03278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ backtrack.len,\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *)\ backtrack.arrayZ,}
\DoxyCodeLine{03279\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structinput}{input}}.len,\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *)\ \mbox{\hyperlink{structinput}{input}}.arrayZ\ +\ 1,}
\DoxyCodeLine{03280\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookahead.len,\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *)\ lookahead.arrayZ,}
\DoxyCodeLine{03281\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_context);}
\DoxyCodeLine{03282\ \ \ \}}
\DoxyCodeLine{03283\ }
\DoxyCodeLine{03284\ \ \ \textcolor{keywordtype}{bool}\ may\_have\_non\_1to1\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{03285\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};\ \}}
\DoxyCodeLine{03286\ }
\DoxyCodeLine{03287\ \ \ \textcolor{keywordtype}{void}\ closure\ (\mbox{\hyperlink{struct_o_t_1_1hb__closure__context__t}{hb\_closure\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03288\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03289\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<Coverage>}}\ \&\mbox{\hyperlink{structinput}{input}}\ =\ StructAfter<Array16OfOffset16To<Coverage>>\ (backtrack);}
\DoxyCodeLine{03290\ }
\DoxyCodeLine{03291\ \ \ \ \ \textcolor{keywordflow}{if}\ (!(\textcolor{keyword}{this}+\mbox{\hyperlink{structinput}{input}}[0]).intersects\ (c-\/>glyphs))}
\DoxyCodeLine{03292\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{03293\ }
\DoxyCodeLine{03294\ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}*\ cur\_active\_glyphs\ =\ \&c-\/>push\_cur\_active\_glyphs\ ();}
\DoxyCodeLine{03295\ \ \ \ \ get\_coverage\ ().intersected\_coverage\_glyphs\ (\&c-\/>previous\_parent\_active\_glyphs\ (),}
\DoxyCodeLine{03296\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cur\_active\_glyphs);}
\DoxyCodeLine{03297\ }
\DoxyCodeLine{03298\ }
\DoxyCodeLine{03299\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<Coverage>}}\ \&lookahead\ =\ StructAfter<Array16OfOffset16To<Coverage>>\ (\mbox{\hyperlink{structinput}{input}});}
\DoxyCodeLine{03300\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<LookupRecord>}}\ \&lookup\ =\ StructAfter<Array16Of<LookupRecord>>\ (lookahead);}
\DoxyCodeLine{03301\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_chain_context_closure_lookup_context}{ChainContextClosureLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{03302\ \ \ \ \ \ \ \{intersects\_coverage,\ intersected\_coverage\_glyphs\},}
\DoxyCodeLine{03303\ \ \ \ \ \ \ ContextFormat::CoverageBasedContext,}
\DoxyCodeLine{03304\ \ \ \ \ \ \ \{\textcolor{keyword}{this},\ \textcolor{keyword}{this},\ \textcolor{keyword}{this}\}}
\DoxyCodeLine{03305\ \ \ \ \ \};}
\DoxyCodeLine{03306\ \ \ \ \ chain\_context\_closure\_lookup\ (c,}
\DoxyCodeLine{03307\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ backtrack.len,\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *)\ backtrack.arrayZ,}
\DoxyCodeLine{03308\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structinput}{input}}.len,\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *)\ \mbox{\hyperlink{structinput}{input}}.arrayZ\ +\ 1,}
\DoxyCodeLine{03309\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookahead.len,\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *)\ lookahead.arrayZ,}
\DoxyCodeLine{03310\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup.len,\ lookup.arrayZ,}
\DoxyCodeLine{03311\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0,\ lookup\_context);}
\DoxyCodeLine{03312\ }
\DoxyCodeLine{03313\ \ \ \ \ c-\/>pop\_cur\_done\_glyphs\ ();}
\DoxyCodeLine{03314\ \ \ \}}
\DoxyCodeLine{03315\ }
\DoxyCodeLine{03316\ \ \ \textcolor{keywordtype}{void}\ closure\_lookups\ (\mbox{\hyperlink{struct_o_t_1_1hb__closure__lookups__context__t}{hb\_closure\_lookups\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03317\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03318\ \ \ \ \ \textcolor{keywordflow}{if}\ (!intersects\ (c-\/>glyphs))}
\DoxyCodeLine{03319\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{03320\ }
\DoxyCodeLine{03321\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<Coverage>}}\ \&\mbox{\hyperlink{structinput}{input}}\ =\ StructAfter<Array16OfOffset16To<Coverage>>\ (backtrack);}
\DoxyCodeLine{03322\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<Coverage>}}\ \&lookahead\ =\ StructAfter<Array16OfOffset16To<Coverage>>\ (\mbox{\hyperlink{structinput}{input}});}
\DoxyCodeLine{03323\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<LookupRecord>}}\ \&lookup\ =\ StructAfter<Array16Of<LookupRecord>>\ (lookahead);}
\DoxyCodeLine{03324\ \ \ \ \ recurse\_lookups\ (c,\ lookup.len,\ lookup.arrayZ);}
\DoxyCodeLine{03325\ \ \ \}}
\DoxyCodeLine{03326\ }
\DoxyCodeLine{03327\ \ \ \textcolor{keywordtype}{void}\ collect\_variation\_indices\ (\mbox{\hyperlink{struct_o_t_1_1hb__collect__variation__indices__context__t}{hb\_collect\_variation\_indices\_context\_t}}\ *c)\textcolor{keyword}{\ const\ }\{\}}
\DoxyCodeLine{03328\ }
\DoxyCodeLine{03329\ \ \ \textcolor{keywordtype}{void}\ collect\_glyphs\ (\mbox{\hyperlink{struct_o_t_1_1hb__collect__glyphs__context__t}{hb\_collect\_glyphs\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03330\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03331\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<Coverage>}}\ \&\mbox{\hyperlink{structinput}{input}}\ =\ StructAfter<Array16OfOffset16To<Coverage>>\ (backtrack);}
\DoxyCodeLine{03332\ }
\DoxyCodeLine{03333\ \ \ \ \ (\textcolor{keyword}{this}+\mbox{\hyperlink{structinput}{input}}[0]).collect\_coverage\ (c-\/>input);}
\DoxyCodeLine{03334\ }
\DoxyCodeLine{03335\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<Coverage>}}\ \&lookahead\ =\ StructAfter<Array16OfOffset16To<Coverage>>\ (\mbox{\hyperlink{structinput}{input}});}
\DoxyCodeLine{03336\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<LookupRecord>}}\ \&lookup\ =\ StructAfter<Array16Of<LookupRecord>>\ (lookahead);}
\DoxyCodeLine{03337\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_chain_context_collect_glyphs_lookup_context}{ChainContextCollectGlyphsLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{03338\ \ \ \ \ \ \ \{collect\_coverage\},}
\DoxyCodeLine{03339\ \ \ \ \ \ \ \{\textcolor{keyword}{this},\ \textcolor{keyword}{this},\ \textcolor{keyword}{this}\}}
\DoxyCodeLine{03340\ \ \ \ \ \};}
\DoxyCodeLine{03341\ \ \ \ \ chain\_context\_collect\_glyphs\_lookup\ (c,}
\DoxyCodeLine{03342\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ backtrack.len,\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *)\ backtrack.arrayZ,}
\DoxyCodeLine{03343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structinput}{input}}.len,\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *)\ \mbox{\hyperlink{structinput}{input}}.arrayZ\ +\ 1,}
\DoxyCodeLine{03344\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookahead.len,\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *)\ lookahead.arrayZ,}
\DoxyCodeLine{03345\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup.len,\ lookup.arrayZ,}
\DoxyCodeLine{03346\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup\_context);}
\DoxyCodeLine{03347\ \ \ \}}
\DoxyCodeLine{03348\ }
\DoxyCodeLine{03349\ \ \ \textcolor{keywordtype}{bool}\ would\_apply\ (\mbox{\hyperlink{struct_o_t_1_1hb__would__apply__context__t}{hb\_would\_apply\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03350\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03351\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<Coverage>}}\ \&\mbox{\hyperlink{structinput}{input}}\ =\ StructAfter<Array16OfOffset16To<Coverage>>\ (backtrack);}
\DoxyCodeLine{03352\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<Coverage>}}\ \&lookahead\ =\ StructAfter<Array16OfOffset16To<Coverage>>\ (\mbox{\hyperlink{structinput}{input}});}
\DoxyCodeLine{03353\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<LookupRecord>}}\ \&lookup\ =\ StructAfter<Array16Of<LookupRecord>>\ (lookahead);}
\DoxyCodeLine{03354\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_chain_context_apply_lookup_context}{ChainContextApplyLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{03355\ \ \ \ \ \ \ \{match\_coverage\},}
\DoxyCodeLine{03356\ \ \ \ \ \ \ \{\textcolor{keyword}{this},\ \textcolor{keyword}{this},\ \textcolor{keyword}{this}\}}
\DoxyCodeLine{03357\ \ \ \ \ \};}
\DoxyCodeLine{03358\ \ \ \ \ \textcolor{keywordflow}{return}\ chain\_context\_would\_apply\_lookup\ (c,}
\DoxyCodeLine{03359\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ backtrack.len,\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *)\ backtrack.arrayZ,}
\DoxyCodeLine{03360\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structinput}{input}}.len,\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *)\ \mbox{\hyperlink{structinput}{input}}.arrayZ\ +\ 1,}
\DoxyCodeLine{03361\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookahead.len,\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *)\ lookahead.arrayZ,}
\DoxyCodeLine{03362\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup.len,\ lookup.arrayZ,\ lookup\_context);}
\DoxyCodeLine{03363\ \ \ \}}
\DoxyCodeLine{03364\ }
\DoxyCodeLine{03365\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_coverage}{Coverage}}\ \&get\_coverage\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{03366\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03367\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<Coverage>}}\ \&\mbox{\hyperlink{structinput}{input}}\ =\ StructAfter<Array16OfOffset16To<Coverage>>\ (backtrack);}
\DoxyCodeLine{03368\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{this}+\mbox{\hyperlink{structinput}{input}}[0];}
\DoxyCodeLine{03369\ \ \ \}}
\DoxyCodeLine{03370\ }
\DoxyCodeLine{03371\ \ \ \textcolor{keywordtype}{bool}\ apply\ (\mbox{\hyperlink{struct_o_t_1_1hb__ot__apply__context__t}{hb\_ot\_apply\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03372\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03373\ \ \ \ \ TRACE\_APPLY\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03374\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<Coverage>}}\ \&\mbox{\hyperlink{structinput}{input}}\ =\ StructAfter<Array16OfOffset16To<Coverage>>\ (backtrack);}
\DoxyCodeLine{03375\ }
\DoxyCodeLine{03376\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ index\ =\ (\textcolor{keyword}{this}+\mbox{\hyperlink{structinput}{input}}[0]).get\_coverage\ (c-\/>buffer-\/>cur().codepoint);}
\DoxyCodeLine{03377\ \ \ \ \ \textcolor{keywordflow}{if}\ (likely\ (index\ ==\ NOT\_COVERED))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{03378\ }
\DoxyCodeLine{03379\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<Coverage>}}\ \&lookahead\ =\ StructAfter<Array16OfOffset16To<Coverage>>\ (\mbox{\hyperlink{structinput}{input}});}
\DoxyCodeLine{03380\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<LookupRecord>}}\ \&lookup\ =\ StructAfter<Array16Of<LookupRecord>>\ (lookahead);}
\DoxyCodeLine{03381\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_chain_context_apply_lookup_context}{ChainContextApplyLookupContext}}\ lookup\_context\ =\ \{}
\DoxyCodeLine{03382\ \ \ \ \ \ \ \{match\_coverage\},}
\DoxyCodeLine{03383\ \ \ \ \ \ \ \{\textcolor{keyword}{this},\ \textcolor{keyword}{this},\ \textcolor{keyword}{this}\}}
\DoxyCodeLine{03384\ \ \ \ \ \};}
\DoxyCodeLine{03385\ \ \ \ \ return\_trace\ (chain\_context\_apply\_lookup\ (c,}
\DoxyCodeLine{03386\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ backtrack.len,\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *)\ backtrack.arrayZ,}
\DoxyCodeLine{03387\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structinput}{input}}.len,\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *)\ \mbox{\hyperlink{structinput}{input}}.arrayZ\ +\ 1,}
\DoxyCodeLine{03388\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookahead.len,\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *)\ lookahead.arrayZ,}
\DoxyCodeLine{03389\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lookup.len,\ lookup.arrayZ,\ lookup\_context));}
\DoxyCodeLine{03390\ \ \ \}}
\DoxyCodeLine{03391\ }
\DoxyCodeLine{03392\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Iterator,}
\DoxyCodeLine{03393\ \ \ \ \ \ \ \ hb\_requires\ (hb\_is\_iterator\ (Iterator))>}
\DoxyCodeLine{03394\ \ \ \textcolor{keywordtype}{bool}\ serialize\_coverage\_offsets\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c,\ Iterator\ it,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ base)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03395\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03396\ \ \ \ \ TRACE\_SERIALIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03397\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>serializer-\/>start\_embed<\mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<Coverage>}}>\ ();}
\DoxyCodeLine{03398\ }
\DoxyCodeLine{03399\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>serializer-\/>allocate\_size<\mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}>\ (HBUINT16::static\_size)))}
\DoxyCodeLine{03400\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{03401\ }
\DoxyCodeLine{03402\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ offset\ :\ it)\ \{}
\DoxyCodeLine{03403\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ *o\ =\ out-\/>serialize\_append\ (c-\/>serializer);}
\DoxyCodeLine{03404\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!o)\ ||\ !o-\/>serialize\_subset\ (c,\ offset,\ base))}
\DoxyCodeLine{03405\ \ \ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{03406\ \ \ \ \ \}}
\DoxyCodeLine{03407\ }
\DoxyCodeLine{03408\ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{03409\ \ \ \}}
\DoxyCodeLine{03410\ }
\DoxyCodeLine{03411\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03412\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03413\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03414\ }
\DoxyCodeLine{03415\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>serializer-\/>start\_embed\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03416\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!out))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{03417\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>serializer-\/>embed\ (this-\/>format)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{03418\ }
\DoxyCodeLine{03419\ \ \ \ \ \textcolor{keywordflow}{if}\ (!serialize\_coverage\_offsets\ (c,\ backtrack.iter\ (),\ \textcolor{keyword}{this}))}
\DoxyCodeLine{03420\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{03421\ }
\DoxyCodeLine{03422\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<Coverage>}}\ \&\mbox{\hyperlink{structinput}{input}}\ =\ StructAfter<Array16OfOffset16To<Coverage>>\ (backtrack);}
\DoxyCodeLine{03423\ \ \ \ \ \textcolor{keywordflow}{if}\ (!serialize\_coverage\_offsets\ (c,\ \mbox{\hyperlink{structinput}{input}}.iter\ (),\ \textcolor{keyword}{this}))}
\DoxyCodeLine{03424\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{03425\ }
\DoxyCodeLine{03426\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<Coverage>}}\ \&lookahead\ =\ StructAfter<Array16OfOffset16To<Coverage>>\ (\mbox{\hyperlink{structinput}{input}});}
\DoxyCodeLine{03427\ \ \ \ \ \textcolor{keywordflow}{if}\ (!serialize\_coverage\_offsets\ (c,\ lookahead.iter\ (),\ \textcolor{keyword}{this}))}
\DoxyCodeLine{03428\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{03429\ }
\DoxyCodeLine{03430\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<LookupRecord>}}\ \&lookupRecord\ =\ StructAfter<Array16Of<LookupRecord>>\ (lookahead);}
\DoxyCodeLine{03431\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *lookup\_map\ =\ c-\/>table\_tag\ ==\ HB\_OT\_TAG\_GSUB\ ?\ c-\/>plan-\/>gsub\_lookups\ :\ c-\/>plan-\/>gpos\_lookups;}
\DoxyCodeLine{03432\ }
\DoxyCodeLine{03433\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ *lookupCount\ =\ c-\/>serializer-\/>copy<\mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}>\ (lookupRecord.len);}
\DoxyCodeLine{03434\ \ \ \ \ \textcolor{keywordflow}{if}\ (!lookupCount)\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{03435\ }
\DoxyCodeLine{03436\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ count\ =\ serialize\_lookuprecord\_array\ (c-\/>serializer,\ lookupRecord.as\_array\ (),\ lookup\_map);}
\DoxyCodeLine{03437\ \ \ \ \ return\_trace\ (c-\/>serializer-\/>check\_assign\ (*lookupCount,\ count,\ HB\_SERIALIZE\_ERROR\_INT\_OVERFLOW));}
\DoxyCodeLine{03438\ \ \ \}}
\DoxyCodeLine{03439\ }
\DoxyCodeLine{03440\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03441\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03442\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03443\ \ \ \ \ \textcolor{keywordflow}{if}\ (!backtrack.sanitize\ (c,\ \textcolor{keyword}{this}))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{03444\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<Coverage>}}\ \&\mbox{\hyperlink{structinput}{input}}\ =\ StructAfter<Array16OfOffset16To<Coverage>>\ (backtrack);}
\DoxyCodeLine{03445\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{structinput}{input}}.sanitize\ (c,\ \textcolor{keyword}{this}))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{03446\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{structinput}{input}}.len)\ return\_trace\ (\textcolor{keyword}{false});\ \textcolor{comment}{/*\ To\ be\ consistent\ with\ Context.\ */}}
\DoxyCodeLine{03447\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<Coverage>}}\ \&lookahead\ =\ StructAfter<Array16OfOffset16To<Coverage>>\ (\mbox{\hyperlink{structinput}{input}});}
\DoxyCodeLine{03448\ \ \ \ \ \textcolor{keywordflow}{if}\ (!lookahead.sanitize\ (c,\ \textcolor{keyword}{this}))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{03449\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<LookupRecord>}}\ \&lookup\ =\ StructAfter<Array16Of<LookupRecord>>\ (lookahead);}
\DoxyCodeLine{03450\ \ \ \ \ return\_trace\ (lookup.sanitize\ (c));}
\DoxyCodeLine{03451\ \ \ \}}
\DoxyCodeLine{03452\ }
\DoxyCodeLine{03453\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{03454\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ format;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Format\ identifier-\/-\/format\ =\ 3\ */}}
\DoxyCodeLine{03455\ \ \ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<Coverage>}}}
\DoxyCodeLine{03456\ \ \ \ \ \ \ \ \ backtrack;\ \ \ \ \ \ \textcolor{comment}{/*\ Array\ of\ coverage\ tables}}
\DoxyCodeLine{03457\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ in\ backtracking\ sequence,\ in\ \ glyph}}
\DoxyCodeLine{03458\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ sequence\ order\ */}}
\DoxyCodeLine{03459\ \ \ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<Coverage>}}}
\DoxyCodeLine{03460\ \ \ \ \ \ \ \ \ inputX\ \ \ \ \ \ ;\ \ \ \textcolor{comment}{/*\ Array\ of\ coverage}}
\DoxyCodeLine{03461\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ tables\ in\ input\ sequence,\ in\ glyph}}
\DoxyCodeLine{03462\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ sequence\ order\ */}}
\DoxyCodeLine{03463\ \ \ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16OfOffset16To<Coverage>}}}
\DoxyCodeLine{03464\ \ \ \ \ \ \ \ \ lookaheadX;\ \ \ \ \ \textcolor{comment}{/*\ Array\ of\ coverage\ tables}}
\DoxyCodeLine{03465\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ in\ lookahead\ sequence,\ in\ glyph}}
\DoxyCodeLine{03466\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ sequence\ order\ */}}
\DoxyCodeLine{03467\ \ \ \mbox{\hyperlink{struct_o_t_1_1_array_of}{Array16Of<LookupRecord>}}}
\DoxyCodeLine{03468\ \ \ \ \ \ \ \ \ lookupX;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Array\ of\ LookupRecords-\/-\/in}}
\DoxyCodeLine{03469\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ design\ order)\ */}}
\DoxyCodeLine{03470\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{03471\ \ \ DEFINE\_SIZE\_MIN\ (10);}
\DoxyCodeLine{03472\ \};}
\DoxyCodeLine{03473\ }
\DoxyCodeLine{03474\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_chain_context}{ChainContext}}}
\DoxyCodeLine{03475\ \{}
\DoxyCodeLine{03476\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ context\_t,\ \textcolor{keyword}{typename}\ ...Ts>}
\DoxyCodeLine{03477\ \ \ \textcolor{keyword}{typename}\ context\_t::return\_t\ dispatch\ (context\_t\ *c,\ Ts\&\&...\ ds)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03478\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03479\ \ \ \ \ TRACE\_DISPATCH\ (\textcolor{keyword}{this},\ u.format);}
\DoxyCodeLine{03480\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>may\_dispatch\ (\textcolor{keyword}{this},\ \&u.format)))\ return\_trace\ (c-\/>no\_dispatch\_return\_value\ ());}
\DoxyCodeLine{03481\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)\ \{}
\DoxyCodeLine{03482\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ return\_trace\ (c-\/>dispatch\ (u.format1,\ std::forward<Ts>\ (ds)...));}
\DoxyCodeLine{03483\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ return\_trace\ (c-\/>dispatch\ (u.format2,\ std::forward<Ts>\ (ds)...));}
\DoxyCodeLine{03484\ \ \ \ \ \textcolor{keywordflow}{case}\ 3:\ return\_trace\ (c-\/>dispatch\ (u.format3,\ std::forward<Ts>\ (ds)...));}
\DoxyCodeLine{03485\ \ \ \ \ \textcolor{keywordflow}{default}:return\_trace\ (c-\/>default\_return\_value\ ());}
\DoxyCodeLine{03486\ \ \ \ \ \}}
\DoxyCodeLine{03487\ \ \ \}}
\DoxyCodeLine{03488\ }
\DoxyCodeLine{03489\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{03490\ \ \ \textcolor{keyword}{union\ }\{}
\DoxyCodeLine{03491\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ \ \ \ \ format;\ \textcolor{comment}{/*\ Format\ identifier\ */}}
\DoxyCodeLine{03492\ \ \ \mbox{\hyperlink{struct_o_t_1_1_chain_context_format1}{ChainContextFormat1}}\ \ \ \ format1;}
\DoxyCodeLine{03493\ \ \ \mbox{\hyperlink{struct_o_t_1_1_chain_context_format2}{ChainContextFormat2}}\ \ \ \ format2;}
\DoxyCodeLine{03494\ \ \ \mbox{\hyperlink{struct_o_t_1_1_chain_context_format3}{ChainContextFormat3}}\ \ \ \ format3;}
\DoxyCodeLine{03495\ \ \ \}\ u;}
\DoxyCodeLine{03496\ \};}
\DoxyCodeLine{03497\ }
\DoxyCodeLine{03498\ }
\DoxyCodeLine{03499\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{03500\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_extension_format1}{ExtensionFormat1}}}
\DoxyCodeLine{03501\ \{}
\DoxyCodeLine{03502\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_type\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ extensionLookupType;\ \}}
\DoxyCodeLine{03503\ }
\DoxyCodeLine{03504\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ X>}
\DoxyCodeLine{03505\ \ \ \textcolor{keyword}{const}\ X\&\ get\_subtable\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{03506\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{this}\ +\ \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset32To<typename\ T::SubTable>}}\ \&\textcolor{keyword}{>}\ (extensionOffset);\ \}}
\DoxyCodeLine{03507\ }
\DoxyCodeLine{03508\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ context\_t,\ \textcolor{keyword}{typename}\ ...Ts>}
\DoxyCodeLine{03509\ \ \ \textcolor{keyword}{typename}\ context\_t::return\_t\ dispatch\ (context\_t\ *c,\ Ts\&\&...\ ds)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03510\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03511\ \ \ \ \ TRACE\_DISPATCH\ (\textcolor{keyword}{this},\ format);}
\DoxyCodeLine{03512\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>may\_dispatch\ (\textcolor{keyword}{this},\ \textcolor{keyword}{this})))\ return\_trace\ (c-\/>no\_dispatch\_return\_value\ ());}
\DoxyCodeLine{03513\ \ \ \ \ return\_trace\ (get\_subtable<typename\ T::SubTable>\ ().dispatch\ (c,\ get\_type\ (),\ std::forward<Ts>\ (ds)...));}
\DoxyCodeLine{03514\ \ \ \}}
\DoxyCodeLine{03515\ }
\DoxyCodeLine{03516\ \ \ \textcolor{keywordtype}{void}\ collect\_variation\_indices\ (\mbox{\hyperlink{struct_o_t_1_1hb__collect__variation__indices__context__t}{hb\_collect\_variation\_indices\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03517\ \textcolor{keyword}{\ \ }\{\ dispatch\ (c);\ \}}
\DoxyCodeLine{03518\ }
\DoxyCodeLine{03519\ \ \ \textcolor{comment}{/*\ This\ is\ called\ from\ may\_dispatch()\ above\ with\ hb\_sanitize\_context\_t.\ */}}
\DoxyCodeLine{03520\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03521\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03522\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03523\ \ \ \ \ return\_trace\ (c-\/>check\_struct\ (\textcolor{keyword}{this})\ \&\&}
\DoxyCodeLine{03524\ \ \ \ \ \ \ \ \ \ \ extensionLookupType\ !=\ T::SubTable::Extension);}
\DoxyCodeLine{03525\ \ \ \}}
\DoxyCodeLine{03526\ }
\DoxyCodeLine{03527\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03528\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03529\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03530\ }
\DoxyCodeLine{03531\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>serializer-\/>start\_embed\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03532\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!out\ ||\ !c-\/>serializer-\/>extend\_min\ (out)))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{03533\ }
\DoxyCodeLine{03534\ \ \ \ \ out-\/>format\ =\ format;}
\DoxyCodeLine{03535\ \ \ \ \ out-\/>extensionLookupType\ =\ extensionLookupType;}
\DoxyCodeLine{03536\ }
\DoxyCodeLine{03537\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ src\_offset\ =}
\DoxyCodeLine{03538\ \ \ \ \ \ \ \ \ \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset32To<typename\ T::SubTable>}}\ \&\textcolor{keyword}{>}\ (extensionOffset);}
\DoxyCodeLine{03539\ \ \ \ \ \textcolor{keyword}{auto}\&\ dest\_offset\ =}
\DoxyCodeLine{03540\ \ \ \ \ \ \ \ \ \textcolor{keyword}{reinterpret\_cast<}\mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset32To<typename\ T::SubTable>}}\ \&\textcolor{keyword}{>}\ (out-\/>extensionOffset);}
\DoxyCodeLine{03541\ }
\DoxyCodeLine{03542\ \ \ \ \ return\_trace\ (dest\_offset.serialize\_subset\ (c,\ src\_offset,\ \textcolor{keyword}{this},\ get\_type\ ()));}
\DoxyCodeLine{03543\ \ \ \}}
\DoxyCodeLine{03544\ }
\DoxyCodeLine{03545\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{03546\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ format;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Format\ identifier.\ Set\ to\ 1.\ */}}
\DoxyCodeLine{03547\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ extensionLookupType;\ \ \ \ \textcolor{comment}{/*\ Lookup\ type\ of\ subtable\ referenced}}
\DoxyCodeLine{03548\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ by\ ExtensionOffset\ (i.e.\ the}}
\DoxyCodeLine{03549\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ extension\ subtable).\ */}}
\DoxyCodeLine{03550\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset}{Offset32}}\ \ extensionOffset;\ \ \ \ \textcolor{comment}{/*\ Offset\ to\ the\ extension\ subtable,}}
\DoxyCodeLine{03551\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ of\ lookup\ type\ subtable.\ */}}
\DoxyCodeLine{03552\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{03553\ \ \ DEFINE\_SIZE\_STATIC\ (8);}
\DoxyCodeLine{03554\ \};}
\DoxyCodeLine{03555\ }
\DoxyCodeLine{03556\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{03557\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_extension}{Extension}}}
\DoxyCodeLine{03558\ \{}
\DoxyCodeLine{03559\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_type\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{03560\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03561\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)\ \{}
\DoxyCodeLine{03562\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \textcolor{keywordflow}{return}\ u.format1.get\_type\ ();}
\DoxyCodeLine{03563\ \ \ \ \ \textcolor{keywordflow}{default}:\textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{03564\ \ \ \ \ \}}
\DoxyCodeLine{03565\ \ \ \}}
\DoxyCodeLine{03566\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ X>}
\DoxyCodeLine{03567\ \ \ \textcolor{keyword}{const}\ X\&\ get\_subtable\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{03568\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03569\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)\ \{}
\DoxyCodeLine{03570\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \textcolor{keywordflow}{return}\ u.format1.template\ get\_subtable<typename\ T::SubTable>\ ();}
\DoxyCodeLine{03571\ \ \ \ \ \textcolor{keywordflow}{default}:\textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_null}{Null}}\ (\textcolor{keyword}{typename}\ T::SubTable);}
\DoxyCodeLine{03572\ \ \ \ \ \}}
\DoxyCodeLine{03573\ \ \ \}}
\DoxyCodeLine{03574\ }
\DoxyCodeLine{03575\ \ \ \textcolor{comment}{//\ Specialization\ of\ dispatch\ for\ subset.\ dispatch()\ normally\ just}}
\DoxyCodeLine{03576\ \ \ \textcolor{comment}{//\ dispatches\ to\ the\ sub\ table\ this\ points\ too,\ but\ for\ subset}}
\DoxyCodeLine{03577\ \ \ \textcolor{comment}{//\ we\ need\ to\ run\ subset\ on\ this\ subtable\ too.}}
\DoxyCodeLine{03578\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ ...Ts>}
\DoxyCodeLine{03579\ \ \ \textcolor{keyword}{typename}\ hb\_subset\_context\_t::return\_t\ dispatch\ (\mbox{\hyperlink{structhb__subset__context__t}{hb\_subset\_context\_t}}\ *c,\ Ts\&\&...\ ds)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03580\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03581\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)\ \{}
\DoxyCodeLine{03582\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ \textcolor{keywordflow}{return}\ u.format1.subset\ (c);}
\DoxyCodeLine{03583\ \ \ \ \ \textcolor{keywordflow}{default}:\ \textcolor{keywordflow}{return}\ c-\/>default\_return\_value\ ();}
\DoxyCodeLine{03584\ \ \ \ \ \}}
\DoxyCodeLine{03585\ \ \ \}}
\DoxyCodeLine{03586\ }
\DoxyCodeLine{03587\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ context\_t,\ \textcolor{keyword}{typename}\ ...Ts>}
\DoxyCodeLine{03588\ \ \ \textcolor{keyword}{typename}\ context\_t::return\_t\ dispatch\ (context\_t\ *c,\ Ts\&\&...\ ds)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03589\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03590\ \ \ \ \ TRACE\_DISPATCH\ (\textcolor{keyword}{this},\ u.format);}
\DoxyCodeLine{03591\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!c-\/>may\_dispatch\ (\textcolor{keyword}{this},\ \&u.format)))\ return\_trace\ (c-\/>no\_dispatch\_return\_value\ ());}
\DoxyCodeLine{03592\ \ \ \ \ \textcolor{keywordflow}{switch}\ (u.format)\ \{}
\DoxyCodeLine{03593\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ return\_trace\ (u.format1.dispatch\ (c,\ std::forward<Ts>\ (ds)...));}
\DoxyCodeLine{03594\ \ \ \ \ \textcolor{keywordflow}{default}:return\_trace\ (c-\/>default\_return\_value\ ());}
\DoxyCodeLine{03595\ \ \ \ \ \}}
\DoxyCodeLine{03596\ \ \ \}}
\DoxyCodeLine{03597\ }
\DoxyCodeLine{03598\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{03599\ \ \ \textcolor{keyword}{union\ }\{}
\DoxyCodeLine{03600\ \ \ \mbox{\hyperlink{struct_o_t_1_1_int_type}{HBUINT16}}\ \ \ \ \ \ format;\ \ \ \ \ \textcolor{comment}{/*\ Format\ identifier\ */}}
\DoxyCodeLine{03601\ \ \ \mbox{\hyperlink{struct_o_t_1_1_extension_format1}{ExtensionFormat1<T>}}\ \ \ \ format1;}
\DoxyCodeLine{03602\ \ \ \}\ u;}
\DoxyCodeLine{03603\ \};}
\DoxyCodeLine{03604\ }
\DoxyCodeLine{03605\ }
\DoxyCodeLine{03606\ \textcolor{comment}{/*}}
\DoxyCodeLine{03607\ \textcolor{comment}{\ *\ GSUB/GPOS\ Common}}
\DoxyCodeLine{03608\ \textcolor{comment}{\ */}}
\DoxyCodeLine{03609\ }
\DoxyCodeLine{03610\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1hb__ot__layout__lookup__accelerator__t}{hb\_ot\_layout\_lookup\_accelerator\_t}}}
\DoxyCodeLine{03611\ \{}
\DoxyCodeLine{03612\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ TLookup>}
\DoxyCodeLine{03613\ \ \ \textcolor{keywordtype}{void}\ init\ (\textcolor{keyword}{const}\ TLookup\ \&lookup)}
\DoxyCodeLine{03614\ \ \ \{}
\DoxyCodeLine{03615\ \ \ \ \ digest.init\ ();}
\DoxyCodeLine{03616\ \ \ \ \ lookup.collect\_coverage\ (\&digest);}
\DoxyCodeLine{03617\ }
\DoxyCodeLine{03618\ \ \ \ \ subtables.init\ ();}
\DoxyCodeLine{03619\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__get__subtables__context__t}{OT::hb\_get\_subtables\_context\_t}}\ c\_get\_subtables\ (subtables);}
\DoxyCodeLine{03620\ \ \ \ \ lookup.dispatch\ (\&c\_get\_subtables);}
\DoxyCodeLine{03621\ \ \ \}}
\DoxyCodeLine{03622\ \ \ \textcolor{keywordtype}{void}\ fini\ ()\ \{\ subtables.fini\ ();\ \}}
\DoxyCodeLine{03623\ }
\DoxyCodeLine{03624\ \ \ \textcolor{keywordtype}{bool}\ may\_have\ (hb\_codepoint\_t\ g)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03625\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ digest.may\_have\ (g);\ \}}
\DoxyCodeLine{03626\ }
\DoxyCodeLine{03627\ \ \ \textcolor{keywordtype}{bool}\ apply\ (\mbox{\hyperlink{struct_o_t_1_1hb__ot__apply__context__t}{hb\_ot\_apply\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03628\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03629\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ subtables.length;\ i++)}
\DoxyCodeLine{03630\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (subtables[i].apply\ (c))}
\DoxyCodeLine{03631\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{03632\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03633\ \ \ \}}
\DoxyCodeLine{03634\ }
\DoxyCodeLine{03635\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{03636\ \ \ \mbox{\hyperlink{structhb__set__digest__combiner__t}{hb\_set\_digest\_t}}\ digest;}
\DoxyCodeLine{03637\ \ \ \mbox{\hyperlink{structhb__vector__t}{hb\_get\_subtables\_context\_t::array\_t}}\ subtables;}
\DoxyCodeLine{03638\ \};}
\DoxyCodeLine{03639\ }
\DoxyCodeLine{03640\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_g_s_u_b_g_p_o_s}{GSUBGPOS}}}
\DoxyCodeLine{03641\ \{}
\DoxyCodeLine{03642\ \ \ \textcolor{keywordtype}{bool}\ has\_data\ ()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ version.to\_int\ ();\ \}}
\DoxyCodeLine{03643\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_script\_count\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{03644\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{this}+scriptList).len;\ \}}
\DoxyCodeLine{03645\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_tag}{Tag}}\&\ get\_script\_tag\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03646\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{this}+scriptList).get\_tag\ (i);\ \}}
\DoxyCodeLine{03647\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_script\_tags\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ start\_offset,}
\DoxyCodeLine{03648\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *script\_count\ \textcolor{comment}{/*\ IN/OUT\ */},}
\DoxyCodeLine{03649\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_tag\_t\ \ \ \ \ *script\_tags\ \textcolor{comment}{/*\ OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{03650\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{this}+scriptList).get\_tags\ (start\_offset,\ script\_count,\ script\_tags);\ \}}
\DoxyCodeLine{03651\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_script}{Script}}\&\ get\_script\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03652\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{this}+scriptList)[i];\ \}}
\DoxyCodeLine{03653\ \ \ \textcolor{keywordtype}{bool}\ find\_script\_index\ (hb\_tag\_t\ tag,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *index)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03654\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{this}+scriptList).find\_index\ (tag,\ index);\ \}}
\DoxyCodeLine{03655\ }
\DoxyCodeLine{03656\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_feature\_count\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{03657\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{this}+featureList).len;\ \}}
\DoxyCodeLine{03658\ \ \ hb\_tag\_t\ get\_feature\_tag\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03659\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ i\ ==\ Index::NOT\_FOUND\_INDEX\ ?\ HB\_TAG\_NONE\ :\ (\textcolor{keyword}{this}+featureList).get\_tag\ (i);\ \}}
\DoxyCodeLine{03660\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_feature\_tags\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ start\_offset,}
\DoxyCodeLine{03661\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *feature\_count\ \textcolor{comment}{/*\ IN/OUT\ */},}
\DoxyCodeLine{03662\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hb\_tag\_t\ \ \ \ \ *feature\_tags\ \textcolor{comment}{/*\ OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{03663\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{this}+featureList).get\_tags\ (start\_offset,\ feature\_count,\ feature\_tags);\ \}}
\DoxyCodeLine{03664\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_feature}{Feature}}\&\ get\_feature\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03665\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{this}+featureList)[i];\ \}}
\DoxyCodeLine{03666\ \ \ \textcolor{keywordtype}{bool}\ find\_feature\_index\ (hb\_tag\_t\ tag,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *index)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03667\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{this}+featureList).find\_index\ (tag,\ index);\ \}}
\DoxyCodeLine{03668\ }
\DoxyCodeLine{03669\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_lookup\_count\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{03670\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{this}+lookupList).len;\ \}}
\DoxyCodeLine{03671\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_lookup}{Lookup}}\&\ get\_lookup\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03672\ \textcolor{keyword}{\ \ }\{\ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{this}+lookupList)[i];\ \}}
\DoxyCodeLine{03673\ }
\DoxyCodeLine{03674\ \ \ \textcolor{keywordtype}{bool}\ find\_variations\_index\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ *coords,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ num\_coords,}
\DoxyCodeLine{03675\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *index)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03676\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03677\ \textcolor{preprocessor}{\#ifdef\ HB\_NO\_VAR}}
\DoxyCodeLine{03678\ \ \ \ \ *index\ =\ FeatureVariations::NOT\_FOUND\_INDEX;}
\DoxyCodeLine{03679\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03680\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03681\ \ \ \ \ \textcolor{keywordflow}{return}\ (version.to\_int\ ()\ >=\ 0x00010001u\ ?\ \textcolor{keyword}{this}+featureVars\ :\ \mbox{\hyperlink{struct_null}{Null}}\ (\mbox{\hyperlink{struct_o_t_1_1_feature_variations}{FeatureVariations}}))}
\DoxyCodeLine{03682\ \ \ \ \ \ \ \ \ .find\_index\ (coords,\ num\_coords,\ index);}
\DoxyCodeLine{03683\ \ \ \}}
\DoxyCodeLine{03684\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_feature}{Feature}}\&\ get\_feature\_variation\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ feature\_index,}
\DoxyCodeLine{03685\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ variations\_index)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03686\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03687\ \textcolor{preprocessor}{\#ifndef\ HB\_NO\_VAR}}
\DoxyCodeLine{03688\ \ \ \ \ \textcolor{keywordflow}{if}\ (FeatureVariations::NOT\_FOUND\_INDEX\ !=\ variations\_index\ \&\&}
\DoxyCodeLine{03689\ \ \ \ \ version.to\_int\ ()\ >=\ 0x00010001u)}
\DoxyCodeLine{03690\ \ \ \ \ \{}
\DoxyCodeLine{03691\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_feature}{Feature}}\ *feature\ =\ (\textcolor{keyword}{this}+featureVars).find\_substitute\ (variations\_index,}
\DoxyCodeLine{03692\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ feature\_index);}
\DoxyCodeLine{03693\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (feature)}
\DoxyCodeLine{03694\ \ \ \ \ \textcolor{keywordflow}{return}\ *feature;}
\DoxyCodeLine{03695\ \ \ \ \ \}}
\DoxyCodeLine{03696\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03697\ \ \ \ \ \textcolor{keywordflow}{return}\ get\_feature\ (feature\_index);}
\DoxyCodeLine{03698\ \ \ \}}
\DoxyCodeLine{03699\ }
\DoxyCodeLine{03700\ \ \ \textcolor{keywordtype}{void}\ feature\_variation\_collect\_lookups\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *feature\_indexes,}
\DoxyCodeLine{03701\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \ \ \ \ \ \ *lookup\_indexes\ \textcolor{comment}{/*\ OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{03702\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03703\ \textcolor{preprocessor}{\#ifndef\ HB\_NO\_VAR}}
\DoxyCodeLine{03704\ \ \ \ \ \textcolor{keywordflow}{if}\ (version.to\_int\ ()\ >=\ 0x00010001u)}
\DoxyCodeLine{03705\ \ \ \ \ \ \ (\textcolor{keyword}{this}+featureVars).collect\_lookups\ (feature\_indexes,\ lookup\_indexes);}
\DoxyCodeLine{03706\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03707\ \ \ \}}
\DoxyCodeLine{03708\ }
\DoxyCodeLine{03709\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ TLookup>}
\DoxyCodeLine{03710\ \ \ \textcolor{keywordtype}{void}\ closure\_lookups\ (\mbox{\hyperlink{structhb__face__t}{hb\_face\_t}}\ \ \ \ \ \ *face,}
\DoxyCodeLine{03711\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *glyphs,}
\DoxyCodeLine{03712\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \ \ \ \ \ \ *lookup\_indexes\ \textcolor{comment}{/*\ IN/OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{03713\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03714\ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ visited\_lookups,\ inactive\_lookups;}
\DoxyCodeLine{03715\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__closure__lookups__context__t}{OT::hb\_closure\_lookups\_context\_t}}\ c\ (face,\ glyphs,\ \&visited\_lookups,\ \&inactive\_lookups);}
\DoxyCodeLine{03716\ }
\DoxyCodeLine{03717\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ lookup\_index\ :\ +\ hb\_iter\ (lookup\_indexes))}
\DoxyCodeLine{03718\ \ \ \ \ \ \ \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }TLookup\ \&\textcolor{keyword}{>}\ (get\_lookup\ (lookup\_index)).closure\_lookups\ (\&c,\ lookup\_index);}
\DoxyCodeLine{03719\ }
\DoxyCodeLine{03720\ \ \ \ \ hb\_set\_union\ (lookup\_indexes,\ \&visited\_lookups);}
\DoxyCodeLine{03721\ \ \ \ \ hb\_set\_subtract\ (lookup\_indexes,\ \&inactive\_lookups);}
\DoxyCodeLine{03722\ \ \ \}}
\DoxyCodeLine{03723\ }
\DoxyCodeLine{03724\ \ \ \textcolor{keywordtype}{void}\ prune\_langsys\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *duplicate\_feature\_map,}
\DoxyCodeLine{03725\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__hashmap__t}{hb\_hashmap\_t<unsigned,\ hb\_set\_t\ *>}}\ *\mbox{\hyperlink{structhb__hashmap__t}{script\_langsys\_map}},}
\DoxyCodeLine{03726\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \ \ \ \ \ \ *new\_feature\_indexes\ \textcolor{comment}{/*\ OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{03727\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03728\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__prune__langsys__context__t}{hb\_prune\_langsys\_context\_t}}\ c\ (\textcolor{keyword}{this},\ \mbox{\hyperlink{structhb__hashmap__t}{script\_langsys\_map}},\ duplicate\_feature\_map,\ new\_feature\_indexes);}
\DoxyCodeLine{03729\ }
\DoxyCodeLine{03730\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ count\ =\ get\_script\_count\ ();}
\DoxyCodeLine{03731\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ script\_index\ =\ 0;\ script\_index\ <\ count;\ script\_index++)}
\DoxyCodeLine{03732\ \ \ \ \ \{}
\DoxyCodeLine{03733\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_script}{Script}}\&\ s\ =\ get\_script\ (script\_index);}
\DoxyCodeLine{03734\ \ \ \ \ \ \ s.prune\_langsys\ (\&c,\ script\_index);}
\DoxyCodeLine{03735\ \ \ \ \ \}}
\DoxyCodeLine{03736\ \ \ \}}
\DoxyCodeLine{03737\ }
\DoxyCodeLine{03738\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ TLookup>}
\DoxyCodeLine{03739\ \ \ \textcolor{keywordtype}{bool}\ subset\ (\mbox{\hyperlink{struct_o_t_1_1hb__subset__layout__context__t}{hb\_subset\_layout\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03740\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03741\ \ \ \ \ TRACE\_SUBSET\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03742\ \ \ \ \ \textcolor{keyword}{auto}\ *out\ =\ c-\/>subset\_context-\/>serializer-\/>embed\ (*\textcolor{keyword}{this});}
\DoxyCodeLine{03743\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!out))\ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{03744\ }
\DoxyCodeLine{03745\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{struct_o_t_1_1_lookup_offset_list}{LookupOffsetList<TLookup>}}\ TLookupList;}
\DoxyCodeLine{03746\ \ \ \ \ \textcolor{keyword}{reinterpret\_cast<}\mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<TLookupList>}}\ \&\textcolor{keyword}{>}\ (out-\/>lookupList)}
\DoxyCodeLine{03747\ \ \ \ \ .serialize\_subset\ (c-\/>subset\_context,}
\DoxyCodeLine{03748\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<TLookupList>}}\ \&\textcolor{keyword}{>}\ (lookupList),}
\DoxyCodeLine{03749\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{this},}
\DoxyCodeLine{03750\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ c);}
\DoxyCodeLine{03751\ }
\DoxyCodeLine{03752\ \ \ \ \ \textcolor{keyword}{reinterpret\_cast<}\mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<RecordListOfFeature>}}\ \&\textcolor{keyword}{>}\ (out-\/>featureList)}
\DoxyCodeLine{03753\ \ \ \ \ .serialize\_subset\ (c-\/>subset\_context,}
\DoxyCodeLine{03754\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<RecordListOfFeature>}}\ \&\textcolor{keyword}{>}\ (featureList),}
\DoxyCodeLine{03755\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{this},}
\DoxyCodeLine{03756\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ c);}
\DoxyCodeLine{03757\ }
\DoxyCodeLine{03758\ \ \ \ \ out-\/>scriptList.serialize\_subset\ (c-\/>subset\_context,}
\DoxyCodeLine{03759\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ scriptList,}
\DoxyCodeLine{03760\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{this},}
\DoxyCodeLine{03761\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ c);}
\DoxyCodeLine{03762\ }
\DoxyCodeLine{03763\ \textcolor{preprocessor}{\#ifndef\ HB\_NO\_VAR}}
\DoxyCodeLine{03764\ \ \ \ \ \textcolor{keywordflow}{if}\ (version.to\_int\ ()\ >=\ 0x00010001u)}
\DoxyCodeLine{03765\ \ \ \ \ \{}
\DoxyCodeLine{03766\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ ret\ =\ out-\/>featureVars.serialize\_subset\ (c-\/>subset\_context,\ featureVars,\ \textcolor{keyword}{this},\ c);}
\DoxyCodeLine{03767\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!ret)}
\DoxyCodeLine{03768\ \ \ \ \ \ \ \{}
\DoxyCodeLine{03769\ \ \ \ \ out-\/>version.major\ =\ 1;}
\DoxyCodeLine{03770\ \ \ \ \ out-\/>version.minor\ =\ 0;}
\DoxyCodeLine{03771\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03772\ \ \ \ \ \}}
\DoxyCodeLine{03773\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03774\ }
\DoxyCodeLine{03775\ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{03776\ \ \ \}}
\DoxyCodeLine{03777\ }
\DoxyCodeLine{03778\ \ \ \textcolor{keywordtype}{void}\ find\_duplicate\_features\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *lookup\_indices,}
\DoxyCodeLine{03779\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ *feature\_indices,}
\DoxyCodeLine{03780\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *duplicate\_feature\_map\ \textcolor{comment}{/*\ OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{03781\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03782\ \ \ \ \ \textcolor{keywordflow}{if}\ (feature\_indices-\/>is\_empty\ ())\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{03783\ \ \ \ \ \mbox{\hyperlink{structhb__hashmap__t}{hb\_hashmap\_t<hb\_tag\_t,\ hb\_set\_t\ *>}}\ unique\_features;}
\DoxyCodeLine{03784\ \ \ \ \ \textcolor{comment}{//find\ out\ duplicate\ features\ after\ subset}}
\DoxyCodeLine{03785\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ :\ feature\_indices-\/>iter\ ())}
\DoxyCodeLine{03786\ \ \ \ \ \{}
\DoxyCodeLine{03787\ \ \ \ \ \ \ hb\_tag\_t\ t\ =\ get\_feature\_tag\ (i);}
\DoxyCodeLine{03788\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (t\ ==\ HB\_MAP\_VALUE\_INVALID)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{03789\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!unique\_features.has\ (t))}
\DoxyCodeLine{03790\ \ \ \ \ \ \ \{}
\DoxyCodeLine{03791\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}*\ indices\ =\ hb\_set\_create\ ();}
\DoxyCodeLine{03792\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (indices\ ==\ hb\_set\_get\_empty\ ()\ ||}
\DoxyCodeLine{03793\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ !unique\_features.set\ (t,\ indices)))}
\DoxyCodeLine{03794\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03795\ \ \ \ \ \ \ \ \ \ \ hb\_set\_destroy\ (indices);}
\DoxyCodeLine{03796\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \_\ :\ unique\_features.iter\ ())}
\DoxyCodeLine{03797\ \ \ \ \ \ \ \ \ \ \ \ \ hb\_set\_destroy\ (\_.second);}
\DoxyCodeLine{03798\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{03799\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03800\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unique\_features.get\ (t))}
\DoxyCodeLine{03801\ \ \ \ \ \ \ \ \ \ \ unique\_features.get\ (t)-\/>add\ (i);}
\DoxyCodeLine{03802\ \ \ \ \ \ \ \ \ duplicate\_feature\_map-\/>set\ (i,\ i);}
\DoxyCodeLine{03803\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{03804\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03805\ }
\DoxyCodeLine{03806\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ found\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03807\ }
\DoxyCodeLine{03808\ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}*\ same\_tag\_features\ =\ unique\_features.get\ (t);}
\DoxyCodeLine{03809\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ other\_f\_index\ :\ same\_tag\_features-\/>iter\ ())}
\DoxyCodeLine{03810\ \ \ \ \ \ \ \{}
\DoxyCodeLine{03811\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_feature}{Feature}}\&\ f\ =\ get\_feature\ (i);}
\DoxyCodeLine{03812\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_feature}{Feature}}\&\ other\_f\ =\ get\_feature\ (other\_f\_index);}
\DoxyCodeLine{03813\ }
\DoxyCodeLine{03814\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ f\_iter\ =}
\DoxyCodeLine{03815\ \ \ \ \ \ \ \ \ +\ hb\_iter\ (f.lookupIndex)}
\DoxyCodeLine{03816\ \ \ \ \ \ \ \ \ |\ hb\_filter\ (lookup\_indices)}
\DoxyCodeLine{03817\ \ \ \ \ \ \ \ \ ;}
\DoxyCodeLine{03818\ }
\DoxyCodeLine{03819\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ other\_f\_iter\ =}
\DoxyCodeLine{03820\ \ \ \ \ \ \ \ \ +\ hb\_iter\ (other\_f.lookupIndex)}
\DoxyCodeLine{03821\ \ \ \ \ \ \ \ \ |\ hb\_filter\ (lookup\_indices)}
\DoxyCodeLine{03822\ \ \ \ \ \ \ \ \ ;}
\DoxyCodeLine{03823\ }
\DoxyCodeLine{03824\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ is\_equal\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03825\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ f\_iter\ \&\&\ other\_f\_iter;\ f\_iter++,\ other\_f\_iter++)}
\DoxyCodeLine{03826\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03827\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{structa}{a}}\ =\ *f\_iter;}
\DoxyCodeLine{03828\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ b\ =\ *other\_f\_iter;}
\DoxyCodeLine{03829\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structa}{a}}\ !=\ b)\ \{\ is\_equal\ =\ \textcolor{keyword}{false};\ \textcolor{keywordflow}{break};\ \}}
\DoxyCodeLine{03830\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03831\ }
\DoxyCodeLine{03832\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_equal\ ==\ \textcolor{keyword}{false}\ ||\ f\_iter\ ||\ other\_f\_iter)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{03833\ }
\DoxyCodeLine{03834\ \ \ \ \ \ \ \ \ found\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03835\ \ \ \ \ \ \ \ \ duplicate\_feature\_map-\/>set\ (i,\ other\_f\_index);}
\DoxyCodeLine{03836\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03837\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03838\ }
\DoxyCodeLine{03839\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (found\ ==\ \textcolor{keyword}{false})}
\DoxyCodeLine{03840\ \ \ \ \ \ \ \{}
\DoxyCodeLine{03841\ \ \ \ \ \ \ \ \ same\_tag\_features-\/>add\ (i);}
\DoxyCodeLine{03842\ \ \ \ \ \ \ \ \ duplicate\_feature\_map-\/>set\ (i,\ i);}
\DoxyCodeLine{03843\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03844\ \ \ \ \ \}}
\DoxyCodeLine{03845\ }
\DoxyCodeLine{03846\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \_\ :\ unique\_features.iter\ ())}
\DoxyCodeLine{03847\ \ \ \ \ \ \ hb\_set\_destroy\ (\_.second);}
\DoxyCodeLine{03848\ \ \ \}}
\DoxyCodeLine{03849\ }
\DoxyCodeLine{03850\ \ \ \textcolor{keywordtype}{void}\ prune\_features\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structhb__map__t}{hb\_map\_t}}\ *lookup\_indices,\ \textcolor{comment}{/*\ IN\ */}}
\DoxyCodeLine{03851\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ \ \ \ \ \ \ *feature\_indices\ \textcolor{comment}{/*\ IN/OUT\ */})\textcolor{keyword}{\ const}}
\DoxyCodeLine{03852\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03853\ \textcolor{preprocessor}{\#ifndef\ HB\_NO\_VAR}}
\DoxyCodeLine{03854\ \ \ \ \ \textcolor{comment}{//\ This\ is\ the\ set\ of\ feature\ indices\ which\ have\ alternate\ versions\ defined}}
\DoxyCodeLine{03855\ \ \ \ \ \textcolor{comment}{//\ if\ the\ FeatureVariation's\ table\ and\ the\ alternate\ version(s)\ intersect\ the}}
\DoxyCodeLine{03856\ \ \ \ \ \textcolor{comment}{//\ set\ of\ lookup\ indices.}}
\DoxyCodeLine{03857\ \ \ \ \ \mbox{\hyperlink{structhb__set__t}{hb\_set\_t}}\ alternate\_feature\_indices;}
\DoxyCodeLine{03858\ \ \ \ \ \textcolor{keywordflow}{if}\ (version.to\_int\ ()\ >=\ 0x00010001u)}
\DoxyCodeLine{03859\ \ \ \ \ \ \ (\textcolor{keyword}{this}+featureVars).closure\_features\ (lookup\_indices,\ \&alternate\_feature\_indices);}
\DoxyCodeLine{03860\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (alternate\_feature\_indices.in\_error()))}
\DoxyCodeLine{03861\ \ \ \ \ \{}
\DoxyCodeLine{03862\ \ \ \ \ \ \ feature\_indices-\/>err\ ();}
\DoxyCodeLine{03863\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{03864\ \ \ \ \ \}}
\DoxyCodeLine{03865\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03866\ }
\DoxyCodeLine{03867\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ :\ feature\_indices-\/>iter())}
\DoxyCodeLine{03868\ \ \ \ \ \{}
\DoxyCodeLine{03869\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_o_t_1_1_feature}{Feature}}\&\ f\ =\ get\_feature\ (i);}
\DoxyCodeLine{03870\ \ \ \ \ \ \ hb\_tag\_t\ tag\ =\ \ get\_feature\_tag\ (i);}
\DoxyCodeLine{03871\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (tag\ ==\ HB\_TAG\ (\textcolor{charliteral}{'p'},\ \textcolor{charliteral}{'r'},\ \textcolor{charliteral}{'e'},\ \textcolor{charliteral}{'f'}))}
\DoxyCodeLine{03872\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Note:\ Never\ ever\ drop\ feature\ 'pref',\ even\ if\ it's\ empty.}}
\DoxyCodeLine{03873\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ HarfBuzz\ chooses\ shaper\ for\ Khmer\ based\ on\ presence\ of\ this}}
\DoxyCodeLine{03874\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ feature.\ See\ thread\ at:}}
\DoxyCodeLine{03875\ \ \ \ \ \textcolor{comment}{//\ http://lists.freedesktop.org/archives/harfbuzz/2012-\/November/002660.html}}
\DoxyCodeLine{03876\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{03877\ }
\DoxyCodeLine{03878\ }
\DoxyCodeLine{03879\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!f.featureParams.is\_null\ ()\ \&\&}
\DoxyCodeLine{03880\ \ \ \ \ \ \ \ \ \ \ tag\ ==\ HB\_TAG\ (\textcolor{charliteral}{'s'},\ \textcolor{charliteral}{'i'},\ \textcolor{charliteral}{'z'},\ \textcolor{charliteral}{'e'}))}
\DoxyCodeLine{03881\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{03882\ }
\DoxyCodeLine{03883\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!f.intersects\_lookup\_indexes\ (lookup\_indices)}
\DoxyCodeLine{03884\ \#ifndef\ HB\_NO\_VAR}
\DoxyCodeLine{03885\ \ \ \ \ \ \ \ \ \ \ \&\&\ !alternate\_feature\_indices.has\ (i)}
\DoxyCodeLine{03886\ \#endif}
\DoxyCodeLine{03887\ \ \ \ \ \ \ )}
\DoxyCodeLine{03888\ \ \ \ \ feature\_indices-\/>del\ (i);}
\DoxyCodeLine{03889\ \ \ \ \ \}}
\DoxyCodeLine{03890\ \ \ \}}
\DoxyCodeLine{03891\ }
\DoxyCodeLine{03892\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ get\_size\ ()\textcolor{keyword}{\ const}}
\DoxyCodeLine{03893\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03894\ \ \ \ \ \textcolor{keywordflow}{return}\ min\_size\ +}
\DoxyCodeLine{03895\ \ \ \ \ \ \ \ (version.to\_int\ ()\ >=\ 0x00010001u\ ?\ featureVars.static\_size\ :\ 0);}
\DoxyCodeLine{03896\ \ \ \}}
\DoxyCodeLine{03897\ }
\DoxyCodeLine{03898\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ TLookup>}
\DoxyCodeLine{03899\ \ \ \textcolor{keywordtype}{bool}\ sanitize\ (\mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ *c)\textcolor{keyword}{\ const}}
\DoxyCodeLine{03900\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{03901\ \ \ \ \ TRACE\_SANITIZE\ (\textcolor{keyword}{this});}
\DoxyCodeLine{03902\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{struct_o_t_1_1_list16_of_offset16_to}{List16OfOffset16To<TLookup>}}\ TLookupList;}
\DoxyCodeLine{03903\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!(version.sanitize\ (c)\ \&\&}
\DoxyCodeLine{03904\ \ \ \ \ \ \ \ \ \ \ \ \ likely\ (version.major\ ==\ 1)\ \&\&}
\DoxyCodeLine{03905\ \ \ \ \ \ \ \ \ \ \ \ \ scriptList.sanitize\ (c,\ \textcolor{keyword}{this})\ \&\&}
\DoxyCodeLine{03906\ \ \ \ \ \ \ \ \ \ \ \ \ featureList.sanitize\ (c,\ \textcolor{keyword}{this})\ \&\&}
\DoxyCodeLine{03907\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<TLookupList>}}\ \&\textcolor{keyword}{>}\ (lookupList).sanitize\ (c,\ \textcolor{keyword}{this}))))}
\DoxyCodeLine{03908\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{03909\ }
\DoxyCodeLine{03910\ \textcolor{preprocessor}{\#ifndef\ HB\_NO\_VAR}}
\DoxyCodeLine{03911\ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!(version.to\_int\ ()\ <\ 0x00010001u\ ||\ featureVars.sanitize\ (c,\ \textcolor{keyword}{this}))))}
\DoxyCodeLine{03912\ \ \ \ \ \ \ return\_trace\ (\textcolor{keyword}{false});}
\DoxyCodeLine{03913\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03914\ }
\DoxyCodeLine{03915\ \ \ \ \ return\_trace\ (\textcolor{keyword}{true});}
\DoxyCodeLine{03916\ \ \ \}}
\DoxyCodeLine{03917\ }
\DoxyCodeLine{03918\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{03919\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_o_t_1_1_g_s_u_b_g_p_o_s_1_1accelerator__t}{accelerator\_t}}}
\DoxyCodeLine{03920\ \ \ \{}
\DoxyCodeLine{03921\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_g_s_u_b_g_p_o_s_1_1accelerator__t}{accelerator\_t}}\ (\mbox{\hyperlink{structhb__face__t}{hb\_face\_t}}\ *face)}
\DoxyCodeLine{03922\ \ \ \ \ \{}
\DoxyCodeLine{03923\ \ \ \ \ \ \ this-\/>table\ =\ \mbox{\hyperlink{structhb__sanitize__context__t}{hb\_sanitize\_context\_t}}\ ().reference\_table<T>\ (face);}
\DoxyCodeLine{03924\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (this-\/>table-\/>is\_blocklisted\ (this-\/>table.get\_blob\ (),\ face)))}
\DoxyCodeLine{03925\ \ \ \ \ \ \ \{}
\DoxyCodeLine{03926\ \ \ \ \ hb\_blob\_destroy\ (this-\/>table.get\_blob\ ());}
\DoxyCodeLine{03927\ \ \ \ \ this-\/>table\ =\ hb\_blob\_get\_empty\ ();}
\DoxyCodeLine{03928\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03929\ }
\DoxyCodeLine{03930\ \ \ \ \ \ \ this-\/>lookup\_count\ =\ table-\/>get\_lookup\_count\ ();}
\DoxyCodeLine{03931\ }
\DoxyCodeLine{03932\ \ \ \ \ \ \ this-\/>accels\ =\ (\mbox{\hyperlink{struct_o_t_1_1hb__ot__layout__lookup__accelerator__t}{hb\_ot\_layout\_lookup\_accelerator\_t}}\ *)\ hb\_calloc\ (this-\/>lookup\_count,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{struct_o_t_1_1hb__ot__layout__lookup__accelerator__t}{hb\_ot\_layout\_lookup\_accelerator\_t}}));}
\DoxyCodeLine{03933\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unlikely\ (!this-\/>accels))}
\DoxyCodeLine{03934\ \ \ \ \ \ \ \{}
\DoxyCodeLine{03935\ \ \ \ \ this-\/>lookup\_count\ =\ 0;}
\DoxyCodeLine{03936\ \ \ \ \ this-\/>table.destroy\ ();}
\DoxyCodeLine{03937\ \ \ \ \ this-\/>table\ =\ hb\_blob\_get\_empty\ ();}
\DoxyCodeLine{03938\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03939\ }
\DoxyCodeLine{03940\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ this-\/>lookup\_count;\ i++)}
\DoxyCodeLine{03941\ \ \ \ \ this-\/>accels[i].init\ (table-\/>get\_lookup\ (i));}
\DoxyCodeLine{03942\ \ \ \ \ \}}
\DoxyCodeLine{03943\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1_g_s_u_b_g_p_o_s_1_1accelerator__t}{\string~accelerator\_t}}\ ()}
\DoxyCodeLine{03944\ \ \ \ \ \{}
\DoxyCodeLine{03945\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ this-\/>lookup\_count;\ i++)}
\DoxyCodeLine{03946\ \ \ \ \ this-\/>accels[i].fini\ ();}
\DoxyCodeLine{03947\ \ \ \ \ \ \ hb\_free\ (this-\/>accels);}
\DoxyCodeLine{03948\ \ \ \ \ \ \ this-\/>table.destroy\ ();}
\DoxyCodeLine{03949\ \ \ \ \ \}}
\DoxyCodeLine{03950\ }
\DoxyCodeLine{03951\ \ \ \ \ \mbox{\hyperlink{structhb__blob__ptr__t}{hb\_blob\_ptr\_t<T>}}\ table;}
\DoxyCodeLine{03952\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ lookup\_count;}
\DoxyCodeLine{03953\ \ \ \ \ \mbox{\hyperlink{struct_o_t_1_1hb__ot__layout__lookup__accelerator__t}{hb\_ot\_layout\_lookup\_accelerator\_t}}\ *accels;}
\DoxyCodeLine{03954\ \ \ \};}
\DoxyCodeLine{03955\ }
\DoxyCodeLine{03956\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{03957\ \ \ \mbox{\hyperlink{struct_o_t_1_1_fixed_version}{FixedVersion<>}}version;\ \ \textcolor{comment}{/*\ Version\ of\ the\ GSUB/GPOS\ table-\/-\/initially\ set}}
\DoxyCodeLine{03958\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ to\ 0x00010000u\ */}}
\DoxyCodeLine{03959\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<ScriptList>}}}
\DoxyCodeLine{03960\ \ \ \ \ \ \ \ \ scriptList;\ \textcolor{comment}{/*\ ScriptList\ table\ */}}
\DoxyCodeLine{03961\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<FeatureList>}}}
\DoxyCodeLine{03962\ \ \ \ \ \ \ \ \ featureList;\ \ \ \ \textcolor{comment}{/*\ FeatureList\ table\ */}}
\DoxyCodeLine{03963\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset16To<LookupList>}}}
\DoxyCodeLine{03964\ \ \ \ \ \ \ \ \ lookupList;\ \textcolor{comment}{/*\ LookupList\ table\ */}}
\DoxyCodeLine{03965\ \ \ \mbox{\hyperlink{struct_o_t_1_1_offset_to}{Offset32To<FeatureVariations>}}}
\DoxyCodeLine{03966\ \ \ \ \ \ \ \ \ featureVars;\ \ \ \ \textcolor{comment}{/*\ Offset\ to\ Feature\ Variations}}
\DoxyCodeLine{03967\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ table-\/-\/from\ beginning\ of\ table}}
\DoxyCodeLine{03968\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ (may\ be\ NULL).\ \ Introduced}}
\DoxyCodeLine{03969\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ in\ version\ 0x00010001.\ */}}
\DoxyCodeLine{03970\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{03971\ \ \ DEFINE\_SIZE\_MIN\ (10);}
\DoxyCodeLine{03972\ \};}
\DoxyCodeLine{03973\ }
\DoxyCodeLine{03974\ }
\DoxyCodeLine{03975\ \}\ \textcolor{comment}{/*\ namespace\ OT\ */}}
\DoxyCodeLine{03976\ }
\DoxyCodeLine{03977\ }
\DoxyCodeLine{03978\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*\ HB\_OT\_LAYOUT\_GSUBGPOS\_HH\ */}\textcolor{preprocessor}{}}

\end{DoxyCode}

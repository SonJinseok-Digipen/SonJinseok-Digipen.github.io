<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: General</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project<span id="projectnumber">&#160;Version 0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">General </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>ws is a command line tool that should exercise most of the IXWebSocket code, and provide example code.</p>
<div class="fragment"><div class="line">ws is a websocket tool</div>
<div class="line">Usage: ws [OPTIONS] SUBCOMMAND</div>
<div class="line"> </div>
<div class="line">Options:</div>
<div class="line">  -h,--help                   Print this help message and exit</div>
<div class="line"> </div>
<div class="line">Subcommands:</div>
<div class="line">  send                        Send a file</div>
<div class="line">  receive                     Receive a file</div>
<div class="line">  transfer                    Broadcasting server</div>
<div class="line">  connect                     Connect to a remote server</div>
<div class="line">  chat                        Group chat</div>
<div class="line">  echo_server                 Echo server</div>
<div class="line">  broadcast_server            Broadcasting server</div>
<div class="line">  ping                        Ping pong</div>
<div class="line">  curl                        HTTP Client</div>
<div class="line">  httpd                       HTTP server</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1761"></a>
curl</h1>
<p>The curl subcommand try to be compatible with the curl syntax, to fetch http pages.</p>
<p>Making a HEAD request with the -I parameter.</p>
<div class="fragment"><div class="line">$ ws curl -I https://www.google.com/</div>
<div class="line"> </div>
<div class="line">Accept-Ranges: none</div>
<div class="line">Alt-Svc: quic=&quot;:443&quot;; ma=2592000; v=&quot;46,43&quot;,h3-Q048=&quot;:443&quot;; ma=2592000,h3-Q046=&quot;:443&quot;; ma=2592000,h3-Q043=&quot;:443&quot;; ma=2592000</div>
<div class="line">Cache-Control: private, max-age=0</div>
<div class="line">Content-Type: text/html; charset=ISO-8859-1</div>
<div class="line">Date: Tue, 08 Oct 2019 21:36:57 GMT</div>
<div class="line">Expires: -1</div>
<div class="line">P3P: CP=&quot;This is not a P3P policy! See g.co/p3phelp for more info.&quot;</div>
<div class="line">Server: gws</div>
<div class="line">Set-Cookie: NID=188=ASwfz8GrXQrHCLqAz-AndLOMLcz0rC9yecnf3h0yXZxRL3rTufTU_GDDwERp7qQL7LZ_EB8gCRyPXGERyOSAgaqgnrkoTmvWrwFemRLMaOZ896GrHobi5fV7VLklnSG2w48Gj8xMlwxfP7Z-bX-xR9UZxep1tHM6UmFQdD_GkBE; expires=Wed, 08-Apr-2020 21:36:57 GMT; path=/; domain=.google.com; HttpOnly</div>
<div class="line">Transfer-Encoding: chunked</div>
<div class="line">Vary: Accept-Encoding</div>
<div class="line">X-Frame-Options: SAMEORIGIN</div>
<div class="line">X-XSS-Protection: 0</div>
<div class="line">Upload size: 143</div>
<div class="line">Download size: 0</div>
<div class="line">Status: 200</div>
</div><!-- fragment --><p>Making a POST request with the -F parameter.</p>
<div class="fragment"><div class="line">$ ws curl -F foo=bar https://httpbin.org/post</div>
<div class="line">foo: bar</div>
<div class="line">Downloaded 438 bytes out of 438</div>
<div class="line">Access-Control-Allow-Credentials: true</div>
<div class="line">Access-Control-Allow-Origin: *</div>
<div class="line">Connection: keep-alive</div>
<div class="line">Content-Encoding:</div>
<div class="line">Content-Length: 438</div>
<div class="line">Content-Type: application/json</div>
<div class="line">Date: Tue, 08 Oct 2019 21:47:54 GMT</div>
<div class="line">Referrer-Policy: no-referrer-when-downgrade</div>
<div class="line">Server: nginx</div>
<div class="line">X-Content-Type-Options: nosniff</div>
<div class="line">X-Frame-Options: DENY</div>
<div class="line">X-XSS-Protection: 1; mode=block</div>
<div class="line">Upload size: 219</div>
<div class="line">Download size: 438</div>
<div class="line">Status: 200</div>
<div class="line">payload: {</div>
<div class="line">  &quot;args&quot;: {},</div>
<div class="line">  &quot;data&quot;: &quot;&quot;,</div>
<div class="line">  &quot;files&quot;: {},</div>
<div class="line">  &quot;form&quot;: {</div>
<div class="line">    &quot;foo&quot;: &quot;bar&quot;</div>
<div class="line">  },</div>
<div class="line">  &quot;headers&quot;: {</div>
<div class="line">    &quot;Accept&quot;: &quot;*/*&quot;,</div>
<div class="line">    &quot;Content-Length&quot;: &quot;7&quot;,</div>
<div class="line">    &quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;,</div>
<div class="line">    &quot;Host&quot;: &quot;httpbin.org&quot;,</div>
<div class="line">    &quot;User-Agent&quot;: &quot;ixwebsocket/7.0.0 macos ssl/OpenSSL OpenSSL 1.0.2q  20 Nov 2018 zlib 1.2.11&quot;</div>
<div class="line">  },</div>
<div class="line">  &quot;json&quot;: null,</div>
<div class="line">  &quot;origin&quot;: &quot;155.94.127.118, 155.94.127.118&quot;,</div>
<div class="line">  &quot;url&quot;: &quot;https://httpbin.org/post&quot;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Passing in a custom header with -H.</p>
<div class="fragment"><div class="line">$ ws curl -F foo=bar -H &#39;my_custom_header: baz&#39; https://httpbin.org/post</div>
<div class="line">my_custom_header:  baz</div>
<div class="line">foo: bar</div>
<div class="line">Downloaded 470 bytes out of 470</div>
<div class="line">Access-Control-Allow-Credentials: true</div>
<div class="line">Access-Control-Allow-Origin: *</div>
<div class="line">Connection: keep-alive</div>
<div class="line">Content-Encoding:</div>
<div class="line">Content-Length: 470</div>
<div class="line">Content-Type: application/json</div>
<div class="line">Date: Tue, 08 Oct 2019 21:50:25 GMT</div>
<div class="line">Referrer-Policy: no-referrer-when-downgrade</div>
<div class="line">Server: nginx</div>
<div class="line">X-Content-Type-Options: nosniff</div>
<div class="line">X-Frame-Options: DENY</div>
<div class="line">X-XSS-Protection: 1; mode=block</div>
<div class="line">Upload size: 243</div>
<div class="line">Download size: 470</div>
<div class="line">Status: 200</div>
<div class="line">payload: {</div>
<div class="line">  &quot;args&quot;: {},</div>
<div class="line">  &quot;data&quot;: &quot;&quot;,</div>
<div class="line">  &quot;files&quot;: {},</div>
<div class="line">  &quot;form&quot;: {</div>
<div class="line">    &quot;foo&quot;: &quot;bar&quot;</div>
<div class="line">  },</div>
<div class="line">  &quot;headers&quot;: {</div>
<div class="line">    &quot;Accept&quot;: &quot;*/*&quot;,</div>
<div class="line">    &quot;Content-Length&quot;: &quot;7&quot;,</div>
<div class="line">    &quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;,</div>
<div class="line">    &quot;Host&quot;: &quot;httpbin.org&quot;,</div>
<div class="line">    &quot;My-Custom-Header&quot;: &quot;baz&quot;,</div>
<div class="line">    &quot;User-Agent&quot;: &quot;ixwebsocket/7.0.0 macos ssl/OpenSSL OpenSSL 1.0.2q  20 Nov 2018 zlib 1.2.11&quot;</div>
<div class="line">  },</div>
<div class="line">  &quot;json&quot;: null,</div>
<div class="line">  &quot;origin&quot;: &quot;155.94.127.118, 155.94.127.118&quot;,</div>
<div class="line">  &quot;url&quot;: &quot;https://httpbin.org/post&quot;</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1762"></a>
connect</h1>
<p>The connect command connects to a websocket endpoint, and starts an interactive prompt. Line editing, such as using the direction keys to fetch the last thing you tried to type) is provided. That command is pretty useful to try to send random data to an endpoint and verify that the service handles it with grace (such as sending invalid json).</p>
<div class="fragment"><div class="line">ws connect wss://echo.websocket.org</div>
<div class="line">Type Ctrl-D to exit prompt...</div>
<div class="line">Connecting to url: wss://echo.websocket.org</div>
<div class="line">&gt; ws_connect: connected</div>
<div class="line">Uri: /</div>
<div class="line">Handshake Headers:</div>
<div class="line">Connection: Upgrade</div>
<div class="line">Date: Tue, 08 Oct 2019 21:38:44 GMT</div>
<div class="line">Sec-WebSocket-Accept: 2j6LBScZveqrMx1W/GJkCWvZo3M=</div>
<div class="line">sec-websocket-extensions:</div>
<div class="line">Server: Kaazing Gateway</div>
<div class="line">Upgrade: websocket</div>
<div class="line">Received ping</div>
<div class="line">Received ping</div>
<div class="line">Received ping</div>
<div class="line">Hello world !</div>
<div class="line">&gt; Received 13 bytes</div>
<div class="line">ws_connect: received message: Hello world !</div>
<div class="line">&gt; Hello world !</div>
<div class="line">&gt; Received 13 bytes</div>
<div class="line">ws_connect: received message: Hello world !</div>
</div><!-- fragment --><div class="fragment"><div class="line">ws connect &#39;ws://jeanserge.com/v2?appkey=_pubsub&#39;</div>
<div class="line">Type Ctrl-D to exit prompt...</div>
<div class="line">Connecting to url: ws://jeanserge.com/v2?appkey=_pubsub</div>
<div class="line">&gt; ws_connect: connected</div>
<div class="line">Uri: /v2?appkey=_pubsub</div>
<div class="line">Handshake Headers:</div>
<div class="line">Connection: Upgrade</div>
<div class="line">Date: Tue, 08 Oct 2019 21:45:28 GMT</div>
<div class="line">Sec-WebSocket-Accept: LYHmjh9Gsu/Yw7aumQqyPObOEV4=</div>
<div class="line">Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=15; client_max_window_bits=15</div>
<div class="line">Server: Python/3.7 websockets/8.0.2</div>
<div class="line">Upgrade: websocket</div>
<div class="line">bababababababab</div>
<div class="line">&gt; ws_connect: connection closed: code 1000 reason</div>
<div class="line"> </div>
<div class="line">ws_connect: connected</div>
<div class="line">Uri: /v2?appkey=_pubsub</div>
<div class="line">Handshake Headers:</div>
<div class="line">Connection: Upgrade</div>
<div class="line">Date: Tue, 08 Oct 2019 21:45:44 GMT</div>
<div class="line">Sec-WebSocket-Accept: I1rqxdLgTU+opPi5/zKPBTuXdLw=</div>
<div class="line">Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=15; client_max_window_bits=15</div>
<div class="line">Server: Python/3.7 websockets/8.0.2</div>
<div class="line">Upgrade: websocket</div>
</div><!-- fragment --><p>It is possible to pass custom <a class="el" href="struct_h_t_t_p.html">HTTP</a> header when doing the connection handshake, the remote server might process them to implement a simple authorization scheme.</p>
<div class="fragment"><div class="line">src$ ws connect -H Authorization:supersecret ws://localhost:8008</div>
<div class="line">Type Ctrl-D to exit prompt...</div>
<div class="line">[2020-12-17 22:35:08.732] [info] Authorization: supersecret</div>
<div class="line">Connecting to url: ws://localhost:8008</div>
<div class="line">&gt; [2020-12-17 22:35:08.736] [info] ws_connect: connected</div>
<div class="line">[2020-12-17 22:35:08.736] [info] Uri: /</div>
<div class="line">[2020-12-17 22:35:08.736] [info] Headers:</div>
<div class="line">[2020-12-17 22:35:08.736] [info] Connection: Upgrade</div>
<div class="line">[2020-12-17 22:35:08.736] [info] Sec-WebSocket-Accept: 2yaTFcdwn8KL6IzSMj2u6Le7KTg=</div>
<div class="line">[2020-12-17 22:35:08.736] [info] Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=15; client_max_window_bits=15</div>
<div class="line">[2020-12-17 22:35:08.736] [info] Server: ixwebsocket/11.0.4 macos ssl/SecureTransport zlib 1.2.11</div>
<div class="line">[2020-12-17 22:35:08.736] [info] Upgrade: websocket</div>
<div class="line">[2020-12-17 22:35:08.736] [info] Received 25 bytes</div>
<div class="line">ws_connect: received message: Authorization suceeded!</div>
<div class="line">[2020-12-17 22:35:08.736] [info] Received pong ixwebsocket::heartbeat::30s::0</div>
<div class="line">hello</div>
<div class="line">&gt; [2020-12-17 22:35:25.157] [info] Received 7 bytes</div>
<div class="line">ws_connect: received message: hello</div>
</div><!-- fragment --><p>If the wrong header is passed in, the server would close the connection with a custom close code (&gt;4000, and &lt;4999).</p>
<div class="fragment"><div class="line">[2020-12-17 22:39:37.044] [info] Upgrade: websocket</div>
<div class="line">ws_connect: connection closed: code 4001 reason Permission denied</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1763"></a>
echo server</h1>
<p>The ws echo server will respond what the client just sent him. If we use the simple &ndash;http_authorization_header we can enforce that client need to pass a special value in the Authorization header to connect.</p>
<div class="fragment"><div class="line">$ ws echo_server --http_authorization_header supersecret</div>
<div class="line">[2020-12-17 22:35:06.192] [info] Listening on 127.0.0.1:8008</div>
<div class="line">[2020-12-17 22:35:08.735] [info] New connection</div>
<div class="line">[2020-12-17 22:35:08.735] [info] remote ip: 127.0.0.1</div>
<div class="line">[2020-12-17 22:35:08.735] [info] id: 0</div>
<div class="line">[2020-12-17 22:35:08.735] [info] Uri: /</div>
<div class="line">[2020-12-17 22:35:08.735] [info] Headers:</div>
<div class="line">[2020-12-17 22:35:08.735] [info] Authorization: supersecret</div>
<div class="line">[2020-12-17 22:35:08.735] [info] Connection: Upgrade</div>
<div class="line">[2020-12-17 22:35:08.735] [info] Host: localhost:8008</div>
<div class="line">[2020-12-17 22:35:08.735] [info] Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=15; client_max_window_bits=15</div>
<div class="line">[2020-12-17 22:35:08.735] [info] Sec-WebSocket-Key: eFF2Gf25dC7eC15Ab1135G==</div>
<div class="line">[2020-12-17 22:35:08.735] [info] Sec-WebSocket-Version: 13</div>
<div class="line">[2020-12-17 22:35:08.735] [info] Upgrade: websocket</div>
<div class="line">[2020-12-17 22:35:08.735] [info] User-Agent: ixwebsocket/11.0.4 macos ssl/SecureTransport zlib 1.2.11</div>
<div class="line">[2020-12-17 22:35:25.157] [info] Received 7 bytes</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1764"></a>
Websocket proxy</h1>
<div class="fragment"><div class="line">ws proxy_server --remote_host ws://127.0.0.1:9000 -v</div>
<div class="line">Listening on 127.0.0.1:8008</div>
</div><!-- fragment --><p>If you connect to ws://127.0.0.1:8008, the proxy will connect to ws://127.0.0.1:9000 and pass all traffic to this server.</p>
<p>You can also use a more complex setup if you want to redirect to different websocket servers based on the hostname your client is trying to connect to. If you have multiple CNAME aliases that point to the same server.</p>
<p><a class="el" href="class_a.html">A</a> JSON config file is used to express that mapping ; here connecting to echo.jeanserge.com will proxy the client to ws://localhost:8008 on the local machine (which actually runs ws echo_server), while connecting to bavarde.jeanserge.com will proxy the client to ws://localhost:5678 where a cobra python server is running. As a side note you will need a wildcard SSL certificate if you want to have SSL enabled on that machine.</p>
<div class="fragment"><div class="line">echo.jeanserge.com=ws://localhost:8008</div>
<div class="line">bavarde.jeanserge.com=ws://localhost:5678</div>
</div><!-- fragment --><p> The &ndash;config_path option is required to instruct ws proxy_server to read that file.</p>
<div class="fragment"><div class="line">ws proxy_server --config_path proxyConfig.json --port 8765</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1765"></a>
File transfer</h1>
<div class="fragment"><div class="line"># Start transfer server, which is just a broadcast server at this point</div>
<div class="line">ws transfer # running on port 8080.</div>
<div class="line"> </div>
<div class="line"># Start receiver first</div>
<div class="line">ws receive ws://localhost:8080</div>
<div class="line"> </div>
<div class="line"># Then send a file. File will be received and written to disk by the receiver process</div>
<div class="line">ws send ws://localhost:8080 /file/to/path</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1766"></a>
HTTP Client</h1>
<div class="fragment"><div class="line">$ ws curl --help</div>
<div class="line">HTTP Client</div>
<div class="line">Usage: ws curl [OPTIONS] url</div>
<div class="line"> </div>
<div class="line">Positionals:</div>
<div class="line">  url TEXT REQUIRED           Connection url</div>
<div class="line"> </div>
<div class="line">Options:</div>
<div class="line">  -h,--help                   Print this help message and exit</div>
<div class="line">  -d TEXT                     Form data</div>
<div class="line">  -F TEXT                     Form data</div>
<div class="line">  -H TEXT                     Header</div>
<div class="line">  --output TEXT               Output file</div>
<div class="line">  -I                          Send a HEAD request</div>
<div class="line">  -L                          Follow redirects</div>
<div class="line">  --max-redirects INT         Max Redirects</div>
<div class="line">  -v                          Verbose</div>
<div class="line">  -O                          Save output to disk</div>
<div class="line">  --compress                  Enable gzip compression</div>
<div class="line">  --connect-timeout INT       Connection timeout</div>
<div class="line">  --transfer-timeout INT      Transfer timeout</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Notes</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project<span id="projectnumber">&#160;Version 0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Notes </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md1380"></a>
General</h1>
<ul>
<li>The default of DLG_FILE (stripping DLG_BASE_PATH (if existent) from the current file) will not really compare DLG_BASE_PATH with the file name but just skip its length</li>
<li>Adding your project name as tag to all calls coming from your library is probably a good idea. It can either be done defining DLG_DEFAULT_TAGS e.g. from the build system (prefer this method). Or add macros that add the tags like this (usually not a good idea):</li>
</ul>
<div class="fragment"><div class="line"><span class="preprocessor">#define MY_ADD_TAGS(tags, ...) (MY_EVAL tags, __VA_ARGS__)</span></div>
<div class="line"><span class="preprocessor">#define MY_EVAL(...) __VA_ARGS__</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define my_warn(...) dlg_warnt((&quot;my&quot;</span>), __VA_ARGS__)</div>
<div class="line"><span class="preprocessor">#deinfe my_warnt(tags, ...) dlg_warnt(MY_ADD_TAGS(tags, &quot;my&quot;</span>), __VA_ARGS__)</div>
</div><!-- fragment --><p><b>TODO</b>: Add some examples on how tags could be used</p>
<h1><a class="anchor" id="autotoc_md1381"></a>
Windows/msvc troubleshooting</h1>
<p>Windows and msvc are fully supported (and tested) by dlg. We try to work around most of the... issues on windows by there are a few things you have to keep in mind for dlg to work.</p>
<ul>
<li>msvc (at the state of 2017, still) does not allow/correctly handle utf-8 string literals<ul>
<li>this means <code>dlg_fprintf(stdout, u8"äü")</code> will not work by default since the string passed there is not utf-8 encoded</li>
<li>The above example can be made to work using the <code>/utf-8</code> switch on msvc</li>
</ul>
</li>
<li>note that dlg always passes filepaths in their native representation so with msvc the filepath will have backslashes (important if you e.g. want to handle logging calls from different files differently)</li>
<li><p class="startli">meson on windows: if you want to define DLG_BASE_PATH using meson you will have to work around the backslashes (e.g. in the path returned from <code>meson.source_root()</code>) sine those would be interpreted as invalid escape characters and there is not meson function to escape backslashes correctly (as of 2017).</p>
<p class="startli">DLG itself handles it this way:</p>
</li>
</ul>
<div class="fragment"><div class="line">source_root = meson.source_root().split(&#39;\\&#39;)</div>
<div class="line">add_project_arguments(&#39;-DDLG_BASE_PATH=&quot;&#39; + &#39;/&#39;.join(source_root) + &#39;/&quot;&#39;, language: &#39;c&#39;)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1382"></a>
C-api tag guards</h2>
<div class="fragment"><div class="line"><span class="preprocessor">    #define dlg_tag_base(global, tags, code) { \</span></div>
<div class="line"><span class="preprocessor">        const char* _dlg_tag_tags[] = {DLG_EVAL tags}; \</span></div>
<div class="line"><span class="preprocessor">        const char** _dlg_tag_ptr = _dlg_tag_tags;; \</span></div>
<div class="line"><span class="preprocessor">        const char* _dlg_tag_func = global ? NULL : __FUNCTION__; \</span></div>
<div class="line"><span class="preprocessor">        while(_dlg_tag_ptr)  \</span></div>
<div class="line"><span class="preprocessor">            dlg_add_tag(_dlg_tag_ptr++, _dlg_tag_func); \</span></div>
<div class="line"><span class="preprocessor">        code \</span></div>
<div class="line"><span class="preprocessor">        _dlg_tag_ptr = _dlg_tag_tags; \</span></div>
<div class="line"><span class="preprocessor">        while(_dlg_tag_ptr) \</span></div>
<div class="line"><span class="preprocessor">             dlg_remove_tag(_dlg_tag_ptr++, _dlg_tag_func); \</span></div>
<div class="line"><span class="preprocessor">    }</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#if DLG_CHECK</span></div>
<div class="line"><span class="preprocessor">    #define dlg_check(code) { code }</span></div>
<div class="line"><span class="preprocessor">    #define dlg_checkt(tags, code) dlg_tag(tags, code)</span></div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor">    #define dlg_check(code)</span></div>
<div class="line"><span class="preprocessor">    #define dlg_checkt(tags, code)</span></div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">// DLG_CHECK</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define dlg_tag(tags, code) dlg_tag_base(false, tags, code)</span></div>
<div class="line"><span class="preprocessor">#define dlg_tag_global(tags, code) dlg_tag_base(true, tags, code)</span></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1383"></a>
Idea: Custom assert macro handler</h2>
<div class="fragment"><div class="line"><span class="comment">// Can be specified to a custom assert handler/checker.</span></div>
<div class="line"><span class="comment">// Will be called for every failed assertion. If it returns true,</span></div>
<div class="line"><span class="comment">// the default failed assertion log will be done by dlg, otherwise</span></div>
<div class="line"><span class="comment">// no further action will be taken.</span></div>
<div class="line"><span class="comment">// Must have the signature &#39;bool (const char* expr)&#39;.</span></div>
<div class="line"><span class="comment">// The default (dlg__assertion_failed) just always returns false.</span></div>
<div class="line"><span class="comment">// Useful as breakpoint.</span></div>
<div class="line"><span class="preprocessor">#ifndef DLG_ASSERT_FILTER</span></div>
<div class="line"><span class="preprocessor">    #define DLG_ASSERT_FILTER dlg__assertion_failed</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">bool</span> dlg_assertion_failed(<span class="keyword">const</span> <span class="keywordtype">char</span>* expr);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="preprocessor">#define DLG__CHECK_ASSERT(lvl, expr) \</span></div>
<div class="line"><span class="preprocessor">    (level &gt; DLG_ASSERT_LEVEL &amp;&amp; !(expr) &amp;&amp; DLG_ASSERT_FILER(#expr))</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define dlg_assertl(level, expr) if(DLG__CHECK_ASSERT(level, expr)) \</span></div>
<div class="line"><span class="preprocessor">    dlg__do_log(level, DLG_CREATE_TAGS(NULL), DLG_FILE, __LINE__, __func__, NULL, #expr)</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// ...</span></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
